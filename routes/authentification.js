function a1_0x1d79(_0x134532,_0x30b921){const _0x252c2a=a1_0x252c();return a1_0x1d79=function(_0x1d796b,_0xc064ac){_0x1d796b=_0x1d796b-0xd1;let _0x36785c=_0x252c2a[_0x1d796b];return _0x36785c;},a1_0x1d79(_0x134532,_0x30b921);}function a1_0x252c(){const _0x555ef4=['../libs/jwt','mkdirSync','/login','last_name','json','single','execute','Error!\x20Something\x20went\x20wrong.','copyFileSync','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20\x20\x20</html>\x0a\x20\x20\x20\x20','body','message','7451650DRlQXT','transporter','119278KrBddR','avatar_url','existsSync','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`id`\x20=\x20?','length','path','status','/validate-email/','Welcome\x20to\x20CADViewer','insertId','User\x20already\x20exists','8djVgVJ','60GnNWvj','crypted_password','smtpFrom','/update-user-info','promise','Invalid\x20user','13krqMdf','jwtSecretKey','2288037MlohyI','24h','first_name','/signup','crypto','diskStorage','express','./avatars','verifyToken','/validate-email/:token','\x0a\x20\x20\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Welcome\x20to\x20CADViewer!</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20are\x20delighted\x20to\x20welcome\x20you\x20to\x20our\x20community.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','user','file','./uploads/','/update-password','UPDATE\x20`users`\x20SET\x20`username`\x20=\x20?,\x20`first_name`\x20=\x20?,\x20`last_name`\x20=\x20?,\x20`avatar_url`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','Invalid\x20email\x20or\x20password','params','post','compare','demo_user','INSERT\x20INTO\x20`users`\x20(`username`,\x20`email`,\x20`crypted_password`,\x20`role`,\x20`is_enabled`,\x20`validation_token`,\x20`created_at`,\x20`updated_at`,\x20`folder_name`)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20NOW(),\x20NOW(),\x20?)','hash','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','64336oIBEdE','username','enableEmailVerification','Email\x20validated\x20successfully','frontendUrl','role','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`is_enabled`\x20=\x201\x20AND\x20`email`\x20=\x20?','sign','3665478hEmlIm','../CADViewer_config.json','6831864sWZsVD','avatar','../libs/mysql.js','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`validation_token`\x20=\x20?','Router','5886027hmujVj','log','multer','stack','ServerUrl','Invalid\x20validation\x20token','email','===================error===================','exports','../libs/mail','avatars/','sendMail','UPDATE\x20`users`\x20SET\x20`crypted_password`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?'];a1_0x252c=function(){return _0x555ef4;};return a1_0x252c();}const a1_0x24311c=a1_0x1d79;(function(_0xca3689,_0xab17b){const _0x3e10f5=a1_0x1d79,_0x557cec=_0xca3689();while(!![]){try{const _0x3c9226=parseInt(_0x3e10f5(0xeb))/0x1*(parseInt(_0x3e10f5(0xd9))/0x2)+-parseInt(_0x3e10f5(0xed))/0x3+parseInt(_0x3e10f5(0x105))/0x4*(parseInt(_0x3e10f5(0xe5))/0x5)+-parseInt(_0x3e10f5(0x10d))/0x6+parseInt(_0x3e10f5(0x114))/0x7*(parseInt(_0x3e10f5(0xe4))/0x8)+-parseInt(_0x3e10f5(0x10f))/0x9+parseInt(_0x3e10f5(0xd7))/0xa;if(_0x3c9226===_0xab17b)break;else _0x557cec['push'](_0x557cec['shift']());}catch(_0x515f8a){_0x557cec['push'](_0x557cec['shift']());}}}(a1_0x252c,0x66f15));const jwt=require('jsonwebtoken'),bcrypt=require('bcrypt'),config=require(a1_0x24311c(0x10e)),conn=require(a1_0x24311c(0x111)),multer=require(a1_0x24311c(0x116)),fs=require('fs'),verifyToken=require(a1_0x24311c(0x121))[a1_0x24311c(0xf5)];!fs[a1_0x24311c(0xdb)](a1_0x24311c(0xf4))&&fs[a1_0x24311c(0x122)](a1_0x24311c(0xf4));const express=require(a1_0x24311c(0xf3)),router=express[a1_0x24311c(0x113)](),{randomUUID}=require(a1_0x24311c(0xf1)),storage=multer[a1_0x24311c(0xf2)]({'destination':function(_0x4bcab4,_0x403969,_0x58276f){_0x58276f(null,'avatars');}}),upload=multer({'storage':storage});router[a1_0x24311c(0xff)](a1_0x24311c(0x123),async(_0x3e9990,_0x33b978,_0x152dd7)=>{const _0x4340e8=a1_0x24311c;let {email:_0x32d134,password:_0x2c4479}=_0x3e9990['body'];console['log']({'email':_0x32d134,'password':_0x2c4479});let _0x36e07f;try{const [_0x111504]=await conn[_0x4340e8(0xe9)]()[_0x4340e8(0xd1)](_0x4340e8(0x10b),[_0x32d134]);_0x111504[_0x4340e8(0xdd)]>0x0&&(_0x36e07f=_0x111504[0x0]);}catch(_0x3a7c51){console[_0x4340e8(0x115)]({'err':_0x3a7c51}),_0x33b978[_0x4340e8(0xdf)](0x1f4)[_0x4340e8(0x125)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x36e07f||!await bcrypt[_0x4340e8(0x100)](_0x2c4479,_0x36e07f?.['crypted_password'])){_0x33b978[_0x4340e8(0xdf)](0x191)['json']({'error':_0x4340e8(0xfd)});return;}let _0x4aef3b;try{_0x4aef3b=jwt[_0x4340e8(0x10c)]({'userId':_0x36e07f['id'],'email':_0x36e07f['email']},config[_0x4340e8(0xec)],{'expiresIn':_0x4340e8(0xee)});}catch(_0x19cbb1){console[_0x4340e8(0x115)](_0x19cbb1),_0x33b978[_0x4340e8(0xdf)](0x1f4)[_0x4340e8(0x125)]({'error':_0x4340e8(0xd2)});return;}_0x33b978[_0x4340e8(0xdf)](0xc8)['json']({'success':!![],'data':{'userId':_0x36e07f['id'],'username':_0x36e07f['username'],'first_name':_0x36e07f[_0x4340e8(0xef)],'last_name':_0x36e07f['last_name'],'email':_0x36e07f[_0x4340e8(0x11a)],'avatar_url':_0x36e07f[_0x4340e8(0xda)],'id':_0x36e07f['id'],'role':_0x36e07f[_0x4340e8(0x10a)],'token':_0x4aef3b}});}),router[a1_0x24311c(0xff)](a1_0x24311c(0xf0),async(_0x14e9e0,_0x2a53f2,_0x1ad252)=>{const _0x350fc6=a1_0x24311c,{username:_0x68b2d6,email:_0x585171,password:_0x38785e}=_0x14e9e0[_0x350fc6(0xd5)],[_0x133703]=await conn[_0x350fc6(0xe9)]()[_0x350fc6(0xd1)](_0x350fc6(0x104),[_0x585171]);if(_0x133703[_0x350fc6(0xdd)]>0x0){_0x2a53f2[_0x350fc6(0xdf)](0x1a6)[_0x350fc6(0x125)]({'error':_0x350fc6(0xe3)});return;}const _0x1adf7b=await bcrypt['hash'](_0x38785e,0xa);let _0x20974f=null,_0x359093=0x1;config[_0x350fc6(0x107)]&&(_0x20974f=randomUUID(),_0x359093=0x0);let _0x423a75;try{const _0x405d7f=randomUUID(),_0x406876=_0x350fc6(0xfa)+_0x405d7f;fs[_0x350fc6(0x122)](_0x406876);const [_0xd100f0]=await conn[_0x350fc6(0xe9)]()[_0x350fc6(0xd1)](_0x350fc6(0x102),[_0x68b2d6,_0x585171,_0x1adf7b,_0x350fc6(0x101),_0x359093,_0x20974f,_0x405d7f]);if(_0xd100f0[_0x350fc6(0xe2)]){const [_0x50abf1]=await conn[_0x350fc6(0xe9)]()['execute'](_0x350fc6(0xdc),[_0xd100f0[_0x350fc6(0xe2)]]);_0x50abf1[_0x350fc6(0xdd)]>0x0&&(_0x423a75=_0x50abf1[0x0]);}}catch{_0x2a53f2['status'](0x1f4)['json']({'error':_0x350fc6(0xd2)});return;}let _0x42b20a;try{_0x42b20a=jwt[_0x350fc6(0x10c)]({'userId':_0x423a75['id'],'email':_0x423a75['email']},config[_0x350fc6(0xec)],{'expiresIn':_0x350fc6(0xee)});}catch(_0x383ba6){_0x2a53f2[_0x350fc6(0xdf)](0x1f4)[_0x350fc6(0x125)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}const _0x395b38=require(_0x350fc6(0x11d))[_0x350fc6(0xd8)];let _0x5dc23a='<p>Welcome\x20to\x20CADViewer</p>';if(config[_0x350fc6(0x107)]){const _0x1e92b2=config[_0x350fc6(0x109)]+_0x350fc6(0xe0)+_0x20974f;_0x5dc23a=_0x350fc6(0xf7)+_0x1e92b2+'\x22\x20class=\x22button\x22>Validate\x20my\x20email\x20address</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20the\x20button\x20doesn\x27t\x20work,\x20you\x20can\x20copy\x20and\x20paste\x20this\x20link\x20in\x20your\x20browser:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22word-break:\x20break-all;\x22>'+_0x1e92b2+_0x350fc6(0xd4);const _0xbe343c={'from':config[_0x350fc6(0xe7)],'to':_0x423a75[_0x350fc6(0x11a)],'subject':_0x350fc6(0xe1),'text':_0x350fc6(0xe1),'html':_0x5dc23a};try{await _0x395b38[_0x350fc6(0x11f)](_0xbe343c);}catch(_0x4ff161){console[_0x350fc6(0x115)](_0x350fc6(0x11b)),console['log'](_0x4ff161),_0x2a53f2['status'](0x1f4)['json']({'error':'Error!\x20Something\x20went\x20wrong\x20while\x20sending\x20the\x20email','stack':_0x4ff161[_0x350fc6(0x117)],'message':_0x4ff161[_0x350fc6(0xd6)]});return;}_0x2a53f2[_0x350fc6(0xdf)](0xc8)[_0x350fc6(0x125)]({'success':!![],'message':'Please\x20check\x20your\x20email\x20to\x20validate\x20your\x20account'});return;}_0x2a53f2['status'](0xc9)['json']({'success':!![],'data':{'userId':_0x423a75['id'],'username':_0x423a75[_0x350fc6(0x106)],'first_name':_0x423a75[_0x350fc6(0xef)],'last_name':_0x423a75[_0x350fc6(0x124)],'email':_0x423a75[_0x350fc6(0x11a)],'avatar_url':_0x423a75[_0x350fc6(0xda)],'id':_0x423a75['id'],'role':_0x423a75['role'],'token':_0x42b20a,'is_enabled':_0x423a75['is_enabled']}});}),router[a1_0x24311c(0xff)](a1_0x24311c(0xf6),async(_0x2cd8b5,_0x2092be)=>{const _0x60540b=a1_0x24311c;try{const {token:_0x61fae8}=_0x2cd8b5[_0x60540b(0xfe)],[_0x2fefe1]=await conn[_0x60540b(0xe9)]()[_0x60540b(0xd1)](_0x60540b(0x112),[_0x61fae8]);if(_0x2fefe1['length']===0x0){_0x2092be[_0x60540b(0xdf)](0x194)[_0x60540b(0x125)]({'error':_0x60540b(0x119)});return;}await conn[_0x60540b(0xe9)]()['execute']('UPDATE\x20`users`\x20SET\x20`is_enabled`\x20=\x201,\x20`validation_token`\x20=\x20NULL,\x20`updated_at`\x20=\x20NOW()\x20WHERE\x20`validation_token`\x20=\x20?',[_0x61fae8]);const _0x51ac80=jwt[_0x60540b(0x10c)]({'id':_0x2fefe1[0x0]['id'],'email':_0x2fefe1[0x0]['email']},config[_0x60540b(0xec)],{'expiresIn':_0x60540b(0xee)});_0x2092be['status'](0xc8)[_0x60540b(0x125)]({'success':!![],'message':_0x60540b(0x108),'data':{'userId':_0x2fefe1[0x0]['id'],'username':_0x2fefe1[0x0][_0x60540b(0x106)],'first_name':_0x2fefe1[0x0]['first_name'],'last_name':_0x2fefe1[0x0][_0x60540b(0x124)],'email':_0x2fefe1[0x0][_0x60540b(0x11a)],'avatar_url':_0x2fefe1[0x0][_0x60540b(0xda)],'id':_0x2fefe1[0x0]['id'],'role':_0x2fefe1[0x0][_0x60540b(0x10a)],'token':_0x51ac80,'is_enabled':0x1}});}catch(_0x338d10){console['log'](_0x60540b(0x11b)),console['log'](_0x338d10),_0x2092be['status'](0x1f4)[_0x60540b(0x125)]({'error':'Error!\x20Something\x20went\x20wrong.','stack':_0x338d10[_0x60540b(0x117)],'message':_0x338d10['message']});}}),router[a1_0x24311c(0xff)](a1_0x24311c(0xfb),verifyToken,async(_0x246912,_0xd4a46e,_0x502ed3)=>{const _0x4b8b89=a1_0x24311c,{current_password:_0x3e80f2,new_password:_0xe1eae8}=_0x246912[_0x4b8b89(0xd5)];console[_0x4b8b89(0x115)]({'body':_0x246912[_0x4b8b89(0xd5)]});const _0x2cd082=_0x246912['user']['email'];let _0x5442c3;try{const [_0x33d14a]=await conn[_0x4b8b89(0xe9)]()[_0x4b8b89(0xd1)](_0x4b8b89(0x104),[_0x2cd082]);if(_0x33d14a[_0x4b8b89(0xdd)]>0x0){_0x5442c3=_0x33d14a[0x0];if(!await bcrypt['compare'](_0x3e80f2,_0x5442c3[_0x4b8b89(0xe6)])){_0xd4a46e[_0x4b8b89(0xdf)](0x191)[_0x4b8b89(0x125)]({'error':'Invalid\x20password'});return;}const _0xbe98ed=await bcrypt[_0x4b8b89(0x103)](_0xe1eae8,0xa);await conn[_0x4b8b89(0xe9)]()[_0x4b8b89(0xd1)](_0x4b8b89(0x120),[_0xbe98ed,_0x2cd082]),_0xd4a46e[_0x4b8b89(0xdf)](0xc8)[_0x4b8b89(0x125)]({'success':!![]});}}catch(_0x233663){console['log']({'err':_0x233663}),_0xd4a46e[_0x4b8b89(0xdf)](0x1f4)[_0x4b8b89(0x125)]({'error':_0x4b8b89(0xd2)});return;}}),router[a1_0x24311c(0xff)](a1_0x24311c(0xe8),upload[a1_0x24311c(0x126)](a1_0x24311c(0x110)),verifyToken,async(_0x1caa28,_0x3326a1,_0x4bd388)=>{const _0x3aa23f=a1_0x24311c,{username:_0x59dc5f,first_name:_0x55b234,last_name:_0x252ad6}=_0x1caa28[_0x3aa23f(0xd5)],_0x37fd87=_0x1caa28[_0x3aa23f(0xf8)][_0x3aa23f(0x11a)];let _0x5e437b;try{const [_0x532d05]=await conn[_0x3aa23f(0xe9)]()[_0x3aa23f(0xd1)]('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x37fd87]);_0x532d05['length']>0x0&&(_0x5e437b=_0x532d05[0x0]);}catch(_0x3f7efb){console['log']({'err':_0x3f7efb}),_0x3326a1[_0x3aa23f(0xdf)](0x1f4)[_0x3aa23f(0x125)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x5e437b){_0x3326a1['status'](0x191)[_0x3aa23f(0x125)]({'error':_0x3aa23f(0xea)});return;}console['log']({'req':_0x1caa28[_0x3aa23f(0xd5)]});let _0x451f61=_0x5e437b[_0x3aa23f(0xda)];if(_0x1caa28[_0x3aa23f(0xf9)]){const _0xd6089c=_0x3aa23f(0x11e)+randomUUID()+'.png';fs[_0x3aa23f(0xd3)](_0x1caa28[_0x3aa23f(0xf9)][_0x3aa23f(0xde)],'./'+_0xd6089c),fs['unlinkSync'](_0x1caa28[_0x3aa23f(0xf9)][_0x3aa23f(0xde)]),_0x451f61=config[_0x3aa23f(0x118)]+'/'+_0xd6089c;}try{await conn[_0x3aa23f(0xe9)]()['execute'](_0x3aa23f(0xfc),[_0x59dc5f,_0x55b234,_0x252ad6,_0x451f61,_0x37fd87]);let _0x1cc077;try{_0x1cc077=jwt[_0x3aa23f(0x10c)]({'userId':_0x5e437b['id'],'email':_0x5e437b['email']},config[_0x3aa23f(0xec)],{'expiresIn':_0x3aa23f(0xee)});}catch(_0x37a555){console[_0x3aa23f(0x115)](_0x37a555),_0x3326a1[_0x3aa23f(0xdf)](0x1f4)[_0x3aa23f(0x125)]({'error':_0x3aa23f(0xd2)});return;}_0x3326a1['status'](0xc8)[_0x3aa23f(0x125)]({'success':!![],'data':{'userId':_0x5e437b['id'],'username':_0x59dc5f,'first_name':_0x55b234,'last_name':_0x252ad6,'email':_0x5e437b[_0x3aa23f(0x11a)],'avatar_url':_0x451f61,'token':_0x1cc077}});}catch(_0x43d880){console['log']({'err':_0x43d880}),_0x3326a1[_0x3aa23f(0xdf)](0x1f4)['json']({'error':_0x3aa23f(0xd2)});return;}}),module[a1_0x24311c(0x11c)]=router;