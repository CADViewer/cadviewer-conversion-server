const a15_0x113c6c=a15_0x935e;(function(_0x28cb89,_0x5ec9b1){const _0x1c4c17=a15_0x935e,_0x461b14=_0x28cb89();while(!![]){try{const _0x3e8e98=-parseInt(_0x1c4c17(0xb8))/0x1*(-parseInt(_0x1c4c17(0xb5))/0x2)+parseInt(_0x1c4c17(0xbe))/0x3*(parseInt(_0x1c4c17(0xd6))/0x4)+parseInt(_0x1c4c17(0xcf))/0x5*(parseInt(_0x1c4c17(0xad))/0x6)+-parseInt(_0x1c4c17(0xd0))/0x7*(-parseInt(_0x1c4c17(0xd9))/0x8)+-parseInt(_0x1c4c17(0xaf))/0x9+-parseInt(_0x1c4c17(0xe6))/0xa*(-parseInt(_0x1c4c17(0xba))/0xb)+-parseInt(_0x1c4c17(0xda))/0xc;if(_0x3e8e98===_0x5ec9b1)break;else _0x461b14['push'](_0x461b14['shift']());}catch(_0xdf9ecd){_0x461b14['push'](_0x461b14['shift']());}}}(a15_0x33a0,0x318ec));function a15_0x935e(_0x649402,_0x17130a){const _0x33a06d=a15_0x33a0();return a15_0x935e=function(_0x935e55,_0x4511a7){_0x935e55=_0x935e55-0xa8;let _0x565f9b=_0x33a06d[_0x935e55];return _0x565f9b;},a15_0x935e(_0x649402,_0x17130a);}const fs=require('fs'),path=require(a15_0x113c6c(0xe1)),config=require(a15_0x113c6c(0xaa)),verifyTokenOptional=require(a15_0x113c6c(0xae))[a15_0x113c6c(0xc7)],show_folders=![],express=require(a15_0x113c6c(0xcb)),router=express[a15_0x113c6c(0xdc)](),conn=require(a15_0x113c6c(0xc3)),{randomUUID}=require(a15_0x113c6c(0xc9)),dir=a15_0x113c6c(0xb9);function a15_0x33a0(){const _0x40e639=['Error!\x20Something\x20went\x20wrong.','utf8','cvhs_debug:','execute','path','push','./uploads/','readdirSync','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','190JiAHui','\x20\x20\x20','false','get','folderLocationDemoUser','../CADViewer_config.json','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','role','5976tCBgSZ','../libs/jwt','2028771ShIfHf','in\x20listFolderStructure\x20folderLocation=','json','\x20show_folders:','status','send','2YAuKkp','parse','existsSync','239119VPyLXa','./uploads','217393NeBpQC','query','CADViewer_config.json','├──\x20','117ozNbSr','length','user','promise','mkdirSync','../libs/mysql','log','└──\x20','email','verifyTokenOptional','exports','crypto','MY\x20FOLDER','express','children','birthtime','Invalid\x20user','565jbQDrN','21qZlwyH','folderLocation','join','dirname','mtime','loginFeatureEnabled','39452wRumGC','cvjs_debug','size','1042936MNjtRt','12894180uKygWc','resolve','Router'];a15_0x33a0=function(){return _0x40e639;};return a15_0x33a0();}!fs[a15_0x113c6c(0xb7)](dir)&&fs[a15_0x113c6c(0xc2)](dir);const sortFoldersFirst=(_0x46bc4c,_0x13b6e3)=>{const _0x10e142=a15_0x113c6c;if(_0x46bc4c['children']&&!_0x13b6e3[_0x10e142(0xcc)])return-0x1;else return!_0x46bc4c[_0x10e142(0xcc)]&&_0x13b6e3[_0x10e142(0xcc)]?0x1:0x0;},listFolderStructure=(_0x5e894a,_0x343705='')=>{const _0x53171d=a15_0x113c6c,_0xab548f=fs[_0x53171d(0xe4)](_0x5e894a),_0xc121d3=[];return _0xab548f['forEach'](_0x119c59=>{const _0x2c810d=_0x53171d,_0x2f05f8=path[_0x2c810d(0xd2)](_0x5e894a,_0x119c59),_0x3528f2=fs['statSync'](_0x2f05f8);if(_0x3528f2['isDirectory']()){if(config['cvjs_debug']&&show_folders)console['log'](_0x343705+_0x2c810d(0xc5)+_0x119c59);const _0x1fb3b1=listFolderStructure(_0x2f05f8,_0x343705+_0x2c810d(0xe7));_0xc121d3[_0x2c810d(0xe2)]({'name':_0x119c59,'path':_0x2f05f8,'size':_0x3528f2[_0x2c810d(0xd8)],'created':_0x3528f2[_0x2c810d(0xcd)],'modified':_0x3528f2[_0x2c810d(0xd4)],'isFolder':!![],'children':_0x1fb3b1});}else{_0xc121d3[_0x2c810d(0xe2)]({'name':_0x119c59,'path':_0x2f05f8,'size':_0x3528f2[_0x2c810d(0xd8)],'created':_0x3528f2['birthtime'],'modified':_0x3528f2[_0x2c810d(0xd4)],'isFolder':![]});if(config[_0x2c810d(0xd7)]&&show_folders)console['log'](_0x343705+_0x2c810d(0xbd)+_0x119c59);}}),_0xc121d3['sort'](sortFoldersFirst);};router[a15_0x113c6c(0xa8)]('',verifyTokenOptional,async(_0x41ac7d,_0x578e5c)=>{const _0x35be7b=a15_0x113c6c,_0x590fa1=path['join'](path[_0x35be7b(0xd3)](require['main']['filename']),_0x35be7b(0xbc)),_0x1b1480=JSON[_0x35be7b(0xb6)](fs['readFileSync'](_0x590fa1,_0x35be7b(0xde))),_0x2d14c1=_0x41ac7d[_0x35be7b(0xbb)][_0x35be7b(0xd5)];let _0x1c46e2=_0x1b1480[_0x35be7b(0xa9)];_0x2d14c1===_0x35be7b(0xe8)&&(_0x1c46e2=_0x1b1480[_0x35be7b(0xd1)]);console[_0x35be7b(0xc4)](_0x35be7b(0xb0)+_0x1c46e2+_0x35be7b(0xb2)+show_folders+_0x35be7b(0xdf)+config[_0x35be7b(0xd7)]);if(_0x41ac7d['user']){let _0x43ff62;try{const [_0x2e7fca]=await conn[_0x35be7b(0xc1)]()[_0x35be7b(0xe0)](_0x35be7b(0xab),[_0x41ac7d['user']['email']]);_0x2e7fca[_0x35be7b(0xbf)]>0x0&&(_0x43ff62=_0x2e7fca[0x0]);}catch(_0xafc93e){console[_0x35be7b(0xc4)]({'err':_0xafc93e}),_0x578e5c[_0x35be7b(0xb3)](0x1f4)['json']({'error':_0x35be7b(0xdd)});return;}if(!_0x43ff62){_0x578e5c[_0x35be7b(0xb3)](0x191)['json']({'error':_0x35be7b(0xce)});return;}_0x43ff62[_0x35be7b(0xac)]==='admin'&&(_0x1c46e2=_0x1b1480['folderLocation']);let _0x13500f=_0x43ff62['folder_name'];if(!_0x13500f){_0x13500f=randomUUID();try{await conn[_0x35be7b(0xc1)]()[_0x35be7b(0xe0)](_0x35be7b(0xe5),[_0x13500f,_0x41ac7d[_0x35be7b(0xc0)][_0x35be7b(0xc6)]]);}catch(_0x780c0e){console['log']({'err':_0x780c0e}),_0x578e5c['status'](0x1f4)[_0x35be7b(0xb1)]({'error':_0x35be7b(0xdd)});return;}}const _0x4ed059=_0x35be7b(0xe3)+_0x13500f;!fs['existsSync'](_0x4ed059)&&fs[_0x35be7b(0xc2)](_0x4ed059);const _0x2dc69a=path[_0x35be7b(0xdb)](_0x4ed059),_0x1745c6=listFolderStructure(_0x2dc69a);!fs[_0x35be7b(0xb7)](_0x1c46e2)&&fs[_0x35be7b(0xc2)](_0x1c46e2),dirs=[{'own':!![],'name':_0x35be7b(0xca),'path':_0x4ed059,'isFolder':!![],'children':_0x1745c6},...listFolderStructure(_0x1c46e2)],_0x578e5c[_0x35be7b(0xb4)](dirs);}else!fs[_0x35be7b(0xb7)](_0x1c46e2)&&fs[_0x35be7b(0xc2)](_0x1c46e2),_0x578e5c[_0x35be7b(0xb4)](listFolderStructure(_0x1c46e2));}),module[a15_0x113c6c(0xc8)]=router;