const a15_0x1171cd=a15_0x5789;(function(_0x243e6e,_0x430643){const _0x4da5bd=a15_0x5789,_0x4d894c=_0x243e6e();while(!![]){try{const _0x1eb8e2=parseInt(_0x4da5bd(0x18e))/0x1*(parseInt(_0x4da5bd(0x17b))/0x2)+parseInt(_0x4da5bd(0x175))/0x3+-parseInt(_0x4da5bd(0x1a3))/0x4*(parseInt(_0x4da5bd(0x18d))/0x5)+parseInt(_0x4da5bd(0x1ab))/0x6*(parseInt(_0x4da5bd(0x171))/0x7)+parseInt(_0x4da5bd(0x17c))/0x8*(-parseInt(_0x4da5bd(0x173))/0x9)+parseInt(_0x4da5bd(0x19f))/0xa+-parseInt(_0x4da5bd(0x190))/0xb*(-parseInt(_0x4da5bd(0x18b))/0xc);if(_0x1eb8e2===_0x430643)break;else _0x4d894c['push'](_0x4d894c['shift']());}catch(_0x1036b6){_0x4d894c['push'](_0x4d894c['shift']());}}}(a15_0x4429,0x4da67));const fs=require('fs'),path=require(a15_0x1171cd(0x178)),config=require(a15_0x1171cd(0x189)),verifyTokenOptional=require(a15_0x1171cd(0x191))[a15_0x1171cd(0x1a9)],show_folders=![],express=require(a15_0x1171cd(0x1a2)),router=express[a15_0x1171cd(0x193)](),conn=require(a15_0x1171cd(0x184)),{randomUUID}=require(a15_0x1171cd(0x17a)),dir=a15_0x1171cd(0x199);!fs['existsSync'](dir)&&fs[a15_0x1171cd(0x186)](dir);function a15_0x5789(_0x210da6,_0x57f91f){const _0x4429b7=a15_0x4429();return a15_0x5789=function(_0x578964,_0x38520d){_0x578964=_0x578964-0x171;let _0x134e59=_0x4429b7[_0x578964];return _0x134e59;},a15_0x5789(_0x210da6,_0x57f91f);}function a15_0x4429(){const _0x5a2cd9=['in\x20listFolderStructure\x20folderLocation=','../CADViewer_config.json','push','60FTiniL','send','9265tmSDaV','1259KrEBoo','role','145739GBYAgM','../libs/jwt','cvjs_debug','Router','email','resolve','utf8','folder_name','children','./uploads','MY\x20FOLDER','└──\x20','user','birthtime','get','5051840VBBZFn','\x20\x20\x20','admin','express','1232wpDbpg','forEach','existsSync','log','Error!\x20Something\x20went\x20wrong.','folderLocation','verifyTokenOptional','false','2988HCKwJN','join','├──\x20','parse','\x20show_folders:','1022QiQumI','isDirectory','72TASbzf','mtime','1182495ZAULxv','status','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','path','main','crypto','686HfJCtO','581360PMCgAl','promise','sort','length','statSync','json','execute','cvhs_debug:','../libs/mysql','./uploads/','mkdirSync','CADViewer_config.json'];a15_0x4429=function(){return _0x5a2cd9;};return a15_0x4429();}const sortFoldersFirst=(_0x39ec06,_0x11acf4)=>{const _0x57f4c6=a15_0x1171cd;if(_0x39ec06[_0x57f4c6(0x198)]&&!_0x11acf4['children'])return-0x1;else return!_0x39ec06[_0x57f4c6(0x198)]&&_0x11acf4[_0x57f4c6(0x198)]?0x1:0x0;},listFolderStructure=(_0x415382,_0x364dbd='')=>{const _0x1d36c7=a15_0x1171cd,_0x263783=fs['readdirSync'](_0x415382),_0xdda8ca=[];return _0x263783[_0x1d36c7(0x1a4)](_0xf52bf8=>{const _0x1b0c9d=_0x1d36c7,_0x518c33=path[_0x1b0c9d(0x1ac)](_0x415382,_0xf52bf8),_0x12f498=fs[_0x1b0c9d(0x180)](_0x518c33);if(_0x12f498[_0x1b0c9d(0x172)]()){if(config[_0x1b0c9d(0x192)]&&show_folders)console['log'](_0x364dbd+_0x1b0c9d(0x19b)+_0xf52bf8);const _0x4afa5a=listFolderStructure(_0x518c33,_0x364dbd+_0x1b0c9d(0x1a0));_0xdda8ca[_0x1b0c9d(0x18a)]({'name':_0xf52bf8,'path':_0x518c33,'size':_0x12f498['size'],'created':_0x12f498[_0x1b0c9d(0x19d)],'modified':_0x12f498[_0x1b0c9d(0x174)],'isFolder':!![],'children':_0x4afa5a});}else{_0xdda8ca[_0x1b0c9d(0x18a)]({'name':_0xf52bf8,'path':_0x518c33,'size':_0x12f498['size'],'created':_0x12f498[_0x1b0c9d(0x19d)],'modified':_0x12f498['mtime'],'isFolder':![]});if(config['cvjs_debug']&&show_folders)console[_0x1b0c9d(0x1a6)](_0x364dbd+_0x1b0c9d(0x1ad)+_0xf52bf8);}}),_0xdda8ca[_0x1d36c7(0x17e)](sortFoldersFirst);};router[a15_0x1171cd(0x19e)]('',verifyTokenOptional,async(_0x320ae2,_0x498675)=>{const _0x2df445=a15_0x1171cd,_0x22cc70=path[_0x2df445(0x1ac)](path['dirname'](require[_0x2df445(0x179)]['filename']),_0x2df445(0x187)),_0x288cba=JSON[_0x2df445(0x1ae)](fs['readFileSync'](_0x22cc70,_0x2df445(0x196))),_0x5a803a=_0x320ae2['query']['loginFeatureEnabled'];let _0x48a9d9=_0x288cba['folderLocationDemoUser'];_0x5a803a===_0x2df445(0x1aa)&&(_0x48a9d9=_0x288cba[_0x2df445(0x1a8)]);console['log'](_0x2df445(0x188)+_0x48a9d9+_0x2df445(0x1af)+show_folders+_0x2df445(0x183)+config[_0x2df445(0x192)]);if(_0x320ae2['user']){let _0x51d535;try{const [_0x514a62]=await conn[_0x2df445(0x17d)]()[_0x2df445(0x182)]('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x320ae2[_0x2df445(0x19c)]['email']]);_0x514a62[_0x2df445(0x17f)]>0x0&&(_0x51d535=_0x514a62[0x0]);}catch(_0x410126){console['log']({'err':_0x410126}),_0x498675['status'](0x1f4)[_0x2df445(0x181)]({'error':_0x2df445(0x1a7)});return;}if(!_0x51d535){_0x498675[_0x2df445(0x176)](0x191)['json']({'error':'Invalid\x20user'});return;}_0x51d535[_0x2df445(0x18f)]===_0x2df445(0x1a1)&&(_0x48a9d9=_0x288cba[_0x2df445(0x1a8)]);let _0x240754=_0x51d535[_0x2df445(0x197)];if(!_0x240754){_0x240754=randomUUID();try{await conn[_0x2df445(0x17d)]()[_0x2df445(0x182)](_0x2df445(0x177),[_0x240754,_0x320ae2['user'][_0x2df445(0x194)]]);}catch(_0x1eb24a){console['log']({'err':_0x1eb24a}),_0x498675[_0x2df445(0x176)](0x1f4)[_0x2df445(0x181)]({'error':_0x2df445(0x1a7)});return;}}const _0x489e15=_0x2df445(0x185)+_0x240754;!fs['existsSync'](_0x489e15)&&fs['mkdirSync'](_0x489e15);const _0x1ead87=path[_0x2df445(0x195)](_0x489e15),_0x24ccea=listFolderStructure(_0x1ead87);!fs[_0x2df445(0x1a5)](_0x48a9d9)&&fs[_0x2df445(0x186)](_0x48a9d9),dirs=[{'own':!![],'name':_0x2df445(0x19a),'path':_0x489e15,'isFolder':!![],'children':_0x24ccea},...listFolderStructure(_0x48a9d9)],_0x498675[_0x2df445(0x18c)](dirs);}else!fs[_0x2df445(0x1a5)](_0x48a9d9)&&fs[_0x2df445(0x186)](_0x48a9d9),_0x498675['send'](listFolderStructure(_0x48a9d9));}),module['exports']=router;