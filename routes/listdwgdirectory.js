const a15_0x15f554=a15_0x2d28;(function(_0x877692,_0x57644d){const _0x120b32=a15_0x2d28,_0x105141=_0x877692();while(!![]){try{const _0x132c1d=-parseInt(_0x120b32(0x87))/0x1*(parseInt(_0x120b32(0x81))/0x2)+parseInt(_0x120b32(0xb8))/0x3*(parseInt(_0x120b32(0x80))/0x4)+parseInt(_0x120b32(0x82))/0x5*(-parseInt(_0x120b32(0x86))/0x6)+-parseInt(_0x120b32(0x98))/0x7*(parseInt(_0x120b32(0x96))/0x8)+-parseInt(_0x120b32(0xad))/0x9+parseInt(_0x120b32(0x97))/0xa*(-parseInt(_0x120b32(0xa7))/0xb)+-parseInt(_0x120b32(0xa4))/0xc*(-parseInt(_0x120b32(0x8d))/0xd);if(_0x132c1d===_0x57644d)break;else _0x105141['push'](_0x105141['shift']());}catch(_0x35973a){_0x105141['push'](_0x105141['shift']());}}}(a15_0x5da6,0x8af7f));const fs=require('fs'),path=require(a15_0x15f554(0xb3)),config=require(a15_0x15f554(0x92)),verifyTokenOptional=require(a15_0x15f554(0x8f))[a15_0x15f554(0x85)],show_folders=![],express=require(a15_0x15f554(0x9e)),router=express[a15_0x15f554(0xa8)](),conn=require(a15_0x15f554(0xb6)),{randomUUID}=require(a15_0x15f554(0x8a)),dir=a15_0x15f554(0x9b);!fs[a15_0x15f554(0xab)](dir)&&fs['mkdirSync'](dir);function a15_0x2d28(_0x22ff07,_0x3c7d76){const _0x5da6d8=a15_0x5da6();return a15_0x2d28=function(_0x2d2867,_0x3f715b){_0x2d2867=_0x2d2867-0x7d;let _0x7de583=_0x5da6d8[_0x2d2867];return _0x7de583;},a15_0x2d28(_0x22ff07,_0x3c7d76);}const sortFoldersFirst=(_0x5a8432,_0x4c5c64)=>{const _0x19e6fa=a15_0x15f554;if(_0x5a8432[_0x19e6fa(0xac)]&&!_0x4c5c64[_0x19e6fa(0xac)])return-0x1;else return!_0x5a8432[_0x19e6fa(0xac)]&&_0x4c5c64['children']?0x1:0x0;},listFolderStructure=(_0x328c46,_0xa9b61='')=>{const _0x7bf83c=a15_0x15f554,_0x501485=fs[_0x7bf83c(0x9c)](_0x328c46),_0x5e1a3f=[];return _0x501485[_0x7bf83c(0x9d)](_0x484758=>{const _0x517d03=_0x7bf83c,_0x4499d1=path[_0x517d03(0xa0)](_0x328c46,_0x484758),_0x3034b5=fs['statSync'](_0x4499d1);if(_0x3034b5[_0x517d03(0x89)]()){if(config['cvjs_debug']&&show_folders)console[_0x517d03(0x9a)](_0xa9b61+_0x517d03(0xb4)+_0x484758);const _0x59b10d=listFolderStructure(_0x4499d1,_0xa9b61+_0x517d03(0xb9));_0x5e1a3f[_0x517d03(0x95)]({'name':_0x484758,'path':_0x4499d1,'size':_0x3034b5[_0x517d03(0xbb)],'created':_0x3034b5[_0x517d03(0xb2)],'modified':_0x3034b5['mtime'],'isFolder':!![],'children':_0x59b10d});}else{_0x5e1a3f[_0x517d03(0x95)]({'name':_0x484758,'path':_0x4499d1,'size':_0x3034b5[_0x517d03(0xbb)],'created':_0x3034b5['birthtime'],'modified':_0x3034b5['mtime'],'isFolder':![]});if(config['cvjs_debug']&&show_folders)console['log'](_0xa9b61+_0x517d03(0x91)+_0x484758);}}),_0x5e1a3f['sort'](sortFoldersFirst);};router[a15_0x15f554(0x8e)]('',verifyTokenOptional,async(_0x1f0e7f,_0x5558cc)=>{const _0x28535d=a15_0x15f554,_0x23498d=path[_0x28535d(0xa0)](path[_0x28535d(0xbd)](require[_0x28535d(0x7e)]['filename']),_0x28535d(0x8b)),_0x35e1b4=JSON[_0x28535d(0xa3)](fs[_0x28535d(0xae)](_0x23498d,_0x28535d(0xa9))),_0x35ea8b=_0x1f0e7f[_0x28535d(0xaa)][_0x28535d(0x8c)];let _0x2e8e91=_0x35e1b4['folderLocationDemoUser'];_0x35ea8b===_0x28535d(0xb1)&&(_0x2e8e91=_0x35e1b4[_0x28535d(0x83)]);console[_0x28535d(0x9a)]('in\x20listFolderStructure\x20folderLocation='+_0x2e8e91+_0x28535d(0x99)+show_folders+_0x28535d(0xb5)+config[_0x28535d(0xb0)]);if(_0x1f0e7f[_0x28535d(0x94)]){let _0x31f944;try{const [_0x4b5c24]=await conn[_0x28535d(0xba)]()[_0x28535d(0xa1)]('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x1f0e7f[_0x28535d(0x94)][_0x28535d(0x9f)]]);_0x4b5c24[_0x28535d(0x88)]>0x0&&(_0x31f944=_0x4b5c24[0x0]);}catch(_0x28d970){console[_0x28535d(0x9a)]({'err':_0x28d970}),_0x5558cc[_0x28535d(0xa5)](0x1f4)[_0x28535d(0x84)]({'error':_0x28535d(0xb7)});return;}if(!_0x31f944){_0x5558cc[_0x28535d(0xa5)](0x191)[_0x28535d(0x84)]({'error':_0x28535d(0x93)});return;}_0x31f944['role']===_0x28535d(0x7d)&&(_0x2e8e91=_0x35e1b4[_0x28535d(0x83)]);let _0x109837=_0x31f944['folder_name'];if(!_0x109837){_0x109837=randomUUID();try{await conn[_0x28535d(0xba)]()[_0x28535d(0xa1)]('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x109837,_0x1f0e7f['user'][_0x28535d(0x9f)]]);}catch(_0x52798f){console['log']({'err':_0x52798f}),_0x5558cc[_0x28535d(0xa5)](0x1f4)[_0x28535d(0x84)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x5de7b4=_0x28535d(0xa2)+_0x109837;!fs[_0x28535d(0xab)](_0x5de7b4)&&fs[_0x28535d(0x7f)](_0x5de7b4);const _0x4de6a1=path[_0x28535d(0xbc)](_0x5de7b4),_0x3a306f=listFolderStructure(_0x4de6a1);!fs[_0x28535d(0xab)](_0x2e8e91)&&fs[_0x28535d(0x7f)](_0x2e8e91),dirs=[{'own':!![],'name':_0x28535d(0x90),'path':_0x5de7b4,'isFolder':!![],'children':_0x3a306f},...listFolderStructure(_0x2e8e91)],_0x5558cc[_0x28535d(0xaf)](dirs);}else!fs['existsSync'](_0x2e8e91)&&fs[_0x28535d(0x7f)](_0x2e8e91),_0x5558cc[_0x28535d(0xaf)](listFolderStructure(_0x2e8e91));}),module[a15_0x15f554(0xa6)]=router;function a15_0x5da6(){const _0x1eb01b=['../libs/mysql','Error!\x20Something\x20went\x20wrong.','11433hqCFgQ','\x20\x20\x20','promise','size','resolve','dirname','admin','main','mkdirSync','1108MCqQYQ','2BTjPis','2300uYvmfD','folderLocation','json','verifyTokenOptional','4728efxLNo','893377zJKUGC','length','isDirectory','crypto','CADViewer_config.json','loginFeatureEnabled','4677699LzqeRD','get','../libs/jwt','MY\x20FOLDER','├──\x20','../CADViewer_config.json','Invalid\x20user','user','push','72VbSkbV','6845000nofmcw','794815ymsSrZ','\x20show_folders:','log','./uploads','readdirSync','forEach','express','email','join','execute','./uploads/','parse','84GuDVpn','status','exports','11qrIlss','Router','utf8','query','existsSync','children','386379rlgPuZ','readFileSync','send','cvjs_debug','false','birthtime','path','└──\x20','cvhs_debug:'];a15_0x5da6=function(){return _0x1eb01b;};return a15_0x5da6();}