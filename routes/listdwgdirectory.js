const a15_0x2e928b=a15_0x1b89;(function(_0x7dae4d,_0x254ace){const _0x51f2fd=a15_0x1b89,_0x39ff2a=_0x7dae4d();while(!![]){try{const _0x1c56b2=-parseInt(_0x51f2fd(0x17b))/0x1*(-parseInt(_0x51f2fd(0x171))/0x2)+parseInt(_0x51f2fd(0x197))/0x3+-parseInt(_0x51f2fd(0x18b))/0x4*(-parseInt(_0x51f2fd(0x17d))/0x5)+-parseInt(_0x51f2fd(0x196))/0x6+-parseInt(_0x51f2fd(0x192))/0x7*(-parseInt(_0x51f2fd(0x19a))/0x8)+-parseInt(_0x51f2fd(0x18a))/0x9*(-parseInt(_0x51f2fd(0x16b))/0xa)+-parseInt(_0x51f2fd(0x1a0))/0xb*(parseInt(_0x51f2fd(0x17c))/0xc);if(_0x1c56b2===_0x254ace)break;else _0x39ff2a['push'](_0x39ff2a['shift']());}catch(_0x4c08b5){_0x39ff2a['push'](_0x39ff2a['shift']());}}}(a15_0x5e18,0xc24a3));const fs=require('fs'),path=require(a15_0x2e928b(0x194)),config=require(a15_0x2e928b(0x18c)),verifyTokenOptional=require(a15_0x2e928b(0x18e))[a15_0x2e928b(0x19d)],show_folders=![],express=require(a15_0x2e928b(0x169)),router=express[a15_0x2e928b(0x183)](),conn=require(a15_0x2e928b(0x16f)),{randomUUID}=require('crypto'),dir=a15_0x2e928b(0x170);function a15_0x5e18(){const _0x2e2a7f=['Error!\x20Something\x20went\x20wrong.','Router','in\x20listFolderStructure\x20folderLocation=','cvjs_debug','user','false','MY\x20FOLDER','status','18lPiOMp','22996dNgNhu','../CADViewer_config.json','cvhs_debug:','../libs/jwt','loginFeatureEnabled','isDirectory','send','497pHZTdY','mtime','path','folderLocation','3750480IeJArU','806187lnpTRx','./uploads/','sort','151992MMfQEB','push','json','verifyTokenOptional','log','query','77TTSYoE','parse','main','readdirSync','execute','admin','children','CADViewer_config.json','readFileSync','statSync','birthtime','resolve','filename','express','get','163110HxGBid','exports','└──\x20','promise','../libs/mysql','./uploads','134QZNEFR','\x20show_folders:','├──\x20','utf8','forEach','length','email','folderLocationDemoUser','size','mkdirSync','3527mszCQJ','2582172YpNjPR','905cfOwZg','join','role','existsSync','\x20\x20\x20'];a15_0x5e18=function(){return _0x2e2a7f;};return a15_0x5e18();}!fs[a15_0x2e928b(0x180)](dir)&&fs[a15_0x2e928b(0x17a)](dir);function a15_0x1b89(_0x3dbf2a,_0x4c21d2){const _0x5e1806=a15_0x5e18();return a15_0x1b89=function(_0x1b894d,_0x42c8d2){_0x1b894d=_0x1b894d-0x164;let _0x22d2bb=_0x5e1806[_0x1b894d];return _0x22d2bb;},a15_0x1b89(_0x3dbf2a,_0x4c21d2);}const sortFoldersFirst=(_0x2069a4,_0xe62155)=>{const _0x443719=a15_0x2e928b;if(_0x2069a4[_0x443719(0x1a6)]&&!_0xe62155[_0x443719(0x1a6)])return-0x1;else return!_0x2069a4[_0x443719(0x1a6)]&&_0xe62155[_0x443719(0x1a6)]?0x1:0x0;},listFolderStructure=(_0x52bb0a,_0x2f99c4='')=>{const _0x6e9d57=a15_0x2e928b,_0x526d4e=fs[_0x6e9d57(0x1a3)](_0x52bb0a),_0x1679da=[];return _0x526d4e[_0x6e9d57(0x175)](_0x476212=>{const _0x2fd9f2=_0x6e9d57,_0x556263=path[_0x2fd9f2(0x17e)](_0x52bb0a,_0x476212),_0x448090=fs[_0x2fd9f2(0x165)](_0x556263);if(_0x448090[_0x2fd9f2(0x190)]()){if(config['cvjs_debug']&&show_folders)console['log'](_0x2f99c4+_0x2fd9f2(0x16d)+_0x476212);const _0x4357a5=listFolderStructure(_0x556263,_0x2f99c4+_0x2fd9f2(0x181));_0x1679da[_0x2fd9f2(0x19b)]({'name':_0x476212,'path':_0x556263,'size':_0x448090[_0x2fd9f2(0x179)],'created':_0x448090['birthtime'],'modified':_0x448090[_0x2fd9f2(0x193)],'isFolder':!![],'children':_0x4357a5});}else{_0x1679da['push']({'name':_0x476212,'path':_0x556263,'size':_0x448090[_0x2fd9f2(0x179)],'created':_0x448090[_0x2fd9f2(0x166)],'modified':_0x448090[_0x2fd9f2(0x193)],'isFolder':![]});if(config[_0x2fd9f2(0x185)]&&show_folders)console[_0x2fd9f2(0x19e)](_0x2f99c4+_0x2fd9f2(0x173)+_0x476212);}}),_0x1679da[_0x6e9d57(0x199)](sortFoldersFirst);};router[a15_0x2e928b(0x16a)]('',verifyTokenOptional,async(_0x40ee0d,_0x3f32a2)=>{const _0x2ffdb6=a15_0x2e928b,_0x3baefd=path[_0x2ffdb6(0x17e)](path['dirname'](require[_0x2ffdb6(0x1a2)][_0x2ffdb6(0x168)]),_0x2ffdb6(0x1a7)),_0x420683=JSON[_0x2ffdb6(0x1a1)](fs[_0x2ffdb6(0x164)](_0x3baefd,_0x2ffdb6(0x174))),_0xef9119=_0x40ee0d[_0x2ffdb6(0x19f)][_0x2ffdb6(0x18f)];let _0x47d184=_0x420683[_0x2ffdb6(0x178)];_0xef9119===_0x2ffdb6(0x187)&&(_0x47d184=_0x420683[_0x2ffdb6(0x195)]);console[_0x2ffdb6(0x19e)](_0x2ffdb6(0x184)+_0x47d184+_0x2ffdb6(0x172)+show_folders+_0x2ffdb6(0x18d)+config[_0x2ffdb6(0x185)]);if(_0x40ee0d[_0x2ffdb6(0x186)]){let _0x162a39;try{const [_0x1fbc38]=await conn['promise']()[_0x2ffdb6(0x1a4)]('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x40ee0d[_0x2ffdb6(0x186)][_0x2ffdb6(0x177)]]);_0x1fbc38[_0x2ffdb6(0x176)]>0x0&&(_0x162a39=_0x1fbc38[0x0]);}catch(_0xb29a3c){console[_0x2ffdb6(0x19e)]({'err':_0xb29a3c}),_0x3f32a2[_0x2ffdb6(0x189)](0x1f4)['json']({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x162a39){_0x3f32a2[_0x2ffdb6(0x189)](0x191)['json']({'error':'Invalid\x20user'});return;}_0x162a39[_0x2ffdb6(0x17f)]===_0x2ffdb6(0x1a5)&&(_0x47d184=_0x420683['folderLocation']);let _0x30d987=_0x162a39['folder_name'];if(!_0x30d987){_0x30d987=randomUUID();try{await conn[_0x2ffdb6(0x16e)]()[_0x2ffdb6(0x1a4)]('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x30d987,_0x40ee0d[_0x2ffdb6(0x186)][_0x2ffdb6(0x177)]]);}catch(_0x14d24c){console[_0x2ffdb6(0x19e)]({'err':_0x14d24c}),_0x3f32a2['status'](0x1f4)[_0x2ffdb6(0x19c)]({'error':_0x2ffdb6(0x182)});return;}}const _0x2d5392=_0x2ffdb6(0x198)+_0x30d987;!fs[_0x2ffdb6(0x180)](_0x2d5392)&&fs[_0x2ffdb6(0x17a)](_0x2d5392);const _0x249e3a=path[_0x2ffdb6(0x167)](_0x2d5392),_0x1ebca9=listFolderStructure(_0x249e3a);!fs['existsSync'](_0x47d184)&&fs[_0x2ffdb6(0x17a)](_0x47d184),dirs=[{'own':!![],'name':_0x2ffdb6(0x188),'path':_0x2d5392,'isFolder':!![],'children':_0x1ebca9},...listFolderStructure(_0x47d184)],_0x3f32a2[_0x2ffdb6(0x191)](dirs);}else!fs[_0x2ffdb6(0x180)](_0x47d184)&&fs[_0x2ffdb6(0x17a)](_0x47d184),_0x3f32a2[_0x2ffdb6(0x191)](listFolderStructure(_0x47d184));}),module[a15_0x2e928b(0x16c)]=router;