const a15_0x1060f9=a15_0x322b;function a15_0x322b(_0x51efe0,_0x5622da){const _0x229d3a=a15_0x229d();return a15_0x322b=function(_0x322b61,_0x12e576){_0x322b61=_0x322b61-0x1e5;let _0x192fa9=_0x229d3a[_0x322b61];return _0x192fa9;},a15_0x322b(_0x51efe0,_0x5622da);}(function(_0x24ba0c,_0x574ef4){const _0x4ee6ca=a15_0x322b,_0x5e5f34=_0x24ba0c();while(!![]){try{const _0x4e52dd=-parseInt(_0x4ee6ca(0x1e7))/0x1*(-parseInt(_0x4ee6ca(0x207))/0x2)+-parseInt(_0x4ee6ca(0x1e9))/0x3+-parseInt(_0x4ee6ca(0x1ec))/0x4*(-parseInt(_0x4ee6ca(0x214))/0x5)+-parseInt(_0x4ee6ca(0x1f5))/0x6+parseInt(_0x4ee6ca(0x20d))/0x7+parseInt(_0x4ee6ca(0x20f))/0x8+parseInt(_0x4ee6ca(0x200))/0x9*(parseInt(_0x4ee6ca(0x1fe))/0xa);if(_0x4e52dd===_0x574ef4)break;else _0x5e5f34['push'](_0x5e5f34['shift']());}catch(_0x14ac85){_0x5e5f34['push'](_0x5e5f34['shift']());}}}(a15_0x229d,0xcac1e));const fs=require('fs'),path=require('path'),config=require(a15_0x1060f9(0x1eb)),verifyTokenOptional=require(a15_0x1060f9(0x210))[a15_0x1060f9(0x203)],show_folders=![],express=require(a15_0x1060f9(0x205)),router=express['Router'](),conn=require(a15_0x1060f9(0x1e5)),{randomUUID}=require('crypto'),dir=a15_0x1060f9(0x201);function a15_0x229d(){const _0x32a30b=['mtime','verifyTokenOptional','size','express','push','4BHcgYu','user','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','json','birthtime','join','1230257nhfonL','Error!\x20Something\x20went\x20wrong.','1809296CUaUzQ','../libs/jwt','resolve','children','email','18890dbQvbh','\x20show_folders:','cvjs_debug','../libs/mysql','./uploads/','579868ksNpcC','folderLocation','2824686GrIeSg','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','../CADViewer_config.json','460OTiUpF','promise','execute','log','forEach','exports','in\x20listFolderStructure\x20folderLocation=','existsSync','cvhs_debug:','9691980HcerTY','mkdirSync','status','MY\x20FOLDER','get','statSync','├──\x20','length','sort','13912670cHHzlZ','Invalid\x20user','9ypMeLA','./uploads'];a15_0x229d=function(){return _0x32a30b;};return a15_0x229d();}!fs[a15_0x1060f9(0x1f3)](dir)&&fs[a15_0x1060f9(0x1f6)](dir);const sortFoldersFirst=(_0x41715c,_0x517a7e)=>{const _0x4bb4ff=a15_0x1060f9;if(_0x41715c[_0x4bb4ff(0x212)]&&!_0x517a7e[_0x4bb4ff(0x212)])return-0x1;else return!_0x41715c[_0x4bb4ff(0x212)]&&_0x517a7e[_0x4bb4ff(0x212)]?0x1:0x0;},listFolderStructure=(_0x5c50c1,_0x5c9bb5='')=>{const _0x326684=a15_0x1060f9,_0x5d9135=fs['readdirSync'](_0x5c50c1),_0xe3c708=[];return _0x5d9135[_0x326684(0x1f0)](_0x46526c=>{const _0x284dc2=_0x326684,_0x82fdac=path[_0x284dc2(0x20c)](_0x5c50c1,_0x46526c),_0x5c44b2=fs[_0x284dc2(0x1fa)](_0x82fdac);if(_0x5c44b2['isDirectory']()){if(config[_0x284dc2(0x216)]&&show_folders)console['log'](_0x5c9bb5+'└──\x20'+_0x46526c);const _0x4970dd=listFolderStructure(_0x82fdac,_0x5c9bb5+'\x20\x20\x20');_0xe3c708[_0x284dc2(0x206)]({'name':_0x46526c,'path':_0x82fdac,'size':_0x5c44b2[_0x284dc2(0x204)],'created':_0x5c44b2[_0x284dc2(0x20b)],'modified':_0x5c44b2[_0x284dc2(0x202)],'isFolder':!![],'children':_0x4970dd});}else{_0xe3c708[_0x284dc2(0x206)]({'name':_0x46526c,'path':_0x82fdac,'size':_0x5c44b2[_0x284dc2(0x204)],'created':_0x5c44b2['birthtime'],'modified':_0x5c44b2['mtime'],'isFolder':![]});if(config[_0x284dc2(0x216)]&&show_folders)console[_0x284dc2(0x1ef)](_0x5c9bb5+_0x284dc2(0x1fb)+_0x46526c);}}),_0xe3c708[_0x326684(0x1fd)](sortFoldersFirst);};router[a15_0x1060f9(0x1f9)]('',verifyTokenOptional,async(_0x2272d0,_0x30a473)=>{const _0x3c1f7a=a15_0x1060f9,_0x21bd73=config[_0x3c1f7a(0x1e8)];console[_0x3c1f7a(0x1ef)](_0x3c1f7a(0x1f2)+_0x21bd73+_0x3c1f7a(0x215)+show_folders+_0x3c1f7a(0x1f4)+config[_0x3c1f7a(0x216)]);let _0x1d285a=listFolderStructure(_0x21bd73);if(_0x2272d0[_0x3c1f7a(0x208)]){let _0x404d9b;try{const [_0x3ca71e]=await conn[_0x3c1f7a(0x1ed)]()[_0x3c1f7a(0x1ee)](_0x3c1f7a(0x209),[_0x2272d0[_0x3c1f7a(0x208)][_0x3c1f7a(0x213)]]);_0x3ca71e[_0x3c1f7a(0x1fc)]>0x0&&(_0x404d9b=_0x3ca71e[0x0]);}catch(_0x9c2f0e){console[_0x3c1f7a(0x1ef)]({'err':_0x9c2f0e}),_0x30a473[_0x3c1f7a(0x1f7)](0x1f4)[_0x3c1f7a(0x20a)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x404d9b){_0x30a473['status'](0x191)[_0x3c1f7a(0x20a)]({'error':_0x3c1f7a(0x1ff)});return;}let _0xdc53de=_0x404d9b['folder_name'];if(!_0xdc53de){_0xdc53de=randomUUID();try{await conn[_0x3c1f7a(0x1ed)]()[_0x3c1f7a(0x1ee)](_0x3c1f7a(0x1ea),[_0xdc53de,_0x2272d0[_0x3c1f7a(0x208)][_0x3c1f7a(0x213)]]);}catch(_0x2348fa){console[_0x3c1f7a(0x1ef)]({'err':_0x2348fa}),_0x30a473[_0x3c1f7a(0x1f7)](0x1f4)['json']({'error':_0x3c1f7a(0x20e)});return;}}const _0x9a8cde=_0x3c1f7a(0x1e6)+_0xdc53de;!fs[_0x3c1f7a(0x1f3)](_0x9a8cde)&&fs[_0x3c1f7a(0x1f6)](_0x9a8cde);const _0x580c7a=path[_0x3c1f7a(0x211)](_0x9a8cde),_0x116e9e=listFolderStructure(_0x580c7a);_0x1d285a=[{'own':!![],'name':_0x3c1f7a(0x1f8),'path':_0x9a8cde,'isFolder':!![],'children':_0x116e9e},..._0x1d285a];}_0x30a473['send'](_0x1d285a);}),module[a15_0x1060f9(0x1f1)]=router;