function a15_0x3ceb(){const _0x2b736f=['\x20show_folders:','log','join','../libs/jwt','mtime','utf8','sort','450024NJkHfd','user','json','675954ZmpnCw','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','MY\x20FOLDER','cvjs_debug','isDirectory','\x20\x20\x20','├──\x20','size','resolve','└──\x20','statSync','readFileSync','exports','1491539ggFHsv','forEach','push','Error!\x20Something\x20went\x20wrong.','existsSync','./uploads/','CADViewer_config.json','query','get','677568lOOuqx','22YbChZG','5OLtXYP','folder_name','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','folderLocation','mkdirSync','status','send','891438dqGcrh','readdirSync','execute','birthtime','admin','cvhs_debug:','14595MIsyjd','false','../libs/mysql','filename','in\x20listFolderStructure\x20folderLocation=','crypto','promise','express','20475SVhDfB','dirname','children','parse','folderLocationDemoUser'];a15_0x3ceb=function(){return _0x2b736f;};return a15_0x3ceb();}const a15_0x3cb687=a15_0x1a39;(function(_0x4f3371,_0x23aee7){const _0x4ba9a8=a15_0x1a39,_0x1e948d=_0x4f3371();while(!![]){try{const _0x3665e9=parseInt(_0x4ba9a8(0xa9))/0x1+parseInt(_0x4ba9a8(0x9b))/0x2*(-parseInt(_0x4ba9a8(0xb1))/0x3)+-parseInt(_0x4ba9a8(0x9a))/0x4+parseInt(_0x4ba9a8(0x9c))/0x5*(parseInt(_0x4ba9a8(0xa3))/0x6)+parseInt(_0x4ba9a8(0x91))/0x7+parseInt(_0x4ba9a8(0xbd))/0x8+-parseInt(_0x4ba9a8(0xc0))/0x9;if(_0x3665e9===_0x23aee7)break;else _0x1e948d['push'](_0x1e948d['shift']());}catch(_0x2a978d){_0x1e948d['push'](_0x1e948d['shift']());}}}(a15_0x3ceb,0x1b91d));const fs=require('fs'),path=require('path'),config=require('../CADViewer_config.json'),verifyTokenOptional=require(a15_0x3cb687(0xb9))['verifyTokenOptional'],show_folders=![],express=require(a15_0x3cb687(0xb0)),router=express['Router'](),conn=require(a15_0x3cb687(0xab)),{randomUUID}=require(a15_0x3cb687(0xae)),dir='./uploads';!fs['existsSync'](dir)&&fs['mkdirSync'](dir);function a15_0x1a39(_0x3a24ad,_0xeea94a){const _0x3ceb6b=a15_0x3ceb();return a15_0x1a39=function(_0x1a3925,_0x19b215){_0x1a3925=_0x1a3925-0x90;let _0xab914=_0x3ceb6b[_0x1a3925];return _0xab914;},a15_0x1a39(_0x3a24ad,_0xeea94a);}const sortFoldersFirst=(_0x12bf0f,_0x3fe0ae)=>{const _0x3b80f9=a15_0x3cb687;if(_0x12bf0f['children']&&!_0x3fe0ae['children'])return-0x1;else return!_0x12bf0f[_0x3b80f9(0xb3)]&&_0x3fe0ae[_0x3b80f9(0xb3)]?0x1:0x0;},listFolderStructure=(_0x5deef9,_0x5d3a74='')=>{const _0x98f895=a15_0x3cb687,_0x135644=fs[_0x98f895(0xa4)](_0x5deef9),_0x171c40=[];return _0x135644[_0x98f895(0x92)](_0x23f201=>{const _0x4032ca=_0x98f895,_0x5cfac2=path['join'](_0x5deef9,_0x23f201),_0x3c2158=fs[_0x4032ca(0xca)](_0x5cfac2);if(_0x3c2158[_0x4032ca(0xc4)]()){if(config['cvjs_debug']&&show_folders)console['log'](_0x5d3a74+_0x4032ca(0xc9)+_0x23f201);const _0x3c4cf3=listFolderStructure(_0x5cfac2,_0x5d3a74+_0x4032ca(0xc5));_0x171c40[_0x4032ca(0x93)]({'name':_0x23f201,'path':_0x5cfac2,'size':_0x3c2158['size'],'created':_0x3c2158[_0x4032ca(0xa6)],'modified':_0x3c2158[_0x4032ca(0xba)],'isFolder':!![],'children':_0x3c4cf3});}else{_0x171c40[_0x4032ca(0x93)]({'name':_0x23f201,'path':_0x5cfac2,'size':_0x3c2158[_0x4032ca(0xc7)],'created':_0x3c2158[_0x4032ca(0xa6)],'modified':_0x3c2158['mtime'],'isFolder':![]});if(config['cvjs_debug']&&show_folders)console[_0x4032ca(0xb7)](_0x5d3a74+_0x4032ca(0xc6)+_0x23f201);}}),_0x171c40[_0x98f895(0xbc)](sortFoldersFirst);};router[a15_0x3cb687(0x99)]('',verifyTokenOptional,async(_0x58a17c,_0x1cda8f)=>{const _0x569569=a15_0x3cb687,_0x301e4b=path[_0x569569(0xb8)](path[_0x569569(0xb2)](require['main'][_0x569569(0xac)]),_0x569569(0x97)),_0x4490d8=JSON[_0x569569(0xb4)](fs[_0x569569(0xcb)](_0x301e4b,_0x569569(0xbb))),_0x1fb5c1=_0x58a17c[_0x569569(0x98)]['loginFeatureEnabled'];let _0x477495=_0x4490d8[_0x569569(0xb5)];_0x1fb5c1===_0x569569(0xaa)&&(_0x477495=_0x4490d8[_0x569569(0x9f)]);console[_0x569569(0xb7)](_0x569569(0xad)+_0x477495+_0x569569(0xb6)+show_folders+_0x569569(0xa8)+config[_0x569569(0xc3)]);if(_0x58a17c['user']){let _0x337bdd;try{const [_0x2ac43d]=await conn[_0x569569(0xaf)]()[_0x569569(0xa5)](_0x569569(0xc1),[_0x58a17c['user']['email']]);_0x2ac43d['length']>0x0&&(_0x337bdd=_0x2ac43d[0x0]);}catch(_0x1813fc){console[_0x569569(0xb7)]({'err':_0x1813fc}),_0x1cda8f[_0x569569(0xa1)](0x1f4)[_0x569569(0xbf)]({'error':_0x569569(0x94)});return;}if(!_0x337bdd){_0x1cda8f[_0x569569(0xa1)](0x191)['json']({'error':'Invalid\x20user'});return;}_0x337bdd['role']===_0x569569(0xa7)&&(_0x477495=_0x4490d8[_0x569569(0x9f)]);let _0x1370a0=_0x337bdd[_0x569569(0x9d)];if(!_0x1370a0){_0x1370a0=randomUUID();try{await conn[_0x569569(0xaf)]()[_0x569569(0xa5)](_0x569569(0x9e),[_0x1370a0,_0x58a17c[_0x569569(0xbe)]['email']]);}catch(_0x9cf7d9){console['log']({'err':_0x9cf7d9}),_0x1cda8f[_0x569569(0xa1)](0x1f4)[_0x569569(0xbf)]({'error':_0x569569(0x94)});return;}}const _0x5a033d=_0x569569(0x96)+_0x1370a0;!fs[_0x569569(0x95)](_0x5a033d)&&fs[_0x569569(0xa0)](_0x5a033d);const _0x52153f=path[_0x569569(0xc8)](_0x5a033d),_0x10ea0d=listFolderStructure(_0x52153f);!fs['existsSync'](_0x477495)&&fs[_0x569569(0xa0)](_0x477495),dirs=[{'own':!![],'name':_0x569569(0xc2),'path':_0x5a033d,'isFolder':!![],'children':_0x10ea0d},...listFolderStructure(_0x477495)],_0x1cda8f[_0x569569(0xa2)](dirs);}else!fs[_0x569569(0x95)](_0x477495)&&fs['mkdirSync'](_0x477495),_0x1cda8f['send'](listFolderStructure(_0x477495));}),module[a15_0x3cb687(0x90)]=router;