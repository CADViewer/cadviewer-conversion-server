const a15_0xe378df=a15_0x314d;(function(_0x22cec4,_0x48a0f1){const _0x5e048f=a15_0x314d,_0x47c3c6=_0x22cec4();while(!![]){try{const _0x28ef48=-parseInt(_0x5e048f(0x1af))/0x1+-parseInt(_0x5e048f(0x1cf))/0x2*(-parseInt(_0x5e048f(0x1bc))/0x3)+-parseInt(_0x5e048f(0x1d0))/0x4*(parseInt(_0x5e048f(0x1da))/0x5)+parseInt(_0x5e048f(0x1cd))/0x6*(-parseInt(_0x5e048f(0x1a8))/0x7)+parseInt(_0x5e048f(0x1b6))/0x8+-parseInt(_0x5e048f(0x1c1))/0x9*(-parseInt(_0x5e048f(0x1ae))/0xa)+parseInt(_0x5e048f(0x1ac))/0xb*(-parseInt(_0x5e048f(0x1b8))/0xc);if(_0x28ef48===_0x48a0f1)break;else _0x47c3c6['push'](_0x47c3c6['shift']());}catch(_0x10b796){_0x47c3c6['push'](_0x47c3c6['shift']());}}}(a15_0x3165,0x7a09f));const fs=require('fs'),path=require(a15_0xe378df(0x1a1)),config=require(a15_0xe378df(0x1bd)),verifyTokenOptional=require('../libs/jwt')['verifyTokenOptional'],show_folders=![],express=require(a15_0xe378df(0x1df)),router=express[a15_0xe378df(0x1e1)](),conn=require(a15_0xe378df(0x1c3)),{randomUUID}=require('crypto'),dir=a15_0xe378df(0x1c7);function a15_0x3165(){const _0x4a3c9d=['4153138zCNaqe','mkdirSync','20OCocTx','365767PfzZBE','folderLocation','false','folderLocationDemoUser','execute','resolve','main','7064200mZJboB','readFileSync','12CHjzVp','parse','send','└──\x20','15VNITRu','../CADViewer_config.json','get','push','exports','3111534zRjwDn','email','../libs/mysql','readdirSync','utf8','folder_name','./uploads','existsSync','loginFeatureEnabled','CADViewer_config.json','log','\x20show_folders:','30EjnzLh','├──\x20','75058ntQyXt','10524AujmkS','admin','\x20\x20\x20','user','children','cvhs_debug:','isDirectory','status','statSync','sort','755HjLPEg','json','Error!\x20Something\x20went\x20wrong.','filename','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','express','MY\x20FOLDER','Router','mtime','Invalid\x20user','length','path','cvjs_debug','query','./uploads/','size','dirname','birthtime','170303fsQgUq','join','promise','in\x20listFolderStructure\x20folderLocation='];a15_0x3165=function(){return _0x4a3c9d;};return a15_0x3165();}function a15_0x314d(_0x46c616,_0x159dc8){const _0x3165be=a15_0x3165();return a15_0x314d=function(_0x314dc4,_0x3b2143){_0x314dc4=_0x314dc4-0x19f;let _0xfeccd2=_0x3165be[_0x314dc4];return _0xfeccd2;},a15_0x314d(_0x46c616,_0x159dc8);}!fs[a15_0xe378df(0x1c8)](dir)&&fs['mkdirSync'](dir);const sortFoldersFirst=(_0x411d23,_0x28f8f9)=>{const _0x3b7f1c=a15_0xe378df;if(_0x411d23[_0x3b7f1c(0x1d4)]&&!_0x28f8f9[_0x3b7f1c(0x1d4)])return-0x1;else return!_0x411d23[_0x3b7f1c(0x1d4)]&&_0x28f8f9[_0x3b7f1c(0x1d4)]?0x1:0x0;},listFolderStructure=(_0x1435db,_0x104b87='')=>{const _0xe17df4=a15_0xe378df,_0x4b68c4=fs[_0xe17df4(0x1c4)](_0x1435db),_0x305ef3=[];return _0x4b68c4['forEach'](_0x2e9f25=>{const _0x3510a7=_0xe17df4,_0x37d5e4=path['join'](_0x1435db,_0x2e9f25),_0x253a0d=fs[_0x3510a7(0x1d8)](_0x37d5e4);if(_0x253a0d[_0x3510a7(0x1d6)]()){if(config['cvjs_debug']&&show_folders)console[_0x3510a7(0x1cb)](_0x104b87+_0x3510a7(0x1bb)+_0x2e9f25);const _0x239500=listFolderStructure(_0x37d5e4,_0x104b87+_0x3510a7(0x1d2));_0x305ef3['push']({'name':_0x2e9f25,'path':_0x37d5e4,'size':_0x253a0d[_0x3510a7(0x1a5)],'created':_0x253a0d['birthtime'],'modified':_0x253a0d[_0x3510a7(0x1e2)],'isFolder':!![],'children':_0x239500});}else{_0x305ef3[_0x3510a7(0x1bf)]({'name':_0x2e9f25,'path':_0x37d5e4,'size':_0x253a0d['size'],'created':_0x253a0d[_0x3510a7(0x1a7)],'modified':_0x253a0d['mtime'],'isFolder':![]});if(config[_0x3510a7(0x1a2)]&&show_folders)console['log'](_0x104b87+_0x3510a7(0x1ce)+_0x2e9f25);}}),_0x305ef3[_0xe17df4(0x1d9)](sortFoldersFirst);};router[a15_0xe378df(0x1be)]('',verifyTokenOptional,async(_0x2b0ceb,_0x4c3b44)=>{const _0x36a3b0=a15_0xe378df,_0x31845d=path[_0x36a3b0(0x1a9)](path[_0x36a3b0(0x1a6)](require[_0x36a3b0(0x1b5)][_0x36a3b0(0x1dd)]),_0x36a3b0(0x1ca)),_0x5a3e54=JSON[_0x36a3b0(0x1b9)](fs[_0x36a3b0(0x1b7)](_0x31845d,_0x36a3b0(0x1c5))),_0x323b25=_0x2b0ceb[_0x36a3b0(0x1a3)][_0x36a3b0(0x1c9)];let _0x2b00f4=_0x5a3e54[_0x36a3b0(0x1b2)];_0x323b25===_0x36a3b0(0x1b1)&&(_0x2b00f4=_0x5a3e54[_0x36a3b0(0x1b0)]);console['log'](_0x36a3b0(0x1ab)+_0x2b00f4+_0x36a3b0(0x1cc)+show_folders+_0x36a3b0(0x1d5)+config['cvjs_debug']);if(_0x2b0ceb['user']){let _0x533572;try{const [_0x458319]=await conn[_0x36a3b0(0x1aa)]()[_0x36a3b0(0x1b3)](_0x36a3b0(0x1de),[_0x2b0ceb[_0x36a3b0(0x1d3)][_0x36a3b0(0x1c2)]]);_0x458319[_0x36a3b0(0x1a0)]>0x0&&(_0x533572=_0x458319[0x0]);}catch(_0x5e37a7){console[_0x36a3b0(0x1cb)]({'err':_0x5e37a7}),_0x4c3b44['status'](0x1f4)[_0x36a3b0(0x1db)]({'error':_0x36a3b0(0x1dc)});return;}if(!_0x533572){_0x4c3b44[_0x36a3b0(0x1d7)](0x191)['json']({'error':_0x36a3b0(0x19f)});return;}_0x533572['role']===_0x36a3b0(0x1d1)&&(_0x2b00f4=_0x5a3e54[_0x36a3b0(0x1b0)]);let _0x38970f=_0x533572[_0x36a3b0(0x1c6)];if(!_0x38970f){_0x38970f=randomUUID();try{await conn[_0x36a3b0(0x1aa)]()[_0x36a3b0(0x1b3)]('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x38970f,_0x2b0ceb[_0x36a3b0(0x1d3)][_0x36a3b0(0x1c2)]]);}catch(_0x416d20){console['log']({'err':_0x416d20}),_0x4c3b44['status'](0x1f4)[_0x36a3b0(0x1db)]({'error':_0x36a3b0(0x1dc)});return;}}const _0x17478a=_0x36a3b0(0x1a4)+_0x38970f;!fs[_0x36a3b0(0x1c8)](_0x17478a)&&fs[_0x36a3b0(0x1ad)](_0x17478a);const _0x31cc47=path[_0x36a3b0(0x1b4)](_0x17478a),_0xbe4717=listFolderStructure(_0x31cc47);!fs[_0x36a3b0(0x1c8)](_0x2b00f4)&&fs[_0x36a3b0(0x1ad)](_0x2b00f4),dirs=[{'own':!![],'name':_0x36a3b0(0x1e0),'path':_0x17478a,'isFolder':!![],'children':_0xbe4717},...listFolderStructure(_0x2b00f4)],_0x4c3b44['send'](dirs);}else!fs[_0x36a3b0(0x1c8)](_0x2b00f4)&&fs[_0x36a3b0(0x1ad)](_0x2b00f4),_0x4c3b44[_0x36a3b0(0x1ba)](listFolderStructure(_0x2b00f4));}),module[a15_0xe378df(0x1c0)]=router;