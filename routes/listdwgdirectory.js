const a15_0x9aca1a=a15_0xb1be;function a15_0xb1be(_0x4b37d2,_0x79adf2){const _0x47f061=a15_0x47f0();return a15_0xb1be=function(_0xb1be48,_0x884b64){_0xb1be48=_0xb1be48-0x18b;let _0x516220=_0x47f061[_0xb1be48];return _0x516220;},a15_0xb1be(_0x4b37d2,_0x79adf2);}(function(_0x4fc40b,_0x393a4c){const _0x1d3dbe=a15_0xb1be,_0x4c0eac=_0x4fc40b();while(!![]){try{const _0x227a6c=parseInt(_0x1d3dbe(0x1c5))/0x1+parseInt(_0x1d3dbe(0x18c))/0x2*(parseInt(_0x1d3dbe(0x1c7))/0x3)+parseInt(_0x1d3dbe(0x19b))/0x4+parseInt(_0x1d3dbe(0x19f))/0x5+parseInt(_0x1d3dbe(0x1a7))/0x6*(-parseInt(_0x1d3dbe(0x1b2))/0x7)+parseInt(_0x1d3dbe(0x1c8))/0x8*(-parseInt(_0x1d3dbe(0x198))/0x9)+parseInt(_0x1d3dbe(0x1b6))/0xa*(parseInt(_0x1d3dbe(0x195))/0xb);if(_0x227a6c===_0x393a4c)break;else _0x4c0eac['push'](_0x4c0eac['shift']());}catch(_0x1a78d6){_0x4c0eac['push'](_0x4c0eac['shift']());}}}(a15_0x47f0,0xb83ec));const fs=require('fs'),path=require(a15_0x9aca1a(0x18d)),config=require(a15_0x9aca1a(0x1bf)),verifyTokenOptional=require(a15_0x9aca1a(0x19d))['verifyTokenOptional'],show_folders=![],express=require('express'),router=express[a15_0x9aca1a(0x1b7)](),conn=require(a15_0x9aca1a(0x196)),{randomUUID}=require('crypto'),dir=a15_0x9aca1a(0x1ae);!fs['existsSync'](dir)&&fs['mkdirSync'](dir);const sortFoldersFirst=(_0x2193a8,_0x559b2c)=>{const _0x14819e=a15_0x9aca1a;if(_0x2193a8[_0x14819e(0x1ba)]&&!_0x559b2c['children'])return-0x1;else return!_0x2193a8[_0x14819e(0x1ba)]&&_0x559b2c[_0x14819e(0x1ba)]?0x1:0x0;},listFolderStructure=(_0x1fcf58,_0x4e5f2='')=>{const _0x196500=a15_0x9aca1a,_0x418da1=fs[_0x196500(0x1b3)](_0x1fcf58),_0x629a50=[];return _0x418da1[_0x196500(0x19a)](_0x2ab0bc=>{const _0x166028=_0x196500,_0x5baae7=path[_0x166028(0x1a1)](_0x1fcf58,_0x2ab0bc),_0x339b7f=fs['statSync'](_0x5baae7);if(_0x339b7f[_0x166028(0x19c)]()){if(config[_0x166028(0x1b5)]&&show_folders)console[_0x166028(0x1a3)](_0x4e5f2+_0x166028(0x190)+_0x2ab0bc);const _0x2dcea8=listFolderStructure(_0x5baae7,_0x4e5f2+_0x166028(0x1af));_0x629a50[_0x166028(0x1ab)]({'name':_0x2ab0bc,'path':_0x5baae7,'size':_0x339b7f['size'],'created':_0x339b7f[_0x166028(0x1c0)],'modified':_0x339b7f['mtime'],'isFolder':!![],'children':_0x2dcea8});}else{_0x629a50[_0x166028(0x1ab)]({'name':_0x2ab0bc,'path':_0x5baae7,'size':_0x339b7f[_0x166028(0x197)],'created':_0x339b7f[_0x166028(0x1c0)],'modified':_0x339b7f[_0x166028(0x194)],'isFolder':![]});if(config['cvjs_debug']&&show_folders)console[_0x166028(0x1a3)](_0x4e5f2+'├──\x20'+_0x2ab0bc);}}),_0x629a50[_0x196500(0x1a4)](sortFoldersFirst);};router[a15_0x9aca1a(0x1b1)]('',verifyTokenOptional,async(_0x1bb9ac,_0x184525)=>{const _0x5d101a=a15_0x9aca1a,_0x27b155=path[_0x5d101a(0x1a1)](path[_0x5d101a(0x1bd)](require[_0x5d101a(0x1a5)]['filename']),'CADViewer_config.json'),_0x170e84=JSON[_0x5d101a(0x1a8)](fs[_0x5d101a(0x1aa)](_0x27b155,_0x5d101a(0x1bb))),_0x3a9b53=_0x1bb9ac[_0x5d101a(0x1b0)][_0x5d101a(0x1c3)];let _0x3d75a6=_0x170e84[_0x5d101a(0x18b)];_0x3a9b53===_0x5d101a(0x1a0)&&(_0x3d75a6=_0x170e84[_0x5d101a(0x1c6)]);console[_0x5d101a(0x1a3)](_0x5d101a(0x1c1)+_0x3d75a6+'\x20show_folders:'+show_folders+'cvhs_debug:'+config[_0x5d101a(0x1b5)]);if(_0x1bb9ac[_0x5d101a(0x1c2)]){let _0xabbe79;try{const [_0x220f7a]=await conn[_0x5d101a(0x193)]()[_0x5d101a(0x1ac)](_0x5d101a(0x1b8),[_0x1bb9ac[_0x5d101a(0x1c2)][_0x5d101a(0x19e)]]);_0x220f7a[_0x5d101a(0x1c4)]>0x0&&(_0xabbe79=_0x220f7a[0x0]);}catch(_0x1d530a){console[_0x5d101a(0x1a3)]({'err':_0x1d530a}),_0x184525['status'](0x1f4)[_0x5d101a(0x1ad)]({'error':_0x5d101a(0x1b4)});return;}if(!_0xabbe79){_0x184525[_0x5d101a(0x1a9)](0x191)['json']({'error':_0x5d101a(0x1be)});return;}_0xabbe79[_0x5d101a(0x1a2)]===_0x5d101a(0x18f)&&(_0x3d75a6=_0x170e84[_0x5d101a(0x1c6)]);let _0x57f6a8=_0xabbe79[_0x5d101a(0x18e)];if(!_0x57f6a8){_0x57f6a8=randomUUID();try{await conn['promise']()[_0x5d101a(0x1ac)]('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x57f6a8,_0x1bb9ac['user'][_0x5d101a(0x19e)]]);}catch(_0x4568e9){console[_0x5d101a(0x1a3)]({'err':_0x4568e9}),_0x184525[_0x5d101a(0x1a9)](0x1f4)['json']({'error':_0x5d101a(0x1b4)});return;}}const _0x130daf=_0x5d101a(0x1bc)+_0x57f6a8;!fs[_0x5d101a(0x1a6)](_0x130daf)&&fs[_0x5d101a(0x199)](_0x130daf);const _0x47384b=path[_0x5d101a(0x1b9)](_0x130daf),_0x150bc1=listFolderStructure(_0x47384b);!fs[_0x5d101a(0x1a6)](_0x3d75a6)&&fs['mkdirSync'](_0x3d75a6),dirs=[{'own':!![],'name':_0x5d101a(0x191),'path':_0x130daf,'isFolder':!![],'children':_0x150bc1},...listFolderStructure(_0x3d75a6)],_0x184525[_0x5d101a(0x192)](dirs);}else!fs[_0x5d101a(0x1a6)](_0x3d75a6)&&fs[_0x5d101a(0x199)](_0x3d75a6),_0x184525[_0x5d101a(0x192)](listFolderStructure(_0x3d75a6));}),module['exports']=router;function a15_0x47f0(){const _0x420931=['MY\x20FOLDER','send','promise','mtime','1576201XTIAJL','../libs/mysql','size','1854oRHzEt','mkdirSync','forEach','1899788FXxKcm','isDirectory','../libs/jwt','email','1586155xHbLVX','false','join','role','log','sort','main','existsSync','150oUBjli','parse','status','readFileSync','push','execute','json','./uploads','\x20\x20\x20','query','get','319228rzZgCF','readdirSync','Error!\x20Something\x20went\x20wrong.','cvjs_debug','10FlBxfL','Router','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','resolve','children','utf8','./uploads/','dirname','Invalid\x20user','../CADViewer_config.json','birthtime','in\x20listFolderStructure\x20folderLocation=','user','loginFeatureEnabled','length','449801wrwmBw','folderLocation','138zffagb','34608dBMNAB','folderLocationDemoUser','60898WYnArx','path','folder_name','admin','└──\x20'];a15_0x47f0=function(){return _0x420931;};return a15_0x47f0();}