const a15_0x5c2b70=a15_0x2b2f;(function(_0x20a7e7,_0x3792eb){const _0x59c345=a15_0x2b2f,_0x4f8321=_0x20a7e7();while(!![]){try{const _0x12db2e=-parseInt(_0x59c345(0x1d6))/0x1*(-parseInt(_0x59c345(0x1ce))/0x2)+-parseInt(_0x59c345(0x1ac))/0x3+-parseInt(_0x59c345(0x1bf))/0x4*(parseInt(_0x59c345(0x1a9))/0x5)+-parseInt(_0x59c345(0x1cc))/0x6*(-parseInt(_0x59c345(0x1d8))/0x7)+parseInt(_0x59c345(0x1aa))/0x8+parseInt(_0x59c345(0x1db))/0x9*(-parseInt(_0x59c345(0x1d4))/0xa)+parseInt(_0x59c345(0x1d7))/0xb;if(_0x12db2e===_0x3792eb)break;else _0x4f8321['push'](_0x4f8321['shift']());}catch(_0x28e8e2){_0x4f8321['push'](_0x4f8321['shift']());}}}(a15_0x1951,0x4077a));const fs=require('fs'),path=require('path'),config=require(a15_0x5c2b70(0x1c7)),verifyTokenOptional=require(a15_0x5c2b70(0x1b7))[a15_0x5c2b70(0x1e2)],show_folders=![],express=require(a15_0x5c2b70(0x1cf)),router=express['Router'](),conn=require(a15_0x5c2b70(0x1c9)),{randomUUID}=require('crypto'),dir='./uploads';!fs[a15_0x5c2b70(0x1c1)](dir)&&fs[a15_0x5c2b70(0x1da)](dir);const sortFoldersFirst=(_0x36594c,_0x21126d)=>{const _0x27ea83=a15_0x5c2b70;if(_0x36594c[_0x27ea83(0x1ba)]&&!_0x21126d[_0x27ea83(0x1ba)])return-0x1;else return!_0x36594c[_0x27ea83(0x1ba)]&&_0x21126d['children']?0x1:0x0;},listFolderStructure=(_0x3e425e,_0x2f0b26='')=>{const _0x5ba267=a15_0x5c2b70,_0x3f6b1b=fs[_0x5ba267(0x1b1)](_0x3e425e),_0x32aa70=[];return _0x3f6b1b[_0x5ba267(0x1c6)](_0x2588bc=>{const _0x503535=_0x5ba267,_0x56b46a=path[_0x503535(0x1de)](_0x3e425e,_0x2588bc),_0x68bd78=fs[_0x503535(0x1b6)](_0x56b46a);if(_0x68bd78['isDirectory']()){if(config[_0x503535(0x1cd)]&&show_folders)console[_0x503535(0x1d5)](_0x2f0b26+'└──\x20'+_0x2588bc);const _0x13518c=listFolderStructure(_0x56b46a,_0x2f0b26+_0x503535(0x1d3));_0x32aa70[_0x503535(0x1cb)]({'name':_0x2588bc,'path':_0x56b46a,'size':_0x68bd78[_0x503535(0x1c3)],'created':_0x68bd78[_0x503535(0x1b0)],'modified':_0x68bd78['mtime'],'isFolder':!![],'children':_0x13518c});}else{_0x32aa70[_0x503535(0x1cb)]({'name':_0x2588bc,'path':_0x56b46a,'size':_0x68bd78['size'],'created':_0x68bd78['birthtime'],'modified':_0x68bd78['mtime'],'isFolder':![]});if(config[_0x503535(0x1cd)]&&show_folders)console['log'](_0x2f0b26+_0x503535(0x1c8)+_0x2588bc);}}),_0x32aa70[_0x5ba267(0x1a8)](sortFoldersFirst);};function a15_0x1951(){const _0x189099=['1416XUwvcp','status','existsSync','folder_name','size','admin','role','forEach','../CADViewer_config.json','├──\x20','../libs/mysql','length','push','183270CDjfJf','cvjs_debug','149754ytWkyc','express','folderLocationDemoUser','utf8','cvhs_debug:','\x20\x20\x20','10jicOLC','log','2VWvtlV','6097795Zeswsl','7BWjTbs','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','mkdirSync','2917638RXFphG','filename','readFileSync','join','get','user','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','verifyTokenOptional','execute','sort','65CQQWZu','1213216kNecFw','json','880362LBnCwZ','dirname','exports','Invalid\x20user','birthtime','readdirSync','resolve','CADViewer_config.json','\x20show_folders:','send','statSync','../libs/jwt','folderLocation','Error!\x20Something\x20went\x20wrong.','children','MY\x20FOLDER','email','promise','loginFeatureEnabled'];a15_0x1951=function(){return _0x189099;};return a15_0x1951();}function a15_0x2b2f(_0x36864d,_0x27cd69){const _0x1951ac=a15_0x1951();return a15_0x2b2f=function(_0x2b2f7a,_0x3c795f){_0x2b2f7a=_0x2b2f7a-0x1a7;let _0x146b67=_0x1951ac[_0x2b2f7a];return _0x146b67;},a15_0x2b2f(_0x36864d,_0x27cd69);}router[a15_0x5c2b70(0x1df)]('',verifyTokenOptional,async(_0x346299,_0x3d9f56)=>{const _0x41c23f=a15_0x5c2b70,_0xc04aca=path[_0x41c23f(0x1de)](path[_0x41c23f(0x1ad)](require['main'][_0x41c23f(0x1dc)]),_0x41c23f(0x1b3)),_0x275a55=JSON['parse'](fs[_0x41c23f(0x1dd)](_0xc04aca,_0x41c23f(0x1d1))),_0x3590d6=_0x346299['query'][_0x41c23f(0x1be)];let _0x3fcf3b=_0x275a55[_0x41c23f(0x1d0)];_0x3590d6==='false'&&(_0x3fcf3b=_0x275a55[_0x41c23f(0x1b8)]);console[_0x41c23f(0x1d5)]('in\x20listFolderStructure\x20folderLocation='+_0x3fcf3b+_0x41c23f(0x1b4)+show_folders+_0x41c23f(0x1d2)+config['cvjs_debug']);if(_0x346299['user']){let _0x11c4ac;try{const [_0x4c593c]=await conn[_0x41c23f(0x1bd)]()[_0x41c23f(0x1a7)](_0x41c23f(0x1e1),[_0x346299[_0x41c23f(0x1e0)][_0x41c23f(0x1bc)]]);_0x4c593c[_0x41c23f(0x1ca)]>0x0&&(_0x11c4ac=_0x4c593c[0x0]);}catch(_0x2faaf0){console[_0x41c23f(0x1d5)]({'err':_0x2faaf0}),_0x3d9f56['status'](0x1f4)[_0x41c23f(0x1ab)]({'error':_0x41c23f(0x1b9)});return;}if(!_0x11c4ac){_0x3d9f56[_0x41c23f(0x1c0)](0x191)['json']({'error':_0x41c23f(0x1af)});return;}_0x11c4ac[_0x41c23f(0x1c5)]===_0x41c23f(0x1c4)&&(_0x3fcf3b=_0x275a55[_0x41c23f(0x1b8)]);let _0xd2ed35=_0x11c4ac[_0x41c23f(0x1c2)];if(!_0xd2ed35){_0xd2ed35=randomUUID();try{await conn[_0x41c23f(0x1bd)]()[_0x41c23f(0x1a7)](_0x41c23f(0x1d9),[_0xd2ed35,_0x346299[_0x41c23f(0x1e0)][_0x41c23f(0x1bc)]]);}catch(_0x5670f8){console[_0x41c23f(0x1d5)]({'err':_0x5670f8}),_0x3d9f56[_0x41c23f(0x1c0)](0x1f4)[_0x41c23f(0x1ab)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x3ab14a='./uploads/'+_0xd2ed35;!fs['existsSync'](_0x3ab14a)&&fs[_0x41c23f(0x1da)](_0x3ab14a);const _0x3f5dfb=path[_0x41c23f(0x1b2)](_0x3ab14a),_0x5a5222=listFolderStructure(_0x3f5dfb);!fs[_0x41c23f(0x1c1)](_0x3fcf3b)&&fs['mkdirSync'](_0x3fcf3b),dirs=[{'own':!![],'name':_0x41c23f(0x1bb),'path':_0x3ab14a,'isFolder':!![],'children':_0x5a5222},...listFolderStructure(_0x3fcf3b)],_0x3d9f56['send'](dirs);}else!fs[_0x41c23f(0x1c1)](_0x3fcf3b)&&fs[_0x41c23f(0x1da)](_0x3fcf3b),_0x3d9f56[_0x41c23f(0x1b5)](listFolderStructure(_0x3fcf3b));}),module[a15_0x5c2b70(0x1ae)]=router;