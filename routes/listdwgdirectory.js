const a15_0x215556=a15_0x3c26;(function(_0x55bb4d,_0x1aaa4b){const _0x3eb51b=a15_0x3c26,_0x131095=_0x55bb4d();while(!![]){try{const _0x400865=-parseInt(_0x3eb51b(0x12a))/0x1+parseInt(_0x3eb51b(0x104))/0x2*(-parseInt(_0x3eb51b(0x13c))/0x3)+-parseInt(_0x3eb51b(0x11b))/0x4*(-parseInt(_0x3eb51b(0x12b))/0x5)+parseInt(_0x3eb51b(0x125))/0x6*(parseInt(_0x3eb51b(0x112))/0x7)+-parseInt(_0x3eb51b(0x10e))/0x8*(-parseInt(_0x3eb51b(0x138))/0x9)+parseInt(_0x3eb51b(0x11c))/0xa*(parseInt(_0x3eb51b(0x11f))/0xb)+parseInt(_0x3eb51b(0x132))/0xc*(-parseInt(_0x3eb51b(0x114))/0xd);if(_0x400865===_0x1aaa4b)break;else _0x131095['push'](_0x131095['shift']());}catch(_0x28efe3){_0x131095['push'](_0x131095['shift']());}}}(a15_0x368f,0x70e16));function a15_0x3c26(_0x51e98d,_0x35be82){const _0x368fa1=a15_0x368f();return a15_0x3c26=function(_0x3c268e,_0x5049c5){_0x3c268e=_0x3c268e-0x103;let _0x225935=_0x368fa1[_0x3c268e];return _0x225935;},a15_0x3c26(_0x51e98d,_0x35be82);}function a15_0x368f(){const _0x4224b5=['user','9270613ZtTeup','MY\x20FOLDER','dirname','readdirSync','folderLocationDemoUser','existsSync','2120358arILab','crypto','false','log','Router','772785riKjQS','335fKNocc','in\x20listFolderStructure\x20folderLocation=','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','json','query','birthtime','./uploads/','2302548QYCeer','├──\x20','push','Invalid\x20user','folder_name','children','6651bTeEWN','size','join','folderLocation','93582oZNFWy','main','admin','get','\x20show_folders:','\x20\x20\x20','email','CADViewer_config.json','42NrFzVY','parse','length','mkdirSync','role','cvjs_debug','../libs/jwt','./uploads','../libs/mysql','cvhs_debug:','9512IDXcQy','status','send','loginFeatureEnabled','14yUzXlm','Error!\x20Something\x20went\x20wrong.','78gfiWtZ','utf8','└──\x20','promise','execute','forEach','mtime','36612XjniSI','10jZTQpH','readFileSync'];a15_0x368f=function(){return _0x4224b5;};return a15_0x368f();}const fs=require('fs'),path=require('path'),config=require('../CADViewer_config.json'),verifyTokenOptional=require(a15_0x215556(0x10a))['verifyTokenOptional'],show_folders=![],express=require('express'),router=express[a15_0x215556(0x129)](),conn=require(a15_0x215556(0x10c)),{randomUUID}=require(a15_0x215556(0x126)),dir=a15_0x215556(0x10b);!fs[a15_0x215556(0x124)](dir)&&fs['mkdirSync'](dir);const sortFoldersFirst=(_0x41e1bd,_0x4414c0)=>{const _0x59032f=a15_0x215556;if(_0x41e1bd[_0x59032f(0x137)]&&!_0x4414c0[_0x59032f(0x137)])return-0x1;else return!_0x41e1bd['children']&&_0x4414c0['children']?0x1:0x0;},listFolderStructure=(_0x2d9d16,_0x3a3135='')=>{const _0x856c4a=a15_0x215556,_0x155310=fs[_0x856c4a(0x122)](_0x2d9d16),_0x17cc7a=[];return _0x155310[_0x856c4a(0x119)](_0x2fda6f=>{const _0x33ade2=_0x856c4a,_0x3e69ef=path[_0x33ade2(0x13a)](_0x2d9d16,_0x2fda6f),_0x4a0b1c=fs['statSync'](_0x3e69ef);if(_0x4a0b1c['isDirectory']()){if(config[_0x33ade2(0x109)]&&show_folders)console[_0x33ade2(0x128)](_0x3a3135+_0x33ade2(0x116)+_0x2fda6f);const _0x47c79=listFolderStructure(_0x3e69ef,_0x3a3135+_0x33ade2(0x141));_0x17cc7a[_0x33ade2(0x134)]({'name':_0x2fda6f,'path':_0x3e69ef,'size':_0x4a0b1c[_0x33ade2(0x139)],'created':_0x4a0b1c[_0x33ade2(0x130)],'modified':_0x4a0b1c[_0x33ade2(0x11a)],'isFolder':!![],'children':_0x47c79});}else{_0x17cc7a['push']({'name':_0x2fda6f,'path':_0x3e69ef,'size':_0x4a0b1c[_0x33ade2(0x139)],'created':_0x4a0b1c[_0x33ade2(0x130)],'modified':_0x4a0b1c[_0x33ade2(0x11a)],'isFolder':![]});if(config[_0x33ade2(0x109)]&&show_folders)console[_0x33ade2(0x128)](_0x3a3135+_0x33ade2(0x133)+_0x2fda6f);}}),_0x17cc7a['sort'](sortFoldersFirst);};router[a15_0x215556(0x13f)]('',verifyTokenOptional,async(_0x487137,_0x134b4c)=>{const _0x392b8d=a15_0x215556,_0x2cdac7=path[_0x392b8d(0x13a)](path[_0x392b8d(0x121)](require[_0x392b8d(0x13d)]['filename']),_0x392b8d(0x103)),_0xdfb382=JSON[_0x392b8d(0x105)](fs[_0x392b8d(0x11d)](_0x2cdac7,_0x392b8d(0x115))),_0x43f466=_0x487137[_0x392b8d(0x12f)][_0x392b8d(0x111)];let _0x468a62=_0xdfb382[_0x392b8d(0x123)];_0x43f466===_0x392b8d(0x127)&&(_0x468a62=_0xdfb382[_0x392b8d(0x13b)]);console['log'](_0x392b8d(0x12c)+_0x468a62+_0x392b8d(0x140)+show_folders+_0x392b8d(0x10d)+config[_0x392b8d(0x109)]);if(_0x487137[_0x392b8d(0x11e)]){let _0x169ba0;try{const [_0x350c09]=await conn[_0x392b8d(0x117)]()[_0x392b8d(0x118)]('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x487137[_0x392b8d(0x11e)][_0x392b8d(0x142)]]);_0x350c09[_0x392b8d(0x106)]>0x0&&(_0x169ba0=_0x350c09[0x0]);}catch(_0x2f4271){console[_0x392b8d(0x128)]({'err':_0x2f4271}),_0x134b4c[_0x392b8d(0x10f)](0x1f4)[_0x392b8d(0x12e)]({'error':_0x392b8d(0x113)});return;}if(!_0x169ba0){_0x134b4c['status'](0x191)['json']({'error':_0x392b8d(0x135)});return;}_0x169ba0[_0x392b8d(0x108)]===_0x392b8d(0x13e)&&(_0x468a62=_0xdfb382[_0x392b8d(0x13b)]);let _0x102c53=_0x169ba0[_0x392b8d(0x136)];if(!_0x102c53){_0x102c53=randomUUID();try{await conn[_0x392b8d(0x117)]()[_0x392b8d(0x118)](_0x392b8d(0x12d),[_0x102c53,_0x487137[_0x392b8d(0x11e)][_0x392b8d(0x142)]]);}catch(_0x53930c){console[_0x392b8d(0x128)]({'err':_0x53930c}),_0x134b4c[_0x392b8d(0x10f)](0x1f4)['json']({'error':_0x392b8d(0x113)});return;}}const _0x116f05=_0x392b8d(0x131)+_0x102c53;!fs[_0x392b8d(0x124)](_0x116f05)&&fs[_0x392b8d(0x107)](_0x116f05);const _0x5ba02a=path['resolve'](_0x116f05),_0x92afd0=listFolderStructure(_0x5ba02a);!fs['existsSync'](_0x468a62)&&fs[_0x392b8d(0x107)](_0x468a62),dirs=[{'own':!![],'name':_0x392b8d(0x120),'path':_0x116f05,'isFolder':!![],'children':_0x92afd0},...listFolderStructure(_0x468a62)],_0x134b4c[_0x392b8d(0x110)](dirs);}else!fs['existsSync'](_0x468a62)&&fs['mkdirSync'](_0x468a62),_0x134b4c[_0x392b8d(0x110)](listFolderStructure(_0x468a62));}),module['exports']=router;