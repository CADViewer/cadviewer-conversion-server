const a15_0x4e6e04=a15_0x43ca;(function(_0x27936a,_0x4ea1d6){const _0x105117=a15_0x43ca,_0x463e22=_0x27936a();while(!![]){try{const _0x1eeb8a=parseInt(_0x105117(0x162))/0x1+parseInt(_0x105117(0x14e))/0x2*(-parseInt(_0x105117(0x16e))/0x3)+parseInt(_0x105117(0x17e))/0x4+parseInt(_0x105117(0x15c))/0x5+parseInt(_0x105117(0x172))/0x6*(parseInt(_0x105117(0x155))/0x7)+-parseInt(_0x105117(0x180))/0x8*(parseInt(_0x105117(0x148))/0x9)+parseInt(_0x105117(0x177))/0xa;if(_0x1eeb8a===_0x4ea1d6)break;else _0x463e22['push'](_0x463e22['shift']());}catch(_0x163d64){_0x463e22['push'](_0x463e22['shift']());}}}(a15_0x2ba8,0xd5206));const fs=require('fs'),path=require(a15_0x4e6e04(0x16b)),config=require(a15_0x4e6e04(0x15b)),verifyTokenOptional=require('../libs/jwt')[a15_0x4e6e04(0x181)],show_folders=![],express=require(a15_0x4e6e04(0x169)),router=express[a15_0x4e6e04(0x16f)](),conn=require(a15_0x4e6e04(0x15e)),{randomUUID}=require(a15_0x4e6e04(0x168)),dir=a15_0x4e6e04(0x153);!fs[a15_0x4e6e04(0x163)](dir)&&fs[a15_0x4e6e04(0x170)](dir);function a15_0x2ba8(){const _0x52b8c7=['mkdirSync','Error!\x20Something\x20went\x20wrong.','9633822RthrcG','json','get','promise','dirname','3998270hJbIvy','folder_name','size','filename','execute','loginFeatureEnabled','mtime','2782472DOmVeI','email','72jxsPra','verifyTokenOptional','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','children','length','log','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','└──\x20','1189233whOPxR','role','main','in\x20listFolderStructure\x20folderLocation=','join','./uploads/','1576766gCkhcF','statSync','readdirSync','folderLocation','├──\x20','./uploads','\x20\x20\x20','7fulrwc','cvhs_debug:','birthtime','cvjs_debug','push','query','../CADViewer_config.json','209855FDrTsz','status','../libs/mysql','MY\x20FOLDER','isDirectory','readFileSync','895912GdaxGz','existsSync','utf8','Invalid\x20user','send','\x20show_folders:','crypto','express','exports','path','CADViewer_config.json','user','6nOrztt','Router'];a15_0x2ba8=function(){return _0x52b8c7;};return a15_0x2ba8();}function a15_0x43ca(_0x1ac896,_0x4fb28f){const _0x2ba82b=a15_0x2ba8();return a15_0x43ca=function(_0x43cae6,_0x56af13){_0x43cae6=_0x43cae6-0x147;let _0x3be079=_0x2ba82b[_0x43cae6];return _0x3be079;},a15_0x43ca(_0x1ac896,_0x4fb28f);}const sortFoldersFirst=(_0x59e9f4,_0x5f1b8a)=>{const _0x2164c2=a15_0x4e6e04;if(_0x59e9f4['children']&&!_0x5f1b8a[_0x2164c2(0x183)])return-0x1;else return!_0x59e9f4['children']&&_0x5f1b8a['children']?0x1:0x0;},listFolderStructure=(_0x34a4a0,_0x275e87='')=>{const _0x10c6f6=a15_0x4e6e04,_0x4a340d=fs[_0x10c6f6(0x150)](_0x34a4a0),_0x925234=[];return _0x4a340d['forEach'](_0x404f71=>{const _0x26a8ae=_0x10c6f6,_0x4de210=path[_0x26a8ae(0x14c)](_0x34a4a0,_0x404f71),_0x4ffe97=fs[_0x26a8ae(0x14f)](_0x4de210);if(_0x4ffe97[_0x26a8ae(0x160)]()){if(config[_0x26a8ae(0x158)]&&show_folders)console[_0x26a8ae(0x185)](_0x275e87+_0x26a8ae(0x147)+_0x404f71);const _0x140642=listFolderStructure(_0x4de210,_0x275e87+_0x26a8ae(0x154));_0x925234['push']({'name':_0x404f71,'path':_0x4de210,'size':_0x4ffe97[_0x26a8ae(0x179)],'created':_0x4ffe97[_0x26a8ae(0x157)],'modified':_0x4ffe97[_0x26a8ae(0x17d)],'isFolder':!![],'children':_0x140642});}else{_0x925234[_0x26a8ae(0x159)]({'name':_0x404f71,'path':_0x4de210,'size':_0x4ffe97[_0x26a8ae(0x179)],'created':_0x4ffe97[_0x26a8ae(0x157)],'modified':_0x4ffe97[_0x26a8ae(0x17d)],'isFolder':![]});if(config[_0x26a8ae(0x158)]&&show_folders)console[_0x26a8ae(0x185)](_0x275e87+_0x26a8ae(0x152)+_0x404f71);}}),_0x925234['sort'](sortFoldersFirst);};router[a15_0x4e6e04(0x174)]('',verifyTokenOptional,async(_0x3fd19d,_0x388ebd)=>{const _0x378738=a15_0x4e6e04,_0x50ed9c=path['join'](path[_0x378738(0x176)](require[_0x378738(0x14a)][_0x378738(0x17a)]),_0x378738(0x16c)),_0x38dd72=JSON['parse'](fs[_0x378738(0x161)](_0x50ed9c,_0x378738(0x164))),_0xc0bc93=_0x3fd19d[_0x378738(0x15a)][_0x378738(0x17c)];let _0x5b7b74=_0x38dd72['folderLocationDemoUser'];_0xc0bc93==='false'&&(_0x5b7b74=_0x38dd72[_0x378738(0x151)]);console['log'](_0x378738(0x14b)+_0x5b7b74+_0x378738(0x167)+show_folders+_0x378738(0x156)+config[_0x378738(0x158)]);if(_0x3fd19d[_0x378738(0x16d)]){let _0x2119c5;try{const [_0x4a7afd]=await conn[_0x378738(0x175)]()[_0x378738(0x17b)](_0x378738(0x186),[_0x3fd19d['user']['email']]);_0x4a7afd[_0x378738(0x184)]>0x0&&(_0x2119c5=_0x4a7afd[0x0]);}catch(_0x4cba97){console[_0x378738(0x185)]({'err':_0x4cba97}),_0x388ebd['status'](0x1f4)[_0x378738(0x173)]({'error':_0x378738(0x171)});return;}if(!_0x2119c5){_0x388ebd[_0x378738(0x15d)](0x191)['json']({'error':_0x378738(0x165)});return;}_0x2119c5[_0x378738(0x149)]==='admin'&&(_0x5b7b74=_0x38dd72[_0x378738(0x151)]);let _0x14cc18=_0x2119c5[_0x378738(0x178)];if(!_0x14cc18){_0x14cc18=randomUUID();try{await conn[_0x378738(0x175)]()[_0x378738(0x17b)](_0x378738(0x182),[_0x14cc18,_0x3fd19d[_0x378738(0x16d)][_0x378738(0x17f)]]);}catch(_0x25a7ae){console[_0x378738(0x185)]({'err':_0x25a7ae}),_0x388ebd[_0x378738(0x15d)](0x1f4)['json']({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x119827=_0x378738(0x14d)+_0x14cc18;!fs['existsSync'](_0x119827)&&fs['mkdirSync'](_0x119827);const _0x5a3d28=path['resolve'](_0x119827),_0x53df08=listFolderStructure(_0x5a3d28);!fs[_0x378738(0x163)](_0x5b7b74)&&fs['mkdirSync'](_0x5b7b74),dirs=[{'own':!![],'name':_0x378738(0x15f),'path':_0x119827,'isFolder':!![],'children':_0x53df08},...listFolderStructure(_0x5b7b74)],_0x388ebd[_0x378738(0x166)](dirs);}else!fs['existsSync'](_0x5b7b74)&&fs[_0x378738(0x170)](_0x5b7b74),_0x388ebd[_0x378738(0x166)](listFolderStructure(_0x5b7b74));}),module[a15_0x4e6e04(0x16a)]=router;