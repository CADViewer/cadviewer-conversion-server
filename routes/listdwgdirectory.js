const a15_0x3125eb=a15_0x2e95;function a15_0x2e95(_0x59d1ae,_0x33bbd1){const _0x964a6a=a15_0x964a();return a15_0x2e95=function(_0x2e958c,_0xf7ec11){_0x2e958c=_0x2e958c-0x65;let _0xc0b2d4=_0x964a6a[_0x2e958c];return _0xc0b2d4;},a15_0x2e95(_0x59d1ae,_0x33bbd1);}(function(_0x4dc3e0,_0x347805){const _0x55e08e=a15_0x2e95,_0x4cc607=_0x4dc3e0();while(!![]){try{const _0xb7c74f=-parseInt(_0x55e08e(0x72))/0x1+-parseInt(_0x55e08e(0xa3))/0x2+-parseInt(_0x55e08e(0x70))/0x3*(parseInt(_0x55e08e(0x9f))/0x4)+parseInt(_0x55e08e(0x7e))/0x5*(parseInt(_0x55e08e(0x89))/0x6)+-parseInt(_0x55e08e(0x9c))/0x7+-parseInt(_0x55e08e(0x9a))/0x8+-parseInt(_0x55e08e(0x9e))/0x9*(-parseInt(_0x55e08e(0x7f))/0xa);if(_0xb7c74f===_0x347805)break;else _0x4cc607['push'](_0x4cc607['shift']());}catch(_0x4d550c){_0x4cc607['push'](_0x4cc607['shift']());}}}(a15_0x964a,0x8057f));function a15_0x964a(){const _0x379f71=['length','size','Router','Error!\x20Something\x20went\x20wrong.','exports','12KHJIuX','filename','parse','crypto','verifyTokenOptional','path','push','./uploads','folderLocationDemoUser','mkdirSync','mtime','Invalid\x20user','utf8','\x20show_folders:','status','in\x20listFolderStructure\x20folderLocation=','send','5717848uJothr','promise','420812LVVBAt','readFileSync','45dGSrDE','104yFCbwG','cvjs_debug','folderLocation','join','1839822AIqLFi','user','cvhs_debug:','execute','email','get','\x20\x20\x20','../libs/mysql','dirname','query','└──\x20','express','25287yCWAzI','├──\x20','768080LpriAp','MY\x20FOLDER','./uploads/','readdirSync','forEach','isDirectory','../libs/jwt','../CADViewer_config.json','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','children','sort','json','1735880syqRCJ','5026670FzaTXj','folder_name','existsSync','log','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?'];a15_0x964a=function(){return _0x379f71;};return a15_0x964a();}const fs=require('fs'),path=require(a15_0x3125eb(0x8e)),config=require(a15_0x3125eb(0x79)),verifyTokenOptional=require(a15_0x3125eb(0x78))[a15_0x3125eb(0x8d)],show_folders=![],express=require(a15_0x3125eb(0x6f)),router=express[a15_0x3125eb(0x86)](),conn=require(a15_0x3125eb(0x6b)),{randomUUID}=require(a15_0x3125eb(0x8c)),dir=a15_0x3125eb(0x90);!fs[a15_0x3125eb(0x81)](dir)&&fs[a15_0x3125eb(0x92)](dir);const sortFoldersFirst=(_0xdbcb5c,_0x3201be)=>{const _0x55d105=a15_0x3125eb;if(_0xdbcb5c[_0x55d105(0x7b)]&&!_0x3201be[_0x55d105(0x7b)])return-0x1;else return!_0xdbcb5c[_0x55d105(0x7b)]&&_0x3201be[_0x55d105(0x7b)]?0x1:0x0;},listFolderStructure=(_0x393acc,_0x5e764e='')=>{const _0x9a9fd7=a15_0x3125eb,_0xca57cb=fs[_0x9a9fd7(0x75)](_0x393acc),_0x2c1176=[];return _0xca57cb[_0x9a9fd7(0x76)](_0x84ccdb=>{const _0xd440e5=_0x9a9fd7,_0x1d3e3d=path['join'](_0x393acc,_0x84ccdb),_0x43ca25=fs['statSync'](_0x1d3e3d);if(_0x43ca25[_0xd440e5(0x77)]()){if(config['cvjs_debug']&&show_folders)console[_0xd440e5(0x82)](_0x5e764e+_0xd440e5(0x6e)+_0x84ccdb);const _0x90339c=listFolderStructure(_0x1d3e3d,_0x5e764e+_0xd440e5(0x6a));_0x2c1176[_0xd440e5(0x8f)]({'name':_0x84ccdb,'path':_0x1d3e3d,'size':_0x43ca25[_0xd440e5(0x85)],'created':_0x43ca25['birthtime'],'modified':_0x43ca25[_0xd440e5(0x93)],'isFolder':!![],'children':_0x90339c});}else{_0x2c1176[_0xd440e5(0x8f)]({'name':_0x84ccdb,'path':_0x1d3e3d,'size':_0x43ca25['size'],'created':_0x43ca25['birthtime'],'modified':_0x43ca25[_0xd440e5(0x93)],'isFolder':![]});if(config[_0xd440e5(0xa0)]&&show_folders)console[_0xd440e5(0x82)](_0x5e764e+_0xd440e5(0x71)+_0x84ccdb);}}),_0x2c1176[_0x9a9fd7(0x7c)](sortFoldersFirst);};router[a15_0x3125eb(0x69)]('',verifyTokenOptional,async(_0x362477,_0x395718)=>{const _0x25459c=a15_0x3125eb,_0x22dfb2=path[_0x25459c(0xa2)](path[_0x25459c(0x6c)](require['main'][_0x25459c(0x8a)]),'CADViewer_config.json'),_0x536440=JSON[_0x25459c(0x8b)](fs[_0x25459c(0x9d)](_0x22dfb2,_0x25459c(0x95))),_0x3bea63=_0x362477[_0x25459c(0x6d)]['loginFeatureEnabled'];let _0x443819=_0x536440[_0x25459c(0x91)];_0x3bea63==='false'&&(_0x443819=_0x536440[_0x25459c(0xa1)]);console[_0x25459c(0x82)](_0x25459c(0x98)+_0x443819+_0x25459c(0x96)+show_folders+_0x25459c(0x66)+config[_0x25459c(0xa0)]);if(_0x362477[_0x25459c(0x65)]){let _0x4f4d28;try{const [_0x5cb34f]=await conn[_0x25459c(0x9b)]()[_0x25459c(0x67)](_0x25459c(0x83),[_0x362477[_0x25459c(0x65)][_0x25459c(0x68)]]);_0x5cb34f[_0x25459c(0x84)]>0x0&&(_0x4f4d28=_0x5cb34f[0x0]);}catch(_0x4be4a9){console[_0x25459c(0x82)]({'err':_0x4be4a9}),_0x395718['status'](0x1f4)['json']({'error':_0x25459c(0x87)});return;}if(!_0x4f4d28){_0x395718[_0x25459c(0x97)](0x191)['json']({'error':_0x25459c(0x94)});return;}_0x4f4d28['role']==='admin'&&(_0x443819=_0x536440['folderLocation']);let _0x4acb1b=_0x4f4d28[_0x25459c(0x80)];if(!_0x4acb1b){_0x4acb1b=randomUUID();try{await conn[_0x25459c(0x9b)]()[_0x25459c(0x67)](_0x25459c(0x7a),[_0x4acb1b,_0x362477[_0x25459c(0x65)]['email']]);}catch(_0x8ca216){console[_0x25459c(0x82)]({'err':_0x8ca216}),_0x395718[_0x25459c(0x97)](0x1f4)[_0x25459c(0x7d)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x4b2983=_0x25459c(0x74)+_0x4acb1b;!fs['existsSync'](_0x4b2983)&&fs[_0x25459c(0x92)](_0x4b2983);const _0x366311=path['resolve'](_0x4b2983),_0x4aa1ad=listFolderStructure(_0x366311);!fs[_0x25459c(0x81)](_0x443819)&&fs[_0x25459c(0x92)](_0x443819),dirs=[{'own':!![],'name':_0x25459c(0x73),'path':_0x4b2983,'isFolder':!![],'children':_0x4aa1ad},...listFolderStructure(_0x443819)],_0x395718[_0x25459c(0x99)](dirs);}else!fs[_0x25459c(0x81)](_0x443819)&&fs['mkdirSync'](_0x443819),_0x395718[_0x25459c(0x99)](listFolderStructure(_0x443819));}),module[a15_0x3125eb(0x88)]=router;