const a15_0x3c4721=a15_0x3d35;function a15_0x3bdd(){const _0x5a8372=['user','size','../CADViewer_config.json','length','join','forEach','46398abwYrR','mtime','CADViewer_config.json','send','children','24025BBNXLC','Invalid\x20user','role','existsSync','516DPatSr','dirname','../libs/jwt','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','555375hzakDc','19704010ilmEtm','folder_name','\x20\x20\x20','crypto','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','query','push','9pWsMTF','execute','isDirectory','\x20show_folders:','../libs/mysql','utf8','email','path','statSync','express','promise','├──\x20','folderLocation','./uploads/','status','readFileSync','loginFeatureEnabled','sort','false','json','73768vRCFqT','folderLocationDemoUser','572327hzezLq','mkdirSync','889MhbpqG','cvhs_debug:','exports','verifyTokenOptional','./uploads','3622432jyFCpn','cvjs_debug','└──\x20','log','filename'];a15_0x3bdd=function(){return _0x5a8372;};return a15_0x3bdd();}(function(_0x948007,_0x3cb8cc){const _0x1dd581=a15_0x3d35,_0x1efee6=_0x948007();while(!![]){try{const _0x143ba0=parseInt(_0x1dd581(0x189))/0x1+-parseInt(_0x1dd581(0x19b))/0x2+-parseInt(_0x1dd581(0x1a8))/0x3+-parseInt(_0x1dd581(0x190))/0x4+-parseInt(_0x1dd581(0x1a0))/0x5*(-parseInt(_0x1dd581(0x1a4))/0x6)+-parseInt(_0x1dd581(0x18b))/0x7*(parseInt(_0x1dd581(0x187))/0x8)+-parseInt(_0x1dd581(0x1b0))/0x9*(-parseInt(_0x1dd581(0x1a9))/0xa);if(_0x143ba0===_0x3cb8cc)break;else _0x1efee6['push'](_0x1efee6['shift']());}catch(_0x2a743f){_0x1efee6['push'](_0x1efee6['shift']());}}}(a15_0x3bdd,0xa3cef));const fs=require('fs'),path=require(a15_0x3c4721(0x17a)),config=require(a15_0x3c4721(0x197)),verifyTokenOptional=require(a15_0x3c4721(0x1a6))[a15_0x3c4721(0x18e)],show_folders=![],express=require(a15_0x3c4721(0x17c)),router=express['Router'](),conn=require(a15_0x3c4721(0x1b4)),{randomUUID}=require(a15_0x3c4721(0x1ac)),dir=a15_0x3c4721(0x18f);function a15_0x3d35(_0x204f64,_0x584269){const _0x3bdd88=a15_0x3bdd();return a15_0x3d35=function(_0x3d351f,_0xe78358){_0x3d351f=_0x3d351f-0x178;let _0x2eaf9c=_0x3bdd88[_0x3d351f];return _0x2eaf9c;},a15_0x3d35(_0x204f64,_0x584269);}!fs['existsSync'](dir)&&fs[a15_0x3c4721(0x18a)](dir);const sortFoldersFirst=(_0x247fe4,_0x15d31b)=>{const _0x427577=a15_0x3c4721;if(_0x247fe4[_0x427577(0x19f)]&&!_0x15d31b[_0x427577(0x19f)])return-0x1;else return!_0x247fe4[_0x427577(0x19f)]&&_0x15d31b[_0x427577(0x19f)]?0x1:0x0;},listFolderStructure=(_0x2eae9e,_0xa08d37='')=>{const _0x42eb95=a15_0x3c4721,_0x56217e=fs['readdirSync'](_0x2eae9e),_0x4fce61=[];return _0x56217e[_0x42eb95(0x19a)](_0x1cae22=>{const _0x1d2ed9=_0x42eb95,_0x209f9c=path[_0x1d2ed9(0x199)](_0x2eae9e,_0x1cae22),_0x1686f4=fs[_0x1d2ed9(0x17b)](_0x209f9c);if(_0x1686f4[_0x1d2ed9(0x1b2)]()){if(config[_0x1d2ed9(0x191)]&&show_folders)console[_0x1d2ed9(0x193)](_0xa08d37+_0x1d2ed9(0x192)+_0x1cae22);const _0xc6749a=listFolderStructure(_0x209f9c,_0xa08d37+_0x1d2ed9(0x1ab));_0x4fce61[_0x1d2ed9(0x1af)]({'name':_0x1cae22,'path':_0x209f9c,'size':_0x1686f4[_0x1d2ed9(0x196)],'created':_0x1686f4['birthtime'],'modified':_0x1686f4[_0x1d2ed9(0x19c)],'isFolder':!![],'children':_0xc6749a});}else{_0x4fce61[_0x1d2ed9(0x1af)]({'name':_0x1cae22,'path':_0x209f9c,'size':_0x1686f4[_0x1d2ed9(0x196)],'created':_0x1686f4['birthtime'],'modified':_0x1686f4['mtime'],'isFolder':![]});if(config[_0x1d2ed9(0x191)]&&show_folders)console[_0x1d2ed9(0x193)](_0xa08d37+_0x1d2ed9(0x17e)+_0x1cae22);}}),_0x4fce61[_0x42eb95(0x184)](sortFoldersFirst);};router['get']('',verifyTokenOptional,async(_0x12f9e4,_0x507cfa)=>{const _0x4d9d17=a15_0x3c4721,_0x2814bf=path[_0x4d9d17(0x199)](path[_0x4d9d17(0x1a5)](require['main'][_0x4d9d17(0x194)]),_0x4d9d17(0x19d)),_0x109d2d=JSON['parse'](fs[_0x4d9d17(0x182)](_0x2814bf,_0x4d9d17(0x178))),_0x276152=_0x12f9e4[_0x4d9d17(0x1ae)][_0x4d9d17(0x183)];let _0x163318=_0x109d2d[_0x4d9d17(0x188)];_0x276152===_0x4d9d17(0x185)&&(_0x163318=_0x109d2d[_0x4d9d17(0x17f)]);console[_0x4d9d17(0x193)]('in\x20listFolderStructure\x20folderLocation='+_0x163318+_0x4d9d17(0x1b3)+show_folders+_0x4d9d17(0x18c)+config[_0x4d9d17(0x191)]);if(_0x12f9e4['user']){let _0x167321;try{const [_0x2c2085]=await conn[_0x4d9d17(0x17d)]()[_0x4d9d17(0x1b1)](_0x4d9d17(0x1ad),[_0x12f9e4[_0x4d9d17(0x195)][_0x4d9d17(0x179)]]);_0x2c2085[_0x4d9d17(0x198)]>0x0&&(_0x167321=_0x2c2085[0x0]);}catch(_0x2d78a2){console['log']({'err':_0x2d78a2}),_0x507cfa[_0x4d9d17(0x181)](0x1f4)[_0x4d9d17(0x186)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x167321){_0x507cfa['status'](0x191)['json']({'error':_0x4d9d17(0x1a1)});return;}_0x167321[_0x4d9d17(0x1a2)]==='admin'&&(_0x163318=_0x109d2d[_0x4d9d17(0x17f)]);let _0x45fe68=_0x167321[_0x4d9d17(0x1aa)];if(!_0x45fe68){_0x45fe68=randomUUID();try{await conn[_0x4d9d17(0x17d)]()[_0x4d9d17(0x1b1)](_0x4d9d17(0x1a7),[_0x45fe68,_0x12f9e4[_0x4d9d17(0x195)][_0x4d9d17(0x179)]]);}catch(_0x432dba){console[_0x4d9d17(0x193)]({'err':_0x432dba}),_0x507cfa[_0x4d9d17(0x181)](0x1f4)[_0x4d9d17(0x186)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x1dde25=_0x4d9d17(0x180)+_0x45fe68;!fs[_0x4d9d17(0x1a3)](_0x1dde25)&&fs[_0x4d9d17(0x18a)](_0x1dde25);const _0xbd79f0=path['resolve'](_0x1dde25),_0x4e3585=listFolderStructure(_0xbd79f0);!fs[_0x4d9d17(0x1a3)](_0x163318)&&fs[_0x4d9d17(0x18a)](_0x163318),dirs=[{'own':!![],'name':'MY\x20FOLDER','path':_0x1dde25,'isFolder':!![],'children':_0x4e3585},...listFolderStructure(_0x163318)],_0x507cfa[_0x4d9d17(0x19e)](dirs);}else!fs['existsSync'](_0x163318)&&fs[_0x4d9d17(0x18a)](_0x163318),_0x507cfa['send'](listFolderStructure(_0x163318));}),module[a15_0x3c4721(0x18d)]=router;