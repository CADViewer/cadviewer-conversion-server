const a15_0x52f6fe=a15_0x5c8f;(function(_0xf255f6,_0x244490){const _0x394a83=a15_0x5c8f,_0x1b7f94=_0xf255f6();while(!![]){try{const _0x2f9095=-parseInt(_0x394a83(0xe8))/0x1+-parseInt(_0x394a83(0xe3))/0x2*(-parseInt(_0x394a83(0xd1))/0x3)+-parseInt(_0x394a83(0xca))/0x4+parseInt(_0x394a83(0xe0))/0x5+-parseInt(_0x394a83(0xd2))/0x6*(parseInt(_0x394a83(0xdd))/0x7)+parseInt(_0x394a83(0xdb))/0x8+-parseInt(_0x394a83(0xfa))/0x9;if(_0x2f9095===_0x244490)break;else _0x1b7f94['push'](_0x1b7f94['shift']());}catch(_0xb57e86){_0x1b7f94['push'](_0x1b7f94['shift']());}}}(a15_0x4784,0x3efc0));const fs=require('fs'),path=require(a15_0x52f6fe(0xd0)),config=require(a15_0x52f6fe(0xcb)),verifyTokenOptional=require(a15_0x52f6fe(0xe1))[a15_0x52f6fe(0xfc)],show_folders=![],express=require(a15_0x52f6fe(0xe9)),router=express[a15_0x52f6fe(0xf3)](),conn=require(a15_0x52f6fe(0xe6)),{randomUUID}=require('crypto'),dir=a15_0x52f6fe(0xe4);!fs['existsSync'](dir)&&fs[a15_0x52f6fe(0xdf)](dir);function a15_0x5c8f(_0x398353,_0x3399f7){const _0x478478=a15_0x4784();return a15_0x5c8f=function(_0x5c8f40,_0x247d52){_0x5c8f40=_0x5c8f40-0xc7;let _0x5d4d61=_0x478478[_0x5c8f40];return _0x5d4d61;},a15_0x5c8f(_0x398353,_0x3399f7);}const sortFoldersFirst=(_0x1d9506,_0x229a59)=>{const _0x2616a9=a15_0x52f6fe;if(_0x1d9506[_0x2616a9(0xd9)]&&!_0x229a59['children'])return-0x1;else return!_0x1d9506[_0x2616a9(0xd9)]&&_0x229a59[_0x2616a9(0xd9)]?0x1:0x0;},listFolderStructure=(_0x2389a8,_0x2e99c7='')=>{const _0x1c655b=a15_0x52f6fe,_0x2d5cef=fs[_0x1c655b(0xce)](_0x2389a8),_0x2d70ad=[];return _0x2d5cef[_0x1c655b(0xf1)](_0x597fad=>{const _0x266fa9=_0x1c655b,_0x5efefb=path[_0x266fa9(0xf5)](_0x2389a8,_0x597fad),_0x18de98=fs['statSync'](_0x5efefb);if(_0x18de98[_0x266fa9(0xdc)]()){if(config[_0x266fa9(0xf2)]&&show_folders)console['log'](_0x2e99c7+_0x266fa9(0xf0)+_0x597fad);const _0xac6d04=listFolderStructure(_0x5efefb,_0x2e99c7+'\x20\x20\x20');_0x2d70ad[_0x266fa9(0x101)]({'name':_0x597fad,'path':_0x5efefb,'size':_0x18de98[_0x266fa9(0xc8)],'created':_0x18de98[_0x266fa9(0xe5)],'modified':_0x18de98['mtime'],'isFolder':!![],'children':_0xac6d04});}else{_0x2d70ad['push']({'name':_0x597fad,'path':_0x5efefb,'size':_0x18de98['size'],'created':_0x18de98[_0x266fa9(0xe5)],'modified':_0x18de98[_0x266fa9(0xea)],'isFolder':![]});if(config[_0x266fa9(0xf2)]&&show_folders)console['log'](_0x2e99c7+'├──\x20'+_0x597fad);}}),_0x2d70ad[_0x1c655b(0xde)](sortFoldersFirst);};function a15_0x4784(){const _0xba177b=['send','readdirSync','folderLocationDemoUser','path','89835qnWCCA','32304aYuWNA','filename','resolve','json','Error!\x20Something\x20went\x20wrong.','dirname','get','children','log','2474544tHfazE','isDirectory','56ApFkXy','sort','mkdirSync','2556675slsqRi','../libs/jwt','parse','2YLhvkr','./uploads','birthtime','../libs/mysql','email','46533eqWeib','express','mtime','promise','cvhs_debug:','status','./uploads/','Invalid\x20user','└──\x20','forEach','cvjs_debug','Router','query','join','folderLocation','user','exports','MY\x20FOLDER','4232745jQaRvR','existsSync','verifyTokenOptional','role','admin','length','execute','push','main','size','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','130816SdelDp','../CADViewer_config.json','readFileSync'];a15_0x4784=function(){return _0xba177b;};return a15_0x4784();}router[a15_0x52f6fe(0xd8)]('',verifyTokenOptional,async(_0x9e21a3,_0x5edc85)=>{const _0x38f11e=a15_0x52f6fe,_0x35c178=path[_0x38f11e(0xf5)](path[_0x38f11e(0xd7)](require[_0x38f11e(0xc7)][_0x38f11e(0xd3)]),'CADViewer_config.json'),_0x5202b4=JSON[_0x38f11e(0xe2)](fs[_0x38f11e(0xcc)](_0x35c178,'utf8')),_0x1245a7=_0x9e21a3[_0x38f11e(0xf4)]['loginFeatureEnabled'];let _0x2f3f2a=_0x5202b4[_0x38f11e(0xcf)];_0x1245a7==='false'&&(_0x2f3f2a=_0x5202b4[_0x38f11e(0xf6)]);console[_0x38f11e(0xda)]('in\x20listFolderStructure\x20folderLocation='+_0x2f3f2a+'\x20show_folders:'+show_folders+_0x38f11e(0xec)+config[_0x38f11e(0xf2)]);if(_0x9e21a3[_0x38f11e(0xf7)]){let _0x4741c4;try{const [_0x5bc934]=await conn[_0x38f11e(0xeb)]()[_0x38f11e(0x100)](_0x38f11e(0xc9),[_0x9e21a3[_0x38f11e(0xf7)][_0x38f11e(0xe7)]]);_0x5bc934[_0x38f11e(0xff)]>0x0&&(_0x4741c4=_0x5bc934[0x0]);}catch(_0x205bde){console[_0x38f11e(0xda)]({'err':_0x205bde}),_0x5edc85['status'](0x1f4)[_0x38f11e(0xd5)]({'error':_0x38f11e(0xd6)});return;}if(!_0x4741c4){_0x5edc85[_0x38f11e(0xed)](0x191)['json']({'error':_0x38f11e(0xef)});return;}_0x4741c4[_0x38f11e(0xfd)]===_0x38f11e(0xfe)&&(_0x2f3f2a=_0x5202b4[_0x38f11e(0xf6)]);let _0x4c031c=_0x4741c4['folder_name'];if(!_0x4c031c){_0x4c031c=randomUUID();try{await conn[_0x38f11e(0xeb)]()[_0x38f11e(0x100)]('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x4c031c,_0x9e21a3[_0x38f11e(0xf7)]['email']]);}catch(_0x22d2a2){console[_0x38f11e(0xda)]({'err':_0x22d2a2}),_0x5edc85[_0x38f11e(0xed)](0x1f4)[_0x38f11e(0xd5)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x2ec2ad=_0x38f11e(0xee)+_0x4c031c;!fs[_0x38f11e(0xfb)](_0x2ec2ad)&&fs[_0x38f11e(0xdf)](_0x2ec2ad);const _0x5c01b9=path[_0x38f11e(0xd4)](_0x2ec2ad),_0x564398=listFolderStructure(_0x5c01b9);!fs[_0x38f11e(0xfb)](_0x2f3f2a)&&fs[_0x38f11e(0xdf)](_0x2f3f2a),dirs=[{'own':!![],'name':_0x38f11e(0xf9),'path':_0x2ec2ad,'isFolder':!![],'children':_0x564398},...listFolderStructure(_0x2f3f2a)],_0x5edc85[_0x38f11e(0xcd)](dirs);}else!fs['existsSync'](_0x2f3f2a)&&fs[_0x38f11e(0xdf)](_0x2f3f2a),_0x5edc85[_0x38f11e(0xcd)](listFolderStructure(_0x2f3f2a));}),module[a15_0x52f6fe(0xf8)]=router;