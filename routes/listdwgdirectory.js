const a15_0x5d2ff6=a15_0x40ad;(function(_0x4ec426,_0x2b0b0e){const _0x262a69=a15_0x40ad,_0x4c1695=_0x4ec426();while(!![]){try{const _0x202dc6=parseInt(_0x262a69(0x178))/0x1*(parseInt(_0x262a69(0x152))/0x2)+parseInt(_0x262a69(0x189))/0x3*(parseInt(_0x262a69(0x186))/0x4)+parseInt(_0x262a69(0x176))/0x5+parseInt(_0x262a69(0x175))/0x6*(-parseInt(_0x262a69(0x156))/0x7)+-parseInt(_0x262a69(0x154))/0x8+-parseInt(_0x262a69(0x16e))/0x9+parseInt(_0x262a69(0x160))/0xa*(-parseInt(_0x262a69(0x162))/0xb);if(_0x202dc6===_0x2b0b0e)break;else _0x4c1695['push'](_0x4c1695['shift']());}catch(_0x2de77c){_0x4c1695['push'](_0x4c1695['shift']());}}}(a15_0x2969,0xcbf8b));function a15_0x40ad(_0x1439b0,_0x2674cc){const _0x29696a=a15_0x2969();return a15_0x40ad=function(_0x40ad57,_0x754e75){_0x40ad57=_0x40ad57-0x14e;let _0x5847fa=_0x29696a[_0x40ad57];return _0x5847fa;},a15_0x40ad(_0x1439b0,_0x2674cc);}const fs=require('fs'),path=require(a15_0x5d2ff6(0x18b)),config=require(a15_0x5d2ff6(0x15d)),verifyTokenOptional=require(a15_0x5d2ff6(0x158))[a15_0x5d2ff6(0x14e)],show_folders=![],express=require(a15_0x5d2ff6(0x15c)),router=express[a15_0x5d2ff6(0x14f)](),conn=require(a15_0x5d2ff6(0x167)),{randomUUID}=require('crypto'),dir=a15_0x5d2ff6(0x151);!fs['existsSync'](dir)&&fs[a15_0x5d2ff6(0x173)](dir);function a15_0x2969(){const _0x1e14b3=['2477710hiFTVS','sort','55EAIGiL','exports','log','execute','join','../libs/mysql','in\x20listFolderStructure\x20folderLocation=','birthtime','admin','json','├──\x20','loginFeatureEnabled','494469gKDNFC','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','./uploads/','readFileSync','email','mkdirSync','readdirSync','7126446YKVDqX','7294910epplBB','false','6igJHLu','Error!\x20Something\x20went\x20wrong.','query','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','send','└──\x20','CADViewer_config.json','statSync','status','size','\x20show_folders:','main','resolve','user','634404KTNKCL','role','\x20\x20\x20','27XlQwII','cvjs_debug','path','filename','verifyTokenOptional','Router','utf8','./uploads','244346YOFXuK','promise','2419400FfyACK','existsSync','7sJYyNR','mtime','../libs/jwt','MY\x20FOLDER','push','folderLocation','express','../CADViewer_config.json','dirname','children'];a15_0x2969=function(){return _0x1e14b3;};return a15_0x2969();}const sortFoldersFirst=(_0x45a077,_0x151302)=>{const _0x578c5c=a15_0x5d2ff6;if(_0x45a077[_0x578c5c(0x15f)]&&!_0x151302['children'])return-0x1;else return!_0x45a077[_0x578c5c(0x15f)]&&_0x151302[_0x578c5c(0x15f)]?0x1:0x0;},listFolderStructure=(_0x3b2d05,_0x510661='')=>{const _0x53a5e7=a15_0x5d2ff6,_0x109165=fs[_0x53a5e7(0x174)](_0x3b2d05),_0x6d1a7e=[];return _0x109165['forEach'](_0x26cf5e=>{const _0x5666fc=_0x53a5e7,_0x45e782=path[_0x5666fc(0x166)](_0x3b2d05,_0x26cf5e),_0x3caae0=fs[_0x5666fc(0x17f)](_0x45e782);if(_0x3caae0['isDirectory']()){if(config[_0x5666fc(0x18a)]&&show_folders)console[_0x5666fc(0x164)](_0x510661+_0x5666fc(0x17d)+_0x26cf5e);const _0x55ae6c=listFolderStructure(_0x45e782,_0x510661+_0x5666fc(0x188));_0x6d1a7e[_0x5666fc(0x15a)]({'name':_0x26cf5e,'path':_0x45e782,'size':_0x3caae0[_0x5666fc(0x181)],'created':_0x3caae0[_0x5666fc(0x169)],'modified':_0x3caae0[_0x5666fc(0x157)],'isFolder':!![],'children':_0x55ae6c});}else{_0x6d1a7e[_0x5666fc(0x15a)]({'name':_0x26cf5e,'path':_0x45e782,'size':_0x3caae0['size'],'created':_0x3caae0[_0x5666fc(0x169)],'modified':_0x3caae0[_0x5666fc(0x157)],'isFolder':![]});if(config[_0x5666fc(0x18a)]&&show_folders)console[_0x5666fc(0x164)](_0x510661+_0x5666fc(0x16c)+_0x26cf5e);}}),_0x6d1a7e[_0x53a5e7(0x161)](sortFoldersFirst);};router['get']('',verifyTokenOptional,async(_0xd44698,_0x1722d7)=>{const _0x5e4915=a15_0x5d2ff6,_0x40deaf=path['join'](path[_0x5e4915(0x15e)](require[_0x5e4915(0x183)][_0x5e4915(0x18c)]),_0x5e4915(0x17e)),_0x1d449b=JSON['parse'](fs[_0x5e4915(0x171)](_0x40deaf,_0x5e4915(0x150))),_0x4aa136=_0xd44698[_0x5e4915(0x17a)][_0x5e4915(0x16d)];let _0x110217=_0x1d449b['folderLocationDemoUser'];_0x4aa136===_0x5e4915(0x177)&&(_0x110217=_0x1d449b[_0x5e4915(0x15b)]);console[_0x5e4915(0x164)](_0x5e4915(0x168)+_0x110217+_0x5e4915(0x182)+show_folders+'cvhs_debug:'+config[_0x5e4915(0x18a)]);if(_0xd44698[_0x5e4915(0x185)]){let _0x19c9ad;try{const [_0x39772e]=await conn[_0x5e4915(0x153)]()[_0x5e4915(0x165)](_0x5e4915(0x17b),[_0xd44698[_0x5e4915(0x185)][_0x5e4915(0x172)]]);_0x39772e['length']>0x0&&(_0x19c9ad=_0x39772e[0x0]);}catch(_0x411085){console[_0x5e4915(0x164)]({'err':_0x411085}),_0x1722d7[_0x5e4915(0x180)](0x1f4)[_0x5e4915(0x16b)]({'error':_0x5e4915(0x179)});return;}if(!_0x19c9ad){_0x1722d7[_0x5e4915(0x180)](0x191)[_0x5e4915(0x16b)]({'error':'Invalid\x20user'});return;}_0x19c9ad[_0x5e4915(0x187)]===_0x5e4915(0x16a)&&(_0x110217=_0x1d449b['folderLocation']);let _0x834c4a=_0x19c9ad['folder_name'];if(!_0x834c4a){_0x834c4a=randomUUID();try{await conn[_0x5e4915(0x153)]()['execute'](_0x5e4915(0x16f),[_0x834c4a,_0xd44698[_0x5e4915(0x185)][_0x5e4915(0x172)]]);}catch(_0x2c3ee7){console[_0x5e4915(0x164)]({'err':_0x2c3ee7}),_0x1722d7[_0x5e4915(0x180)](0x1f4)[_0x5e4915(0x16b)]({'error':_0x5e4915(0x179)});return;}}const _0x2b8172=_0x5e4915(0x170)+_0x834c4a;!fs[_0x5e4915(0x155)](_0x2b8172)&&fs['mkdirSync'](_0x2b8172);const _0x2e3450=path[_0x5e4915(0x184)](_0x2b8172),_0x14cbbc=listFolderStructure(_0x2e3450);!fs['existsSync'](_0x110217)&&fs[_0x5e4915(0x173)](_0x110217),dirs=[{'own':!![],'name':_0x5e4915(0x159),'path':_0x2b8172,'isFolder':!![],'children':_0x14cbbc},...listFolderStructure(_0x110217)],_0x1722d7[_0x5e4915(0x17c)](dirs);}else!fs['existsSync'](_0x110217)&&fs['mkdirSync'](_0x110217),_0x1722d7[_0x5e4915(0x17c)](listFolderStructure(_0x110217));}),module[a15_0x5d2ff6(0x163)]=router;