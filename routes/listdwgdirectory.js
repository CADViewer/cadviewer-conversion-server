function a15_0x1c67(_0x340195,_0x3540c2){const _0x29f1fd=a15_0x29f1();return a15_0x1c67=function(_0x1c6768,_0x1e3e59){_0x1c6768=_0x1c6768-0x91;let _0x3e1a46=_0x29f1fd[_0x1c6768];return _0x3e1a46;},a15_0x1c67(_0x340195,_0x3540c2);}const a15_0x28c48f=a15_0x1c67;(function(_0x2e41d7,_0x256bde){const _0x1e1723=a15_0x1c67,_0x5b836f=_0x2e41d7();while(!![]){try{const _0x21785c=parseInt(_0x1e1723(0xc7))/0x1*(-parseInt(_0x1e1723(0xa0))/0x2)+-parseInt(_0x1e1723(0x97))/0x3+-parseInt(_0x1e1723(0xc8))/0x4+parseInt(_0x1e1723(0x92))/0x5+parseInt(_0x1e1723(0xac))/0x6+-parseInt(_0x1e1723(0xba))/0x7*(parseInt(_0x1e1723(0xad))/0x8)+-parseInt(_0x1e1723(0xb2))/0x9*(-parseInt(_0x1e1723(0x9a))/0xa);if(_0x21785c===_0x256bde)break;else _0x5b836f['push'](_0x5b836f['shift']());}catch(_0x494636){_0x5b836f['push'](_0x5b836f['shift']());}}}(a15_0x29f1,0xf407e));const fs=require('fs'),path=require(a15_0x28c48f(0x9d)),config=require(a15_0x28c48f(0xae)),verifyTokenOptional=require('../libs/jwt')[a15_0x28c48f(0xc2)],show_folders=![],express=require(a15_0x28c48f(0xc0)),router=express[a15_0x28c48f(0xc9)](),conn=require('../libs/mysql'),{randomUUID}=require(a15_0x28c48f(0xbf)),dir='./uploads';function a15_0x29f1(){const _0x40252d=['2713848JUaRVV','Router','cvjs_debug','resolve','children','6556435GMAEiW','mtime','exports','folderLocation','\x20\x20\x20','4128387WOQSYG','Error!\x20Something\x20went\x20wrong.','log','20AISswz','parse','join','path','./uploads/','send','12EHEgbW','push','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','false','├──\x20','readFileSync','└──\x20','Invalid\x20user','json','isDirectory','user','5796948JmxKKp','4136pLHxoU','../CADViewer_config.json','admin','MY\x20FOLDER','size','18757593doWzOt','filename','execute','forEach','status','email','birthtime','role','22652tHhnAo','statSync','mkdirSync','in\x20listFolderStructure\x20folderLocation=','cvhs_debug:','crypto','express','length','verifyTokenOptional','get','existsSync','sort','promise','286441YBQOtG'];a15_0x29f1=function(){return _0x40252d;};return a15_0x29f1();}!fs['existsSync'](dir)&&fs[a15_0x28c48f(0xbc)](dir);const sortFoldersFirst=(_0xc3c563,_0x57e99f)=>{const _0x18db9f=a15_0x28c48f;if(_0xc3c563[_0x18db9f(0x91)]&&!_0x57e99f[_0x18db9f(0x91)])return-0x1;else return!_0xc3c563[_0x18db9f(0x91)]&&_0x57e99f[_0x18db9f(0x91)]?0x1:0x0;},listFolderStructure=(_0xdffcf7,_0x5a1f66='')=>{const _0x15f12d=a15_0x28c48f,_0x23fd76=fs['readdirSync'](_0xdffcf7),_0x5dd117=[];return _0x23fd76[_0x15f12d(0xb5)](_0x252a0e=>{const _0x3e13c1=_0x15f12d,_0x5387db=path[_0x3e13c1(0x9c)](_0xdffcf7,_0x252a0e),_0x4b9303=fs[_0x3e13c1(0xbb)](_0x5387db);if(_0x4b9303[_0x3e13c1(0xaa)]()){if(config[_0x3e13c1(0xca)]&&show_folders)console[_0x3e13c1(0x99)](_0x5a1f66+_0x3e13c1(0xa7)+_0x252a0e);const _0x2a4425=listFolderStructure(_0x5387db,_0x5a1f66+_0x3e13c1(0x96));_0x5dd117[_0x3e13c1(0xa1)]({'name':_0x252a0e,'path':_0x5387db,'size':_0x4b9303[_0x3e13c1(0xb1)],'created':_0x4b9303[_0x3e13c1(0xb8)],'modified':_0x4b9303[_0x3e13c1(0x93)],'isFolder':!![],'children':_0x2a4425});}else{_0x5dd117[_0x3e13c1(0xa1)]({'name':_0x252a0e,'path':_0x5387db,'size':_0x4b9303[_0x3e13c1(0xb1)],'created':_0x4b9303[_0x3e13c1(0xb8)],'modified':_0x4b9303['mtime'],'isFolder':![]});if(config[_0x3e13c1(0xca)]&&show_folders)console[_0x3e13c1(0x99)](_0x5a1f66+_0x3e13c1(0xa5)+_0x252a0e);}}),_0x5dd117[_0x15f12d(0xc5)](sortFoldersFirst);};router[a15_0x28c48f(0xc3)]('',verifyTokenOptional,async(_0xff630b,_0x44cb62)=>{const _0x4e6d32=a15_0x28c48f,_0x4ab623=path[_0x4e6d32(0x9c)](path['dirname'](require['main'][_0x4e6d32(0xb3)]),'CADViewer_config.json'),_0x3a719a=JSON[_0x4e6d32(0x9b)](fs[_0x4e6d32(0xa6)](_0x4ab623,'utf8')),_0x327567=_0xff630b['query']['loginFeatureEnabled'];let _0x12d702=_0x3a719a['folderLocationDemoUser'];_0x327567===_0x4e6d32(0xa4)&&(_0x12d702=_0x3a719a[_0x4e6d32(0x95)]);console[_0x4e6d32(0x99)](_0x4e6d32(0xbd)+_0x12d702+'\x20show_folders:'+show_folders+_0x4e6d32(0xbe)+config[_0x4e6d32(0xca)]);if(_0xff630b[_0x4e6d32(0xab)]){let _0x5985c6;try{const [_0x41ce9f]=await conn['promise']()[_0x4e6d32(0xb4)](_0x4e6d32(0xa3),[_0xff630b[_0x4e6d32(0xab)][_0x4e6d32(0xb7)]]);_0x41ce9f[_0x4e6d32(0xc1)]>0x0&&(_0x5985c6=_0x41ce9f[0x0]);}catch(_0x43b807){console[_0x4e6d32(0x99)]({'err':_0x43b807}),_0x44cb62[_0x4e6d32(0xb6)](0x1f4)[_0x4e6d32(0xa9)]({'error':_0x4e6d32(0x98)});return;}if(!_0x5985c6){_0x44cb62[_0x4e6d32(0xb6)](0x191)[_0x4e6d32(0xa9)]({'error':_0x4e6d32(0xa8)});return;}_0x5985c6[_0x4e6d32(0xb9)]===_0x4e6d32(0xaf)&&(_0x12d702=_0x3a719a[_0x4e6d32(0x95)]);let _0x38b1f5=_0x5985c6['folder_name'];if(!_0x38b1f5){_0x38b1f5=randomUUID();try{await conn[_0x4e6d32(0xc6)]()[_0x4e6d32(0xb4)](_0x4e6d32(0xa2),[_0x38b1f5,_0xff630b['user']['email']]);}catch(_0x486951){console[_0x4e6d32(0x99)]({'err':_0x486951}),_0x44cb62['status'](0x1f4)[_0x4e6d32(0xa9)]({'error':_0x4e6d32(0x98)});return;}}const _0x15bb6a=_0x4e6d32(0x9e)+_0x38b1f5;!fs[_0x4e6d32(0xc4)](_0x15bb6a)&&fs[_0x4e6d32(0xbc)](_0x15bb6a);const _0xe6fb10=path[_0x4e6d32(0xcb)](_0x15bb6a),_0x498d8e=listFolderStructure(_0xe6fb10);!fs[_0x4e6d32(0xc4)](_0x12d702)&&fs[_0x4e6d32(0xbc)](_0x12d702),dirs=[{'own':!![],'name':_0x4e6d32(0xb0),'path':_0x15bb6a,'isFolder':!![],'children':_0x498d8e},...listFolderStructure(_0x12d702)],_0x44cb62[_0x4e6d32(0x9f)](dirs);}else!fs[_0x4e6d32(0xc4)](_0x12d702)&&fs[_0x4e6d32(0xbc)](_0x12d702),_0x44cb62['send'](listFolderStructure(_0x12d702));}),module[a15_0x28c48f(0x94)]=router;