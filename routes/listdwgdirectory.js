const a16_0x4dea9c=a16_0x3d14;function a16_0x3d14(_0x1316f6,_0x469faf){const _0x52d743=a16_0x52d7();return a16_0x3d14=function(_0x3d146b,_0x5c6eb1){_0x3d146b=_0x3d146b-0xdb;let _0x4b7550=_0x52d743[_0x3d146b];return _0x4b7550;},a16_0x3d14(_0x1316f6,_0x469faf);}(function(_0x208344,_0x468ffa){const _0x328026=a16_0x3d14,_0x1a14ba=_0x208344();while(!![]){try{const _0x1baffe=parseInt(_0x328026(0xe4))/0x1*(-parseInt(_0x328026(0x10a))/0x2)+parseInt(_0x328026(0xed))/0x3+parseInt(_0x328026(0x105))/0x4*(-parseInt(_0x328026(0x107))/0x5)+parseInt(_0x328026(0x112))/0x6*(parseInt(_0x328026(0xf6))/0x7)+parseInt(_0x328026(0x108))/0x8+parseInt(_0x328026(0x102))/0x9*(-parseInt(_0x328026(0xe7))/0xa)+parseInt(_0x328026(0xff))/0xb;if(_0x1baffe===_0x468ffa)break;else _0x1a14ba['push'](_0x1a14ba['shift']());}catch(_0xe025aa){_0x1a14ba['push'](_0x1a14ba['shift']());}}}(a16_0x52d7,0xf2497));const fs=require('fs'),path=require('path'),config=require(a16_0x4dea9c(0x10d)),verifyTokenOptional=require('../libs/jwt')[a16_0x4dea9c(0x106)],show_folders=![],express=require('express'),router=express['Router'](),conn=require(a16_0x4dea9c(0xdb)),{randomUUID}=require(a16_0x4dea9c(0x10b)),dir=a16_0x4dea9c(0x101);!fs['existsSync'](dir)&&fs[a16_0x4dea9c(0xec)](dir);const sortFoldersFirst=(_0x4927e7,_0x1b107e)=>{const _0x5b9f06=a16_0x4dea9c;if(_0x4927e7[_0x5b9f06(0x10e)]&&!_0x1b107e['children'])return-0x1;else return!_0x4927e7[_0x5b9f06(0x10e)]&&_0x1b107e[_0x5b9f06(0x10e)]?0x1:0x0;},listFolderStructure=(_0x444743,_0x4755d8='')=>{const _0x416ae6=a16_0x4dea9c,_0x13290a=fs[_0x416ae6(0xfd)](_0x444743),_0x6cb046=[];return _0x13290a['forEach'](_0x5276da=>{const _0x557ea1=_0x416ae6,_0xe23a00=path[_0x557ea1(0xe6)](_0x444743,_0x5276da),_0xa2e647=fs['statSync'](_0xe23a00);if(_0xa2e647[_0x557ea1(0xdf)]()){if(config[_0x557ea1(0xf5)]&&show_folders)console[_0x557ea1(0xf9)](_0x4755d8+_0x557ea1(0xe0)+_0x5276da);const _0x512295=listFolderStructure(_0xe23a00,_0x4755d8+_0x557ea1(0xfe));_0x6cb046[_0x557ea1(0xf8)]({'name':_0x5276da,'path':_0xe23a00,'size':_0xa2e647[_0x557ea1(0xf3)],'created':_0xa2e647[_0x557ea1(0x111)],'modified':_0xa2e647[_0x557ea1(0xe3)],'isFolder':!![],'children':_0x512295});}else{_0x6cb046['push']({'name':_0x5276da,'path':_0xe23a00,'size':_0xa2e647[_0x557ea1(0xf3)],'created':_0xa2e647[_0x557ea1(0x111)],'modified':_0xa2e647[_0x557ea1(0xe3)],'isFolder':![]});if(config[_0x557ea1(0xf5)]&&show_folders)console[_0x557ea1(0xf9)](_0x4755d8+_0x557ea1(0x10f)+_0x5276da);}}),_0x6cb046['sort'](sortFoldersFirst);};function a16_0x52d7(){const _0x37ff38=['filename','exports','get','mkdirSync','3372294kBQAgw','cvhs_debug:','./uploads/','false','parse','json','size','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','cvjs_debug','5906075QSJBuw','promise','push','log','folderLocation','query','loginFeatureEnabled','readdirSync','\x20\x20\x20','27876222zBgskV','folder_name','./uploads','74268KrIhYu','CADViewer_config.json','Error!\x20Something\x20went\x20wrong.','12qqhWxC','verifyTokenOptional','2936785BECleh','2386096EOtnWY','role','986kiRCpC','crypto','admin','../CADViewer_config.json','children','├──\x20','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','birthtime','6xpmvOI','status','MY\x20FOLDER','../libs/mysql','\x20show_folders:','user','send','isDirectory','└──\x20','email','existsSync','mtime','869ENgBAP','readFileSync','join','1960wIWhJJ','execute'];a16_0x52d7=function(){return _0x37ff38;};return a16_0x52d7();}router[a16_0x4dea9c(0xeb)]('',verifyTokenOptional,async(_0xdfc5f3,_0x32ee07)=>{const _0x4326cc=a16_0x4dea9c,_0x2a4f0f=path['join'](path['dirname'](require['main'][_0x4326cc(0xe9)]),_0x4326cc(0x103)),_0x495a30=JSON[_0x4326cc(0xf1)](fs[_0x4326cc(0xe5)](_0x2a4f0f,'utf8')),_0x24f669=_0xdfc5f3[_0x4326cc(0xfb)][_0x4326cc(0xfc)];let _0x209a63=_0x495a30['folderLocationDemoUser'];_0x24f669===_0x4326cc(0xf0)&&(_0x209a63=_0x495a30[_0x4326cc(0xfa)]);console[_0x4326cc(0xf9)]('in\x20listFolderStructure\x20folderLocation='+_0x209a63+_0x4326cc(0xdc)+show_folders+_0x4326cc(0xee)+config[_0x4326cc(0xf5)]);if(_0xdfc5f3[_0x4326cc(0xdd)]){let _0x33b0b8;try{const [_0x6590f0]=await conn['promise']()[_0x4326cc(0xe8)](_0x4326cc(0xf4),[_0xdfc5f3['user'][_0x4326cc(0xe1)]]);_0x6590f0['length']>0x0&&(_0x33b0b8=_0x6590f0[0x0]);}catch(_0x2d9e94){console[_0x4326cc(0xf9)]({'err':_0x2d9e94}),_0x32ee07[_0x4326cc(0x113)](0x1f4)['json']({'error':_0x4326cc(0x104)});return;}if(!_0x33b0b8){_0x32ee07['status'](0x191)['json']({'error':'Invalid\x20user'});return;}_0x33b0b8[_0x4326cc(0x109)]===_0x4326cc(0x10c)&&(_0x209a63=_0x495a30['folderLocation']);let _0x132a4b=_0x33b0b8[_0x4326cc(0x100)];if(!_0x132a4b){_0x132a4b=randomUUID();try{await conn[_0x4326cc(0xf7)]()[_0x4326cc(0xe8)](_0x4326cc(0x110),[_0x132a4b,_0xdfc5f3[_0x4326cc(0xdd)]['email']]);}catch(_0x56c956){console[_0x4326cc(0xf9)]({'err':_0x56c956}),_0x32ee07[_0x4326cc(0x113)](0x1f4)[_0x4326cc(0xf2)]({'error':_0x4326cc(0x104)});return;}}const _0x5df720=_0x4326cc(0xef)+_0x132a4b;!fs[_0x4326cc(0xe2)](_0x5df720)&&fs[_0x4326cc(0xec)](_0x5df720);const _0x5094f3=path['resolve'](_0x5df720),_0x3c9082=listFolderStructure(_0x5094f3);!fs['existsSync'](_0x209a63)&&fs['mkdirSync'](_0x209a63),dirs=[{'own':!![],'name':_0x4326cc(0x114),'path':_0x5df720,'isFolder':!![],'children':_0x3c9082},...listFolderStructure(_0x209a63)],_0x32ee07[_0x4326cc(0xde)](dirs);}else!fs[_0x4326cc(0xe2)](_0x209a63)&&fs[_0x4326cc(0xec)](_0x209a63),_0x32ee07[_0x4326cc(0xde)](listFolderStructure(_0x209a63));}),module[a16_0x4dea9c(0xea)]=router;