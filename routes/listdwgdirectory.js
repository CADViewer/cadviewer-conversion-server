function a15_0xfc80(){const _0x3db1d8=['loginFeatureEnabled','query','./uploads','existsSync','\x20\x20\x20','Invalid\x20user','sort','execute','72cHVVKr','in\x20listFolderStructure\x20folderLocation=','Router','json','readdirSync','promise','39013931HybZdv','log','get','114872KOsiFZ','4281765EewEUo','28QBfAeh','false','resolve','utf8','filename','mtime','crypto','express','status','./uploads/','size','role','main','3877sXDTUZ','children','birthtime','email','cvhs_debug:','896736mCQUYG','3666876uMjreG','folder_name','send','folderLocationDemoUser','mkdirSync','cvjs_debug','└──\x20','parse','verifyTokenOptional','readFileSync','../CADViewer_config.json','\x20show_folders:','statSync','folderLocation','3663OKieGo','Error!\x20Something\x20went\x20wrong.','push','user','CADViewer_config.json','10duaNgx','1992EhGGId','dirname'];a15_0xfc80=function(){return _0x3db1d8;};return a15_0xfc80();}const a15_0x466b57=a15_0x36ec;(function(_0x388850,_0x247762){const _0x166cdb=a15_0x36ec,_0x172d30=_0x388850();while(!![]){try{const _0x88fd48=parseInt(_0x166cdb(0x166))/0x1*(-parseInt(_0x166cdb(0x14e))/0x2)+-parseInt(_0x166cdb(0x16c))/0x3+-parseInt(_0x166cdb(0x157))/0x4+-parseInt(_0x166cdb(0x158))/0x5+parseInt(_0x166cdb(0x16b))/0x6*(-parseInt(_0x166cdb(0x159))/0x7)+-parseInt(_0x166cdb(0x144))/0x8*(-parseInt(_0x166cdb(0x13e))/0x9)+-parseInt(_0x166cdb(0x143))/0xa*(-parseInt(_0x166cdb(0x154))/0xb);if(_0x88fd48===_0x247762)break;else _0x172d30['push'](_0x172d30['shift']());}catch(_0xe71cd6){_0x172d30['push'](_0x172d30['shift']());}}}(a15_0xfc80,0xc41e9));const fs=require('fs'),path=require('path'),config=require(a15_0x466b57(0x13a)),verifyTokenOptional=require('../libs/jwt')[a15_0x466b57(0x138)],show_folders=![],express=require(a15_0x466b57(0x160)),router=express[a15_0x466b57(0x150)](),conn=require('../libs/mysql'),{randomUUID}=require(a15_0x466b57(0x15f)),dir=a15_0x466b57(0x148);function a15_0x36ec(_0x257ec3,_0x577c17){const _0xfc807c=a15_0xfc80();return a15_0x36ec=function(_0x36ec0b,_0x256a2b){_0x36ec0b=_0x36ec0b-0x131;let _0x2abee4=_0xfc807c[_0x36ec0b];return _0x2abee4;},a15_0x36ec(_0x257ec3,_0x577c17);}!fs[a15_0x466b57(0x149)](dir)&&fs[a15_0x466b57(0x134)](dir);const sortFoldersFirst=(_0x1056d4,_0x14d27f)=>{const _0x3e9ab8=a15_0x466b57;if(_0x1056d4[_0x3e9ab8(0x167)]&&!_0x14d27f[_0x3e9ab8(0x167)])return-0x1;else return!_0x1056d4[_0x3e9ab8(0x167)]&&_0x14d27f[_0x3e9ab8(0x167)]?0x1:0x0;},listFolderStructure=(_0x3d8794,_0x1e35b1='')=>{const _0x1c5dd6=a15_0x466b57,_0xc2d97b=fs[_0x1c5dd6(0x152)](_0x3d8794),_0x42a76b=[];return _0xc2d97b['forEach'](_0x59ea63=>{const _0x5d1680=_0x1c5dd6,_0x8331bf=path['join'](_0x3d8794,_0x59ea63),_0x5b5e8c=fs[_0x5d1680(0x13c)](_0x8331bf);if(_0x5b5e8c['isDirectory']()){if(config['cvjs_debug']&&show_folders)console[_0x5d1680(0x155)](_0x1e35b1+_0x5d1680(0x136)+_0x59ea63);const _0x355a1b=listFolderStructure(_0x8331bf,_0x1e35b1+_0x5d1680(0x14a));_0x42a76b['push']({'name':_0x59ea63,'path':_0x8331bf,'size':_0x5b5e8c[_0x5d1680(0x163)],'created':_0x5b5e8c[_0x5d1680(0x168)],'modified':_0x5b5e8c[_0x5d1680(0x15e)],'isFolder':!![],'children':_0x355a1b});}else{_0x42a76b[_0x5d1680(0x140)]({'name':_0x59ea63,'path':_0x8331bf,'size':_0x5b5e8c[_0x5d1680(0x163)],'created':_0x5b5e8c[_0x5d1680(0x168)],'modified':_0x5b5e8c['mtime'],'isFolder':![]});if(config[_0x5d1680(0x135)]&&show_folders)console[_0x5d1680(0x155)](_0x1e35b1+'├──\x20'+_0x59ea63);}}),_0x42a76b[_0x1c5dd6(0x14c)](sortFoldersFirst);};router[a15_0x466b57(0x156)]('',verifyTokenOptional,async(_0x1c31b5,_0x2e1062)=>{const _0x313b4b=a15_0x466b57,_0x3c0ca3=path['join'](path[_0x313b4b(0x145)](require[_0x313b4b(0x165)][_0x313b4b(0x15d)]),_0x313b4b(0x142)),_0x3f4457=JSON[_0x313b4b(0x137)](fs[_0x313b4b(0x139)](_0x3c0ca3,_0x313b4b(0x15c))),_0x248420=_0x1c31b5[_0x313b4b(0x147)][_0x313b4b(0x146)];let _0x1d6c30=_0x3f4457[_0x313b4b(0x133)];_0x248420===_0x313b4b(0x15a)&&(_0x1d6c30=_0x3f4457[_0x313b4b(0x13d)]);console[_0x313b4b(0x155)](_0x313b4b(0x14f)+_0x1d6c30+_0x313b4b(0x13b)+show_folders+_0x313b4b(0x16a)+config[_0x313b4b(0x135)]);if(_0x1c31b5['user']){let _0x10ca34;try{const [_0x187d73]=await conn[_0x313b4b(0x153)]()[_0x313b4b(0x14d)]('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x1c31b5[_0x313b4b(0x141)]['email']]);_0x187d73['length']>0x0&&(_0x10ca34=_0x187d73[0x0]);}catch(_0x5d9a64){console['log']({'err':_0x5d9a64}),_0x2e1062[_0x313b4b(0x161)](0x1f4)[_0x313b4b(0x151)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x10ca34){_0x2e1062['status'](0x191)[_0x313b4b(0x151)]({'error':_0x313b4b(0x14b)});return;}_0x10ca34[_0x313b4b(0x164)]==='admin'&&(_0x1d6c30=_0x3f4457[_0x313b4b(0x13d)]);let _0x5d5f18=_0x10ca34[_0x313b4b(0x131)];if(!_0x5d5f18){_0x5d5f18=randomUUID();try{await conn[_0x313b4b(0x153)]()['execute']('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x5d5f18,_0x1c31b5[_0x313b4b(0x141)][_0x313b4b(0x169)]]);}catch(_0x2aa603){console[_0x313b4b(0x155)]({'err':_0x2aa603}),_0x2e1062['status'](0x1f4)['json']({'error':_0x313b4b(0x13f)});return;}}const _0x3165a4=_0x313b4b(0x162)+_0x5d5f18;!fs[_0x313b4b(0x149)](_0x3165a4)&&fs[_0x313b4b(0x134)](_0x3165a4);const _0x490128=path[_0x313b4b(0x15b)](_0x3165a4),_0x135c08=listFolderStructure(_0x490128);!fs[_0x313b4b(0x149)](_0x1d6c30)&&fs[_0x313b4b(0x134)](_0x1d6c30),dirs=[{'own':!![],'name':'MY\x20FOLDER','path':_0x3165a4,'isFolder':!![],'children':_0x135c08},...listFolderStructure(_0x1d6c30)],_0x2e1062[_0x313b4b(0x132)](dirs);}else!fs[_0x313b4b(0x149)](_0x1d6c30)&&fs[_0x313b4b(0x134)](_0x1d6c30),_0x2e1062[_0x313b4b(0x132)](listFolderStructure(_0x1d6c30));}),module['exports']=router;