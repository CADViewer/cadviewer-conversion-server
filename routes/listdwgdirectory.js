const a15_0x455084=a15_0x2e91;function a15_0x3fe8(){const _0x129df5=['log','2oJDuOY','execute','cvhs_debug:','path','role','readdirSync','./uploads/','2047384ZPvUCN','join','882874NRtxbP','promise','loginFeatureEnabled','filename','../libs/mysql','user','├──\x20','admin','readFileSync','./uploads','forEach','sort','dirname','MY\x20FOLDER','express','Error!\x20Something\x20went\x20wrong.','2775762mnwwJr','parse','get','query','../CADViewer_config.json','resolve','size','mkdirSync','2406159nnyFXe','statSync','existsSync','birthtime','CADViewer_config.json','false','main','6182071dSaUvb','children','Router','push','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','1084UJsJqY','folderLocation','11787qpfswu','json','Invalid\x20user','2304165ePPvni','mtime','email','folder_name','../libs/jwt','cvjs_debug','send','status'];a15_0x3fe8=function(){return _0x129df5;};return a15_0x3fe8();}(function(_0x2320a7,_0x13b5c0){const _0x45cc8f=a15_0x2e91,_0xe51739=_0x2320a7();while(!![]){try{const _0x29aef1=-parseInt(_0x45cc8f(0x1e9))/0x1*(-parseInt(_0x45cc8f(0x1e0))/0x2)+parseInt(_0x45cc8f(0x1d4))/0x3*(-parseInt(_0x45cc8f(0x1d2))/0x4)+parseInt(_0x45cc8f(0x1d7))/0x5+-parseInt(_0x45cc8f(0x1f9))/0x6+parseInt(_0x45cc8f(0x1cd))/0x7+parseInt(_0x45cc8f(0x1e7))/0x8+-parseInt(_0x45cc8f(0x1c6))/0x9;if(_0x29aef1===_0x13b5c0)break;else _0xe51739['push'](_0xe51739['shift']());}catch(_0x195a44){_0xe51739['push'](_0xe51739['shift']());}}}(a15_0x3fe8,0xa7fae));const fs=require('fs'),path=require(a15_0x455084(0x1e3)),config=require(a15_0x455084(0x1c2)),verifyTokenOptional=require(a15_0x455084(0x1db))['verifyTokenOptional'],show_folders=![],express=require(a15_0x455084(0x1f7)),router=express[a15_0x455084(0x1cf)](),conn=require(a15_0x455084(0x1ed)),{randomUUID}=require('crypto'),dir=a15_0x455084(0x1f2);function a15_0x2e91(_0x23bb86,_0x739218){const _0x3fe81d=a15_0x3fe8();return a15_0x2e91=function(_0x2e9122,_0x2da01d){_0x2e9122=_0x2e9122-0x1c1;let _0x4491e7=_0x3fe81d[_0x2e9122];return _0x4491e7;},a15_0x2e91(_0x23bb86,_0x739218);}!fs[a15_0x455084(0x1c8)](dir)&&fs['mkdirSync'](dir);const sortFoldersFirst=(_0x4997c8,_0x28a0ca)=>{const _0x4c7a0e=a15_0x455084;if(_0x4997c8[_0x4c7a0e(0x1ce)]&&!_0x28a0ca[_0x4c7a0e(0x1ce)])return-0x1;else return!_0x4997c8[_0x4c7a0e(0x1ce)]&&_0x28a0ca[_0x4c7a0e(0x1ce)]?0x1:0x0;},listFolderStructure=(_0x950aa1,_0x1fb4db='')=>{const _0x698a53=a15_0x455084,_0x2e13f2=fs[_0x698a53(0x1e5)](_0x950aa1),_0x4d7d85=[];return _0x2e13f2[_0x698a53(0x1f3)](_0x158b92=>{const _0x5eb44c=_0x698a53,_0x15b642=path[_0x5eb44c(0x1e8)](_0x950aa1,_0x158b92),_0x1dd464=fs[_0x5eb44c(0x1c7)](_0x15b642);if(_0x1dd464['isDirectory']()){if(config['cvjs_debug']&&show_folders)console['log'](_0x1fb4db+'└──\x20'+_0x158b92);const _0x3f4aa9=listFolderStructure(_0x15b642,_0x1fb4db+'\x20\x20\x20');_0x4d7d85[_0x5eb44c(0x1d0)]({'name':_0x158b92,'path':_0x15b642,'size':_0x1dd464[_0x5eb44c(0x1c4)],'created':_0x1dd464[_0x5eb44c(0x1c9)],'modified':_0x1dd464[_0x5eb44c(0x1d8)],'isFolder':!![],'children':_0x3f4aa9});}else{_0x4d7d85[_0x5eb44c(0x1d0)]({'name':_0x158b92,'path':_0x15b642,'size':_0x1dd464[_0x5eb44c(0x1c4)],'created':_0x1dd464[_0x5eb44c(0x1c9)],'modified':_0x1dd464[_0x5eb44c(0x1d8)],'isFolder':![]});if(config['cvjs_debug']&&show_folders)console[_0x5eb44c(0x1df)](_0x1fb4db+_0x5eb44c(0x1ef)+_0x158b92);}}),_0x4d7d85[_0x698a53(0x1f4)](sortFoldersFirst);};router[a15_0x455084(0x1fb)]('',verifyTokenOptional,async(_0x79cae7,_0x33df95)=>{const _0x19ccfc=a15_0x455084,_0x38d788=path[_0x19ccfc(0x1e8)](path[_0x19ccfc(0x1f5)](require[_0x19ccfc(0x1cc)][_0x19ccfc(0x1ec)]),_0x19ccfc(0x1ca)),_0x382af1=JSON[_0x19ccfc(0x1fa)](fs[_0x19ccfc(0x1f1)](_0x38d788,'utf8')),_0x36ddf0=_0x79cae7[_0x19ccfc(0x1c1)][_0x19ccfc(0x1eb)];let _0x3dda67=_0x382af1['folderLocationDemoUser'];_0x36ddf0===_0x19ccfc(0x1cb)&&(_0x3dda67=_0x382af1[_0x19ccfc(0x1d3)]);console[_0x19ccfc(0x1df)]('in\x20listFolderStructure\x20folderLocation='+_0x3dda67+'\x20show_folders:'+show_folders+_0x19ccfc(0x1e2)+config[_0x19ccfc(0x1dc)]);if(_0x79cae7[_0x19ccfc(0x1ee)]){let _0x23cf2f;try{const [_0x361e3b]=await conn['promise']()[_0x19ccfc(0x1e1)]('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x79cae7[_0x19ccfc(0x1ee)]['email']]);_0x361e3b['length']>0x0&&(_0x23cf2f=_0x361e3b[0x0]);}catch(_0x3802de){console[_0x19ccfc(0x1df)]({'err':_0x3802de}),_0x33df95[_0x19ccfc(0x1de)](0x1f4)[_0x19ccfc(0x1d5)]({'error':_0x19ccfc(0x1f8)});return;}if(!_0x23cf2f){_0x33df95[_0x19ccfc(0x1de)](0x191)['json']({'error':_0x19ccfc(0x1d6)});return;}_0x23cf2f[_0x19ccfc(0x1e4)]===_0x19ccfc(0x1f0)&&(_0x3dda67=_0x382af1[_0x19ccfc(0x1d3)]);let _0x52c21c=_0x23cf2f[_0x19ccfc(0x1da)];if(!_0x52c21c){_0x52c21c=randomUUID();try{await conn[_0x19ccfc(0x1ea)]()[_0x19ccfc(0x1e1)](_0x19ccfc(0x1d1),[_0x52c21c,_0x79cae7['user'][_0x19ccfc(0x1d9)]]);}catch(_0x55e888){console[_0x19ccfc(0x1df)]({'err':_0x55e888}),_0x33df95[_0x19ccfc(0x1de)](0x1f4)[_0x19ccfc(0x1d5)]({'error':_0x19ccfc(0x1f8)});return;}}const _0x5d5612=_0x19ccfc(0x1e6)+_0x52c21c;!fs[_0x19ccfc(0x1c8)](_0x5d5612)&&fs['mkdirSync'](_0x5d5612);const _0x1c6ffe=path[_0x19ccfc(0x1c3)](_0x5d5612),_0x58b1f4=listFolderStructure(_0x1c6ffe);!fs[_0x19ccfc(0x1c8)](_0x3dda67)&&fs[_0x19ccfc(0x1c5)](_0x3dda67),dirs=[{'own':!![],'name':_0x19ccfc(0x1f6),'path':_0x5d5612,'isFolder':!![],'children':_0x58b1f4},...listFolderStructure(_0x3dda67)],_0x33df95[_0x19ccfc(0x1dd)](dirs);}else!fs[_0x19ccfc(0x1c8)](_0x3dda67)&&fs['mkdirSync'](_0x3dda67),_0x33df95[_0x19ccfc(0x1dd)](listFolderStructure(_0x3dda67));}),module['exports']=router;