const a15_0x4cd9a4=a15_0x58b9;(function(_0x471877,_0x4edad6){const _0x1796e6=a15_0x58b9,_0x48f829=_0x471877();while(!![]){try{const _0x13c1da=parseInt(_0x1796e6(0x1bf))/0x1*(parseInt(_0x1796e6(0x19c))/0x2)+parseInt(_0x1796e6(0x1a1))/0x3+-parseInt(_0x1796e6(0x1cd))/0x4*(parseInt(_0x1796e6(0x1b4))/0x5)+-parseInt(_0x1796e6(0x1c0))/0x6*(-parseInt(_0x1796e6(0x1a7))/0x7)+parseInt(_0x1796e6(0x1c3))/0x8+parseInt(_0x1796e6(0x1b2))/0x9*(parseInt(_0x1796e6(0x1aa))/0xa)+parseInt(_0x1796e6(0x1c7))/0xb*(-parseInt(_0x1796e6(0x1a5))/0xc);if(_0x13c1da===_0x4edad6)break;else _0x48f829['push'](_0x48f829['shift']());}catch(_0x202920){_0x48f829['push'](_0x48f829['shift']());}}}(a15_0x60c9,0x72b35));const fs=require('fs'),path=require(a15_0x4cd9a4(0x1bc)),config=require('../CADViewer_config.json'),verifyTokenOptional=require(a15_0x4cd9a4(0x1d0))[a15_0x4cd9a4(0x1c6)],show_folders=![],express=require(a15_0x4cd9a4(0x1ab)),router=express['Router'](),conn=require(a15_0x4cd9a4(0x19a)),{randomUUID}=require('crypto'),dir=a15_0x4cd9a4(0x1b0);!fs[a15_0x4cd9a4(0x1d1)](dir)&&fs[a15_0x4cd9a4(0x1a3)](dir);function a15_0x60c9(){const _0x1ddd33=['cvhs_debug:','user','cvjs_debug','sort','filename','admin','birthtime','path','folder_name','readFileSync','367qWwXyv','4185882ITfhKl','join','json','4229408cKmFBo','get','\x20\x20\x20','verifyTokenOptional','494219mfeVYq','email','folderLocationDemoUser','Error!\x20Something\x20went\x20wrong.','promise','children','1488012pTfoDU','role','status','../libs/jwt','existsSync','../libs/mysql','send','4022AhIFVM','size','resolve','length','push','451968HMXSRN','└──\x20','mkdirSync','mtime','252BTOqvz','execute','7BbeUsf','dirname','Invalid\x20user','3280vzGWjk','express','./uploads/','loginFeatureEnabled','log','parse','./uploads','isDirectory','1161tCcHBI','\x20show_folders:','10upCKof'];a15_0x60c9=function(){return _0x1ddd33;};return a15_0x60c9();}function a15_0x58b9(_0x13acc8,_0x16dc93){const _0x60c9b0=a15_0x60c9();return a15_0x58b9=function(_0x58b90d,_0x1cdbb3){_0x58b90d=_0x58b90d-0x19a;let _0x236d64=_0x60c9b0[_0x58b90d];return _0x236d64;},a15_0x58b9(_0x13acc8,_0x16dc93);}const sortFoldersFirst=(_0x2b2147,_0xeb9b7)=>{const _0x3acbcb=a15_0x4cd9a4;if(_0x2b2147[_0x3acbcb(0x1cc)]&&!_0xeb9b7[_0x3acbcb(0x1cc)])return-0x1;else return!_0x2b2147[_0x3acbcb(0x1cc)]&&_0xeb9b7[_0x3acbcb(0x1cc)]?0x1:0x0;},listFolderStructure=(_0x2446d8,_0x515b15='')=>{const _0x48355b=a15_0x4cd9a4,_0x136b62=fs['readdirSync'](_0x2446d8),_0x5816f1=[];return _0x136b62['forEach'](_0x5a28ed=>{const _0x347b32=a15_0x58b9,_0x5536bf=path[_0x347b32(0x1c1)](_0x2446d8,_0x5a28ed),_0x145da4=fs['statSync'](_0x5536bf);if(_0x145da4[_0x347b32(0x1b1)]()){if(config[_0x347b32(0x1b7)]&&show_folders)console[_0x347b32(0x1ae)](_0x515b15+_0x347b32(0x1a2)+_0x5a28ed);const _0x2cc4c2=listFolderStructure(_0x5536bf,_0x515b15+_0x347b32(0x1c5));_0x5816f1[_0x347b32(0x1a0)]({'name':_0x5a28ed,'path':_0x5536bf,'size':_0x145da4['size'],'created':_0x145da4[_0x347b32(0x1bb)],'modified':_0x145da4['mtime'],'isFolder':!![],'children':_0x2cc4c2});}else{_0x5816f1[_0x347b32(0x1a0)]({'name':_0x5a28ed,'path':_0x5536bf,'size':_0x145da4[_0x347b32(0x19d)],'created':_0x145da4[_0x347b32(0x1bb)],'modified':_0x145da4[_0x347b32(0x1a4)],'isFolder':![]});if(config[_0x347b32(0x1b7)]&&show_folders)console[_0x347b32(0x1ae)](_0x515b15+'├──\x20'+_0x5a28ed);}}),_0x5816f1[_0x48355b(0x1b8)](sortFoldersFirst);};router[a15_0x4cd9a4(0x1c4)]('',verifyTokenOptional,async(_0x4397d5,_0x2a4d33)=>{const _0x332e48=a15_0x4cd9a4,_0x5159f1=path[_0x332e48(0x1c1)](path[_0x332e48(0x1a8)](require['main'][_0x332e48(0x1b9)]),'CADViewer_config.json'),_0x11dde6=JSON[_0x332e48(0x1af)](fs[_0x332e48(0x1be)](_0x5159f1,'utf8')),_0x4b13d9=_0x4397d5['query'][_0x332e48(0x1ad)];let _0x54f7c3=_0x11dde6[_0x332e48(0x1c9)];_0x4b13d9==='false'&&(_0x54f7c3=_0x11dde6['folderLocation']);console[_0x332e48(0x1ae)]('in\x20listFolderStructure\x20folderLocation='+_0x54f7c3+_0x332e48(0x1b3)+show_folders+_0x332e48(0x1b5)+config['cvjs_debug']);if(_0x4397d5['user']){let _0x545803;try{const [_0x4107e6]=await conn[_0x332e48(0x1cb)]()['execute']('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x4397d5[_0x332e48(0x1b6)][_0x332e48(0x1c8)]]);_0x4107e6[_0x332e48(0x19f)]>0x0&&(_0x545803=_0x4107e6[0x0]);}catch(_0x4c523d){console[_0x332e48(0x1ae)]({'err':_0x4c523d}),_0x2a4d33[_0x332e48(0x1cf)](0x1f4)[_0x332e48(0x1c2)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x545803){_0x2a4d33[_0x332e48(0x1cf)](0x191)[_0x332e48(0x1c2)]({'error':_0x332e48(0x1a9)});return;}_0x545803[_0x332e48(0x1ce)]===_0x332e48(0x1ba)&&(_0x54f7c3=_0x11dde6['folderLocation']);let _0x3e4ba8=_0x545803[_0x332e48(0x1bd)];if(!_0x3e4ba8){_0x3e4ba8=randomUUID();try{await conn[_0x332e48(0x1cb)]()[_0x332e48(0x1a6)]('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x3e4ba8,_0x4397d5[_0x332e48(0x1b6)][_0x332e48(0x1c8)]]);}catch(_0xa7857b){console[_0x332e48(0x1ae)]({'err':_0xa7857b}),_0x2a4d33[_0x332e48(0x1cf)](0x1f4)['json']({'error':_0x332e48(0x1ca)});return;}}const _0x50923b=_0x332e48(0x1ac)+_0x3e4ba8;!fs['existsSync'](_0x50923b)&&fs[_0x332e48(0x1a3)](_0x50923b);const _0x384d08=path[_0x332e48(0x19e)](_0x50923b),_0x1dbcbd=listFolderStructure(_0x384d08);!fs[_0x332e48(0x1d1)](_0x54f7c3)&&fs[_0x332e48(0x1a3)](_0x54f7c3),dirs=[{'own':!![],'name':'MY\x20FOLDER','path':_0x50923b,'isFolder':!![],'children':_0x1dbcbd},...listFolderStructure(_0x54f7c3)],_0x2a4d33[_0x332e48(0x19b)](dirs);}else!fs[_0x332e48(0x1d1)](_0x54f7c3)&&fs[_0x332e48(0x1a3)](_0x54f7c3),_0x2a4d33[_0x332e48(0x19b)](listFolderStructure(_0x54f7c3));}),module['exports']=router;