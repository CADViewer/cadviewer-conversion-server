const a15_0x411d4d=a15_0x14bb;function a15_0x14bb(_0x55c6c2,_0x51209b){const _0x5921e3=a15_0x5921();return a15_0x14bb=function(_0x14bb36,_0x30f092){_0x14bb36=_0x14bb36-0x194;let _0x4462c4=_0x5921e3[_0x14bb36];return _0x4462c4;},a15_0x14bb(_0x55c6c2,_0x51209b);}(function(_0x2f55aa,_0x22085f){const _0x330fc1=a15_0x14bb,_0x1fdac3=_0x2f55aa();while(!![]){try{const _0x35f284=parseInt(_0x330fc1(0x19d))/0x1+-parseInt(_0x330fc1(0x19f))/0x2+-parseInt(_0x330fc1(0x1a1))/0x3+-parseInt(_0x330fc1(0x1b4))/0x4*(-parseInt(_0x330fc1(0x1be))/0x5)+-parseInt(_0x330fc1(0x1a0))/0x6+parseInt(_0x330fc1(0x1d1))/0x7*(-parseInt(_0x330fc1(0x19c))/0x8)+-parseInt(_0x330fc1(0x1cc))/0x9*(-parseInt(_0x330fc1(0x1ad))/0xa);if(_0x35f284===_0x22085f)break;else _0x1fdac3['push'](_0x1fdac3['shift']());}catch(_0xb27c53){_0x1fdac3['push'](_0x1fdac3['shift']());}}}(a15_0x5921,0x2f632));const fs=require('fs'),path=require(a15_0x411d4d(0x1c7)),config=require(a15_0x411d4d(0x1a9)),verifyTokenOptional=require(a15_0x411d4d(0x1cd))[a15_0x411d4d(0x19a)],show_folders=![],express=require(a15_0x411d4d(0x1ce)),router=express[a15_0x411d4d(0x1ab)](),conn=require(a15_0x411d4d(0x1c8)),{randomUUID}=require(a15_0x411d4d(0x1a4)),dir=a15_0x411d4d(0x1a7);!fs['existsSync'](dir)&&fs[a15_0x411d4d(0x1bd)](dir);const sortFoldersFirst=(_0x348408,_0x58991e)=>{const _0x13a764=a15_0x411d4d;if(_0x348408['children']&&!_0x58991e['children'])return-0x1;else return!_0x348408[_0x13a764(0x1ca)]&&_0x58991e['children']?0x1:0x0;},listFolderStructure=(_0x597150,_0x1e1db0='')=>{const _0x177336=a15_0x411d4d,_0x5a93b7=fs['readdirSync'](_0x597150),_0x1d8441=[];return _0x5a93b7[_0x177336(0x1c2)](_0x5c5618=>{const _0x593a34=_0x177336,_0x2b9e91=path[_0x593a34(0x1a3)](_0x597150,_0x5c5618),_0x31ceaf=fs[_0x593a34(0x1d2)](_0x2b9e91);if(_0x31ceaf[_0x593a34(0x1b7)]()){if(config[_0x593a34(0x1b2)]&&show_folders)console[_0x593a34(0x1bc)](_0x1e1db0+_0x593a34(0x1c9)+_0x5c5618);const _0x420612=listFolderStructure(_0x2b9e91,_0x1e1db0+_0x593a34(0x1ba));_0x1d8441[_0x593a34(0x194)]({'name':_0x5c5618,'path':_0x2b9e91,'size':_0x31ceaf[_0x593a34(0x1d0)],'created':_0x31ceaf[_0x593a34(0x1b5)],'modified':_0x31ceaf[_0x593a34(0x1ae)],'isFolder':!![],'children':_0x420612});}else{_0x1d8441['push']({'name':_0x5c5618,'path':_0x2b9e91,'size':_0x31ceaf[_0x593a34(0x1d0)],'created':_0x31ceaf['birthtime'],'modified':_0x31ceaf[_0x593a34(0x1ae)],'isFolder':![]});if(config['cvjs_debug']&&show_folders)console['log'](_0x1e1db0+_0x593a34(0x1a6)+_0x5c5618);}}),_0x1d8441[_0x177336(0x1b9)](sortFoldersFirst);};router[a15_0x411d4d(0x1b3)]('',verifyTokenOptional,async(_0x373b13,_0x5c3ecd)=>{const _0x4558f4=a15_0x411d4d,_0x1e8baa=path[_0x4558f4(0x1a3)](path[_0x4558f4(0x198)](require[_0x4558f4(0x1c1)]['filename']),_0x4558f4(0x19e)),_0x1f0550=JSON[_0x4558f4(0x1b0)](fs[_0x4558f4(0x1b8)](_0x1e8baa,_0x4558f4(0x1b6))),_0x2840a5=_0x373b13['query'][_0x4558f4(0x195)];let _0x4f8172=_0x1f0550['folderLocationDemoUser'];_0x2840a5==='false'&&(_0x4f8172=_0x1f0550[_0x4558f4(0x1bf)]);console[_0x4558f4(0x1bc)](_0x4558f4(0x1c4)+_0x4f8172+'\x20show_folders:'+show_folders+_0x4558f4(0x1aa)+config[_0x4558f4(0x1b2)]);if(_0x373b13[_0x4558f4(0x1cb)]){let _0x35ad5f;try{const [_0x25f761]=await conn[_0x4558f4(0x1c0)]()[_0x4558f4(0x196)](_0x4558f4(0x199),[_0x373b13['user'][_0x4558f4(0x1bb)]]);_0x25f761[_0x4558f4(0x197)]>0x0&&(_0x35ad5f=_0x25f761[0x0]);}catch(_0x306912){console[_0x4558f4(0x1bc)]({'err':_0x306912}),_0x5c3ecd[_0x4558f4(0x1a2)](0x1f4)['json']({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x35ad5f){_0x5c3ecd['status'](0x191)[_0x4558f4(0x1af)]({'error':_0x4558f4(0x1c3)});return;}_0x35ad5f[_0x4558f4(0x19b)]===_0x4558f4(0x1cf)&&(_0x4f8172=_0x1f0550[_0x4558f4(0x1bf)]);let _0x6c95d1=_0x35ad5f['folder_name'];if(!_0x6c95d1){_0x6c95d1=randomUUID();try{await conn[_0x4558f4(0x1c0)]()[_0x4558f4(0x196)](_0x4558f4(0x1b1),[_0x6c95d1,_0x373b13[_0x4558f4(0x1cb)][_0x4558f4(0x1bb)]]);}catch(_0x121a45){console[_0x4558f4(0x1bc)]({'err':_0x121a45}),_0x5c3ecd[_0x4558f4(0x1a2)](0x1f4)['json']({'error':_0x4558f4(0x1a5)});return;}}const _0x2e7677='./uploads/'+_0x6c95d1;!fs[_0x4558f4(0x1a8)](_0x2e7677)&&fs[_0x4558f4(0x1bd)](_0x2e7677);const _0x143cea=path[_0x4558f4(0x1ac)](_0x2e7677),_0x37fb57=listFolderStructure(_0x143cea);!fs[_0x4558f4(0x1a8)](_0x4f8172)&&fs['mkdirSync'](_0x4f8172),dirs=[{'own':!![],'name':_0x4558f4(0x1c5),'path':_0x2e7677,'isFolder':!![],'children':_0x37fb57},...listFolderStructure(_0x4f8172)],_0x5c3ecd['send'](dirs);}else!fs[_0x4558f4(0x1a8)](_0x4f8172)&&fs['mkdirSync'](_0x4f8172),_0x5c3ecd['send'](listFolderStructure(_0x4f8172));}),module[a15_0x411d4d(0x1c6)]=router;function a15_0x5921(){const _0x326441=['dirname','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','verifyTokenOptional','role','2646312ntNwSz','48979ibDRun','CADViewer_config.json','354514WStKzR','2050974cRCJHq','127371GjGJEL','status','join','crypto','Error!\x20Something\x20went\x20wrong.','├──\x20','./uploads','existsSync','../CADViewer_config.json','cvhs_debug:','Router','resolve','60zYJWRk','mtime','json','parse','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','cvjs_debug','get','65156heVjRu','birthtime','utf8','isDirectory','readFileSync','sort','\x20\x20\x20','email','log','mkdirSync','45YeRHgN','folderLocation','promise','main','forEach','Invalid\x20user','in\x20listFolderStructure\x20folderLocation=','MY\x20FOLDER','exports','path','../libs/mysql','└──\x20','children','user','1336275cgGJfD','../libs/jwt','express','admin','size','7lCorhp','statSync','push','loginFeatureEnabled','execute','length'];a15_0x5921=function(){return _0x326441;};return a15_0x5921();}