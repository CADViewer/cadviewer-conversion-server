const a15_0x5d69f6=a15_0x5b61;(function(_0x4579e5,_0x5314a5){const _0xb9da4f=a15_0x5b61,_0x4110ed=_0x4579e5();while(!![]){try{const _0x380d4d=-parseInt(_0xb9da4f(0x1ef))/0x1*(-parseInt(_0xb9da4f(0x1d3))/0x2)+-parseInt(_0xb9da4f(0x1e7))/0x3*(parseInt(_0xb9da4f(0x201))/0x4)+-parseInt(_0xb9da4f(0x1c6))/0x5*(parseInt(_0xb9da4f(0x1ff))/0x6)+parseInt(_0xb9da4f(0x1ea))/0x7*(-parseInt(_0xb9da4f(0x1e9))/0x8)+-parseInt(_0xb9da4f(0x1cb))/0x9*(-parseInt(_0xb9da4f(0x1f9))/0xa)+parseInt(_0xb9da4f(0x1f8))/0xb+parseInt(_0xb9da4f(0x1e0))/0xc;if(_0x380d4d===_0x5314a5)break;else _0x4110ed['push'](_0x4110ed['shift']());}catch(_0x433be4){_0x4110ed['push'](_0x4110ed['shift']());}}}(a15_0x3d0e,0xb1f1e));function a15_0x3d0e(){const _0x3fbe4f=['crypto','get','status','772mnLIlK','├──\x20','../libs/jwt','email','execute','Error!\x20Something\x20went\x20wrong.','folderLocation','role','send','user','dirname','utf8','\x20show_folders:','24013104GIcoAc','log','\x20\x20\x20','verifyTokenOptional','existsSync','forEach','children','85227DLbLay','CADViewer_config.json','79384FAlrfo','973LuLLzY','./uploads','└──\x20','json','path','3427XSgaOD','birthtime','query','sort','cvjs_debug','filename','Router','join','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','3400936pqbPAm','120iziwqD','readdirSync','push','loginFeatureEnabled','isDirectory','promise','6EMAuNw','mkdirSync','48iLBRsi','main','parse','size','exports','6091535KEhAsU','folderLocationDemoUser','../CADViewer_config.json','folder_name','length','25713akbuxq','mtime','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','express','../libs/mysql'];a15_0x3d0e=function(){return _0x3fbe4f;};return a15_0x3d0e();}function a15_0x5b61(_0x197718,_0x576b14){const _0x3d0ef8=a15_0x3d0e();return a15_0x5b61=function(_0x5b6159,_0xafb99d){_0x5b6159=_0x5b6159-0x1c3;let _0x4ab85c=_0x3d0ef8[_0x5b6159];return _0x4ab85c;},a15_0x5b61(_0x197718,_0x576b14);}const fs=require('fs'),path=require(a15_0x5d69f6(0x1ee)),config=require(a15_0x5d69f6(0x1c8)),verifyTokenOptional=require(a15_0x5d69f6(0x1d5))[a15_0x5d69f6(0x1e3)],show_folders=![],express=require(a15_0x5d69f6(0x1ce)),router=express[a15_0x5d69f6(0x1f5)](),conn=require(a15_0x5d69f6(0x1cf)),{randomUUID}=require(a15_0x5d69f6(0x1d0)),dir=a15_0x5d69f6(0x1eb);!fs[a15_0x5d69f6(0x1e4)](dir)&&fs[a15_0x5d69f6(0x200)](dir);const sortFoldersFirst=(_0x695934,_0x10d002)=>{const _0x37e80d=a15_0x5d69f6;if(_0x695934['children']&&!_0x10d002[_0x37e80d(0x1e6)])return-0x1;else return!_0x695934[_0x37e80d(0x1e6)]&&_0x10d002[_0x37e80d(0x1e6)]?0x1:0x0;},listFolderStructure=(_0x675313,_0x59beb4='')=>{const _0x11e9ad=a15_0x5d69f6,_0x523a53=fs[_0x11e9ad(0x1fa)](_0x675313),_0x3bb5ea=[];return _0x523a53[_0x11e9ad(0x1e5)](_0x3dbb1f=>{const _0x3c7b9f=_0x11e9ad,_0x1727f8=path[_0x3c7b9f(0x1f6)](_0x675313,_0x3dbb1f),_0x3a6ed7=fs['statSync'](_0x1727f8);if(_0x3a6ed7[_0x3c7b9f(0x1fd)]()){if(config['cvjs_debug']&&show_folders)console[_0x3c7b9f(0x1e1)](_0x59beb4+_0x3c7b9f(0x1ec)+_0x3dbb1f);const _0x532851=listFolderStructure(_0x1727f8,_0x59beb4+_0x3c7b9f(0x1e2));_0x3bb5ea[_0x3c7b9f(0x1fb)]({'name':_0x3dbb1f,'path':_0x1727f8,'size':_0x3a6ed7['size'],'created':_0x3a6ed7['birthtime'],'modified':_0x3a6ed7['mtime'],'isFolder':!![],'children':_0x532851});}else{_0x3bb5ea[_0x3c7b9f(0x1fb)]({'name':_0x3dbb1f,'path':_0x1727f8,'size':_0x3a6ed7[_0x3c7b9f(0x1c4)],'created':_0x3a6ed7[_0x3c7b9f(0x1f0)],'modified':_0x3a6ed7[_0x3c7b9f(0x1cc)],'isFolder':![]});if(config[_0x3c7b9f(0x1f3)]&&show_folders)console['log'](_0x59beb4+_0x3c7b9f(0x1d4)+_0x3dbb1f);}}),_0x3bb5ea[_0x11e9ad(0x1f2)](sortFoldersFirst);};router[a15_0x5d69f6(0x1d1)]('',verifyTokenOptional,async(_0x436bdf,_0x325ee0)=>{const _0x2280b1=a15_0x5d69f6,_0xdfdc26=path['join'](path[_0x2280b1(0x1dd)](require[_0x2280b1(0x202)][_0x2280b1(0x1f4)]),_0x2280b1(0x1e8)),_0x46f988=JSON[_0x2280b1(0x1c3)](fs['readFileSync'](_0xdfdc26,_0x2280b1(0x1de))),_0x60c2c4=_0x436bdf[_0x2280b1(0x1f1)][_0x2280b1(0x1fc)];let _0xf6bb3=_0x46f988[_0x2280b1(0x1c7)];_0x60c2c4==='false'&&(_0xf6bb3=_0x46f988[_0x2280b1(0x1d9)]);console['log']('in\x20listFolderStructure\x20folderLocation='+_0xf6bb3+_0x2280b1(0x1df)+show_folders+'cvhs_debug:'+config[_0x2280b1(0x1f3)]);if(_0x436bdf[_0x2280b1(0x1dc)]){let _0x4ddf00;try{const [_0x3ea5a6]=await conn[_0x2280b1(0x1fe)]()[_0x2280b1(0x1d7)](_0x2280b1(0x1cd),[_0x436bdf[_0x2280b1(0x1dc)][_0x2280b1(0x1d6)]]);_0x3ea5a6[_0x2280b1(0x1ca)]>0x0&&(_0x4ddf00=_0x3ea5a6[0x0]);}catch(_0x57bbc8){console[_0x2280b1(0x1e1)]({'err':_0x57bbc8}),_0x325ee0[_0x2280b1(0x1d2)](0x1f4)[_0x2280b1(0x1ed)]({'error':_0x2280b1(0x1d8)});return;}if(!_0x4ddf00){_0x325ee0[_0x2280b1(0x1d2)](0x191)[_0x2280b1(0x1ed)]({'error':'Invalid\x20user'});return;}_0x4ddf00[_0x2280b1(0x1da)]==='admin'&&(_0xf6bb3=_0x46f988[_0x2280b1(0x1d9)]);let _0x16af52=_0x4ddf00[_0x2280b1(0x1c9)];if(!_0x16af52){_0x16af52=randomUUID();try{await conn['promise']()[_0x2280b1(0x1d7)](_0x2280b1(0x1f7),[_0x16af52,_0x436bdf[_0x2280b1(0x1dc)][_0x2280b1(0x1d6)]]);}catch(_0x49b591){console[_0x2280b1(0x1e1)]({'err':_0x49b591}),_0x325ee0[_0x2280b1(0x1d2)](0x1f4)[_0x2280b1(0x1ed)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x315b24='./uploads/'+_0x16af52;!fs[_0x2280b1(0x1e4)](_0x315b24)&&fs[_0x2280b1(0x200)](_0x315b24);const _0x3d66b6=path['resolve'](_0x315b24),_0x5cc4d2=listFolderStructure(_0x3d66b6);!fs[_0x2280b1(0x1e4)](_0xf6bb3)&&fs[_0x2280b1(0x200)](_0xf6bb3),dirs=[{'own':!![],'name':'MY\x20FOLDER','path':_0x315b24,'isFolder':!![],'children':_0x5cc4d2},...listFolderStructure(_0xf6bb3)],_0x325ee0[_0x2280b1(0x1db)](dirs);}else!fs['existsSync'](_0xf6bb3)&&fs['mkdirSync'](_0xf6bb3),_0x325ee0['send'](listFolderStructure(_0xf6bb3));}),module[a15_0x5d69f6(0x1c5)]=router;