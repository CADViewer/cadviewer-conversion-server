const a15_0x3ec230=a15_0x1dcb;function a15_0x1dcb(_0x1b670e,_0x3a883b){const _0x188169=a15_0x1881();return a15_0x1dcb=function(_0x1dcb3d,_0x2823dd){_0x1dcb3d=_0x1dcb3d-0x87;let _0x57b562=_0x188169[_0x1dcb3d];return _0x57b562;},a15_0x1dcb(_0x1b670e,_0x3a883b);}(function(_0x5b5e7d,_0x2d519e){const _0xafb61f=a15_0x1dcb,_0x564100=_0x5b5e7d();while(!![]){try{const _0x2fa671=-parseInt(_0xafb61f(0xa2))/0x1*(-parseInt(_0xafb61f(0x8d))/0x2)+-parseInt(_0xafb61f(0x95))/0x3*(-parseInt(_0xafb61f(0x89))/0x4)+parseInt(_0xafb61f(0x8c))/0x5*(parseInt(_0xafb61f(0x9b))/0x6)+-parseInt(_0xafb61f(0x96))/0x7+-parseInt(_0xafb61f(0xb2))/0x8*(parseInt(_0xafb61f(0x8f))/0x9)+parseInt(_0xafb61f(0x94))/0xa+-parseInt(_0xafb61f(0x8a))/0xb;if(_0x2fa671===_0x2d519e)break;else _0x564100['push'](_0x564100['shift']());}catch(_0x5d4bb2){_0x564100['push'](_0x564100['shift']());}}}(a15_0x1881,0x8bb33));const fs=require('fs'),path=require(a15_0x3ec230(0x98)),config=require(a15_0x3ec230(0xa8)),verifyTokenOptional=require(a15_0x3ec230(0xa1))['verifyTokenOptional'],show_folders=![],express=require('express'),router=express[a15_0x3ec230(0xa6)](),conn=require(a15_0x3ec230(0xc2)),{randomUUID}=require(a15_0x3ec230(0xb0)),dir=a15_0x3ec230(0xaa);!fs['existsSync'](dir)&&fs['mkdirSync'](dir);function a15_0x1881(){const _0x565be7=['SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','mtime','length','../libs/jwt','1zRUXgW','admin','loginFeatureEnabled','user','Router','CADViewer_config.json','../CADViewer_config.json','in\x20listFolderStructure\x20folderLocation=','./uploads','role','├──\x20','promise','log','join','crypto','isDirectory','24ihviBX','size','folder_name','parse','\x20\x20\x20','email','└──\x20','resolve','birthtime','cvjs_debug','Invalid\x20user','execute','status','mkdirSync','MY\x20FOLDER','children','../libs/mysql','Error!\x20Something\x20went\x20wrong.','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','1106668EUFRBe','3696484GbJbia','send','2111215HKNRtZ','1049220msqdey','readFileSync','2484027MFfnMh','existsSync','json','exports','utf8','5332200RUiCNk','12DBpVNF','5953339oPKbNE','./uploads/','path','folderLocationDemoUser','statSync','6mVLqbG','push','get'];a15_0x1881=function(){return _0x565be7;};return a15_0x1881();}const sortFoldersFirst=(_0x2ca98e,_0x3486f9)=>{const _0x13fe80=a15_0x3ec230;if(_0x2ca98e[_0x13fe80(0xc1)]&&!_0x3486f9[_0x13fe80(0xc1)])return-0x1;else return!_0x2ca98e[_0x13fe80(0xc1)]&&_0x3486f9[_0x13fe80(0xc1)]?0x1:0x0;},listFolderStructure=(_0xb7d042,_0xb52110='')=>{const _0x442b37=fs['readdirSync'](_0xb7d042),_0x3d4293=[];return _0x442b37['forEach'](_0x6f2dfa=>{const _0x1754b7=a15_0x1dcb,_0x41c590=path[_0x1754b7(0xaf)](_0xb7d042,_0x6f2dfa),_0x4408da=fs[_0x1754b7(0x9a)](_0x41c590);if(_0x4408da[_0x1754b7(0xb1)]()){if(config[_0x1754b7(0xbb)]&&show_folders)console[_0x1754b7(0xae)](_0xb52110+_0x1754b7(0xb8)+_0x6f2dfa);const _0xcf97c2=listFolderStructure(_0x41c590,_0xb52110+_0x1754b7(0xb6));_0x3d4293['push']({'name':_0x6f2dfa,'path':_0x41c590,'size':_0x4408da[_0x1754b7(0xb3)],'created':_0x4408da[_0x1754b7(0xba)],'modified':_0x4408da[_0x1754b7(0x9f)],'isFolder':!![],'children':_0xcf97c2});}else{_0x3d4293[_0x1754b7(0x9c)]({'name':_0x6f2dfa,'path':_0x41c590,'size':_0x4408da[_0x1754b7(0xb3)],'created':_0x4408da[_0x1754b7(0xba)],'modified':_0x4408da[_0x1754b7(0x9f)],'isFolder':![]});if(config[_0x1754b7(0xbb)]&&show_folders)console[_0x1754b7(0xae)](_0xb52110+_0x1754b7(0xac)+_0x6f2dfa);}}),_0x3d4293['sort'](sortFoldersFirst);};router[a15_0x3ec230(0x9d)]('',verifyTokenOptional,async(_0x396c8b,_0xddf0d)=>{const _0x163eaa=a15_0x3ec230,_0x114b87=path[_0x163eaa(0xaf)](path['dirname'](require['main']['filename']),_0x163eaa(0xa7)),_0x2528d9=JSON[_0x163eaa(0xb5)](fs[_0x163eaa(0x8e)](_0x114b87,_0x163eaa(0x93))),_0x482712=_0x396c8b['query'][_0x163eaa(0xa4)];let _0x3a1a64=_0x2528d9[_0x163eaa(0x99)];_0x482712==='false'&&(_0x3a1a64=_0x2528d9['folderLocation']);console[_0x163eaa(0xae)](_0x163eaa(0xa9)+_0x3a1a64+'\x20show_folders:'+show_folders+'cvhs_debug:'+config['cvjs_debug']);if(_0x396c8b[_0x163eaa(0xa5)]){let _0x29f209;try{const [_0x736f5b]=await conn[_0x163eaa(0xad)]()[_0x163eaa(0xbd)](_0x163eaa(0x9e),[_0x396c8b['user'][_0x163eaa(0xb7)]]);_0x736f5b[_0x163eaa(0xa0)]>0x0&&(_0x29f209=_0x736f5b[0x0]);}catch(_0x3ed250){console['log']({'err':_0x3ed250}),_0xddf0d[_0x163eaa(0xbe)](0x1f4)[_0x163eaa(0x91)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x29f209){_0xddf0d[_0x163eaa(0xbe)](0x191)[_0x163eaa(0x91)]({'error':_0x163eaa(0xbc)});return;}_0x29f209[_0x163eaa(0xab)]===_0x163eaa(0xa3)&&(_0x3a1a64=_0x2528d9['folderLocation']);let _0x17ba7f=_0x29f209[_0x163eaa(0xb4)];if(!_0x17ba7f){_0x17ba7f=randomUUID();try{await conn[_0x163eaa(0xad)]()[_0x163eaa(0xbd)](_0x163eaa(0x88),[_0x17ba7f,_0x396c8b[_0x163eaa(0xa5)]['email']]);}catch(_0x32c19c){console[_0x163eaa(0xae)]({'err':_0x32c19c}),_0xddf0d['status'](0x1f4)[_0x163eaa(0x91)]({'error':_0x163eaa(0x87)});return;}}const _0x53e67e=_0x163eaa(0x97)+_0x17ba7f;!fs[_0x163eaa(0x90)](_0x53e67e)&&fs[_0x163eaa(0xbf)](_0x53e67e);const _0x2d1398=path[_0x163eaa(0xb9)](_0x53e67e),_0x4bf166=listFolderStructure(_0x2d1398);!fs[_0x163eaa(0x90)](_0x3a1a64)&&fs[_0x163eaa(0xbf)](_0x3a1a64),dirs=[{'own':!![],'name':_0x163eaa(0xc0),'path':_0x53e67e,'isFolder':!![],'children':_0x4bf166},...listFolderStructure(_0x3a1a64)],_0xddf0d[_0x163eaa(0x8b)](dirs);}else!fs['existsSync'](_0x3a1a64)&&fs[_0x163eaa(0xbf)](_0x3a1a64),_0xddf0d['send'](listFolderStructure(_0x3a1a64));}),module[a15_0x3ec230(0x92)]=router;