const a15_0x51e1f2=a15_0x488b;(function(_0x9524d7,_0x5df039){const _0x48dac2=a15_0x488b,_0x2bb7b8=_0x9524d7();while(!![]){try{const _0x1b7a69=parseInt(_0x48dac2(0xd5))/0x1*(parseInt(_0x48dac2(0xd9))/0x2)+parseInt(_0x48dac2(0xe0))/0x3*(-parseInt(_0x48dac2(0xbd))/0x4)+-parseInt(_0x48dac2(0xd0))/0x5*(-parseInt(_0x48dac2(0xc5))/0x6)+parseInt(_0x48dac2(0xbb))/0x7+parseInt(_0x48dac2(0xcc))/0x8*(-parseInt(_0x48dac2(0xd3))/0x9)+-parseInt(_0x48dac2(0xd6))/0xa*(parseInt(_0x48dac2(0xe2))/0xb)+parseInt(_0x48dac2(0xe4))/0xc;if(_0x1b7a69===_0x5df039)break;else _0x2bb7b8['push'](_0x2bb7b8['shift']());}catch(_0x5b60bf){_0x2bb7b8['push'](_0x2bb7b8['shift']());}}}(a15_0x3bba,0xb58e6));function a15_0x3bba(){const _0x245842=['filename','3KcSlHl','cvjs_debug','113718mbEPJh','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','13610796KjatgT','\x20show_folders:','query','./uploads/','statSync','mkdirSync','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','crypto','CADViewer_config.json','folderLocation','email','log','forEach','readFileSync','express','admin','verifyTokenOptional','Invalid\x20user','utf8','8871898hnkVQe','MY\x20FOLDER','4893444ntprug','false','role','parse','join','status','folder_name','children','2864436ikDXWo','push','Error!\x20Something\x20went\x20wrong.','exports','size','get','in\x20listFolderStructure\x20folderLocation=','24dKkvFu','Router','loginFeatureEnabled','sort','5JmBkkW','length','promise','4297509UzRQml','mtime','1Ofrcfw','720pVrMWu','user','send','2529602ieccdh','resolve','./uploads','../libs/mysql','existsSync','json'];a15_0x3bba=function(){return _0x245842;};return a15_0x3bba();}const fs=require('fs'),path=require('path'),config=require('../CADViewer_config.json'),verifyTokenOptional=require('../libs/jwt')[a15_0x51e1f2(0xb8)],show_folders=![],express=require(a15_0x51e1f2(0xb6)),router=express[a15_0x51e1f2(0xcd)](),conn=require(a15_0x51e1f2(0xdc)),{randomUUID}=require(a15_0x51e1f2(0xaf)),dir=a15_0x51e1f2(0xdb);!fs[a15_0x51e1f2(0xdd)](dir)&&fs['mkdirSync'](dir);function a15_0x488b(_0x866ca0,_0x4e0922){const _0x3bbac1=a15_0x3bba();return a15_0x488b=function(_0x488be5,_0x153ef3){_0x488be5=_0x488be5-0xac;let _0x18c494=_0x3bbac1[_0x488be5];return _0x18c494;},a15_0x488b(_0x866ca0,_0x4e0922);}const sortFoldersFirst=(_0x4c573e,_0x2b23cc)=>{const _0x3ce005=a15_0x51e1f2;if(_0x4c573e[_0x3ce005(0xc4)]&&!_0x2b23cc[_0x3ce005(0xc4)])return-0x1;else return!_0x4c573e[_0x3ce005(0xc4)]&&_0x2b23cc['children']?0x1:0x0;},listFolderStructure=(_0x4f312d,_0x20e206='')=>{const _0x1ba580=a15_0x51e1f2,_0x2c7f9f=fs['readdirSync'](_0x4f312d),_0x7c8c8f=[];return _0x2c7f9f[_0x1ba580(0xb4)](_0x3797e5=>{const _0x7fcc37=_0x1ba580,_0x4ac431=path[_0x7fcc37(0xc1)](_0x4f312d,_0x3797e5),_0x4bc27e=fs[_0x7fcc37(0xac)](_0x4ac431);if(_0x4bc27e['isDirectory']()){if(config[_0x7fcc37(0xe1)]&&show_folders)console[_0x7fcc37(0xb3)](_0x20e206+'└──\x20'+_0x3797e5);const _0x5907c0=listFolderStructure(_0x4ac431,_0x20e206+'\x20\x20\x20');_0x7c8c8f[_0x7fcc37(0xc6)]({'name':_0x3797e5,'path':_0x4ac431,'size':_0x4bc27e[_0x7fcc37(0xc9)],'created':_0x4bc27e['birthtime'],'modified':_0x4bc27e[_0x7fcc37(0xd4)],'isFolder':!![],'children':_0x5907c0});}else{_0x7c8c8f['push']({'name':_0x3797e5,'path':_0x4ac431,'size':_0x4bc27e['size'],'created':_0x4bc27e['birthtime'],'modified':_0x4bc27e['mtime'],'isFolder':![]});if(config[_0x7fcc37(0xe1)]&&show_folders)console['log'](_0x20e206+'├──\x20'+_0x3797e5);}}),_0x7c8c8f[_0x1ba580(0xcf)](sortFoldersFirst);};router[a15_0x51e1f2(0xca)]('',verifyTokenOptional,async(_0x570103,_0x1a7ee3)=>{const _0x3b1707=a15_0x51e1f2,_0x1e584c=path[_0x3b1707(0xc1)](path['dirname'](require['main'][_0x3b1707(0xdf)]),_0x3b1707(0xb0)),_0x16008d=JSON[_0x3b1707(0xc0)](fs[_0x3b1707(0xb5)](_0x1e584c,_0x3b1707(0xba))),_0x325d15=_0x570103[_0x3b1707(0xe6)][_0x3b1707(0xce)];let _0x13f2c0=_0x16008d['folderLocationDemoUser'];_0x325d15===_0x3b1707(0xbe)&&(_0x13f2c0=_0x16008d[_0x3b1707(0xb1)]);console['log'](_0x3b1707(0xcb)+_0x13f2c0+_0x3b1707(0xe5)+show_folders+'cvhs_debug:'+config[_0x3b1707(0xe1)]);if(_0x570103[_0x3b1707(0xd7)]){let _0x45b982;try{const [_0xbead69]=await conn[_0x3b1707(0xd2)]()['execute'](_0x3b1707(0xe3),[_0x570103[_0x3b1707(0xd7)][_0x3b1707(0xb2)]]);_0xbead69[_0x3b1707(0xd1)]>0x0&&(_0x45b982=_0xbead69[0x0]);}catch(_0x3dd4b1){console[_0x3b1707(0xb3)]({'err':_0x3dd4b1}),_0x1a7ee3[_0x3b1707(0xc2)](0x1f4)[_0x3b1707(0xde)]({'error':_0x3b1707(0xc7)});return;}if(!_0x45b982){_0x1a7ee3['status'](0x191)[_0x3b1707(0xde)]({'error':_0x3b1707(0xb9)});return;}_0x45b982[_0x3b1707(0xbf)]===_0x3b1707(0xb7)&&(_0x13f2c0=_0x16008d[_0x3b1707(0xb1)]);let _0x56a7c6=_0x45b982[_0x3b1707(0xc3)];if(!_0x56a7c6){_0x56a7c6=randomUUID();try{await conn[_0x3b1707(0xd2)]()['execute'](_0x3b1707(0xae),[_0x56a7c6,_0x570103[_0x3b1707(0xd7)][_0x3b1707(0xb2)]]);}catch(_0x5a68c9){console[_0x3b1707(0xb3)]({'err':_0x5a68c9}),_0x1a7ee3['status'](0x1f4)[_0x3b1707(0xde)]({'error':_0x3b1707(0xc7)});return;}}const _0x2b7fc3=_0x3b1707(0xe7)+_0x56a7c6;!fs[_0x3b1707(0xdd)](_0x2b7fc3)&&fs[_0x3b1707(0xad)](_0x2b7fc3);const _0x1d42a6=path[_0x3b1707(0xda)](_0x2b7fc3),_0x4b501f=listFolderStructure(_0x1d42a6);!fs[_0x3b1707(0xdd)](_0x13f2c0)&&fs[_0x3b1707(0xad)](_0x13f2c0),dirs=[{'own':!![],'name':_0x3b1707(0xbc),'path':_0x2b7fc3,'isFolder':!![],'children':_0x4b501f},...listFolderStructure(_0x13f2c0)],_0x1a7ee3[_0x3b1707(0xd8)](dirs);}else!fs[_0x3b1707(0xdd)](_0x13f2c0)&&fs[_0x3b1707(0xad)](_0x13f2c0),_0x1a7ee3[_0x3b1707(0xd8)](listFolderStructure(_0x13f2c0));}),module[a15_0x51e1f2(0xc8)]=router;