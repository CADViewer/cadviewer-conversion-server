const a15_0x1cb0fb=a15_0x3e1a;(function(_0x4995e4,_0x6480c1){const _0x56fb5b=a15_0x3e1a,_0x1399d2=_0x4995e4();while(!![]){try{const _0x30db6d=parseInt(_0x56fb5b(0xdc))/0x1+parseInt(_0x56fb5b(0xc1))/0x2+-parseInt(_0x56fb5b(0xcc))/0x3+parseInt(_0x56fb5b(0xd2))/0x4+parseInt(_0x56fb5b(0xbf))/0x5*(parseInt(_0x56fb5b(0xf1))/0x6)+-parseInt(_0x56fb5b(0xeb))/0x7+-parseInt(_0x56fb5b(0xf3))/0x8;if(_0x30db6d===_0x6480c1)break;else _0x1399d2['push'](_0x1399d2['shift']());}catch(_0x3c7f35){_0x1399d2['push'](_0x1399d2['shift']());}}}(a15_0x2232,0x4997a));const fs=require('fs'),path=require(a15_0x1cb0fb(0xc9)),config=require('../CADViewer_config.json'),verifyTokenOptional=require(a15_0x1cb0fb(0xcd))[a15_0x1cb0fb(0xcb)],show_folders=![],express=require(a15_0x1cb0fb(0xe6)),router=express[a15_0x1cb0fb(0xcf)](),conn=require(a15_0x1cb0fb(0xf2)),{randomUUID}=require(a15_0x1cb0fb(0xed)),dir=a15_0x1cb0fb(0xd9);function a15_0x2232(){const _0x524783=['size','loginFeatureEnabled','json','Error!\x20Something\x20went\x20wrong.','parse','./uploads','folderLocationDemoUser','./uploads/','443011bnLbPB','sort','readFileSync','mtime','dirname','cvjs_debug','folderLocation','log','execute','existsSync','express','\x20show_folders:','├──\x20','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','children','686007UMwLgu','push','crypto','Invalid\x20user','resolve','utf8','6ZIfAVA','../libs/mysql','7503280IDmATW','\x20\x20\x20','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','false','readdirSync','email','folder_name','forEach','1726715tSfzPT','user','795812yPAbXR','birthtime','mkdirSync','admin','send','CADViewer_config.json','query','statSync','path','status','verifyTokenOptional','1052838mCSEry','../libs/jwt','length','Router','└──\x20','filename','2008124VmPvht','main'];a15_0x2232=function(){return _0x524783;};return a15_0x2232();}!fs['existsSync'](dir)&&fs['mkdirSync'](dir);const sortFoldersFirst=(_0x5275bc,_0x29f278)=>{const _0x5a14d9=a15_0x1cb0fb;if(_0x5275bc[_0x5a14d9(0xea)]&&!_0x29f278[_0x5a14d9(0xea)])return-0x1;else return!_0x5275bc[_0x5a14d9(0xea)]&&_0x29f278[_0x5a14d9(0xea)]?0x1:0x0;},listFolderStructure=(_0x4a1ab2,_0x3eee3b='')=>{const _0x4c2b0d=a15_0x1cb0fb,_0x98fc73=fs[_0x4c2b0d(0xbb)](_0x4a1ab2),_0x2a10d2=[];return _0x98fc73[_0x4c2b0d(0xbe)](_0xb2ec9b=>{const _0x3ff48e=_0x4c2b0d,_0x147085=path['join'](_0x4a1ab2,_0xb2ec9b),_0x3945e6=fs[_0x3ff48e(0xc8)](_0x147085);if(_0x3945e6['isDirectory']()){if(config[_0x3ff48e(0xe1)]&&show_folders)console[_0x3ff48e(0xe3)](_0x3eee3b+_0x3ff48e(0xd0)+_0xb2ec9b);const _0x4bd70c=listFolderStructure(_0x147085,_0x3eee3b+_0x3ff48e(0xf4));_0x2a10d2[_0x3ff48e(0xec)]({'name':_0xb2ec9b,'path':_0x147085,'size':_0x3945e6[_0x3ff48e(0xd4)],'created':_0x3945e6[_0x3ff48e(0xc2)],'modified':_0x3945e6[_0x3ff48e(0xdf)],'isFolder':!![],'children':_0x4bd70c});}else{_0x2a10d2[_0x3ff48e(0xec)]({'name':_0xb2ec9b,'path':_0x147085,'size':_0x3945e6[_0x3ff48e(0xd4)],'created':_0x3945e6['birthtime'],'modified':_0x3945e6[_0x3ff48e(0xdf)],'isFolder':![]});if(config[_0x3ff48e(0xe1)]&&show_folders)console[_0x3ff48e(0xe3)](_0x3eee3b+_0x3ff48e(0xe8)+_0xb2ec9b);}}),_0x2a10d2[_0x4c2b0d(0xdd)](sortFoldersFirst);};function a15_0x3e1a(_0x3b9f51,_0x5a6b51){const _0x2232ba=a15_0x2232();return a15_0x3e1a=function(_0x3e1a3c,_0xa26b35){_0x3e1a3c=_0x3e1a3c-0xbb;let _0x44794d=_0x2232ba[_0x3e1a3c];return _0x44794d;},a15_0x3e1a(_0x3b9f51,_0x5a6b51);}router['get']('',verifyTokenOptional,async(_0x43b0c4,_0x1bbf12)=>{const _0x30c570=a15_0x1cb0fb,_0x26e761=path['join'](path[_0x30c570(0xe0)](require[_0x30c570(0xd3)][_0x30c570(0xd1)]),_0x30c570(0xc6)),_0x335f03=JSON[_0x30c570(0xd8)](fs[_0x30c570(0xde)](_0x26e761,_0x30c570(0xf0))),_0x3e2010=_0x43b0c4[_0x30c570(0xc7)][_0x30c570(0xd5)];let _0x2a3386=_0x335f03[_0x30c570(0xda)];_0x3e2010===_0x30c570(0xf6)&&(_0x2a3386=_0x335f03['folderLocation']);console['log']('in\x20listFolderStructure\x20folderLocation='+_0x2a3386+_0x30c570(0xe7)+show_folders+'cvhs_debug:'+config[_0x30c570(0xe1)]);if(_0x43b0c4[_0x30c570(0xc0)]){let _0x87cb56;try{const [_0x424724]=await conn['promise']()[_0x30c570(0xe4)](_0x30c570(0xe9),[_0x43b0c4[_0x30c570(0xc0)][_0x30c570(0xbc)]]);_0x424724[_0x30c570(0xce)]>0x0&&(_0x87cb56=_0x424724[0x0]);}catch(_0x303ff2){console[_0x30c570(0xe3)]({'err':_0x303ff2}),_0x1bbf12['status'](0x1f4)[_0x30c570(0xd6)]({'error':_0x30c570(0xd7)});return;}if(!_0x87cb56){_0x1bbf12[_0x30c570(0xca)](0x191)[_0x30c570(0xd6)]({'error':_0x30c570(0xee)});return;}_0x87cb56['role']===_0x30c570(0xc4)&&(_0x2a3386=_0x335f03[_0x30c570(0xe2)]);let _0x21bc3a=_0x87cb56[_0x30c570(0xbd)];if(!_0x21bc3a){_0x21bc3a=randomUUID();try{await conn['promise']()[_0x30c570(0xe4)](_0x30c570(0xf5),[_0x21bc3a,_0x43b0c4[_0x30c570(0xc0)][_0x30c570(0xbc)]]);}catch(_0x92dcd3){console[_0x30c570(0xe3)]({'err':_0x92dcd3}),_0x1bbf12['status'](0x1f4)[_0x30c570(0xd6)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0xe950c4=_0x30c570(0xdb)+_0x21bc3a;!fs[_0x30c570(0xe5)](_0xe950c4)&&fs[_0x30c570(0xc3)](_0xe950c4);const _0x2a03cf=path[_0x30c570(0xef)](_0xe950c4),_0x3cfc5d=listFolderStructure(_0x2a03cf);!fs[_0x30c570(0xe5)](_0x2a3386)&&fs[_0x30c570(0xc3)](_0x2a3386),dirs=[{'own':!![],'name':'MY\x20FOLDER','path':_0xe950c4,'isFolder':!![],'children':_0x3cfc5d},...listFolderStructure(_0x2a3386)],_0x1bbf12[_0x30c570(0xc5)](dirs);}else!fs[_0x30c570(0xe5)](_0x2a3386)&&fs['mkdirSync'](_0x2a3386),_0x1bbf12[_0x30c570(0xc5)](listFolderStructure(_0x2a3386));}),module['exports']=router;