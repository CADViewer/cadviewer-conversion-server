const a15_0x45b544=a15_0x1d32;function a15_0x1d32(_0x2cc871,_0x40e1e8){const _0x5f25d7=a15_0x5f25();return a15_0x1d32=function(_0x1d3265,_0x5f163d){_0x1d3265=_0x1d3265-0xb9;let _0x2c61b1=_0x5f25d7[_0x1d3265];return _0x2c61b1;},a15_0x1d32(_0x2cc871,_0x40e1e8);}(function(_0x23f36b,_0x444ea0){const _0x350abe=a15_0x1d32,_0x36958d=_0x23f36b();while(!![]){try{const _0x42128b=parseInt(_0x350abe(0xf1))/0x1*(-parseInt(_0x350abe(0xec))/0x2)+-parseInt(_0x350abe(0xe2))/0x3*(-parseInt(_0x350abe(0xd9))/0x4)+-parseInt(_0x350abe(0xcf))/0x5+-parseInt(_0x350abe(0xca))/0x6*(parseInt(_0x350abe(0xe8))/0x7)+-parseInt(_0x350abe(0xcd))/0x8*(-parseInt(_0x350abe(0xbf))/0x9)+-parseInt(_0x350abe(0xc2))/0xa*(parseInt(_0x350abe(0xba))/0xb)+parseInt(_0x350abe(0xb9))/0xc*(parseInt(_0x350abe(0xc5))/0xd);if(_0x42128b===_0x444ea0)break;else _0x36958d['push'](_0x36958d['shift']());}catch(_0x14a596){_0x36958d['push'](_0x36958d['shift']());}}}(a15_0x5f25,0x2160c));function a15_0x5f25(){const _0x245344=['\x20show_folders:','9pyDfqd','readdirSync','query','10JpYMLz','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','sort','299MxKWUv','children','birthtime','push','execute','83706RLxIRh','folderLocation','status','1490824EwqExU','dirname','323630GIeZHK','user','json','verifyTokenOptional','Router','crypto','express','loginFeatureEnabled','existsSync','parse','4zmmREy','CADViewer_config.json','utf8','exports','cvhs_debug:','Invalid\x20user','send','false','cvjs_debug','337749XCGvOR','filename','email','Error!\x20Something\x20went\x20wrong.','log','mkdirSync','7dabwvO','main','role','join','44SPWtym','./uploads/','statSync','in\x20listFolderStructure\x20folderLocation=','get','2017cYqLkQ','isDirectory','length','readFileSync','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','admin','61512FbAoQZ','1727737eUULLh','folder_name','../libs/jwt','size'];a15_0x5f25=function(){return _0x245344;};return a15_0x5f25();}const fs=require('fs'),path=require('path'),config=require('../CADViewer_config.json'),verifyTokenOptional=require(a15_0x45b544(0xbc))[a15_0x45b544(0xd2)],show_folders=![],express=require(a15_0x45b544(0xd5)),router=express[a15_0x45b544(0xd3)](),conn=require('../libs/mysql'),{randomUUID}=require(a15_0x45b544(0xd4)),dir='./uploads';!fs[a15_0x45b544(0xd7)](dir)&&fs[a15_0x45b544(0xe7)](dir);const sortFoldersFirst=(_0x591544,_0x598bef)=>{const _0x45d5bf=a15_0x45b544;if(_0x591544[_0x45d5bf(0xc6)]&&!_0x598bef[_0x45d5bf(0xc6)])return-0x1;else return!_0x591544[_0x45d5bf(0xc6)]&&_0x598bef[_0x45d5bf(0xc6)]?0x1:0x0;},listFolderStructure=(_0x3366aa,_0x3d8ae4='')=>{const _0x328c35=a15_0x45b544,_0x16bb8e=fs[_0x328c35(0xc0)](_0x3366aa),_0x13362b=[];return _0x16bb8e['forEach'](_0x4c7a62=>{const _0x46bc84=_0x328c35,_0x18755a=path[_0x46bc84(0xeb)](_0x3366aa,_0x4c7a62),_0x358071=fs[_0x46bc84(0xee)](_0x18755a);if(_0x358071[_0x46bc84(0xf2)]()){if(config[_0x46bc84(0xe1)]&&show_folders)console[_0x46bc84(0xe6)](_0x3d8ae4+'└──\x20'+_0x4c7a62);const _0x385c30=listFolderStructure(_0x18755a,_0x3d8ae4+'\x20\x20\x20');_0x13362b[_0x46bc84(0xc8)]({'name':_0x4c7a62,'path':_0x18755a,'size':_0x358071[_0x46bc84(0xbd)],'created':_0x358071[_0x46bc84(0xc7)],'modified':_0x358071['mtime'],'isFolder':!![],'children':_0x385c30});}else{_0x13362b[_0x46bc84(0xc8)]({'name':_0x4c7a62,'path':_0x18755a,'size':_0x358071[_0x46bc84(0xbd)],'created':_0x358071[_0x46bc84(0xc7)],'modified':_0x358071['mtime'],'isFolder':![]});if(config[_0x46bc84(0xe1)]&&show_folders)console[_0x46bc84(0xe6)](_0x3d8ae4+'├──\x20'+_0x4c7a62);}}),_0x13362b[_0x328c35(0xc4)](sortFoldersFirst);};router[a15_0x45b544(0xf0)]('',verifyTokenOptional,async(_0x181909,_0x168b24)=>{const _0x4c5bd0=a15_0x45b544,_0x41a4d3=path[_0x4c5bd0(0xeb)](path[_0x4c5bd0(0xce)](require[_0x4c5bd0(0xe9)][_0x4c5bd0(0xe3)]),_0x4c5bd0(0xda)),_0x5377d4=JSON[_0x4c5bd0(0xd8)](fs[_0x4c5bd0(0xf4)](_0x41a4d3,_0x4c5bd0(0xdb))),_0x36fac4=_0x181909[_0x4c5bd0(0xc1)][_0x4c5bd0(0xd6)];let _0x43f5a8=_0x5377d4['folderLocationDemoUser'];_0x36fac4===_0x4c5bd0(0xe0)&&(_0x43f5a8=_0x5377d4[_0x4c5bd0(0xcb)]);console[_0x4c5bd0(0xe6)](_0x4c5bd0(0xef)+_0x43f5a8+_0x4c5bd0(0xbe)+show_folders+_0x4c5bd0(0xdd)+config['cvjs_debug']);if(_0x181909['user']){let _0x2223a5;try{const [_0xdfe34a]=await conn['promise']()[_0x4c5bd0(0xc9)](_0x4c5bd0(0xc3),[_0x181909[_0x4c5bd0(0xd0)]['email']]);_0xdfe34a[_0x4c5bd0(0xf3)]>0x0&&(_0x2223a5=_0xdfe34a[0x0]);}catch(_0x57c3f9){console[_0x4c5bd0(0xe6)]({'err':_0x57c3f9}),_0x168b24[_0x4c5bd0(0xcc)](0x1f4)[_0x4c5bd0(0xd1)]({'error':_0x4c5bd0(0xe5)});return;}if(!_0x2223a5){_0x168b24['status'](0x191)[_0x4c5bd0(0xd1)]({'error':_0x4c5bd0(0xde)});return;}_0x2223a5[_0x4c5bd0(0xea)]===_0x4c5bd0(0xf6)&&(_0x43f5a8=_0x5377d4[_0x4c5bd0(0xcb)]);let _0x2041ce=_0x2223a5[_0x4c5bd0(0xbb)];if(!_0x2041ce){_0x2041ce=randomUUID();try{await conn['promise']()[_0x4c5bd0(0xc9)](_0x4c5bd0(0xf5),[_0x2041ce,_0x181909['user'][_0x4c5bd0(0xe4)]]);}catch(_0x9286e2){console['log']({'err':_0x9286e2}),_0x168b24[_0x4c5bd0(0xcc)](0x1f4)[_0x4c5bd0(0xd1)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x190b68=_0x4c5bd0(0xed)+_0x2041ce;!fs['existsSync'](_0x190b68)&&fs[_0x4c5bd0(0xe7)](_0x190b68);const _0x21f7b7=path['resolve'](_0x190b68),_0x3c325d=listFolderStructure(_0x21f7b7);!fs['existsSync'](_0x43f5a8)&&fs['mkdirSync'](_0x43f5a8),dirs=[{'own':!![],'name':'MY\x20FOLDER','path':_0x190b68,'isFolder':!![],'children':_0x3c325d},...listFolderStructure(_0x43f5a8)],_0x168b24[_0x4c5bd0(0xdf)](dirs);}else!fs['existsSync'](_0x43f5a8)&&fs[_0x4c5bd0(0xe7)](_0x43f5a8),_0x168b24[_0x4c5bd0(0xdf)](listFolderStructure(_0x43f5a8));}),module[a15_0x45b544(0xdc)]=router;