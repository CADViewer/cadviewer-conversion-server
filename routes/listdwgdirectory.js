const a16_0x3fafca=a16_0x5980;(function(_0x4d8d67,_0x50744f){const _0x47f10e=a16_0x5980,_0x57323c=_0x4d8d67();while(!![]){try{const _0x38ee51=-parseInt(_0x47f10e(0xec))/0x1+-parseInt(_0x47f10e(0xda))/0x2*(parseInt(_0x47f10e(0xce))/0x3)+-parseInt(_0x47f10e(0xc8))/0x4+parseInt(_0x47f10e(0xd3))/0x5+-parseInt(_0x47f10e(0xcb))/0x6+-parseInt(_0x47f10e(0xd1))/0x7*(parseInt(_0x47f10e(0xc5))/0x8)+-parseInt(_0x47f10e(0xef))/0x9*(-parseInt(_0x47f10e(0xd5))/0xa);if(_0x38ee51===_0x50744f)break;else _0x57323c['push'](_0x57323c['shift']());}catch(_0xc07708){_0x57323c['push'](_0x57323c['shift']());}}}(a16_0x1405,0x96c13));const fs=require('fs'),path=require('path'),config=require('../CADViewer_config.json'),verifyTokenOptional=require(a16_0x3fafca(0xc6))[a16_0x3fafca(0xc3)],show_folders=![],express=require(a16_0x3fafca(0xd7)),router=express[a16_0x3fafca(0xd4)](),conn=require(a16_0x3fafca(0xf1)),{randomUUID}=require(a16_0x3fafca(0xf5)),dir=a16_0x3fafca(0xdb);!fs[a16_0x3fafca(0xed)](dir)&&fs['mkdirSync'](dir);const sortFoldersFirst=(_0x363ece,_0x39abb2)=>{const _0x5b8269=a16_0x3fafca;if(_0x363ece['children']&&!_0x39abb2[_0x5b8269(0xe2)])return-0x1;else return!_0x363ece[_0x5b8269(0xe2)]&&_0x39abb2[_0x5b8269(0xe2)]?0x1:0x0;},listFolderStructure=(_0x37c552,_0x5afa7c='')=>{const _0x2f7b05=a16_0x3fafca,_0x58cbef=fs['readdirSync'](_0x37c552),_0x48249b=[];return _0x58cbef[_0x2f7b05(0xd8)](_0x18fde7=>{const _0x146baf=_0x2f7b05,_0x2a5dcc=path[_0x146baf(0xe1)](_0x37c552,_0x18fde7),_0x1f2d49=fs[_0x146baf(0xea)](_0x2a5dcc);if(_0x1f2d49[_0x146baf(0xc1)]()){if(config[_0x146baf(0xd0)]&&show_folders)console[_0x146baf(0xe9)](_0x5afa7c+_0x146baf(0xcd)+_0x18fde7);const _0xec1bd8=listFolderStructure(_0x2a5dcc,_0x5afa7c+_0x146baf(0xd9));_0x48249b[_0x146baf(0xd2)]({'name':_0x18fde7,'path':_0x2a5dcc,'size':_0x1f2d49['size'],'created':_0x1f2d49[_0x146baf(0xdc)],'modified':_0x1f2d49['mtime'],'isFolder':!![],'children':_0xec1bd8});}else{_0x48249b[_0x146baf(0xd2)]({'name':_0x18fde7,'path':_0x2a5dcc,'size':_0x1f2d49[_0x146baf(0xf0)],'created':_0x1f2d49['birthtime'],'modified':_0x1f2d49[_0x146baf(0xc7)],'isFolder':![]});if(config[_0x146baf(0xd0)]&&show_folders)console['log'](_0x5afa7c+'├──\x20'+_0x18fde7);}}),_0x48249b[_0x2f7b05(0xde)](sortFoldersFirst);};function a16_0x1405(){const _0x445de7=['role','CADViewer_config.json','Error!\x20Something\x20went\x20wrong.','execute','promise','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','isDirectory','length','verifyTokenOptional','filename','274912UIPHzd','../libs/jwt','mtime','2342984kXxJVe','resolve','exports','6491832AIotbK','json','└──\x20','335193DBVdnH','folderLocationDemoUser','cvjs_debug','7oFLEZK','push','3256550jclxJc','Router','2160dSvqgL','in\x20listFolderStructure\x20folderLocation=','express','forEach','\x20\x20\x20','4FUkRNc','./uploads','birthtime','false','sort','utf8','query','join','children','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','mkdirSync','user','\x20show_folders:','readFileSync','parse','log','statSync','./uploads/','664851wzQOWB','existsSync','admin','106524rLQcOr','size','../libs/mysql','status','folderLocation','MY\x20FOLDER','crypto','folder_name','send','loginFeatureEnabled'];a16_0x1405=function(){return _0x445de7;};return a16_0x1405();}function a16_0x5980(_0x18f9f7,_0x17182d){const _0x140578=a16_0x1405();return a16_0x5980=function(_0x5980ff,_0x85223a){_0x5980ff=_0x5980ff-0xbb;let _0x5bf994=_0x140578[_0x5980ff];return _0x5bf994;},a16_0x5980(_0x18f9f7,_0x17182d);}router['get']('',verifyTokenOptional,async(_0x3ea09c,_0x20a71b)=>{const _0x2071c5=a16_0x3fafca,_0x42948b=path[_0x2071c5(0xe1)](path['dirname'](require['main'][_0x2071c5(0xc4)]),_0x2071c5(0xbc)),_0x168178=JSON[_0x2071c5(0xe8)](fs[_0x2071c5(0xe7)](_0x42948b,_0x2071c5(0xdf))),_0x5cfb49=_0x3ea09c[_0x2071c5(0xe0)][_0x2071c5(0xf8)];let _0x3c1085=_0x168178[_0x2071c5(0xcf)];_0x5cfb49===_0x2071c5(0xdd)&&(_0x3c1085=_0x168178[_0x2071c5(0xf3)]);console[_0x2071c5(0xe9)](_0x2071c5(0xd6)+_0x3c1085+_0x2071c5(0xe6)+show_folders+'cvhs_debug:'+config[_0x2071c5(0xd0)]);if(_0x3ea09c[_0x2071c5(0xe5)]){let _0x14afd9;try{const [_0x2e1bb5]=await conn[_0x2071c5(0xbf)]()[_0x2071c5(0xbe)](_0x2071c5(0xc0),[_0x3ea09c[_0x2071c5(0xe5)]['email']]);_0x2e1bb5[_0x2071c5(0xc2)]>0x0&&(_0x14afd9=_0x2e1bb5[0x0]);}catch(_0x236f47){console[_0x2071c5(0xe9)]({'err':_0x236f47}),_0x20a71b['status'](0x1f4)[_0x2071c5(0xcc)]({'error':_0x2071c5(0xbd)});return;}if(!_0x14afd9){_0x20a71b[_0x2071c5(0xf2)](0x191)['json']({'error':'Invalid\x20user'});return;}_0x14afd9[_0x2071c5(0xbb)]===_0x2071c5(0xee)&&(_0x3c1085=_0x168178['folderLocation']);let _0x2d5ff8=_0x14afd9[_0x2071c5(0xf6)];if(!_0x2d5ff8){_0x2d5ff8=randomUUID();try{await conn[_0x2071c5(0xbf)]()[_0x2071c5(0xbe)](_0x2071c5(0xe3),[_0x2d5ff8,_0x3ea09c['user']['email']]);}catch(_0x512f24){console[_0x2071c5(0xe9)]({'err':_0x512f24}),_0x20a71b[_0x2071c5(0xf2)](0x1f4)[_0x2071c5(0xcc)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x53de70=_0x2071c5(0xeb)+_0x2d5ff8;!fs[_0x2071c5(0xed)](_0x53de70)&&fs[_0x2071c5(0xe4)](_0x53de70);const _0x570c58=path[_0x2071c5(0xc9)](_0x53de70),_0x23b7d6=listFolderStructure(_0x570c58);!fs[_0x2071c5(0xed)](_0x3c1085)&&fs['mkdirSync'](_0x3c1085),dirs=[{'own':!![],'name':_0x2071c5(0xf4),'path':_0x53de70,'isFolder':!![],'children':_0x23b7d6},...listFolderStructure(_0x3c1085)],_0x20a71b[_0x2071c5(0xf7)](dirs);}else!fs[_0x2071c5(0xed)](_0x3c1085)&&fs[_0x2071c5(0xe4)](_0x3c1085),_0x20a71b[_0x2071c5(0xf7)](listFolderStructure(_0x3c1085));}),module[a16_0x3fafca(0xca)]=router;