const a15_0x4dc0ee=a15_0x5a33;(function(_0x1cb92b,_0x4e8049){const _0x148207=a15_0x5a33,_0xa44027=_0x1cb92b();while(!![]){try{const _0x560748=parseInt(_0x148207(0x1ab))/0x1+-parseInt(_0x148207(0x19c))/0x2*(-parseInt(_0x148207(0x1d0))/0x3)+-parseInt(_0x148207(0x1c5))/0x4+-parseInt(_0x148207(0x1d2))/0x5+parseInt(_0x148207(0x1a3))/0x6+-parseInt(_0x148207(0x1af))/0x7*(parseInt(_0x148207(0x1b3))/0x8)+parseInt(_0x148207(0x1d7))/0x9*(parseInt(_0x148207(0x1c7))/0xa);if(_0x560748===_0x4e8049)break;else _0xa44027['push'](_0xa44027['shift']());}catch(_0xfd1a53){_0xa44027['push'](_0xa44027['shift']());}}}(a15_0x130b,0xb1e7c));const fs=require('fs'),path=require('path'),config=require(a15_0x4dc0ee(0x1c3)),verifyTokenOptional=require('../libs/jwt')[a15_0x4dc0ee(0x1d4)],show_folders=![],express=require(a15_0x4dc0ee(0x1be)),router=express['Router'](),conn=require(a15_0x4dc0ee(0x1d9)),{randomUUID}=require(a15_0x4dc0ee(0x1c0)),dir=a15_0x4dc0ee(0x1aa);!fs[a15_0x4dc0ee(0x1a2)](dir)&&fs['mkdirSync'](dir);function a15_0x5a33(_0x43a3ff,_0x5f397f){const _0x130b05=a15_0x130b();return a15_0x5a33=function(_0x5a3379,_0x300687){_0x5a3379=_0x5a3379-0x19a;let _0x4e4ad0=_0x130b05[_0x5a3379];return _0x4e4ad0;},a15_0x5a33(_0x43a3ff,_0x5f397f);}function a15_0x130b(){const _0x5241a8=['readdirSync','in\x20listFolderStructure\x20folderLocation=','get','cvhs_debug:','9lUIabu','forEach','3664400psWrYM','mtime','verifyTokenOptional','cvjs_debug','filename','6197949BQKMCl','user','../libs/mysql','resolve','Error!\x20Something\x20went\x20wrong.','email','230760qKBNmQ','query','Invalid\x20user','isDirectory','utf8','\x20show_folders:','existsSync','4690206ftCIbd','mkdirSync','promise','false','join','parse','role','./uploads','1005855YklJYT','push','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','exports','119RcxicT','status','size','birthtime','597896DuKywl','json','execute','folderLocation','└──\x20','log','length','children','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','\x20\x20\x20','MY\x20FOLDER','express','folderLocationDemoUser','crypto','dirname','./uploads/','../CADViewer_config.json','statSync','3115636DtcjnM','admin','20CkJpLh','send','readFileSync','sort','main'];a15_0x130b=function(){return _0x5241a8;};return a15_0x130b();}const sortFoldersFirst=(_0x554c59,_0x3b7abc)=>{const _0xd0e917=a15_0x4dc0ee;if(_0x554c59[_0xd0e917(0x1ba)]&&!_0x3b7abc[_0xd0e917(0x1ba)])return-0x1;else return!_0x554c59[_0xd0e917(0x1ba)]&&_0x3b7abc[_0xd0e917(0x1ba)]?0x1:0x0;},listFolderStructure=(_0xfae05e,_0x3f36d5='')=>{const _0x341dff=a15_0x4dc0ee,_0x50a5aa=fs[_0x341dff(0x1cc)](_0xfae05e),_0x5b8e80=[];return _0x50a5aa[_0x341dff(0x1d1)](_0x32e8f5=>{const _0x37709d=_0x341dff,_0x14e2d0=path[_0x37709d(0x1a7)](_0xfae05e,_0x32e8f5),_0x39d7d6=fs[_0x37709d(0x1c4)](_0x14e2d0);if(_0x39d7d6[_0x37709d(0x19f)]()){if(config[_0x37709d(0x1d5)]&&show_folders)console[_0x37709d(0x1b8)](_0x3f36d5+_0x37709d(0x1b7)+_0x32e8f5);const _0x215bb2=listFolderStructure(_0x14e2d0,_0x3f36d5+_0x37709d(0x1bc));_0x5b8e80['push']({'name':_0x32e8f5,'path':_0x14e2d0,'size':_0x39d7d6[_0x37709d(0x1b1)],'created':_0x39d7d6['birthtime'],'modified':_0x39d7d6['mtime'],'isFolder':!![],'children':_0x215bb2});}else{_0x5b8e80[_0x37709d(0x1ac)]({'name':_0x32e8f5,'path':_0x14e2d0,'size':_0x39d7d6[_0x37709d(0x1b1)],'created':_0x39d7d6[_0x37709d(0x1b2)],'modified':_0x39d7d6[_0x37709d(0x1d3)],'isFolder':![]});if(config[_0x37709d(0x1d5)]&&show_folders)console[_0x37709d(0x1b8)](_0x3f36d5+'├──\x20'+_0x32e8f5);}}),_0x5b8e80[_0x341dff(0x1ca)](sortFoldersFirst);};router[a15_0x4dc0ee(0x1ce)]('',verifyTokenOptional,async(_0x4d8c32,_0xa1b9fe)=>{const _0x1d7502=a15_0x4dc0ee,_0x56b753=path[_0x1d7502(0x1a7)](path[_0x1d7502(0x1c1)](require[_0x1d7502(0x1cb)][_0x1d7502(0x1d6)]),'CADViewer_config.json'),_0xd89e9a=JSON[_0x1d7502(0x1a8)](fs[_0x1d7502(0x1c9)](_0x56b753,_0x1d7502(0x1a0))),_0x51d964=_0x4d8c32[_0x1d7502(0x19d)]['loginFeatureEnabled'];let _0xe09a41=_0xd89e9a[_0x1d7502(0x1bf)];_0x51d964===_0x1d7502(0x1a6)&&(_0xe09a41=_0xd89e9a[_0x1d7502(0x1b6)]);console[_0x1d7502(0x1b8)](_0x1d7502(0x1cd)+_0xe09a41+_0x1d7502(0x1a1)+show_folders+_0x1d7502(0x1cf)+config[_0x1d7502(0x1d5)]);if(_0x4d8c32['user']){let _0x541fde;try{const [_0x423bc5]=await conn[_0x1d7502(0x1a5)]()[_0x1d7502(0x1b5)](_0x1d7502(0x1ad),[_0x4d8c32[_0x1d7502(0x1d8)][_0x1d7502(0x19b)]]);_0x423bc5[_0x1d7502(0x1b9)]>0x0&&(_0x541fde=_0x423bc5[0x0]);}catch(_0x388258){console[_0x1d7502(0x1b8)]({'err':_0x388258}),_0xa1b9fe[_0x1d7502(0x1b0)](0x1f4)[_0x1d7502(0x1b4)]({'error':_0x1d7502(0x19a)});return;}if(!_0x541fde){_0xa1b9fe[_0x1d7502(0x1b0)](0x191)[_0x1d7502(0x1b4)]({'error':_0x1d7502(0x19e)});return;}_0x541fde[_0x1d7502(0x1a9)]===_0x1d7502(0x1c6)&&(_0xe09a41=_0xd89e9a['folderLocation']);let _0x871b41=_0x541fde['folder_name'];if(!_0x871b41){_0x871b41=randomUUID();try{await conn[_0x1d7502(0x1a5)]()[_0x1d7502(0x1b5)](_0x1d7502(0x1bb),[_0x871b41,_0x4d8c32[_0x1d7502(0x1d8)][_0x1d7502(0x19b)]]);}catch(_0x424bb7){console['log']({'err':_0x424bb7}),_0xa1b9fe[_0x1d7502(0x1b0)](0x1f4)[_0x1d7502(0x1b4)]({'error':_0x1d7502(0x19a)});return;}}const _0x1ce7a8=_0x1d7502(0x1c2)+_0x871b41;!fs[_0x1d7502(0x1a2)](_0x1ce7a8)&&fs[_0x1d7502(0x1a4)](_0x1ce7a8);const _0x43c815=path[_0x1d7502(0x1da)](_0x1ce7a8),_0x3e1eb4=listFolderStructure(_0x43c815);!fs[_0x1d7502(0x1a2)](_0xe09a41)&&fs['mkdirSync'](_0xe09a41),dirs=[{'own':!![],'name':_0x1d7502(0x1bd),'path':_0x1ce7a8,'isFolder':!![],'children':_0x3e1eb4},...listFolderStructure(_0xe09a41)],_0xa1b9fe[_0x1d7502(0x1c8)](dirs);}else!fs[_0x1d7502(0x1a2)](_0xe09a41)&&fs[_0x1d7502(0x1a4)](_0xe09a41),_0xa1b9fe['send'](listFolderStructure(_0xe09a41));}),module[a15_0x4dc0ee(0x1ae)]=router;