const a15_0x3929d2=a15_0x592a;(function(_0x397d30,_0x4608e0){const _0x25e77e=a15_0x592a,_0x4198ba=_0x397d30();while(!![]){try{const _0x226832=parseInt(_0x25e77e(0x1cb))/0x1*(-parseInt(_0x25e77e(0x1dd))/0x2)+-parseInt(_0x25e77e(0x1ee))/0x3*(-parseInt(_0x25e77e(0x1c8))/0x4)+-parseInt(_0x25e77e(0x1e9))/0x5+-parseInt(_0x25e77e(0x1c7))/0x6+-parseInt(_0x25e77e(0x1c2))/0x7+-parseInt(_0x25e77e(0x1d9))/0x8*(parseInt(_0x25e77e(0x1c1))/0x9)+parseInt(_0x25e77e(0x1c3))/0xa*(parseInt(_0x25e77e(0x1e1))/0xb);if(_0x226832===_0x4608e0)break;else _0x4198ba['push'](_0x4198ba['shift']());}catch(_0x13b22b){_0x4198ba['push'](_0x4198ba['shift']());}}}(a15_0x4d04,0x7a1af));const fs=require('fs'),path=require(a15_0x3929d2(0x1d7)),config=require(a15_0x3929d2(0x1e5)),verifyTokenOptional=require(a15_0x3929d2(0x1ba))[a15_0x3929d2(0x1ec)],show_folders=![],express=require(a15_0x3929d2(0x1e4)),router=express[a15_0x3929d2(0x1e0)](),conn=require(a15_0x3929d2(0x1e2)),{randomUUID}=require(a15_0x3929d2(0x1bc)),dir=a15_0x3929d2(0x1b7);!fs[a15_0x3929d2(0x1e8)](dir)&&fs[a15_0x3929d2(0x1da)](dir);function a15_0x592a(_0x10769c,_0x105270){const _0x4d04d9=a15_0x4d04();return a15_0x592a=function(_0x592a50,_0x39fb06){_0x592a50=_0x592a50-0x1b2;let _0x452b27=_0x4d04d9[_0x592a50];return _0x452b27;},a15_0x592a(_0x10769c,_0x105270);}function a15_0x4d04(){const _0x33edf2=['forEach','./uploads/','Router','11ZKSRpG','../libs/mysql','birthtime','express','../CADViewer_config.json','admin','└──\x20','existsSync','3093920CZQabz','\x20show_folders:','main','verifyTokenOptional','folderLocation','253755QzENMP','get','folder_name','Invalid\x20user','in\x20listFolderStructure\x20folderLocation=','log','promise','exports','./uploads','Error!\x20Something\x20went\x20wrong.','execute','../libs/jwt','query','crypto','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','json','cvhs_debug:','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','9neNQLS','3357228izeKAV','33034660vSlFUb','false','push','statSync','4020348abqcBR','8YEMKLx','├──\x20','user','25vAKZdE','filename','resolve','dirname','readdirSync','isDirectory','status','children','size','cvjs_debug','folderLocationDemoUser','send','path','parse','6111176DOfDcD','mkdirSync','email','readFileSync','35212puxybp'];a15_0x4d04=function(){return _0x33edf2;};return a15_0x4d04();}const sortFoldersFirst=(_0x18c261,_0x24d1e1)=>{const _0x41ef1c=a15_0x3929d2;if(_0x18c261['children']&&!_0x24d1e1[_0x41ef1c(0x1d2)])return-0x1;else return!_0x18c261[_0x41ef1c(0x1d2)]&&_0x24d1e1[_0x41ef1c(0x1d2)]?0x1:0x0;},listFolderStructure=(_0x5a6bd1,_0x12364d='')=>{const _0x4ef411=a15_0x3929d2,_0x4ac16a=fs[_0x4ef411(0x1cf)](_0x5a6bd1),_0x2fb221=[];return _0x4ac16a[_0x4ef411(0x1de)](_0x3c3d59=>{const _0x77e2c4=_0x4ef411,_0x384fb8=path['join'](_0x5a6bd1,_0x3c3d59),_0x25db0c=fs[_0x77e2c4(0x1c6)](_0x384fb8);if(_0x25db0c[_0x77e2c4(0x1d0)]()){if(config[_0x77e2c4(0x1d4)]&&show_folders)console[_0x77e2c4(0x1b4)](_0x12364d+_0x77e2c4(0x1e7)+_0x3c3d59);const _0x2d82d7=listFolderStructure(_0x384fb8,_0x12364d+'\x20\x20\x20');_0x2fb221['push']({'name':_0x3c3d59,'path':_0x384fb8,'size':_0x25db0c[_0x77e2c4(0x1d3)],'created':_0x25db0c[_0x77e2c4(0x1e3)],'modified':_0x25db0c['mtime'],'isFolder':!![],'children':_0x2d82d7});}else{_0x2fb221[_0x77e2c4(0x1c5)]({'name':_0x3c3d59,'path':_0x384fb8,'size':_0x25db0c[_0x77e2c4(0x1d3)],'created':_0x25db0c[_0x77e2c4(0x1e3)],'modified':_0x25db0c['mtime'],'isFolder':![]});if(config[_0x77e2c4(0x1d4)]&&show_folders)console[_0x77e2c4(0x1b4)](_0x12364d+_0x77e2c4(0x1c9)+_0x3c3d59);}}),_0x2fb221['sort'](sortFoldersFirst);};router[a15_0x3929d2(0x1ef)]('',verifyTokenOptional,async(_0x10fc66,_0x3d6825)=>{const _0x323d17=a15_0x3929d2,_0x566c1a=path['join'](path[_0x323d17(0x1ce)](require[_0x323d17(0x1eb)][_0x323d17(0x1cc)]),'CADViewer_config.json'),_0x142a23=JSON[_0x323d17(0x1d8)](fs[_0x323d17(0x1dc)](_0x566c1a,'utf8')),_0x19c05a=_0x10fc66[_0x323d17(0x1bb)]['loginFeatureEnabled'];let _0x51e2fd=_0x142a23[_0x323d17(0x1d5)];_0x19c05a===_0x323d17(0x1c4)&&(_0x51e2fd=_0x142a23[_0x323d17(0x1ed)]);console['log'](_0x323d17(0x1b3)+_0x51e2fd+_0x323d17(0x1ea)+show_folders+_0x323d17(0x1bf)+config[_0x323d17(0x1d4)]);if(_0x10fc66[_0x323d17(0x1ca)]){let _0x3c11e7;try{const [_0x2ccd1b]=await conn[_0x323d17(0x1b5)]()[_0x323d17(0x1b9)](_0x323d17(0x1c0),[_0x10fc66[_0x323d17(0x1ca)][_0x323d17(0x1db)]]);_0x2ccd1b['length']>0x0&&(_0x3c11e7=_0x2ccd1b[0x0]);}catch(_0x51823a){console[_0x323d17(0x1b4)]({'err':_0x51823a}),_0x3d6825[_0x323d17(0x1d1)](0x1f4)[_0x323d17(0x1be)]({'error':_0x323d17(0x1b8)});return;}if(!_0x3c11e7){_0x3d6825[_0x323d17(0x1d1)](0x191)[_0x323d17(0x1be)]({'error':_0x323d17(0x1b2)});return;}_0x3c11e7['role']===_0x323d17(0x1e6)&&(_0x51e2fd=_0x142a23['folderLocation']);let _0x551701=_0x3c11e7[_0x323d17(0x1f0)];if(!_0x551701){_0x551701=randomUUID();try{await conn[_0x323d17(0x1b5)]()['execute'](_0x323d17(0x1bd),[_0x551701,_0x10fc66['user'][_0x323d17(0x1db)]]);}catch(_0x1b50d7){console['log']({'err':_0x1b50d7}),_0x3d6825[_0x323d17(0x1d1)](0x1f4)['json']({'error':_0x323d17(0x1b8)});return;}}const _0x8b478=_0x323d17(0x1df)+_0x551701;!fs[_0x323d17(0x1e8)](_0x8b478)&&fs['mkdirSync'](_0x8b478);const _0x3abca9=path[_0x323d17(0x1cd)](_0x8b478),_0x3a9350=listFolderStructure(_0x3abca9);!fs[_0x323d17(0x1e8)](_0x51e2fd)&&fs[_0x323d17(0x1da)](_0x51e2fd),dirs=[{'own':!![],'name':'MY\x20FOLDER','path':_0x8b478,'isFolder':!![],'children':_0x3a9350},...listFolderStructure(_0x51e2fd)],_0x3d6825[_0x323d17(0x1d6)](dirs);}else!fs['existsSync'](_0x51e2fd)&&fs[_0x323d17(0x1da)](_0x51e2fd),_0x3d6825[_0x323d17(0x1d6)](listFolderStructure(_0x51e2fd));}),module[a15_0x3929d2(0x1b6)]=router;