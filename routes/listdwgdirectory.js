function a15_0x1590(_0x22b113,_0x205f2f){const _0x44f923=a15_0x44f9();return a15_0x1590=function(_0x1590f2,_0x3d87ed){_0x1590f2=_0x1590f2-0x125;let _0x40d55d=_0x44f923[_0x1590f2];return _0x40d55d;},a15_0x1590(_0x22b113,_0x205f2f);}function a15_0x44f9(){const _0x124fd9=['└──\x20','resolve','join','mtime','../CADViewer_config.json','promise','role','CADViewer_config.json','readdirSync','../libs/mysql','sort','1534935fHakbC','Error!\x20Something\x20went\x20wrong.','exports','get','isDirectory','1464468oUgecI','query','send','378dWgVcK','47462MbDNTc','children','status','folderLocation','filename','json','existsSync','├──\x20','cvjs_debug','statSync','mkdirSync','crypto','Router','folder_name','Invalid\x20user','118304CLDmsU','email','\x20show_folders:','main','path','cvhs_debug:','2737952nzGnQk','675106nnrwWc','user','./uploads/','parse','execute','forEach','dirname','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','folderLocationDemoUser','size','false','51dUzGzu','push','6785658MhYRts','birthtime','readFileSync','log'];a15_0x44f9=function(){return _0x124fd9;};return a15_0x44f9();}const a15_0x419176=a15_0x1590;(function(_0x397a61,_0x559fd6){const _0x7a3d79=a15_0x1590,_0x41ec04=_0x397a61();while(!![]){try{const _0x416479=parseInt(_0x7a3d79(0x128))/0x1+-parseInt(_0x7a3d79(0x14d))/0x2*(-parseInt(_0x7a3d79(0x133))/0x3)+-parseInt(_0x7a3d79(0x127))/0x4+parseInt(_0x7a3d79(0x144))/0x5+-parseInt(_0x7a3d79(0x149))/0x6+-parseInt(_0x7a3d79(0x14c))/0x7*(parseInt(_0x7a3d79(0x15c))/0x8)+parseInt(_0x7a3d79(0x135))/0x9;if(_0x416479===_0x559fd6)break;else _0x41ec04['push'](_0x41ec04['shift']());}catch(_0x3c29ba){_0x41ec04['push'](_0x41ec04['shift']());}}}(a15_0x44f9,0x64acc));const fs=require('fs'),path=require(a15_0x419176(0x125)),config=require(a15_0x419176(0x13d)),verifyTokenOptional=require('../libs/jwt')['verifyTokenOptional'],show_folders=![],express=require('express'),router=express[a15_0x419176(0x159)](),conn=require(a15_0x419176(0x142)),{randomUUID}=require(a15_0x419176(0x158)),dir='./uploads';!fs['existsSync'](dir)&&fs[a15_0x419176(0x157)](dir);const sortFoldersFirst=(_0x4dd3ca,_0x4f5fb9)=>{const _0xff522e=a15_0x419176;if(_0x4dd3ca[_0xff522e(0x14e)]&&!_0x4f5fb9[_0xff522e(0x14e)])return-0x1;else return!_0x4dd3ca['children']&&_0x4f5fb9[_0xff522e(0x14e)]?0x1:0x0;},listFolderStructure=(_0x37b097,_0x5df998='')=>{const _0x59dd3c=a15_0x419176,_0x182499=fs[_0x59dd3c(0x141)](_0x37b097),_0x44d716=[];return _0x182499[_0x59dd3c(0x12d)](_0x2c9192=>{const _0x37d807=_0x59dd3c,_0x4f7094=path[_0x37d807(0x13b)](_0x37b097,_0x2c9192),_0x2a4070=fs[_0x37d807(0x156)](_0x4f7094);if(_0x2a4070[_0x37d807(0x148)]()){if(config[_0x37d807(0x155)]&&show_folders)console['log'](_0x5df998+_0x37d807(0x139)+_0x2c9192);const _0xf8650a=listFolderStructure(_0x4f7094,_0x5df998+'\x20\x20\x20');_0x44d716[_0x37d807(0x134)]({'name':_0x2c9192,'path':_0x4f7094,'size':_0x2a4070[_0x37d807(0x131)],'created':_0x2a4070['birthtime'],'modified':_0x2a4070[_0x37d807(0x13c)],'isFolder':!![],'children':_0xf8650a});}else{_0x44d716[_0x37d807(0x134)]({'name':_0x2c9192,'path':_0x4f7094,'size':_0x2a4070['size'],'created':_0x2a4070[_0x37d807(0x136)],'modified':_0x2a4070[_0x37d807(0x13c)],'isFolder':![]});if(config['cvjs_debug']&&show_folders)console[_0x37d807(0x138)](_0x5df998+_0x37d807(0x154)+_0x2c9192);}}),_0x44d716[_0x59dd3c(0x143)](sortFoldersFirst);};router[a15_0x419176(0x147)]('',verifyTokenOptional,async(_0x2699da,_0xc31a4c)=>{const _0x4462b3=a15_0x419176,_0x10b333=path['join'](path[_0x4462b3(0x12e)](require[_0x4462b3(0x15f)][_0x4462b3(0x151)]),_0x4462b3(0x140)),_0x380090=JSON[_0x4462b3(0x12b)](fs[_0x4462b3(0x137)](_0x10b333,'utf8')),_0x315ce7=_0x2699da[_0x4462b3(0x14a)]['loginFeatureEnabled'];let _0x3413c7=_0x380090[_0x4462b3(0x130)];_0x315ce7===_0x4462b3(0x132)&&(_0x3413c7=_0x380090[_0x4462b3(0x150)]);console['log']('in\x20listFolderStructure\x20folderLocation='+_0x3413c7+_0x4462b3(0x15e)+show_folders+_0x4462b3(0x126)+config[_0x4462b3(0x155)]);if(_0x2699da[_0x4462b3(0x129)]){let _0x14c795;try{const [_0x584932]=await conn[_0x4462b3(0x13e)]()[_0x4462b3(0x12c)](_0x4462b3(0x12f),[_0x2699da[_0x4462b3(0x129)][_0x4462b3(0x15d)]]);_0x584932['length']>0x0&&(_0x14c795=_0x584932[0x0]);}catch(_0x58f353){console[_0x4462b3(0x138)]({'err':_0x58f353}),_0xc31a4c[_0x4462b3(0x14f)](0x1f4)[_0x4462b3(0x152)]({'error':_0x4462b3(0x145)});return;}if(!_0x14c795){_0xc31a4c[_0x4462b3(0x14f)](0x191)['json']({'error':_0x4462b3(0x15b)});return;}_0x14c795[_0x4462b3(0x13f)]==='admin'&&(_0x3413c7=_0x380090[_0x4462b3(0x150)]);let _0xad890f=_0x14c795[_0x4462b3(0x15a)];if(!_0xad890f){_0xad890f=randomUUID();try{await conn['promise']()['execute']('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0xad890f,_0x2699da[_0x4462b3(0x129)][_0x4462b3(0x15d)]]);}catch(_0x4b7be5){console[_0x4462b3(0x138)]({'err':_0x4b7be5}),_0xc31a4c[_0x4462b3(0x14f)](0x1f4)[_0x4462b3(0x152)]({'error':_0x4462b3(0x145)});return;}}const _0x89c504=_0x4462b3(0x12a)+_0xad890f;!fs['existsSync'](_0x89c504)&&fs[_0x4462b3(0x157)](_0x89c504);const _0x4cece0=path[_0x4462b3(0x13a)](_0x89c504),_0x4aa8a9=listFolderStructure(_0x4cece0);!fs[_0x4462b3(0x153)](_0x3413c7)&&fs['mkdirSync'](_0x3413c7),dirs=[{'own':!![],'name':'MY\x20FOLDER','path':_0x89c504,'isFolder':!![],'children':_0x4aa8a9},...listFolderStructure(_0x3413c7)],_0xc31a4c[_0x4462b3(0x14b)](dirs);}else!fs[_0x4462b3(0x153)](_0x3413c7)&&fs[_0x4462b3(0x157)](_0x3413c7),_0xc31a4c['send'](listFolderStructure(_0x3413c7));}),module[a15_0x419176(0x146)]=router;