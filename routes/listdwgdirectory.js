function a15_0x5e80(){const _0x5852bc=['readdirSync','verifyTokenOptional','push','├──\x20','user','MY\x20FOLDER','in\x20listFolderStructure\x20folderLocation=','└──\x20','cvjs_debug','existsSync','promise','send','query','316976jbSIdn','8988450ZvEpoJ','role','length','../CADViewer_config.json','readFileSync','dirname','path','exports','crypto','sort','resolve','11VGKxJc','34413IPysWb','./uploads','main','statSync','json','Router','loginFeatureEnabled','\x20show_folders:','join','2617776TJlvux','folder_name','birthtime','isDirectory','status','./uploads/','email','../libs/jwt','108920GARAeF','execute','25XkPcNf','forEach','2027568qYtTBh','log','children','folderLocation','mkdirSync','mtime','false','144XIXZiq','express','Invalid\x20user','filename','21250WSsnNv','10PZiwCu','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','get'];a15_0x5e80=function(){return _0x5852bc;};return a15_0x5e80();}function a15_0x2f32(_0x432702,_0x1946d0){const _0x5e804a=a15_0x5e80();return a15_0x2f32=function(_0x2f3279,_0x400ca4){_0x2f3279=_0x2f3279-0x16c;let _0x1efad9=_0x5e804a[_0x2f3279];return _0x1efad9;},a15_0x2f32(_0x432702,_0x1946d0);}const a15_0x4d2295=a15_0x2f32;(function(_0x59331b,_0x3e2ca4){const _0x258d8c=a15_0x2f32,_0x1d68cf=_0x59331b();while(!![]){try{const _0x5c7145=parseInt(_0x258d8c(0x1a1))/0x1*(parseInt(_0x258d8c(0x1a2))/0x2)+parseInt(_0x258d8c(0x181))/0x3+-parseInt(_0x258d8c(0x174))/0x4*(parseInt(_0x258d8c(0x194))/0x5)+-parseInt(_0x258d8c(0x19d))/0x6*(parseInt(_0x258d8c(0x192))/0x7)+parseInt(_0x258d8c(0x196))/0x8+-parseInt(_0x258d8c(0x18a))/0x9+-parseInt(_0x258d8c(0x175))/0xa*(-parseInt(_0x258d8c(0x180))/0xb);if(_0x5c7145===_0x3e2ca4)break;else _0x1d68cf['push'](_0x1d68cf['shift']());}catch(_0x4b6016){_0x1d68cf['push'](_0x1d68cf['shift']());}}}(a15_0x5e80,0x33250));const fs=require('fs'),path=require(a15_0x4d2295(0x17b)),config=require(a15_0x4d2295(0x178)),verifyTokenOptional=require(a15_0x4d2295(0x191))[a15_0x4d2295(0x1a6)],show_folders=![],express=require(a15_0x4d2295(0x19e)),router=express[a15_0x4d2295(0x186)](),conn=require('../libs/mysql'),{randomUUID}=require(a15_0x4d2295(0x17d)),dir=a15_0x4d2295(0x182);!fs['existsSync'](dir)&&fs[a15_0x4d2295(0x19a)](dir);const sortFoldersFirst=(_0xa45af3,_0x2d1066)=>{const _0x149ed6=a15_0x4d2295;if(_0xa45af3['children']&&!_0x2d1066[_0x149ed6(0x198)])return-0x1;else return!_0xa45af3[_0x149ed6(0x198)]&&_0x2d1066['children']?0x1:0x0;},listFolderStructure=(_0x2d18f9,_0xecc757='')=>{const _0x222f48=a15_0x4d2295,_0x4f18ad=fs[_0x222f48(0x1a5)](_0x2d18f9),_0xcf60aa=[];return _0x4f18ad[_0x222f48(0x195)](_0x109e5e=>{const _0x3361c5=_0x222f48,_0x1cabfa=path[_0x3361c5(0x189)](_0x2d18f9,_0x109e5e),_0x75db2f=fs[_0x3361c5(0x184)](_0x1cabfa);if(_0x75db2f[_0x3361c5(0x18d)]()){if(config['cvjs_debug']&&show_folders)console[_0x3361c5(0x197)](_0xecc757+_0x3361c5(0x16e)+_0x109e5e);const _0x3b2c97=listFolderStructure(_0x1cabfa,_0xecc757+'\x20\x20\x20');_0xcf60aa['push']({'name':_0x109e5e,'path':_0x1cabfa,'size':_0x75db2f['size'],'created':_0x75db2f[_0x3361c5(0x18c)],'modified':_0x75db2f['mtime'],'isFolder':!![],'children':_0x3b2c97});}else{_0xcf60aa[_0x3361c5(0x1a7)]({'name':_0x109e5e,'path':_0x1cabfa,'size':_0x75db2f['size'],'created':_0x75db2f[_0x3361c5(0x18c)],'modified':_0x75db2f[_0x3361c5(0x19b)],'isFolder':![]});if(config['cvjs_debug']&&show_folders)console[_0x3361c5(0x197)](_0xecc757+_0x3361c5(0x1a8)+_0x109e5e);}}),_0xcf60aa[_0x222f48(0x17e)](sortFoldersFirst);};router[a15_0x4d2295(0x1a4)]('',verifyTokenOptional,async(_0x5ef314,_0x561383)=>{const _0x52a564=a15_0x4d2295,_0x1650b3=path['join'](path[_0x52a564(0x17a)](require[_0x52a564(0x183)][_0x52a564(0x1a0)]),'CADViewer_config.json'),_0x3a7142=JSON['parse'](fs[_0x52a564(0x179)](_0x1650b3,'utf8')),_0x406ce6=_0x5ef314[_0x52a564(0x173)][_0x52a564(0x187)];let _0xff6c48=_0x3a7142['folderLocationDemoUser'];_0x406ce6===_0x52a564(0x19c)&&(_0xff6c48=_0x3a7142['folderLocation']);console[_0x52a564(0x197)](_0x52a564(0x16d)+_0xff6c48+_0x52a564(0x188)+show_folders+'cvhs_debug:'+config[_0x52a564(0x16f)]);if(_0x5ef314['user']){let _0x46d9f4;try{const [_0x3c85a9]=await conn[_0x52a564(0x171)]()[_0x52a564(0x193)]('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x5ef314[_0x52a564(0x1a9)][_0x52a564(0x190)]]);_0x3c85a9[_0x52a564(0x177)]>0x0&&(_0x46d9f4=_0x3c85a9[0x0]);}catch(_0x1ac288){console[_0x52a564(0x197)]({'err':_0x1ac288}),_0x561383[_0x52a564(0x18e)](0x1f4)['json']({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x46d9f4){_0x561383[_0x52a564(0x18e)](0x191)['json']({'error':_0x52a564(0x19f)});return;}_0x46d9f4[_0x52a564(0x176)]==='admin'&&(_0xff6c48=_0x3a7142[_0x52a564(0x199)]);let _0x362a77=_0x46d9f4[_0x52a564(0x18b)];if(!_0x362a77){_0x362a77=randomUUID();try{await conn['promise']()[_0x52a564(0x193)](_0x52a564(0x1a3),[_0x362a77,_0x5ef314['user'][_0x52a564(0x190)]]);}catch(_0x2824b8){console[_0x52a564(0x197)]({'err':_0x2824b8}),_0x561383[_0x52a564(0x18e)](0x1f4)[_0x52a564(0x185)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x171076=_0x52a564(0x18f)+_0x362a77;!fs[_0x52a564(0x170)](_0x171076)&&fs[_0x52a564(0x19a)](_0x171076);const _0x4bbdd1=path[_0x52a564(0x17f)](_0x171076),_0x5d048c=listFolderStructure(_0x4bbdd1);!fs['existsSync'](_0xff6c48)&&fs[_0x52a564(0x19a)](_0xff6c48),dirs=[{'own':!![],'name':_0x52a564(0x16c),'path':_0x171076,'isFolder':!![],'children':_0x5d048c},...listFolderStructure(_0xff6c48)],_0x561383['send'](dirs);}else!fs[_0x52a564(0x170)](_0xff6c48)&&fs[_0x52a564(0x19a)](_0xff6c48),_0x561383[_0x52a564(0x172)](listFolderStructure(_0xff6c48));}),module[a15_0x4d2295(0x17c)]=router;