const a15_0x3f8355=a15_0xb2f5;(function(_0x3de59c,_0x40b71b){const _0x8744fe=a15_0xb2f5,_0x186767=_0x3de59c();while(!![]){try{const _0x56239a=parseInt(_0x8744fe(0x19b))/0x1*(-parseInt(_0x8744fe(0x18f))/0x2)+parseInt(_0x8744fe(0x1ae))/0x3*(-parseInt(_0x8744fe(0x1af))/0x4)+-parseInt(_0x8744fe(0x1ab))/0x5+parseInt(_0x8744fe(0x1bd))/0x6*(parseInt(_0x8744fe(0x187))/0x7)+parseInt(_0x8744fe(0x194))/0x8+parseInt(_0x8744fe(0x185))/0x9+-parseInt(_0x8744fe(0x1ad))/0xa;if(_0x56239a===_0x40b71b)break;else _0x186767['push'](_0x186767['shift']());}catch(_0x46e552){_0x186767['push'](_0x186767['shift']());}}}(a15_0x3207,0x2d0f7));function a15_0x3207(){const _0x3c0b4e=['./uploads','└──\x20','cvhs_debug:','../libs/mysql','false','admin','forEach','status','\x20\x20\x20','log','dirname','sort','query','21040bRXDoU','promise','937160BsFfYj','3831eNLhBN','588WVoVWK','in\x20listFolderStructure\x20folderLocation=','\x20show_folders:','length','./uploads/','role','join','get','../libs/jwt','utf8','send','mtime','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','loginFeatureEnabled','1297938uIEpQw','email','exports','cvjs_debug','children','user','birthtime','Invalid\x20user','1983177cXrBpm','folder_name','7jHnMLP','json','folderLocation','execute','parse','../CADViewer_config.json','mkdirSync','MY\x20FOLDER','34auXnRr','statSync','folderLocationDemoUser','isDirectory','main','1748768Ysrojm','crypto','readdirSync','filename','express','path','existsSync','10886doNcak','Error!\x20Something\x20went\x20wrong.','push'];a15_0x3207=function(){return _0x3c0b4e;};return a15_0x3207();}function a15_0xb2f5(_0xe68422,_0x230cfa){const _0x32079f=a15_0x3207();return a15_0xb2f5=function(_0xb2f562,_0xd3d83){_0xb2f562=_0xb2f562-0x185;let _0xb452a=_0x32079f[_0xb2f562];return _0xb452a;},a15_0xb2f5(_0xe68422,_0x230cfa);}const fs=require('fs'),path=require(a15_0x3f8355(0x199)),config=require(a15_0x3f8355(0x18c)),verifyTokenOptional=require(a15_0x3f8355(0x1b7))['verifyTokenOptional'],show_folders=![],express=require(a15_0x3f8355(0x198)),router=express['Router'](),conn=require(a15_0x3f8355(0x1a1)),{randomUUID}=require(a15_0x3f8355(0x195)),dir=a15_0x3f8355(0x19e);!fs['existsSync'](dir)&&fs[a15_0x3f8355(0x18d)](dir);const sortFoldersFirst=(_0x2fc3ac,_0x3f3ffc)=>{const _0x3f02e9=a15_0x3f8355;if(_0x2fc3ac['children']&&!_0x3f3ffc[_0x3f02e9(0x1c1)])return-0x1;else return!_0x2fc3ac['children']&&_0x3f3ffc[_0x3f02e9(0x1c1)]?0x1:0x0;},listFolderStructure=(_0xda352,_0x7882e5='')=>{const _0x24ea7c=a15_0x3f8355,_0x44d772=fs[_0x24ea7c(0x196)](_0xda352),_0x1fea2c=[];return _0x44d772[_0x24ea7c(0x1a4)](_0x397f48=>{const _0x54558a=_0x24ea7c,_0x5157de=path[_0x54558a(0x1b5)](_0xda352,_0x397f48),_0x71425f=fs[_0x54558a(0x190)](_0x5157de);if(_0x71425f[_0x54558a(0x192)]()){if(config[_0x54558a(0x1c0)]&&show_folders)console[_0x54558a(0x1a7)](_0x7882e5+_0x54558a(0x19f)+_0x397f48);const _0x42c05b=listFolderStructure(_0x5157de,_0x7882e5+_0x54558a(0x1a6));_0x1fea2c['push']({'name':_0x397f48,'path':_0x5157de,'size':_0x71425f['size'],'created':_0x71425f[_0x54558a(0x1c3)],'modified':_0x71425f[_0x54558a(0x1ba)],'isFolder':!![],'children':_0x42c05b});}else{_0x1fea2c[_0x54558a(0x19d)]({'name':_0x397f48,'path':_0x5157de,'size':_0x71425f['size'],'created':_0x71425f[_0x54558a(0x1c3)],'modified':_0x71425f[_0x54558a(0x1ba)],'isFolder':![]});if(config['cvjs_debug']&&show_folders)console[_0x54558a(0x1a7)](_0x7882e5+'├──\x20'+_0x397f48);}}),_0x1fea2c[_0x24ea7c(0x1a9)](sortFoldersFirst);};router[a15_0x3f8355(0x1b6)]('',verifyTokenOptional,async(_0x4c97e7,_0x17bc6a)=>{const _0x1814e8=a15_0x3f8355,_0x56be19=path[_0x1814e8(0x1b5)](path[_0x1814e8(0x1a8)](require[_0x1814e8(0x193)][_0x1814e8(0x197)]),'CADViewer_config.json'),_0x8e67f9=JSON[_0x1814e8(0x18b)](fs['readFileSync'](_0x56be19,_0x1814e8(0x1b8))),_0x326d78=_0x4c97e7[_0x1814e8(0x1aa)][_0x1814e8(0x1bc)];let _0x1d9f3a=_0x8e67f9[_0x1814e8(0x191)];_0x326d78===_0x1814e8(0x1a2)&&(_0x1d9f3a=_0x8e67f9[_0x1814e8(0x189)]);console[_0x1814e8(0x1a7)](_0x1814e8(0x1b0)+_0x1d9f3a+_0x1814e8(0x1b1)+show_folders+_0x1814e8(0x1a0)+config[_0x1814e8(0x1c0)]);if(_0x4c97e7[_0x1814e8(0x1c2)]){let _0xa5f6d1;try{const [_0x426190]=await conn[_0x1814e8(0x1ac)]()[_0x1814e8(0x18a)](_0x1814e8(0x1bb),[_0x4c97e7[_0x1814e8(0x1c2)][_0x1814e8(0x1be)]]);_0x426190[_0x1814e8(0x1b2)]>0x0&&(_0xa5f6d1=_0x426190[0x0]);}catch(_0x3ff55b){console[_0x1814e8(0x1a7)]({'err':_0x3ff55b}),_0x17bc6a['status'](0x1f4)[_0x1814e8(0x188)]({'error':_0x1814e8(0x19c)});return;}if(!_0xa5f6d1){_0x17bc6a[_0x1814e8(0x1a5)](0x191)[_0x1814e8(0x188)]({'error':_0x1814e8(0x1c4)});return;}_0xa5f6d1[_0x1814e8(0x1b4)]===_0x1814e8(0x1a3)&&(_0x1d9f3a=_0x8e67f9[_0x1814e8(0x189)]);let _0x41c38a=_0xa5f6d1[_0x1814e8(0x186)];if(!_0x41c38a){_0x41c38a=randomUUID();try{await conn[_0x1814e8(0x1ac)]()[_0x1814e8(0x18a)]('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x41c38a,_0x4c97e7[_0x1814e8(0x1c2)][_0x1814e8(0x1be)]]);}catch(_0x20ca32){console['log']({'err':_0x20ca32}),_0x17bc6a[_0x1814e8(0x1a5)](0x1f4)[_0x1814e8(0x188)]({'error':_0x1814e8(0x19c)});return;}}const _0x1d8c3f=_0x1814e8(0x1b3)+_0x41c38a;!fs[_0x1814e8(0x19a)](_0x1d8c3f)&&fs[_0x1814e8(0x18d)](_0x1d8c3f);const _0x41c871=path['resolve'](_0x1d8c3f),_0x336d18=listFolderStructure(_0x41c871);!fs[_0x1814e8(0x19a)](_0x1d9f3a)&&fs['mkdirSync'](_0x1d9f3a),dirs=[{'own':!![],'name':_0x1814e8(0x18e),'path':_0x1d8c3f,'isFolder':!![],'children':_0x336d18},...listFolderStructure(_0x1d9f3a)],_0x17bc6a[_0x1814e8(0x1b9)](dirs);}else!fs[_0x1814e8(0x19a)](_0x1d9f3a)&&fs[_0x1814e8(0x18d)](_0x1d9f3a),_0x17bc6a[_0x1814e8(0x1b9)](listFolderStructure(_0x1d9f3a));}),module[a15_0x3f8355(0x1bf)]=router;