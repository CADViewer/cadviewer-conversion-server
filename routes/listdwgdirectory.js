function a16_0x561a(_0x24cb6f,_0x16c406){const _0x73be3c=a16_0x73be();return a16_0x561a=function(_0x561ab0,_0x4073f6){_0x561ab0=_0x561ab0-0x97;let _0x1fe582=_0x73be3c[_0x561ab0];return _0x1fe582;},a16_0x561a(_0x24cb6f,_0x16c406);}const a16_0x5ed6ea=a16_0x561a;(function(_0x431f14,_0x5718fd){const _0x5d8b75=a16_0x561a,_0x59d406=_0x431f14();while(!![]){try{const _0x486cd1=-parseInt(_0x5d8b75(0xa4))/0x1+-parseInt(_0x5d8b75(0xbe))/0x2*(-parseInt(_0x5d8b75(0xc7))/0x3)+parseInt(_0x5d8b75(0xb8))/0x4+parseInt(_0x5d8b75(0xca))/0x5+parseInt(_0x5d8b75(0xb5))/0x6+parseInt(_0x5d8b75(0xcf))/0x7*(-parseInt(_0x5d8b75(0xb7))/0x8)+-parseInt(_0x5d8b75(0xcb))/0x9;if(_0x486cd1===_0x5718fd)break;else _0x59d406['push'](_0x59d406['shift']());}catch(_0x2b669a){_0x59d406['push'](_0x59d406['shift']());}}}(a16_0x73be,0x72d8a));const fs=require('fs'),path=require(a16_0x5ed6ea(0xaf)),config=require('../CADViewer_config.json'),verifyTokenOptional=require(a16_0x5ed6ea(0xa6))[a16_0x5ed6ea(0xab)],show_folders=![],express=require(a16_0x5ed6ea(0xc1)),router=express[a16_0x5ed6ea(0xc9)](),conn=require(a16_0x5ed6ea(0xcd)),{randomUUID}=require(a16_0x5ed6ea(0xa2)),dir='./uploads';!fs[a16_0x5ed6ea(0xa8)](dir)&&fs['mkdirSync'](dir);function a16_0x73be(){const _0x22c210=['in\x20listFolderStructure\x20folderLocation=','resolve','folderLocation','1570eohGup','mkdirSync','\x20show_folders:','express','email','admin','readdirSync','loginFeatureEnabled','role','2823MRjIMT','push','Router','3493640xfWicn','6442002PXgLHn','./uploads/','../libs/mysql','children','175511AVKkMs','MY\x20FOLDER','mtime','query','\x20\x20\x20','user','forEach','cvjs_debug','folder_name','log','Invalid\x20user','isDirectory','size','└──\x20','crypto','Error!\x20Something\x20went\x20wrong.','153827kgBreq','status','../libs/jwt','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','existsSync','get','├──\x20','verifyTokenOptional','filename','sort','join','path','json','false','readFileSync','cvhs_debug:','length','2123712onIJxY','birthtime','224kBJKcz','1002776zmPwEs','promise','parse'];a16_0x73be=function(){return _0x22c210;};return a16_0x73be();}const sortFoldersFirst=(_0x21f7f7,_0x13098d)=>{const _0x2bbb62=a16_0x5ed6ea;if(_0x21f7f7[_0x2bbb62(0xce)]&&!_0x13098d[_0x2bbb62(0xce)])return-0x1;else return!_0x21f7f7[_0x2bbb62(0xce)]&&_0x13098d['children']?0x1:0x0;},listFolderStructure=(_0x564e4e,_0x381c2d='')=>{const _0x4c0804=a16_0x5ed6ea,_0x15f248=fs[_0x4c0804(0xc4)](_0x564e4e),_0x234a12=[];return _0x15f248[_0x4c0804(0x9a)](_0x2cb19c=>{const _0x3fd3bd=_0x4c0804,_0x17a353=path[_0x3fd3bd(0xae)](_0x564e4e,_0x2cb19c),_0x52647a=fs['statSync'](_0x17a353);if(_0x52647a[_0x3fd3bd(0x9f)]()){if(config['cvjs_debug']&&show_folders)console[_0x3fd3bd(0x9d)](_0x381c2d+_0x3fd3bd(0xa1)+_0x2cb19c);const _0x404df6=listFolderStructure(_0x17a353,_0x381c2d+_0x3fd3bd(0x98));_0x234a12[_0x3fd3bd(0xc8)]({'name':_0x2cb19c,'path':_0x17a353,'size':_0x52647a['size'],'created':_0x52647a[_0x3fd3bd(0xb6)],'modified':_0x52647a[_0x3fd3bd(0xd1)],'isFolder':!![],'children':_0x404df6});}else{_0x234a12['push']({'name':_0x2cb19c,'path':_0x17a353,'size':_0x52647a[_0x3fd3bd(0xa0)],'created':_0x52647a[_0x3fd3bd(0xb6)],'modified':_0x52647a[_0x3fd3bd(0xd1)],'isFolder':![]});if(config[_0x3fd3bd(0x9b)]&&show_folders)console['log'](_0x381c2d+_0x3fd3bd(0xaa)+_0x2cb19c);}}),_0x234a12[_0x4c0804(0xad)](sortFoldersFirst);};router[a16_0x5ed6ea(0xa9)]('',verifyTokenOptional,async(_0x4abf82,_0xcf87c2)=>{const _0x38bea2=a16_0x5ed6ea,_0x3eccba=path[_0x38bea2(0xae)](path['dirname'](require['main'][_0x38bea2(0xac)]),'CADViewer_config.json'),_0x4e7dbd=JSON[_0x38bea2(0xba)](fs[_0x38bea2(0xb2)](_0x3eccba,'utf8')),_0x14e98c=_0x4abf82[_0x38bea2(0x97)][_0x38bea2(0xc5)];let _0x5f1980=_0x4e7dbd['folderLocationDemoUser'];_0x14e98c===_0x38bea2(0xb1)&&(_0x5f1980=_0x4e7dbd[_0x38bea2(0xbd)]);console['log'](_0x38bea2(0xbb)+_0x5f1980+_0x38bea2(0xc0)+show_folders+_0x38bea2(0xb3)+config[_0x38bea2(0x9b)]);if(_0x4abf82[_0x38bea2(0x99)]){let _0x4f4bdb;try{const [_0x5e48db]=await conn[_0x38bea2(0xb9)]()['execute'](_0x38bea2(0xa7),[_0x4abf82['user'][_0x38bea2(0xc2)]]);_0x5e48db[_0x38bea2(0xb4)]>0x0&&(_0x4f4bdb=_0x5e48db[0x0]);}catch(_0x5d3147){console[_0x38bea2(0x9d)]({'err':_0x5d3147}),_0xcf87c2[_0x38bea2(0xa5)](0x1f4)[_0x38bea2(0xb0)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x4f4bdb){_0xcf87c2[_0x38bea2(0xa5)](0x191)[_0x38bea2(0xb0)]({'error':_0x38bea2(0x9e)});return;}_0x4f4bdb[_0x38bea2(0xc6)]===_0x38bea2(0xc3)&&(_0x5f1980=_0x4e7dbd[_0x38bea2(0xbd)]);let _0x23d86d=_0x4f4bdb[_0x38bea2(0x9c)];if(!_0x23d86d){_0x23d86d=randomUUID();try{await conn[_0x38bea2(0xb9)]()['execute']('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x23d86d,_0x4abf82[_0x38bea2(0x99)][_0x38bea2(0xc2)]]);}catch(_0x4418a2){console['log']({'err':_0x4418a2}),_0xcf87c2[_0x38bea2(0xa5)](0x1f4)['json']({'error':_0x38bea2(0xa3)});return;}}const _0x508734=_0x38bea2(0xcc)+_0x23d86d;!fs[_0x38bea2(0xa8)](_0x508734)&&fs[_0x38bea2(0xbf)](_0x508734);const _0x164380=path[_0x38bea2(0xbc)](_0x508734),_0x541448=listFolderStructure(_0x164380);!fs[_0x38bea2(0xa8)](_0x5f1980)&&fs['mkdirSync'](_0x5f1980),dirs=[{'own':!![],'name':_0x38bea2(0xd0),'path':_0x508734,'isFolder':!![],'children':_0x541448},...listFolderStructure(_0x5f1980)],_0xcf87c2['send'](dirs);}else!fs['existsSync'](_0x5f1980)&&fs[_0x38bea2(0xbf)](_0x5f1980),_0xcf87c2['send'](listFolderStructure(_0x5f1980));}),module['exports']=router;