const a15_0x5bf088=a15_0x52bb;(function(_0x36f36c,_0x17c351){const _0x3b904e=a15_0x52bb,_0x5c6d2a=_0x36f36c();while(!![]){try{const _0x41ff66=parseInt(_0x3b904e(0x16d))/0x1*(-parseInt(_0x3b904e(0x192))/0x2)+-parseInt(_0x3b904e(0x16f))/0x3*(-parseInt(_0x3b904e(0x175))/0x4)+parseInt(_0x3b904e(0x18c))/0x5*(parseInt(_0x3b904e(0x1a1))/0x6)+-parseInt(_0x3b904e(0x172))/0x7+parseInt(_0x3b904e(0x176))/0x8+parseInt(_0x3b904e(0x180))/0x9+parseInt(_0x3b904e(0x196))/0xa*(-parseInt(_0x3b904e(0x16c))/0xb);if(_0x41ff66===_0x17c351)break;else _0x5c6d2a['push'](_0x5c6d2a['shift']());}catch(_0x5b91a1){_0x5c6d2a['push'](_0x5c6d2a['shift']());}}}(a15_0x49b3,0x207c8));function a15_0x52bb(_0x45014,_0x4b5a7f){const _0x49b3b9=a15_0x49b3();return a15_0x52bb=function(_0x52bbac,_0x45475a){_0x52bbac=_0x52bbac-0x166;let _0x4ae458=_0x49b3b9[_0x52bbac];return _0x4ae458;},a15_0x52bb(_0x45014,_0x4b5a7f);}function a15_0x49b3(){const _0x100706=['MY\x20FOLDER','../CADViewer_config.json','Error!\x20Something\x20went\x20wrong.','Invalid\x20user','\x20show_folders:','email','children','crypto','in\x20listFolderStructure\x20folderLocation=','resolve','4650yrqnwC','size','push','cvhs_debug:','cvjs_debug','CADViewer_config.json','statSync','exports','220hpjdLq','1MBLaIG','readdirSync','22719sXRWpo','execute','log','1025864jeSbBO','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','send','4IMRfcD','1563264lJzzbT','existsSync','dirname','folder_name','query','json','path','birthtime','length','utf8','1656153JJHPRq','join','../libs/mysql','mkdirSync','parse','verifyTokenOptional','isDirectory','express','false','forEach','sort','main','1105YkCPhL','admin','role','./uploads','user','mtime','210274nGwCWQ','folderLocation','Router','promise','86760WOMhVL'];a15_0x49b3=function(){return _0x100706;};return a15_0x49b3();}const fs=require('fs'),path=require(a15_0x5bf088(0x17c)),config=require(a15_0x5bf088(0x198)),verifyTokenOptional=require('../libs/jwt')[a15_0x5bf088(0x185)],show_folders=![],express=require(a15_0x5bf088(0x187)),router=express[a15_0x5bf088(0x194)](),conn=require(a15_0x5bf088(0x182)),{randomUUID}=require(a15_0x5bf088(0x19e)),dir=a15_0x5bf088(0x18f);!fs['existsSync'](dir)&&fs[a15_0x5bf088(0x183)](dir);const sortFoldersFirst=(_0x2f5d9a,_0x29dada)=>{const _0x4b9116=a15_0x5bf088;if(_0x2f5d9a['children']&&!_0x29dada['children'])return-0x1;else return!_0x2f5d9a[_0x4b9116(0x19d)]&&_0x29dada[_0x4b9116(0x19d)]?0x1:0x0;},listFolderStructure=(_0xd17a70,_0x1992fd='')=>{const _0x3a0a3b=a15_0x5bf088,_0x3b219b=fs[_0x3a0a3b(0x16e)](_0xd17a70),_0x31582f=[];return _0x3b219b[_0x3a0a3b(0x189)](_0x35faef=>{const _0x5862c6=_0x3a0a3b,_0x1fd3ed=path[_0x5862c6(0x181)](_0xd17a70,_0x35faef),_0x3bdc92=fs[_0x5862c6(0x16a)](_0x1fd3ed);if(_0x3bdc92[_0x5862c6(0x186)]()){if(config[_0x5862c6(0x168)]&&show_folders)console[_0x5862c6(0x171)](_0x1992fd+'└──\x20'+_0x35faef);const _0x42e554=listFolderStructure(_0x1fd3ed,_0x1992fd+'\x20\x20\x20');_0x31582f[_0x5862c6(0x166)]({'name':_0x35faef,'path':_0x1fd3ed,'size':_0x3bdc92[_0x5862c6(0x1a2)],'created':_0x3bdc92[_0x5862c6(0x17d)],'modified':_0x3bdc92[_0x5862c6(0x191)],'isFolder':!![],'children':_0x42e554});}else{_0x31582f[_0x5862c6(0x166)]({'name':_0x35faef,'path':_0x1fd3ed,'size':_0x3bdc92[_0x5862c6(0x1a2)],'created':_0x3bdc92[_0x5862c6(0x17d)],'modified':_0x3bdc92['mtime'],'isFolder':![]});if(config[_0x5862c6(0x168)]&&show_folders)console['log'](_0x1992fd+'├──\x20'+_0x35faef);}}),_0x31582f[_0x3a0a3b(0x18a)](sortFoldersFirst);};router['get']('',verifyTokenOptional,async(_0x2c7d2f,_0x5011c0)=>{const _0x315f25=a15_0x5bf088,_0x9bfeac=path[_0x315f25(0x181)](path[_0x315f25(0x178)](require[_0x315f25(0x18b)]['filename']),_0x315f25(0x169)),_0x555dce=JSON[_0x315f25(0x184)](fs['readFileSync'](_0x9bfeac,_0x315f25(0x17f))),_0x53828a=_0x2c7d2f[_0x315f25(0x17a)]['loginFeatureEnabled'];let _0x3e4948=_0x555dce['folderLocationDemoUser'];_0x53828a===_0x315f25(0x188)&&(_0x3e4948=_0x555dce[_0x315f25(0x193)]);console['log'](_0x315f25(0x19f)+_0x3e4948+_0x315f25(0x19b)+show_folders+_0x315f25(0x167)+config[_0x315f25(0x168)]);if(_0x2c7d2f[_0x315f25(0x190)]){let _0x5dcc3c;try{const [_0x225411]=await conn[_0x315f25(0x195)]()[_0x315f25(0x170)](_0x315f25(0x173),[_0x2c7d2f['user'][_0x315f25(0x19c)]]);_0x225411[_0x315f25(0x17e)]>0x0&&(_0x5dcc3c=_0x225411[0x0]);}catch(_0x3b09c5){console[_0x315f25(0x171)]({'err':_0x3b09c5}),_0x5011c0['status'](0x1f4)[_0x315f25(0x17b)]({'error':_0x315f25(0x199)});return;}if(!_0x5dcc3c){_0x5011c0['status'](0x191)[_0x315f25(0x17b)]({'error':_0x315f25(0x19a)});return;}_0x5dcc3c[_0x315f25(0x18e)]===_0x315f25(0x18d)&&(_0x3e4948=_0x555dce['folderLocation']);let _0x415540=_0x5dcc3c[_0x315f25(0x179)];if(!_0x415540){_0x415540=randomUUID();try{await conn[_0x315f25(0x195)]()[_0x315f25(0x170)]('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x415540,_0x2c7d2f['user'][_0x315f25(0x19c)]]);}catch(_0x281b62){console[_0x315f25(0x171)]({'err':_0x281b62}),_0x5011c0['status'](0x1f4)[_0x315f25(0x17b)]({'error':_0x315f25(0x199)});return;}}const _0x91b675='./uploads/'+_0x415540;!fs[_0x315f25(0x177)](_0x91b675)&&fs[_0x315f25(0x183)](_0x91b675);const _0x4ec9d6=path[_0x315f25(0x1a0)](_0x91b675),_0xc25f27=listFolderStructure(_0x4ec9d6);!fs[_0x315f25(0x177)](_0x3e4948)&&fs[_0x315f25(0x183)](_0x3e4948),dirs=[{'own':!![],'name':_0x315f25(0x197),'path':_0x91b675,'isFolder':!![],'children':_0xc25f27},...listFolderStructure(_0x3e4948)],_0x5011c0[_0x315f25(0x174)](dirs);}else!fs['existsSync'](_0x3e4948)&&fs[_0x315f25(0x183)](_0x3e4948),_0x5011c0[_0x315f25(0x174)](listFolderStructure(_0x3e4948));}),module[a15_0x5bf088(0x16b)]=router;