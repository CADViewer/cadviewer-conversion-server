const a15_0x3b0cfb=a15_0x321b;(function(_0x48bd3f,_0x46415d){const _0x32b906=a15_0x321b,_0x26f530=_0x48bd3f();while(!![]){try{const _0x4041d9=parseInt(_0x32b906(0x186))/0x1*(-parseInt(_0x32b906(0x1b8))/0x2)+parseInt(_0x32b906(0x1af))/0x3*(-parseInt(_0x32b906(0x19c))/0x4)+parseInt(_0x32b906(0x180))/0x5+-parseInt(_0x32b906(0x18b))/0x6*(-parseInt(_0x32b906(0x1a9))/0x7)+parseInt(_0x32b906(0x19b))/0x8+-parseInt(_0x32b906(0x1ae))/0x9+-parseInt(_0x32b906(0x1b6))/0xa;if(_0x4041d9===_0x46415d)break;else _0x26f530['push'](_0x26f530['shift']());}catch(_0x58c46e){_0x26f530['push'](_0x26f530['shift']());}}}(a15_0x3b2c,0x1b002));function a15_0x3b2c(){const _0x4f7d00=['statSync','loginFeatureEnabled','folder_name','log','1004760AwkAAd','51gulUOZ','parse','Invalid\x20user','admin','send','exports','main','627160FAhTTl','./uploads/','61342FadjpN','readFileSync','mtime','crypto','../CADViewer_config.json','resolve','1070665yznhDU','status','path','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','sort','../libs/mysql','1lxePaY','dirname','execute','cvjs_debug','filename','624096dtZxpR','express','\x20show_folders:','cvhs_debug:','existsSync','verifyTokenOptional','children','isDirectory','├──\x20','role','mkdirSync','email','size','get','CADViewer_config.json','push','1074984pAEVvq','32212RmnVre','join','false','in\x20listFolderStructure\x20folderLocation=','└──\x20','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','folderLocation','user','readdirSync','MY\x20FOLDER','length','Error!\x20Something\x20went\x20wrong.','json','7bFmynQ'];a15_0x3b2c=function(){return _0x4f7d00;};return a15_0x3b2c();}const fs=require('fs'),path=require(a15_0x3b0cfb(0x182)),config=require(a15_0x3b0cfb(0x17e)),verifyTokenOptional=require('../libs/jwt')[a15_0x3b0cfb(0x190)],show_folders=![],express=require(a15_0x3b0cfb(0x18c)),router=express['Router'](),conn=require(a15_0x3b0cfb(0x185)),{randomUUID}=require(a15_0x3b0cfb(0x1bb)),dir='./uploads';!fs[a15_0x3b0cfb(0x18f)](dir)&&fs[a15_0x3b0cfb(0x195)](dir);const sortFoldersFirst=(_0x3db4de,_0x53f5d7)=>{const _0x17f0c5=a15_0x3b0cfb;if(_0x3db4de[_0x17f0c5(0x191)]&&!_0x53f5d7['children'])return-0x1;else return!_0x3db4de[_0x17f0c5(0x191)]&&_0x53f5d7[_0x17f0c5(0x191)]?0x1:0x0;},listFolderStructure=(_0x4e0a23,_0x1027ba='')=>{const _0x5a3b55=a15_0x3b0cfb,_0x3704c2=fs[_0x5a3b55(0x1a4)](_0x4e0a23),_0x54192f=[];return _0x3704c2['forEach'](_0xc3b88d=>{const _0x311002=_0x5a3b55,_0x446c35=path[_0x311002(0x19d)](_0x4e0a23,_0xc3b88d),_0x1846f9=fs[_0x311002(0x1aa)](_0x446c35);if(_0x1846f9[_0x311002(0x192)]()){if(config['cvjs_debug']&&show_folders)console[_0x311002(0x1ad)](_0x1027ba+_0x311002(0x1a0)+_0xc3b88d);const _0x778ceb=listFolderStructure(_0x446c35,_0x1027ba+'\x20\x20\x20');_0x54192f[_0x311002(0x19a)]({'name':_0xc3b88d,'path':_0x446c35,'size':_0x1846f9[_0x311002(0x197)],'created':_0x1846f9['birthtime'],'modified':_0x1846f9[_0x311002(0x1ba)],'isFolder':!![],'children':_0x778ceb});}else{_0x54192f['push']({'name':_0xc3b88d,'path':_0x446c35,'size':_0x1846f9[_0x311002(0x197)],'created':_0x1846f9['birthtime'],'modified':_0x1846f9['mtime'],'isFolder':![]});if(config[_0x311002(0x189)]&&show_folders)console[_0x311002(0x1ad)](_0x1027ba+_0x311002(0x193)+_0xc3b88d);}}),_0x54192f[_0x5a3b55(0x184)](sortFoldersFirst);};function a15_0x321b(_0x1682c8,_0x34a69b){const _0x3b2c52=a15_0x3b2c();return a15_0x321b=function(_0x321bf8,_0x6fb001){_0x321bf8=_0x321bf8-0x17e;let _0x5690a1=_0x3b2c52[_0x321bf8];return _0x5690a1;},a15_0x321b(_0x1682c8,_0x34a69b);}router[a15_0x3b0cfb(0x198)]('',verifyTokenOptional,async(_0x11a253,_0x53be8f)=>{const _0x500621=a15_0x3b0cfb,_0x5aefb0=path['join'](path[_0x500621(0x187)](require[_0x500621(0x1b5)][_0x500621(0x18a)]),_0x500621(0x199)),_0x1443a2=JSON[_0x500621(0x1b0)](fs[_0x500621(0x1b9)](_0x5aefb0,'utf8')),_0x26512d=_0x11a253['query'][_0x500621(0x1ab)];let _0x26396b=_0x1443a2['folderLocationDemoUser'];_0x26512d===_0x500621(0x19e)&&(_0x26396b=_0x1443a2[_0x500621(0x1a2)]);console[_0x500621(0x1ad)](_0x500621(0x19f)+_0x26396b+_0x500621(0x18d)+show_folders+_0x500621(0x18e)+config['cvjs_debug']);if(_0x11a253['user']){let _0x58ec9c;try{const [_0x45768d]=await conn['promise']()['execute'](_0x500621(0x1a1),[_0x11a253[_0x500621(0x1a3)][_0x500621(0x196)]]);_0x45768d[_0x500621(0x1a6)]>0x0&&(_0x58ec9c=_0x45768d[0x0]);}catch(_0x4a9550){console[_0x500621(0x1ad)]({'err':_0x4a9550}),_0x53be8f['status'](0x1f4)[_0x500621(0x1a8)]({'error':_0x500621(0x1a7)});return;}if(!_0x58ec9c){_0x53be8f[_0x500621(0x181)](0x191)['json']({'error':_0x500621(0x1b1)});return;}_0x58ec9c[_0x500621(0x194)]===_0x500621(0x1b2)&&(_0x26396b=_0x1443a2[_0x500621(0x1a2)]);let _0x3cf787=_0x58ec9c[_0x500621(0x1ac)];if(!_0x3cf787){_0x3cf787=randomUUID();try{await conn['promise']()[_0x500621(0x188)](_0x500621(0x183),[_0x3cf787,_0x11a253['user'][_0x500621(0x196)]]);}catch(_0x2cd9c5){console['log']({'err':_0x2cd9c5}),_0x53be8f['status'](0x1f4)[_0x500621(0x1a8)]({'error':_0x500621(0x1a7)});return;}}const _0x3e73b8=_0x500621(0x1b7)+_0x3cf787;!fs['existsSync'](_0x3e73b8)&&fs[_0x500621(0x195)](_0x3e73b8);const _0x32482b=path[_0x500621(0x17f)](_0x3e73b8),_0x23fac1=listFolderStructure(_0x32482b);!fs[_0x500621(0x18f)](_0x26396b)&&fs['mkdirSync'](_0x26396b),dirs=[{'own':!![],'name':_0x500621(0x1a5),'path':_0x3e73b8,'isFolder':!![],'children':_0x23fac1},...listFolderStructure(_0x26396b)],_0x53be8f[_0x500621(0x1b3)](dirs);}else!fs[_0x500621(0x18f)](_0x26396b)&&fs[_0x500621(0x195)](_0x26396b),_0x53be8f[_0x500621(0x1b3)](listFolderStructure(_0x26396b));}),module[a15_0x3b0cfb(0x1b4)]=router;