const a15_0x767d16=a15_0x4531;function a15_0x4531(_0x54dff7,_0x86916e){const _0x5bcc3b=a15_0x5bcc();return a15_0x4531=function(_0x453190,_0x15456a){_0x453190=_0x453190-0x183;let _0x565214=_0x5bcc3b[_0x453190];return _0x565214;},a15_0x4531(_0x54dff7,_0x86916e);}(function(_0x470454,_0x39465a){const _0xd22b1d=a15_0x4531,_0x3ed9f8=_0x470454();while(!![]){try{const _0x14aad4=parseInt(_0xd22b1d(0x192))/0x1*(-parseInt(_0xd22b1d(0x189))/0x2)+-parseInt(_0xd22b1d(0x188))/0x3+-parseInt(_0xd22b1d(0x1aa))/0x4+-parseInt(_0xd22b1d(0x191))/0x5*(parseInt(_0xd22b1d(0x1af))/0x6)+-parseInt(_0xd22b1d(0x1ad))/0x7*(parseInt(_0xd22b1d(0x193))/0x8)+-parseInt(_0xd22b1d(0x18f))/0x9+parseInt(_0xd22b1d(0x19a))/0xa*(parseInt(_0xd22b1d(0x1a9))/0xb);if(_0x14aad4===_0x39465a)break;else _0x3ed9f8['push'](_0x3ed9f8['shift']());}catch(_0x3bc46c){_0x3ed9f8['push'](_0x3ed9f8['shift']());}}}(a15_0x5bcc,0xd6848));function a15_0x5bcc(){const _0x2f189f=['SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','size','readdirSync','statSync','execute','send','log','mtime','208043wGYwwY','4096760NEyszU','exports','filename','133VDDRZF','forEach','1734594QPoLXc','Error!\x20Something\x20went\x20wrong.','email','cvjs_debug','verifyTokenOptional','\x20show_folders:','MY\x20FOLDER','json','path','length','dirname','birthtime','main','../libs/jwt','./uploads','mkdirSync','CADViewer_config.json','parse','role','folder_name','loginFeatureEnabled','424941rpYCnZ','540RNlwkx','../libs/mysql','utf8','express','├──\x20','children','4484142IpWxSg','promise','10RfFTBF','2031ztpXbv','429944CgSmMI','user','in\x20listFolderStructure\x20folderLocation=','join','\x20\x20\x20','existsSync','folderLocation','2480EfTHiq','status','admin','query','../CADViewer_config.json','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','Router'];a15_0x5bcc=function(){return _0x2f189f;};return a15_0x5bcc();}const fs=require('fs'),path=require(a15_0x767d16(0x1b7)),config=require(a15_0x767d16(0x19e)),verifyTokenOptional=require(a15_0x767d16(0x1bc))[a15_0x767d16(0x1b3)],show_folders=![],express=require(a15_0x767d16(0x18c)),router=express[a15_0x767d16(0x1a0)](),conn=require(a15_0x767d16(0x18a)),{randomUUID}=require('crypto'),dir=a15_0x767d16(0x1bd);!fs['existsSync'](dir)&&fs[a15_0x767d16(0x1be)](dir);const sortFoldersFirst=(_0x79e332,_0x2e9819)=>{const _0x47b203=a15_0x767d16;if(_0x79e332[_0x47b203(0x18e)]&&!_0x2e9819[_0x47b203(0x18e)])return-0x1;else return!_0x79e332['children']&&_0x2e9819[_0x47b203(0x18e)]?0x1:0x0;},listFolderStructure=(_0x1161c5,_0x50e13f='')=>{const _0x3da8eb=a15_0x767d16,_0xaaf9ba=fs[_0x3da8eb(0x1a3)](_0x1161c5),_0x36be07=[];return _0xaaf9ba[_0x3da8eb(0x1ae)](_0x3558f2=>{const _0x14c0c2=_0x3da8eb,_0x2c0323=path['join'](_0x1161c5,_0x3558f2),_0x21f106=fs[_0x14c0c2(0x1a4)](_0x2c0323);if(_0x21f106['isDirectory']()){if(config[_0x14c0c2(0x1b2)]&&show_folders)console['log'](_0x50e13f+'└──\x20'+_0x3558f2);const _0x2c97a9=listFolderStructure(_0x2c0323,_0x50e13f+_0x14c0c2(0x197));_0x36be07['push']({'name':_0x3558f2,'path':_0x2c0323,'size':_0x21f106[_0x14c0c2(0x1a2)],'created':_0x21f106[_0x14c0c2(0x1ba)],'modified':_0x21f106['mtime'],'isFolder':!![],'children':_0x2c97a9});}else{_0x36be07['push']({'name':_0x3558f2,'path':_0x2c0323,'size':_0x21f106['size'],'created':_0x21f106[_0x14c0c2(0x1ba)],'modified':_0x21f106[_0x14c0c2(0x1a8)],'isFolder':![]});if(config[_0x14c0c2(0x1b2)]&&show_folders)console['log'](_0x50e13f+_0x14c0c2(0x18d)+_0x3558f2);}}),_0x36be07['sort'](sortFoldersFirst);};router['get']('',verifyTokenOptional,async(_0x2b0ef7,_0xf689ed)=>{const _0x15a0d1=a15_0x767d16,_0x9a0c92=path[_0x15a0d1(0x196)](path[_0x15a0d1(0x1b9)](require[_0x15a0d1(0x1bb)][_0x15a0d1(0x1ac)]),_0x15a0d1(0x183)),_0x188e7e=JSON[_0x15a0d1(0x184)](fs['readFileSync'](_0x9a0c92,_0x15a0d1(0x18b))),_0x23e7e3=_0x2b0ef7[_0x15a0d1(0x19d)][_0x15a0d1(0x187)];let _0x1e2f62=_0x188e7e['folderLocationDemoUser'];_0x23e7e3==='false'&&(_0x1e2f62=_0x188e7e['folderLocation']);console[_0x15a0d1(0x1a7)](_0x15a0d1(0x195)+_0x1e2f62+_0x15a0d1(0x1b4)+show_folders+'cvhs_debug:'+config[_0x15a0d1(0x1b2)]);if(_0x2b0ef7[_0x15a0d1(0x194)]){let _0x28041b;try{const [_0x29c338]=await conn[_0x15a0d1(0x190)]()[_0x15a0d1(0x1a5)](_0x15a0d1(0x1a1),[_0x2b0ef7[_0x15a0d1(0x194)][_0x15a0d1(0x1b1)]]);_0x29c338[_0x15a0d1(0x1b8)]>0x0&&(_0x28041b=_0x29c338[0x0]);}catch(_0x17bf9b){console[_0x15a0d1(0x1a7)]({'err':_0x17bf9b}),_0xf689ed[_0x15a0d1(0x19b)](0x1f4)[_0x15a0d1(0x1b6)]({'error':_0x15a0d1(0x1b0)});return;}if(!_0x28041b){_0xf689ed[_0x15a0d1(0x19b)](0x191)['json']({'error':'Invalid\x20user'});return;}_0x28041b[_0x15a0d1(0x185)]===_0x15a0d1(0x19c)&&(_0x1e2f62=_0x188e7e[_0x15a0d1(0x199)]);let _0x24b460=_0x28041b[_0x15a0d1(0x186)];if(!_0x24b460){_0x24b460=randomUUID();try{await conn[_0x15a0d1(0x190)]()[_0x15a0d1(0x1a5)](_0x15a0d1(0x19f),[_0x24b460,_0x2b0ef7['user']['email']]);}catch(_0x172d2f){console[_0x15a0d1(0x1a7)]({'err':_0x172d2f}),_0xf689ed[_0x15a0d1(0x19b)](0x1f4)[_0x15a0d1(0x1b6)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x329944='./uploads/'+_0x24b460;!fs[_0x15a0d1(0x198)](_0x329944)&&fs[_0x15a0d1(0x1be)](_0x329944);const _0x1cf61c=path['resolve'](_0x329944),_0x3e8471=listFolderStructure(_0x1cf61c);!fs['existsSync'](_0x1e2f62)&&fs[_0x15a0d1(0x1be)](_0x1e2f62),dirs=[{'own':!![],'name':_0x15a0d1(0x1b5),'path':_0x329944,'isFolder':!![],'children':_0x3e8471},...listFolderStructure(_0x1e2f62)],_0xf689ed[_0x15a0d1(0x1a6)](dirs);}else!fs[_0x15a0d1(0x198)](_0x1e2f62)&&fs[_0x15a0d1(0x1be)](_0x1e2f62),_0xf689ed['send'](listFolderStructure(_0x1e2f62));}),module[a15_0x767d16(0x1ab)]=router;