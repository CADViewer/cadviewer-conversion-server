const a15_0x139d6f=a15_0x2bb6;(function(_0x2b0ed6,_0x596140){const _0x4cf95a=a15_0x2bb6,_0x49b60d=_0x2b0ed6();while(!![]){try{const _0x189035=parseInt(_0x4cf95a(0x175))/0x1*(-parseInt(_0x4cf95a(0x167))/0x2)+-parseInt(_0x4cf95a(0x161))/0x3+-parseInt(_0x4cf95a(0x163))/0x4+parseInt(_0x4cf95a(0x158))/0x5*(-parseInt(_0x4cf95a(0x176))/0x6)+-parseInt(_0x4cf95a(0x170))/0x7*(parseInt(_0x4cf95a(0x166))/0x8)+-parseInt(_0x4cf95a(0x152))/0x9*(-parseInt(_0x4cf95a(0x16f))/0xa)+parseInt(_0x4cf95a(0x15f))/0xb;if(_0x189035===_0x596140)break;else _0x49b60d['push'](_0x49b60d['shift']());}catch(_0x44ae0a){_0x49b60d['push'](_0x49b60d['shift']());}}}(a15_0x1b24,0x75479));const fs=require('fs'),path=require(a15_0x139d6f(0x17f)),config=require('../CADViewer_config.json'),verifyTokenOptional=require('../libs/jwt')[a15_0x139d6f(0x16b)],show_folders=![],express=require(a15_0x139d6f(0x171)),router=express[a15_0x139d6f(0x15c)](),conn=require(a15_0x139d6f(0x160)),{randomUUID}=require(a15_0x139d6f(0x162)),dir=a15_0x139d6f(0x17c);!fs[a15_0x139d6f(0x159)](dir)&&fs[a15_0x139d6f(0x15e)](dir);function a15_0x2bb6(_0x43b67e,_0x25b71f){const _0x1b2411=a15_0x1b24();return a15_0x2bb6=function(_0x2bb6bc,_0x5a8693){_0x2bb6bc=_0x2bb6bc-0x152;let _0x5ef992=_0x1b2411[_0x2bb6bc];return _0x5ef992;},a15_0x2bb6(_0x43b67e,_0x25b71f);}function a15_0x1b24(){const _0x1fa37d=['10IKAepX','28XDClHV','express','./uploads/','user','cvjs_debug','309841vEVvze','12PsfDpa','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','send','size','MY\x20FOLDER','./uploads','log','├──\x20','path','sort','Invalid\x20user','2844333SjjtpP','status','execute','folder_name','mtime','json','1175035hheyGa','existsSync','promise','birthtime','Router','push','mkdirSync','28143907DcRWcs','../libs/mysql','2542512dbDsQW','crypto','2957544taYzxx','join','Error!\x20Something\x20went\x20wrong.','54904RLEHEX','2jwclZM','children','readdirSync','\x20show_folders:','verifyTokenOptional','get','└──\x20','resolve'];a15_0x1b24=function(){return _0x1fa37d;};return a15_0x1b24();}const sortFoldersFirst=(_0x198658,_0x381c8a)=>{const _0x4ddf9d=a15_0x139d6f;if(_0x198658[_0x4ddf9d(0x168)]&&!_0x381c8a[_0x4ddf9d(0x168)])return-0x1;else return!_0x198658[_0x4ddf9d(0x168)]&&_0x381c8a[_0x4ddf9d(0x168)]?0x1:0x0;},listFolderStructure=(_0x4344ff,_0xb40aa5='')=>{const _0x2ec6f7=a15_0x139d6f,_0x53ee4c=fs[_0x2ec6f7(0x169)](_0x4344ff),_0x54d639=[];return _0x53ee4c['forEach'](_0x53bafc=>{const _0x1f94df=_0x2ec6f7,_0x3e2d14=path[_0x1f94df(0x164)](_0x4344ff,_0x53bafc),_0x518143=fs['statSync'](_0x3e2d14);if(_0x518143['isDirectory']()){if(config[_0x1f94df(0x174)]&&show_folders)console[_0x1f94df(0x17d)](_0xb40aa5+_0x1f94df(0x16d)+_0x53bafc);const _0x19c503=listFolderStructure(_0x3e2d14,_0xb40aa5+'\x20\x20\x20');_0x54d639[_0x1f94df(0x15d)]({'name':_0x53bafc,'path':_0x3e2d14,'size':_0x518143[_0x1f94df(0x17a)],'created':_0x518143[_0x1f94df(0x15b)],'modified':_0x518143[_0x1f94df(0x156)],'isFolder':!![],'children':_0x19c503});}else{_0x54d639[_0x1f94df(0x15d)]({'name':_0x53bafc,'path':_0x3e2d14,'size':_0x518143[_0x1f94df(0x17a)],'created':_0x518143[_0x1f94df(0x15b)],'modified':_0x518143['mtime'],'isFolder':![]});if(config[_0x1f94df(0x174)]&&show_folders)console[_0x1f94df(0x17d)](_0xb40aa5+_0x1f94df(0x17e)+_0x53bafc);}}),_0x54d639[_0x2ec6f7(0x180)](sortFoldersFirst);};router[a15_0x139d6f(0x16c)]('',verifyTokenOptional,async(_0x16c665,_0x5c75e7)=>{const _0x3aea64=a15_0x139d6f,_0x31f749=config['folderLocation'];console[_0x3aea64(0x17d)]('in\x20listFolderStructure\x20folderLocation='+_0x31f749+_0x3aea64(0x16a)+show_folders+'cvhs_debug:'+config[_0x3aea64(0x174)]);let _0x2664bf=listFolderStructure(_0x31f749);if(_0x16c665['user']){let _0x3670d1;try{const [_0x32330f]=await conn[_0x3aea64(0x15a)]()['execute'](_0x3aea64(0x178),[_0x16c665[_0x3aea64(0x173)]['email']]);_0x32330f['length']>0x0&&(_0x3670d1=_0x32330f[0x0]);}catch(_0x3ffa97){console[_0x3aea64(0x17d)]({'err':_0x3ffa97}),_0x5c75e7[_0x3aea64(0x153)](0x1f4)['json']({'error':_0x3aea64(0x165)});return;}if(!_0x3670d1){_0x5c75e7['status'](0x191)[_0x3aea64(0x157)]({'error':_0x3aea64(0x181)});return;}let _0x44d78c=_0x3670d1[_0x3aea64(0x155)];if(!_0x44d78c){_0x44d78c=randomUUID();try{await conn['promise']()[_0x3aea64(0x154)](_0x3aea64(0x177),[_0x44d78c,_0x16c665[_0x3aea64(0x173)]['email']]);}catch(_0x1f2101){console[_0x3aea64(0x17d)]({'err':_0x1f2101}),_0x5c75e7[_0x3aea64(0x153)](0x1f4)[_0x3aea64(0x157)]({'error':_0x3aea64(0x165)});return;}}const _0x314c8b=_0x3aea64(0x172)+_0x44d78c;!fs[_0x3aea64(0x159)](_0x314c8b)&&fs[_0x3aea64(0x15e)](_0x314c8b);const _0x3aa0b2=path[_0x3aea64(0x16e)](_0x314c8b),_0x33a3b9=listFolderStructure(_0x3aa0b2);_0x2664bf=[{'own':!![],'name':_0x3aea64(0x17b),'path':_0x314c8b,'isFolder':!![],'children':_0x33a3b9},..._0x2664bf];}_0x5c75e7[_0x3aea64(0x179)](_0x2664bf);}),module['exports']=router;