const a15_0x34c801=a15_0x4972;(function(_0x5474f8,_0x7b55ba){const _0x209dc4=a15_0x4972,_0x12ad1b=_0x5474f8();while(!![]){try{const _0xe5f843=parseInt(_0x209dc4(0x10b))/0x1*(parseInt(_0x209dc4(0x127))/0x2)+-parseInt(_0x209dc4(0x11f))/0x3+-parseInt(_0x209dc4(0x135))/0x4*(parseInt(_0x209dc4(0x114))/0x5)+-parseInt(_0x209dc4(0x120))/0x6+-parseInt(_0x209dc4(0x12f))/0x7*(parseInt(_0x209dc4(0x134))/0x8)+parseInt(_0x209dc4(0x11a))/0x9*(-parseInt(_0x209dc4(0x126))/0xa)+parseInt(_0x209dc4(0x13b))/0xb;if(_0xe5f843===_0x7b55ba)break;else _0x12ad1b['push'](_0x12ad1b['shift']());}catch(_0x53c2dd){_0x12ad1b['push'](_0x12ad1b['shift']());}}}(a15_0x71bd,0xbe238));const fs=require('fs'),path=require(a15_0x34c801(0x111)),config=require(a15_0x34c801(0x10c)),verifyTokenOptional=require(a15_0x34c801(0x11c))['verifyTokenOptional'],show_folders=![],express=require(a15_0x34c801(0x104)),router=express[a15_0x34c801(0x10e)](),conn=require('../libs/mysql'),{randomUUID}=require(a15_0x34c801(0x139)),dir=a15_0x34c801(0x103);!fs[a15_0x34c801(0x116)](dir)&&fs[a15_0x34c801(0x131)](dir);function a15_0x4972(_0x25d4c0,_0x40b669){const _0x71bd63=a15_0x71bd();return a15_0x4972=function(_0x4972f3,_0x5a5284){_0x4972f3=_0x4972f3-0xfd;let _0x297d7f=_0x71bd63[_0x4972f3];return _0x297d7f;},a15_0x4972(_0x25d4c0,_0x40b669);}const sortFoldersFirst=(_0x3f9e54,_0x345754)=>{const _0x189d9d=a15_0x34c801;if(_0x3f9e54['children']&&!_0x345754[_0x189d9d(0x10f)])return-0x1;else return!_0x3f9e54['children']&&_0x345754[_0x189d9d(0x10f)]?0x1:0x0;},listFolderStructure=(_0x360088,_0x2c1b1d='')=>{const _0x5ac54a=a15_0x34c801,_0x26db49=fs[_0x5ac54a(0x105)](_0x360088),_0x229290=[];return _0x26db49[_0x5ac54a(0x10d)](_0x104696=>{const _0x32f48c=_0x5ac54a,_0x5545cc=path[_0x32f48c(0x119)](_0x360088,_0x104696),_0x3c8872=fs[_0x32f48c(0x138)](_0x5545cc);if(_0x3c8872[_0x32f48c(0x128)]()){if(config[_0x32f48c(0xfe)]&&show_folders)console[_0x32f48c(0x125)](_0x2c1b1d+_0x32f48c(0x124)+_0x104696);const _0x379e55=listFolderStructure(_0x5545cc,_0x2c1b1d+_0x32f48c(0x12b));_0x229290[_0x32f48c(0x11b)]({'name':_0x104696,'path':_0x5545cc,'size':_0x3c8872[_0x32f48c(0x121)],'created':_0x3c8872[_0x32f48c(0x108)],'modified':_0x3c8872[_0x32f48c(0x109)],'isFolder':!![],'children':_0x379e55});}else{_0x229290[_0x32f48c(0x11b)]({'name':_0x104696,'path':_0x5545cc,'size':_0x3c8872[_0x32f48c(0x121)],'created':_0x3c8872[_0x32f48c(0x108)],'modified':_0x3c8872['mtime'],'isFolder':![]});if(config[_0x32f48c(0xfe)]&&show_folders)console[_0x32f48c(0x125)](_0x2c1b1d+_0x32f48c(0x10a)+_0x104696);}}),_0x229290[_0x5ac54a(0x107)](sortFoldersFirst);};function a15_0x71bd(){const _0x446274=['SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','status','Error!\x20Something\x20went\x20wrong.','parse','./uploads','express','readdirSync','length','sort','birthtime','mtime','├──\x20','13myecxo','../CADViewer_config.json','forEach','Router','children','in\x20listFolderStructure\x20folderLocation=','path','promise','CADViewer_config.json','1052885UbsqIB','execute','existsSync','user','folder_name','join','5472swcLWv','push','../libs/jwt','readFileSync','folderLocation','3783048DXcPsm','6995430EDehdR','size','email','get','└──\x20','log','4820wqqkXm','156380XnMAtx','isDirectory','Invalid\x20user','json','\x20\x20\x20','utf8','\x20show_folders:','admin','7smogtB','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','mkdirSync','send','dirname','936016jnANIq','28otdjZK','cvhs_debug:','MY\x20FOLDER','statSync','crypto','query','44806916sqxlqu','main','cvjs_debug'];a15_0x71bd=function(){return _0x446274;};return a15_0x71bd();}router[a15_0x34c801(0x123)]('',verifyTokenOptional,async(_0x591f35,_0x5a5125)=>{const _0x2dbc3b=a15_0x34c801,_0x5296ae=path[_0x2dbc3b(0x119)](path[_0x2dbc3b(0x133)](require[_0x2dbc3b(0xfd)]['filename']),_0x2dbc3b(0x113)),_0x369aa6=JSON[_0x2dbc3b(0x102)](fs[_0x2dbc3b(0x11d)](_0x5296ae,_0x2dbc3b(0x12c))),_0x10d6bd=_0x591f35[_0x2dbc3b(0x13a)]['loginFeatureEnabled'];let _0x75208e=_0x369aa6['folderLocationDemoUser'];_0x10d6bd==='false'&&(_0x75208e=_0x369aa6[_0x2dbc3b(0x11e)]);console[_0x2dbc3b(0x125)](_0x2dbc3b(0x110)+_0x75208e+_0x2dbc3b(0x12d)+show_folders+_0x2dbc3b(0x136)+config[_0x2dbc3b(0xfe)]);if(_0x591f35[_0x2dbc3b(0x117)]){let _0x2d09f9;try{const [_0xabd3d7]=await conn[_0x2dbc3b(0x112)]()[_0x2dbc3b(0x115)](_0x2dbc3b(0xff),[_0x591f35['user']['email']]);_0xabd3d7[_0x2dbc3b(0x106)]>0x0&&(_0x2d09f9=_0xabd3d7[0x0]);}catch(_0x4e3f43){console['log']({'err':_0x4e3f43}),_0x5a5125[_0x2dbc3b(0x100)](0x1f4)[_0x2dbc3b(0x12a)]({'error':_0x2dbc3b(0x101)});return;}if(!_0x2d09f9){_0x5a5125['status'](0x191)['json']({'error':_0x2dbc3b(0x129)});return;}_0x2d09f9['role']===_0x2dbc3b(0x12e)&&(_0x75208e=_0x369aa6[_0x2dbc3b(0x11e)]);let _0x14ca68=_0x2d09f9[_0x2dbc3b(0x118)];if(!_0x14ca68){_0x14ca68=randomUUID();try{await conn[_0x2dbc3b(0x112)]()[_0x2dbc3b(0x115)](_0x2dbc3b(0x130),[_0x14ca68,_0x591f35[_0x2dbc3b(0x117)][_0x2dbc3b(0x122)]]);}catch(_0x5dec54){console[_0x2dbc3b(0x125)]({'err':_0x5dec54}),_0x5a5125[_0x2dbc3b(0x100)](0x1f4)[_0x2dbc3b(0x12a)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x391c16='./uploads/'+_0x14ca68;!fs['existsSync'](_0x391c16)&&fs[_0x2dbc3b(0x131)](_0x391c16);const _0x172c2=path['resolve'](_0x391c16),_0x27bdf8=listFolderStructure(_0x172c2);!fs['existsSync'](_0x75208e)&&fs[_0x2dbc3b(0x131)](_0x75208e),dirs=[{'own':!![],'name':_0x2dbc3b(0x137),'path':_0x391c16,'isFolder':!![],'children':_0x27bdf8},...listFolderStructure(_0x75208e)],_0x5a5125[_0x2dbc3b(0x132)](dirs);}else!fs['existsSync'](_0x75208e)&&fs[_0x2dbc3b(0x131)](_0x75208e),_0x5a5125[_0x2dbc3b(0x132)](listFolderStructure(_0x75208e));}),module['exports']=router;