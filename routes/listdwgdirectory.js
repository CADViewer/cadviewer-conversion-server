const a15_0x537a9f=a15_0x4d8f;(function(_0x4d0a02,_0x571307){const _0x581ad4=a15_0x4d8f,_0x2e2a84=_0x4d0a02();while(!![]){try{const _0x3855a0=-parseInt(_0x581ad4(0xca))/0x1+-parseInt(_0x581ad4(0xc9))/0x2*(-parseInt(_0x581ad4(0xb0))/0x3)+parseInt(_0x581ad4(0xd5))/0x4*(parseInt(_0x581ad4(0xc2))/0x5)+-parseInt(_0x581ad4(0xd8))/0x6+-parseInt(_0x581ad4(0xed))/0x7+-parseInt(_0x581ad4(0xea))/0x8*(parseInt(_0x581ad4(0xba))/0x9)+-parseInt(_0x581ad4(0xc1))/0xa*(-parseInt(_0x581ad4(0xc4))/0xb);if(_0x3855a0===_0x571307)break;else _0x2e2a84['push'](_0x2e2a84['shift']());}catch(_0x33336b){_0x2e2a84['push'](_0x2e2a84['shift']());}}}(a15_0x59b5,0xae8ca));function a15_0x59b5(){const _0x470b23=['email','./uploads','├──\x20','join','folderLocation','../libs/jwt','filename','isDirectory','query','Error!\x20Something\x20went\x20wrong.','../CADViewer_config.json','folderLocationDemoUser','11279824vDWGtc','mkdirSync','user','2250913YscWIA','1155909aFamgC','Router','birthtime','exports','./uploads/','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','crypto','children','in\x20listFolderStructure\x20folderLocation=','verifyTokenOptional','9arUxur','send','mtime','\x20\x20\x20','length','sort','json','230azfDAu','95905SAhQDP','execute','1746327rmNhSZ','folder_name','express','forEach','size','2fekKmo','940072YgsKZU','utf8','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','get','\x20show_folders:','log','status','cvhs_debug:','role','promise','false','8nqsrjM','MY\x20FOLDER','readdirSync','4131078voJvQE','push','statSync','existsSync','parse','cvjs_debug'];a15_0x59b5=function(){return _0x470b23;};return a15_0x59b5();}const fs=require('fs'),path=require('path'),config=require(a15_0x537a9f(0xe8)),verifyTokenOptional=require(a15_0x537a9f(0xe3))[a15_0x537a9f(0xb9)],show_folders=![],express=require(a15_0x537a9f(0xc6)),router=express[a15_0x537a9f(0xb1)](),conn=require('../libs/mysql'),{randomUUID}=require(a15_0x537a9f(0xb6)),dir=a15_0x537a9f(0xdf);!fs[a15_0x537a9f(0xdb)](dir)&&fs[a15_0x537a9f(0xeb)](dir);const sortFoldersFirst=(_0x2e20df,_0x22ed9f)=>{const _0x47c0f4=a15_0x537a9f;if(_0x2e20df[_0x47c0f4(0xb7)]&&!_0x22ed9f[_0x47c0f4(0xb7)])return-0x1;else return!_0x2e20df[_0x47c0f4(0xb7)]&&_0x22ed9f['children']?0x1:0x0;},listFolderStructure=(_0x690c90,_0x2cae62='')=>{const _0x2222f4=a15_0x537a9f,_0x2ed362=fs[_0x2222f4(0xd7)](_0x690c90),_0x54a750=[];return _0x2ed362[_0x2222f4(0xc7)](_0x2923de=>{const _0x997181=_0x2222f4,_0x41b2e9=path[_0x997181(0xe1)](_0x690c90,_0x2923de),_0x8b085f=fs[_0x997181(0xda)](_0x41b2e9);if(_0x8b085f[_0x997181(0xe5)]()){if(config[_0x997181(0xdd)]&&show_folders)console[_0x997181(0xcf)](_0x2cae62+'└──\x20'+_0x2923de);const _0x4d719f=listFolderStructure(_0x41b2e9,_0x2cae62+_0x997181(0xbd));_0x54a750[_0x997181(0xd9)]({'name':_0x2923de,'path':_0x41b2e9,'size':_0x8b085f[_0x997181(0xc8)],'created':_0x8b085f[_0x997181(0xb2)],'modified':_0x8b085f[_0x997181(0xbc)],'isFolder':!![],'children':_0x4d719f});}else{_0x54a750[_0x997181(0xd9)]({'name':_0x2923de,'path':_0x41b2e9,'size':_0x8b085f[_0x997181(0xc8)],'created':_0x8b085f[_0x997181(0xb2)],'modified':_0x8b085f[_0x997181(0xbc)],'isFolder':![]});if(config[_0x997181(0xdd)]&&show_folders)console[_0x997181(0xcf)](_0x2cae62+_0x997181(0xe0)+_0x2923de);}}),_0x54a750[_0x2222f4(0xbf)](sortFoldersFirst);};function a15_0x4d8f(_0x3f3647,_0x539b79){const _0x59b5e9=a15_0x59b5();return a15_0x4d8f=function(_0x4d8fde,_0x2517a1){_0x4d8fde=_0x4d8fde-0xb0;let _0x3c3ccb=_0x59b5e9[_0x4d8fde];return _0x3c3ccb;},a15_0x4d8f(_0x3f3647,_0x539b79);}router[a15_0x537a9f(0xcd)]('',verifyTokenOptional,async(_0x1a9f3c,_0x51332f)=>{const _0x5a12aa=a15_0x537a9f,_0x494b39=path[_0x5a12aa(0xe1)](path['dirname'](require['main'][_0x5a12aa(0xe4)]),'CADViewer_config.json'),_0x2f8889=JSON[_0x5a12aa(0xdc)](fs['readFileSync'](_0x494b39,_0x5a12aa(0xcb))),_0x5eae87=_0x1a9f3c[_0x5a12aa(0xe6)]['loginFeatureEnabled'];let _0x51c4de=_0x2f8889[_0x5a12aa(0xe9)];_0x5eae87===_0x5a12aa(0xd4)&&(_0x51c4de=_0x2f8889[_0x5a12aa(0xe2)]);console[_0x5a12aa(0xcf)](_0x5a12aa(0xb8)+_0x51c4de+_0x5a12aa(0xce)+show_folders+_0x5a12aa(0xd1)+config[_0x5a12aa(0xdd)]);if(_0x1a9f3c[_0x5a12aa(0xec)]){let _0x2b2350;try{const [_0x29b8e5]=await conn['promise']()[_0x5a12aa(0xc3)](_0x5a12aa(0xb5),[_0x1a9f3c['user'][_0x5a12aa(0xde)]]);_0x29b8e5[_0x5a12aa(0xbe)]>0x0&&(_0x2b2350=_0x29b8e5[0x0]);}catch(_0x27c339){console[_0x5a12aa(0xcf)]({'err':_0x27c339}),_0x51332f[_0x5a12aa(0xd0)](0x1f4)[_0x5a12aa(0xc0)]({'error':_0x5a12aa(0xe7)});return;}if(!_0x2b2350){_0x51332f[_0x5a12aa(0xd0)](0x191)[_0x5a12aa(0xc0)]({'error':'Invalid\x20user'});return;}_0x2b2350[_0x5a12aa(0xd2)]==='admin'&&(_0x51c4de=_0x2f8889[_0x5a12aa(0xe2)]);let _0x52e155=_0x2b2350[_0x5a12aa(0xc5)];if(!_0x52e155){_0x52e155=randomUUID();try{await conn[_0x5a12aa(0xd3)]()['execute'](_0x5a12aa(0xcc),[_0x52e155,_0x1a9f3c[_0x5a12aa(0xec)][_0x5a12aa(0xde)]]);}catch(_0xdbe283){console['log']({'err':_0xdbe283}),_0x51332f['status'](0x1f4)[_0x5a12aa(0xc0)]({'error':_0x5a12aa(0xe7)});return;}}const _0x174b8b=_0x5a12aa(0xb4)+_0x52e155;!fs[_0x5a12aa(0xdb)](_0x174b8b)&&fs[_0x5a12aa(0xeb)](_0x174b8b);const _0x3a9353=path['resolve'](_0x174b8b),_0x313e9f=listFolderStructure(_0x3a9353);!fs[_0x5a12aa(0xdb)](_0x51c4de)&&fs['mkdirSync'](_0x51c4de),dirs=[{'own':!![],'name':_0x5a12aa(0xd6),'path':_0x174b8b,'isFolder':!![],'children':_0x313e9f},...listFolderStructure(_0x51c4de)],_0x51332f['send'](dirs);}else!fs[_0x5a12aa(0xdb)](_0x51c4de)&&fs[_0x5a12aa(0xeb)](_0x51c4de),_0x51332f[_0x5a12aa(0xbb)](listFolderStructure(_0x51c4de));}),module[a15_0x537a9f(0xb3)]=router;