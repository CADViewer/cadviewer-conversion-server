const a3_0x2b4834=a3_0x38e4;(function(_0xf2755d,_0x3fc3c4){const _0x17b966=a3_0x38e4,_0x13c230=_0xf2755d();while(!![]){try{const _0x220cff=parseInt(_0x17b966(0xd2))/0x1+-parseInt(_0x17b966(0xd1))/0x2*(parseInt(_0x17b966(0xc3))/0x3)+-parseInt(_0x17b966(0xe1))/0x4+parseInt(_0x17b966(0xe5))/0x5*(parseInt(_0x17b966(0xe2))/0x6)+-parseInt(_0x17b966(0xd6))/0x7*(-parseInt(_0x17b966(0xd8))/0x8)+parseInt(_0x17b966(0xda))/0x9*(parseInt(_0x17b966(0xc5))/0xa)+parseInt(_0x17b966(0xc0))/0xb*(parseInt(_0x17b966(0xbc))/0xc);if(_0x220cff===_0x3fc3c4)break;else _0x13c230['push'](_0x13c230['shift']());}catch(_0x5b3474){_0x13c230['push'](_0x13c230['shift']());}}}(a3_0x5ea5,0x418d6));const config=require(a3_0x2b4834(0xd3)),cvjs_debug=config[a3_0x2b4834(0xbe)],fs=require('fs'),path=require('path'),{dwgToSvg,initializeFloorplan,updateFloorplan,extractFloorplan}=require(a3_0x2b4834(0xc8)),express=require('express'),router=express['Router'](),{getHotConfig}=require(a3_0x2b4834(0xdc));function a3_0x38e4(_0x2646cd,_0x57ba4f){const _0x5ea51c=a3_0x5ea5();return a3_0x38e4=function(_0x38e49a,_0x3639b8){_0x38e49a=_0x38e49a-0xb3;let _0xa550f7=_0x5ea51c[_0x38e49a];return _0xa550f7;},a3_0x38e4(_0x2646cd,_0x57ba4f);}router['post']('',(_0x5ec2ea,_0x2dc717)=>{const _0x1dbfb1=a3_0x2b4834,{action:_0x49fca3,jsonConfigFilename:_0x187f36,contentLocation:_0x593ecd}=_0x5ec2ea[_0x1dbfb1(0xb4)],_0x5c5143=_0x593ecd[_0x1dbfb1(0xc6)]('/'),_0x3258cb=_0x5c5143[_0x5c5143[_0x1dbfb1(0xcf)]-0x1],_0x52677a=_0x3258cb[_0x1dbfb1(0xc6)]('.')[_0x1dbfb1(0xc4)](),_0x405408=_0x5c5143[_0x1dbfb1(0xb6)](0x0,-0x1)[_0x1dbfb1(0xbb)]('/');console['log'](path[_0x1dbfb1(0xbb)](_0x405408,_0x187f36));if(!fs[_0x1dbfb1(0xdd)](path[_0x1dbfb1(0xbb)](_0x405408,_0x187f36)))return _0x2dc717[_0x1dbfb1(0xd5)](0x190)['json']({'error':_0x1dbfb1(0xbd)});const _0x4b414=path[_0x1dbfb1(0xbb)](_0x405408,''+_0x3258cb[_0x1dbfb1(0xd9)]('.'+_0x52677a,_0x1dbfb1(0xbf))),_0x57ecc1=path[_0x1dbfb1(0xbb)](_0x405408,''+_0x3258cb[_0x1dbfb1(0xd9)]('.'+_0x52677a,_0x1dbfb1(0xc1)));_0x49fca3[_0x1dbfb1(0xb3)]&&initializeFloorplan(_0x593ecd,_0x57ecc1,{'cde':path['join'](_0x405408,_0x187f36['replace']('.json',_0x1dbfb1(0xd0)))});_0x49fca3['update']&&updateFloorplan(_0x57ecc1,_0x4b414,{'du2':path[_0x1dbfb1(0xbb)](_0x405408,_0x187f36[_0x1dbfb1(0xd9)](_0x1dbfb1(0xdb),_0x1dbfb1(0xc2)))});let _0x59d840=null;_0x49fca3[_0x1dbfb1(0xb8)]&&(_0x59d840=_0x4b414[_0x1dbfb1(0xd9)]('.'+_0x52677a,_0x1dbfb1(0xdb))[_0x1dbfb1(0xd9)](_0x1dbfb1(0xd4),'json/property'),extractFloorplan(_0x4b414,_0x59d840,{'dx2':path[_0x1dbfb1(0xbb)](_0x405408,_0x187f36[_0x1dbfb1(0xd9)]('.json',_0x1dbfb1(0xd0)))}));let _0x127487=null;_0x49fca3['createDrawing']&&(_0x127487=_0x4b414[_0x1dbfb1(0xd9)]('.'+_0x52677a,'.svg')['replace'](_0x1dbfb1(0xd4),_0x1dbfb1(0xde)),dwgToSvg(_0x4b414,_0x127487,{'f':_0x1dbfb1(0xde),'last':'','extents':'','rl':_0x1dbfb1(0xca),'tl':_0x1dbfb1(0xb9)})),_0x2dc717['status'](0xc8)[_0x1dbfb1(0xcb)]({'initial_output_path':_0x4b414,'initial_output_tmp_path':_0x57ecc1,'extracted_output_path':_0x59d840,'svg_output_path':_0x127487});}),router['post'](a3_0x2b4834(0xcd),(_0x1a8a2b,_0x2b4c21)=>{const _0x1e08c3=a3_0x2b4834,{jsonConfigFilename:_0x1c0a1e,contentLocation:_0x51428f}=_0x1a8a2b[_0x1e08c3(0xb4)],_0x34a18a=_0x1a8a2b[_0x1e08c3(0xb4)][_0x1e08c3(0xe3)];if(!_0x1c0a1e||!_0x51428f||!_0x34a18a)return _0x2b4c21[_0x1e08c3(0xd5)](0x190)[_0x1e08c3(0xcb)]({'error':_0x1e08c3(0xb5)});try{let _0x3fdef8;try{_0x3fdef8=typeof _0x34a18a===_0x1e08c3(0xb7)?JSON[_0x1e08c3(0xba)](_0x34a18a):_0x34a18a;}catch(_0xd0183){return _0x2b4c21[_0x1e08c3(0xd5)](0x190)[_0x1e08c3(0xcb)]({'error':_0x1e08c3(0xce)});}if(!_0x3fdef8[_0x1e08c3(0xdf)]||!_0x3fdef8[_0x1e08c3(0xd7)]||!Array['isArray'](_0x3fdef8[_0x1e08c3(0xdf)]))return _0x2b4c21[_0x1e08c3(0xd5)](0x190)[_0x1e08c3(0xcb)]({'error':'Invalid\x20config\x20structure:\x20must\x20contain\x20Areas\x20array\x20and\x20Parameters\x20object'});const _0x223ad1=_0x51428f[_0x1e08c3(0xc6)]('/'),_0x2963a9=_0x223ad1['slice'](0x0,-0x1)['join']('/'),_0x11a9cd=_0x1c0a1e,_0x59d68b=path[_0x1e08c3(0xbb)](_0x2963a9,_0x11a9cd);fs['writeFileSync'](_0x59d68b,JSON['stringify'](_0x3fdef8,null,0x2)),_0x2b4c21['status'](0xc8)[_0x1e08c3(0xcb)]({'success':!![],'message':_0x1e08c3(0xc9),'filePath':_0x59d68b});}catch(_0x57bf93){console[_0x1e08c3(0xe6)](_0x1e08c3(0xcc),_0x57bf93),_0x2b4c21[_0x1e08c3(0xd5)](0x1f4)[_0x1e08c3(0xcb)]({'error':_0x1e08c3(0xe0),'details':_0x57bf93[_0x1e08c3(0xe4)]});}}),module[a3_0x2b4834(0xc7)]=router;function a3_0x5ea5(){const _0x27aa1b=['error','initialization','body','Missing\x20required\x20parameters:\x20jsonConfigFilename,\x20contentLocation\x20or\x20configData','slice','string','extraction','VizQuery_ID','parse','join','411924BeNxgQ','Configuration\x20file\x20not\x20found','cvjs_debug','-new.dwg','22SWVfWC','-temp-name.dwg','-changes.json','597nPSbbv','pop','1110EQbfaU','split','exports','../libs/autoexchange','Configuration\x20file\x20saved\x20successfully','VizQuery_Space','json','Error\x20saving\x20configuration\x20file:','/config-file','Invalid\x20JSON\x20data','length','-init.json','5202skksxd','203185NKkLca','../CADViewer_config.json','dwg','status','637QIgXcA','Parameters','7216AGZutV','replace','11331aKrHiC','.json','../libs/config','existsSync','svg','Areas','Failed\x20to\x20save\x20configuration\x20file','860124mhtEUx','18342TKHEwl','configData','message','830VLuMMz'];a3_0x5ea5=function(){return _0x27aa1b;};return a3_0x5ea5();}