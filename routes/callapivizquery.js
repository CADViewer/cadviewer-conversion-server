const a3_0x56794a=a3_0x3be8;function a3_0x3be8(_0x328f6a,_0x55e234){const _0x5a1483=a3_0x5a14();return a3_0x3be8=function(_0x3be824,_0x2629bf){_0x3be824=_0x3be824-0xb5;let _0x2d0afc=_0x5a1483[_0x3be824];return _0x2d0afc;},a3_0x3be8(_0x328f6a,_0x55e234);}(function(_0xa18bee,_0x1eb18f){const _0x325928=a3_0x3be8,_0x4be243=_0xa18bee();while(!![]){try{const _0x359e53=parseInt(_0x325928(0xcc))/0x1+-parseInt(_0x325928(0xb6))/0x2+parseInt(_0x325928(0xc4))/0x3*(parseInt(_0x325928(0xd3))/0x4)+parseInt(_0x325928(0xca))/0x5*(parseInt(_0x325928(0xe1))/0x6)+-parseInt(_0x325928(0xd9))/0x7*(parseInt(_0x325928(0xbf))/0x8)+-parseInt(_0x325928(0xd2))/0x9*(-parseInt(_0x325928(0xe3))/0xa)+parseInt(_0x325928(0xe4))/0xb;if(_0x359e53===_0x1eb18f)break;else _0x4be243['push'](_0x4be243['shift']());}catch(_0x1f58f7){_0x4be243['push'](_0x4be243['shift']());}}}(a3_0x5a14,0x95151));const config=require(a3_0x56794a(0xdf)),cvjs_debug=config[a3_0x56794a(0xdc)],fs=require('fs'),path=require('path'),{dwgToSvg,initializeFloorplan,updateFloorplan,extractFloorplan}=require(a3_0x56794a(0xbb)),express=require(a3_0x56794a(0xc1)),router=express[a3_0x56794a(0xe2)](),{getHotConfig}=require('../libs/config');router['post']('',(_0x30223f,_0x2db2c5)=>{const _0x2b62b1=a3_0x56794a,{filename:_0x2dca9c,action:_0x5a40ca,contentLocation:_0x2af966,initOutputFilename:_0x19460c,initConfigFilename:_0x1cb7c2,updateOutputFilename:_0x298d0d,updateConfigFilename:_0x51b975,extractConfigFilename:_0x127f10,extractOutputFilename:_0x1a730f,drawingOutputFilename:_0x3ce9da}=_0x30223f[_0x2b62b1(0xba)];_0x5a40ca[_0x2b62b1(0xb5)]&&(_0x5a40ca['extraction']=![]);const _0xdab75f=_0x2af966[_0x2b62b1(0xcf)]('/'),_0x430041=_0xdab75f[_0xdab75f['length']-0x1],_0x5d9dc6=_0x430041['split']('.')[_0x2b62b1(0xc5)](),_0x2d14e5=_0xdab75f[_0x2b62b1(0xd7)](0x0,-0x1)[_0x2b62b1(0xbd)]('/');if(_0x5a40ca['initialization']){if(!fs[_0x2b62b1(0xc2)](path[_0x2b62b1(0xbd)](_0x2d14e5,_0x1cb7c2)))return _0x2db2c5['status'](0x190)[_0x2b62b1(0xe5)]({'error':_0x2b62b1(0xb9)});}if(_0x5a40ca['update']){if(!fs[_0x2b62b1(0xc2)](path[_0x2b62b1(0xbd)](_0x2d14e5,_0x51b975)))return _0x2db2c5[_0x2b62b1(0xcd)](0x190)[_0x2b62b1(0xe5)]({'error':'Update\x20configuration\x20file\x20not\x20found'});}if(_0x5a40ca['extraction']){if(!fs['existsSync'](path['join'](_0x2d14e5,_0x127f10)))return _0x2db2c5['status'](0x190)[_0x2b62b1(0xe5)]({'error':_0x2b62b1(0xcb)});}const _0x573c61=path[_0x2b62b1(0xbd)](_0x2d14e5,''+_0x19460c);_0x5a40ca[_0x2b62b1(0xb5)]&&initializeFloorplan(_0x2af966,_0x573c61,{'cde':path['join'](_0x2d14e5,_0x1cb7c2)});const _0x6255fe=_0x5a40ca[_0x2b62b1(0xb5)]?_0x573c61:_0x2af966,_0x57eb84=path[_0x2b62b1(0xbd)](_0x2d14e5,''+_0x298d0d);_0x5a40ca[_0x2b62b1(0xbe)]&&updateFloorplan(_0x6255fe,_0x57eb84,{'du2':path[_0x2b62b1(0xbd)](_0x2d14e5,_0x51b975)});const _0x1dbf95=_0x5a40ca[_0x2b62b1(0xb5)]?_0x573c61:_0x5a40ca[_0x2b62b1(0xbe)]?_0x57eb84:_0x2af966,_0x17905d=path[_0x2b62b1(0xbd)](_0x2d14e5[_0x2b62b1(0xd1)](_0x2b62b1(0xdb),_0x2b62b1(0xb8)),''+_0x1a730f);_0x5a40ca[_0x2b62b1(0xda)]&&(!fs[_0x2b62b1(0xc2)](_0x2d14e5[_0x2b62b1(0xd1)](_0x2b62b1(0xdb),_0x2b62b1(0xb8)))&&fs['mkdirSync'](_0x2d14e5[_0x2b62b1(0xd1)](_0x2b62b1(0xdb),_0x2b62b1(0xb8)),{'recursive':!![]}),extractFloorplan(_0x1dbf95,_0x17905d,{'dx2':path['join'](_0x2d14e5,_0x127f10)}));const _0x1614e7=_0x5a40ca[_0x2b62b1(0xb5)]?_0x573c61:_0x5a40ca[_0x2b62b1(0xbe)]?_0x57eb84:_0x2af966,_0x37bd3c=path[_0x2b62b1(0xbd)](_0x2d14e5[_0x2b62b1(0xd1)]('dwg',_0x2b62b1(0xc9)),''+_0x3ce9da);_0x5a40ca[_0x2b62b1(0xc6)]&&(!fs[_0x2b62b1(0xc2)](_0x2d14e5[_0x2b62b1(0xd1)](_0x2b62b1(0xdb),_0x2b62b1(0xc9)))&&fs[_0x2b62b1(0xc7)](_0x2d14e5['replace'](_0x2b62b1(0xdb),_0x2b62b1(0xc9)),{'recursive':!![]}),dwgToSvg(_0x1614e7,_0x37bd3c,{'f':_0x2b62b1(0xc9),'last':'','extents':'','rl':_0x2b62b1(0xde),'tl':'VizQuery_ID'})),_0x2db2c5[_0x2b62b1(0xcd)](0xc8)['json']({'initial_output_path':_0x5a40ca[_0x2b62b1(0xb5)]?_0x573c61:_0x5a40ca[_0x2b62b1(0xbe)]?_0x57eb84:_0x2af966,'update_output_path':_0x5a40ca[_0x2b62b1(0xbe)]?_0x57eb84:null,'extracted_output_path':_0x5a40ca['extraction']?_0x17905d:null,'drawing_output_path':_0x5a40ca[_0x2b62b1(0xc6)]?_0x37bd3c:null});}),router[a3_0x56794a(0xc8)](a3_0x56794a(0xd5),(_0x4c19a9,_0x3c176c)=>{const _0x448229=a3_0x56794a,{jsonConfigFilename:_0x42efba,contentLocation:_0x3b77ab}=_0x4c19a9[_0x448229(0xba)],_0x1c7048=_0x4c19a9[_0x448229(0xba)][_0x448229(0xe0)];if(!_0x42efba||!_0x3b77ab||!_0x1c7048)return _0x3c176c[_0x448229(0xcd)](0x190)[_0x448229(0xe5)]({'error':_0x448229(0xc3)});try{let _0x8f7f39;try{_0x8f7f39=typeof _0x1c7048==='string'?JSON[_0x448229(0xd0)](_0x1c7048):_0x1c7048;}catch(_0x330327){return _0x3c176c['status'](0x190)['json']({'error':_0x448229(0xb7)});}const _0x482636=_0x3b77ab['split']('/'),_0x4e0d1c=_0x482636['slice'](0x0,-0x1)[_0x448229(0xbd)]('/'),_0x8f1998=_0x42efba,_0x30ec73=path['join'](_0x4e0d1c,_0x8f1998);fs[_0x448229(0xd4)](_0x30ec73,JSON['stringify'](_0x8f7f39,null,0x2)),_0x3c176c['status'](0xc8)[_0x448229(0xe5)]({'success':!![],'message':_0x448229(0xdd),'filePath':_0x30ec73});}catch(_0x4a20da){console[_0x448229(0xbc)](_0x448229(0xc0),_0x4a20da),_0x3c176c[_0x448229(0xcd)](0x1f4)[_0x448229(0xe5)]({'error':_0x448229(0xce),'details':_0x4a20da[_0x448229(0xd6)]});}}),module[a3_0x56794a(0xd8)]=router;function a3_0x5a14(){const _0x342d23=['Extraction\x20configuration\x20file\x20not\x20found','222118rDsMwT','status','Failed\x20to\x20save\x20configuration\x20file','split','parse','replace','33273FUULVM','46336qmzANB','writeFileSync','/config-file','message','slice','exports','7791hPzWOO','extraction','dwg','cvjs_debug','Configuration\x20file\x20saved\x20successfully','VizQuery_Space','../CADViewer_config.json','configData','18JSpVAg','Router','110qxHIaa','2613600aUVAwu','json','initialization','554100EXWHwO','Invalid\x20JSON\x20data','json/property','Initialization\x20configuration\x20file\x20not\x20found','body','../libs/autoexchange','error','join','update','4632UblWSM','Error\x20saving\x20configuration\x20file:','express','existsSync','Missing\x20required\x20parameters:\x20jsonConfigFilename,\x20contentLocation\x20or\x20configData','225jVZbtv','pop','createDrawing','mkdirSync','post','svg','271555bTEiti'];a3_0x5a14=function(){return _0x342d23;};return a3_0x5a14();}