const a3_0x3a6a35=a3_0x12de;(function(_0x410260,_0x41f0be){const _0x11cfd5=a3_0x12de,_0x3e1ef0=_0x410260();while(!![]){try{const _0x51f756=parseInt(_0x11cfd5(0x1cf))/0x1+-parseInt(_0x11cfd5(0x1ce))/0x2*(parseInt(_0x11cfd5(0x1c9))/0x3)+-parseInt(_0x11cfd5(0x1e5))/0x4+parseInt(_0x11cfd5(0x1e7))/0x5+-parseInt(_0x11cfd5(0x1d2))/0x6+parseInt(_0x11cfd5(0x1dd))/0x7+parseInt(_0x11cfd5(0x1ed))/0x8*(parseInt(_0x11cfd5(0x1ca))/0x9);if(_0x51f756===_0x41f0be)break;else _0x3e1ef0['push'](_0x3e1ef0['shift']());}catch(_0x55dbcc){_0x3e1ef0['push'](_0x3e1ef0['shift']());}}}(a3_0x4780,0x86faa));function a3_0x12de(_0x3ad4d9,_0x39a312){const _0x4780b5=a3_0x4780();return a3_0x12de=function(_0x12dec0,_0x369dd3){_0x12dec0=_0x12dec0-0x1c9;let _0x52d05b=_0x4780b5[_0x12dec0];return _0x52d05b;},a3_0x12de(_0x3ad4d9,_0x39a312);}const config=require('../CADViewer_config.json'),cvjs_debug=config[a3_0x3a6a35(0x1e2)],fs=require('fs'),path=require(a3_0x3a6a35(0x1ee)),{dwgToSvg,initializeFloorplan,updateFloorplan,extractFloorplan}=require(a3_0x3a6a35(0x1ef)),express=require(a3_0x3a6a35(0x1d7)),router=express['Router'](),{getHotConfig}=require(a3_0x3a6a35(0x1e6));function a3_0x4780(){const _0x30899d=['join','replace','exports','6576PGyqFp','790616KZTlrN','initialization','configData','3790302sbBwAu','parse','mkdirSync','Failed\x20to\x20save\x20configuration\x20file','status','express','stringify','Extraction\x20configuration\x20file\x20not\x20found','slice','existsSync','dwg','1330735vubUFo','body','error','Initialization\x20configuration\x20file\x20not\x20found','createDrawing','cvjs_debug','Error\x20saving\x20configuration\x20file:','/config-file','2350900QUQBwi','../libs/config','1907115LHtjLv','extraction','json','Update\x20configuration\x20file\x20not\x20found','post','json/property','5099664rWtDRj','path','../libs/autoexchange','message','string','update','split','svg','Configuration\x20file\x20saved\x20successfully','789yuBBfg','18bitDpW'];a3_0x4780=function(){return _0x30899d;};return a3_0x4780();}router[a3_0x3a6a35(0x1eb)]('',(_0x5a1ca8,_0x40993e)=>{const _0x5d2ac2=a3_0x3a6a35,{filename:_0x52a1d8,action:_0x1e7c34,contentLocation:_0x3ccdc9,initOutputFilename:_0x1ca486,initConfigFilename:_0x579413,updateOutputFilename:_0x4fcb1a,updateConfigFilename:_0x28346b,extractConfigFilename:_0x436101,extractOutputFilename:_0x45784a,drawingOutputFilename:_0x59e336}=_0x5a1ca8[_0x5d2ac2(0x1de)];_0x1e7c34[_0x5d2ac2(0x1d0)]&&(_0x1e7c34[_0x5d2ac2(0x1e8)]=![]);const _0x54b1bf=_0x3ccdc9[_0x5d2ac2(0x1f3)]('/'),_0x58a617=_0x54b1bf[_0x54b1bf['length']-0x1],_0x59539f=_0x58a617['split']('.')['pop'](),_0x2b7f83=_0x54b1bf[_0x5d2ac2(0x1da)](0x0,-0x1)[_0x5d2ac2(0x1cb)]('/');if(_0x1e7c34[_0x5d2ac2(0x1d0)]){if(!fs[_0x5d2ac2(0x1db)](path[_0x5d2ac2(0x1cb)](_0x2b7f83,_0x579413)))return _0x40993e[_0x5d2ac2(0x1d6)](0x190)[_0x5d2ac2(0x1e9)]({'error':_0x5d2ac2(0x1e0)});}if(_0x1e7c34[_0x5d2ac2(0x1f2)]){if(!fs[_0x5d2ac2(0x1db)](path['join'](_0x2b7f83,_0x28346b)))return _0x40993e[_0x5d2ac2(0x1d6)](0x190)[_0x5d2ac2(0x1e9)]({'error':_0x5d2ac2(0x1ea)});}if(_0x1e7c34[_0x5d2ac2(0x1e8)]){if(!fs['existsSync'](path['join'](_0x2b7f83,_0x436101)))return _0x40993e[_0x5d2ac2(0x1d6)](0x190)['json']({'error':_0x5d2ac2(0x1d9)});}const _0x1bb5b3=path[_0x5d2ac2(0x1cb)](_0x2b7f83,''+_0x1ca486);_0x1e7c34[_0x5d2ac2(0x1d0)]&&initializeFloorplan(_0x3ccdc9,_0x1bb5b3,{'cde':path[_0x5d2ac2(0x1cb)](_0x2b7f83,_0x579413)});const _0xa10b1b=_0x1e7c34[_0x5d2ac2(0x1d0)]?_0x1bb5b3:_0x3ccdc9,_0x371b3e=path['join'](_0x2b7f83,''+_0x4fcb1a);_0x1e7c34[_0x5d2ac2(0x1f2)]&&updateFloorplan(_0xa10b1b,_0x371b3e,{'du2':path[_0x5d2ac2(0x1cb)](_0x2b7f83,_0x28346b)});const _0x475c60=_0x1e7c34['initialization']?_0x1bb5b3:_0x1e7c34['update']?_0x371b3e:_0x3ccdc9,_0x3e7329=path['join'](_0x2b7f83[_0x5d2ac2(0x1cc)](_0x5d2ac2(0x1dc),'json/property'),''+_0x45784a);_0x1e7c34['extraction']&&(!fs[_0x5d2ac2(0x1db)](_0x2b7f83[_0x5d2ac2(0x1cc)]('dwg','json/property'))&&fs[_0x5d2ac2(0x1d4)](_0x2b7f83['replace'](_0x5d2ac2(0x1dc),_0x5d2ac2(0x1ec)),{'recursive':!![]}),extractFloorplan(_0x475c60,_0x3e7329,{'dx2':path[_0x5d2ac2(0x1cb)](_0x2b7f83,_0x436101)}));const _0x329af2=_0x1e7c34[_0x5d2ac2(0x1d0)]?_0x1bb5b3:_0x1e7c34[_0x5d2ac2(0x1f2)]?_0x371b3e:_0x3ccdc9,_0x4bbecb=path[_0x5d2ac2(0x1cb)](_0x2b7f83['replace'](_0x5d2ac2(0x1dc),_0x5d2ac2(0x1f4)),''+_0x59e336);_0x1e7c34[_0x5d2ac2(0x1e1)]&&(!fs['existsSync'](_0x2b7f83[_0x5d2ac2(0x1cc)](_0x5d2ac2(0x1dc),_0x5d2ac2(0x1f4)))&&fs[_0x5d2ac2(0x1d4)](_0x2b7f83[_0x5d2ac2(0x1cc)](_0x5d2ac2(0x1dc),_0x5d2ac2(0x1f4)),{'recursive':!![]}),dwgToSvg(_0x329af2,_0x4bbecb,{'f':_0x5d2ac2(0x1f4),'last':'','extents':'','rl':'VizQuery_Space','tl':'VizQuery_ID'})),_0x40993e[_0x5d2ac2(0x1d6)](0xc8)[_0x5d2ac2(0x1e9)]({'initial_output_path':_0x1e7c34[_0x5d2ac2(0x1d0)]?_0x1bb5b3:_0x1e7c34[_0x5d2ac2(0x1f2)]?_0x371b3e:_0x3ccdc9,'update_output_path':_0x1e7c34['update']?_0x371b3e:null,'extracted_output_path':_0x1e7c34[_0x5d2ac2(0x1e8)]?_0x3e7329:null,'drawing_output_path':_0x1e7c34[_0x5d2ac2(0x1e1)]?_0x4bbecb:null});}),router[a3_0x3a6a35(0x1eb)](a3_0x3a6a35(0x1e4),(_0x47b0fc,_0x7a6ea3)=>{const _0x5d3bcd=a3_0x3a6a35,{jsonConfigFilename:_0x43ab47,contentLocation:_0x269c18}=_0x47b0fc[_0x5d3bcd(0x1de)],_0x507ed4=_0x47b0fc[_0x5d3bcd(0x1de)][_0x5d3bcd(0x1d1)];if(!_0x43ab47||!_0x269c18||!_0x507ed4)return _0x7a6ea3['status'](0x190)['json']({'error':'Missing\x20required\x20parameters:\x20jsonConfigFilename,\x20contentLocation\x20or\x20configData'});try{let _0x1d1ce3;try{_0x1d1ce3=typeof _0x507ed4===_0x5d3bcd(0x1f1)?JSON[_0x5d3bcd(0x1d3)](_0x507ed4):_0x507ed4;}catch(_0x57d9a9){return _0x7a6ea3['status'](0x190)[_0x5d3bcd(0x1e9)]({'error':'Invalid\x20JSON\x20data'});}const _0x7f936d=_0x269c18[_0x5d3bcd(0x1f3)]('/'),_0x564e1e=_0x7f936d[_0x5d3bcd(0x1da)](0x0,-0x1)[_0x5d3bcd(0x1cb)]('/'),_0x21ce52=_0x43ab47,_0x326651=path[_0x5d3bcd(0x1cb)](_0x564e1e,_0x21ce52);fs['writeFileSync'](_0x326651,JSON[_0x5d3bcd(0x1d8)](_0x1d1ce3,null,0x2)),_0x7a6ea3[_0x5d3bcd(0x1d6)](0xc8)[_0x5d3bcd(0x1e9)]({'success':!![],'message':_0x5d3bcd(0x1f5),'filePath':_0x326651});}catch(_0x2252c2){console[_0x5d3bcd(0x1df)](_0x5d3bcd(0x1e3),_0x2252c2),_0x7a6ea3[_0x5d3bcd(0x1d6)](0x1f4)[_0x5d3bcd(0x1e9)]({'error':_0x5d3bcd(0x1d5),'details':_0x2252c2[_0x5d3bcd(0x1f0)]});}}),module[a3_0x3a6a35(0x1cd)]=router;