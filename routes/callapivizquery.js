const a3_0x17f65c=a3_0x32e0;function a3_0x32e0(_0x421851,_0x746835){const _0x454f23=a3_0x454f();return a3_0x32e0=function(_0x32e007,_0x1d04c1){_0x32e007=_0x32e007-0x1f1;let _0x5df9cf=_0x454f23[_0x32e007];return _0x5df9cf;},a3_0x32e0(_0x421851,_0x746835);}(function(_0x18f791,_0x1f0a11){const _0x2ce40e=a3_0x32e0,_0x3e5d39=_0x18f791();while(!![]){try{const _0x5e3b1a=-parseInt(_0x2ce40e(0x217))/0x1*(-parseInt(_0x2ce40e(0x204))/0x2)+parseInt(_0x2ce40e(0x201))/0x3*(parseInt(_0x2ce40e(0x21e))/0x4)+parseInt(_0x2ce40e(0x20a))/0x5*(parseInt(_0x2ce40e(0x211))/0x6)+parseInt(_0x2ce40e(0x219))/0x7+-parseInt(_0x2ce40e(0x21f))/0x8+-parseInt(_0x2ce40e(0x1fe))/0x9*(-parseInt(_0x2ce40e(0x1fc))/0xa)+-parseInt(_0x2ce40e(0x224))/0xb;if(_0x5e3b1a===_0x1f0a11)break;else _0x3e5d39['push'](_0x3e5d39['shift']());}catch(_0xaa92cb){_0x3e5d39['push'](_0x3e5d39['shift']());}}}(a3_0x454f,0xb0b7a));function a3_0x454f(){const _0x16acf0=['7940472FyMMSQ','string','Extraction\x20configuration\x20file\x20not\x20found','writeFileSync','dwg','15431581BXgMHo','length','Configuration\x20file\x20saved\x20successfully','status','path','cvjs_debug','split','join','existsSync','extraction','Error\x20saving\x20configuration\x20file:','update','2743820ywtVGE','json','45AwDcYW','Invalid\x20JSON\x20data','configData','6HLdVjR','svg','exports','2OTbFeJ','mkdirSync','initialization','stringify','createDrawing','Update\x20configuration\x20file\x20not\x20found','1177570rQPstM','VizQuery_Space','../libs/config','pop','/config-file','slice','post','6WuVnhO','Missing\x20required\x20parameters:\x20jsonConfigFilename,\x20contentLocation\x20or\x20configData','Initialization\x20configuration\x20file\x20not\x20found','express','json/property','VizQuery_ID','483624PFUusi','../CADViewer_config.json','5285742VXyLlp','parse','replace','Failed\x20to\x20save\x20configuration\x20file','body','546220FXmQwa'];a3_0x454f=function(){return _0x16acf0;};return a3_0x454f();}const config=require(a3_0x17f65c(0x218)),cvjs_debug=config[a3_0x17f65c(0x1f5)],fs=require('fs'),path=require(a3_0x17f65c(0x1f4)),{dwgToSvg,initializeFloorplan,updateFloorplan,extractFloorplan}=require('../libs/autoexchange'),express=require(a3_0x17f65c(0x214)),router=express['Router'](),{getHotConfig}=require(a3_0x17f65c(0x20c));router[a3_0x17f65c(0x210)]('',(_0x3c9863,_0x36e27f)=>{const _0x24b9c6=a3_0x17f65c,{filename:_0x4644b6,action:_0x214b4f,contentLocation:_0x3b21f7,initOutputFilename:_0x14a4f1,initConfigFilename:_0x3ad4fc,updateOutputFilename:_0x36b584,updateConfigFilename:_0x36babf,extractConfigFilename:_0x1d3e73,extractOutputFilename:_0x4097fa,drawingOutputFilename:_0x4bd24f}=_0x3c9863[_0x24b9c6(0x21d)];_0x214b4f[_0x24b9c6(0x206)]&&(_0x214b4f[_0x24b9c6(0x1f9)]=![]);const _0x4cdd1c=_0x3b21f7[_0x24b9c6(0x1f6)]('/'),_0x1a94fa=_0x4cdd1c[_0x4cdd1c[_0x24b9c6(0x1f1)]-0x1],_0x25fe33=_0x1a94fa[_0x24b9c6(0x1f6)]('.')[_0x24b9c6(0x20d)](),_0x588550=_0x4cdd1c[_0x24b9c6(0x20f)](0x0,-0x1)[_0x24b9c6(0x1f7)]('/');if(_0x214b4f[_0x24b9c6(0x206)]){if(!fs[_0x24b9c6(0x1f8)](path[_0x24b9c6(0x1f7)](_0x588550,_0x3ad4fc)))return _0x36e27f[_0x24b9c6(0x1f3)](0x190)[_0x24b9c6(0x1fd)]({'error':_0x24b9c6(0x213)});}if(_0x214b4f['update']){if(!fs[_0x24b9c6(0x1f8)](path['join'](_0x588550,_0x36babf)))return _0x36e27f[_0x24b9c6(0x1f3)](0x190)[_0x24b9c6(0x1fd)]({'error':_0x24b9c6(0x209)});}if(_0x214b4f[_0x24b9c6(0x1f9)]){if(!fs[_0x24b9c6(0x1f8)](path[_0x24b9c6(0x1f7)](_0x588550,_0x1d3e73)))return _0x36e27f[_0x24b9c6(0x1f3)](0x190)['json']({'error':_0x24b9c6(0x221)});}const _0x41e683=path[_0x24b9c6(0x1f7)](_0x588550,''+_0x14a4f1);_0x214b4f[_0x24b9c6(0x206)]&&initializeFloorplan(_0x3b21f7,_0x41e683,{'cde':path[_0x24b9c6(0x1f7)](_0x588550,_0x3ad4fc)});const _0x29fd75=_0x214b4f['initialization']?_0x41e683:_0x3b21f7,_0x10712b=path[_0x24b9c6(0x1f7)](_0x588550,''+_0x36b584);_0x214b4f[_0x24b9c6(0x1fb)]&&updateFloorplan(_0x29fd75,_0x10712b,{'du2':path[_0x24b9c6(0x1f7)](_0x588550,_0x36babf)});const _0xb7fc1=_0x214b4f[_0x24b9c6(0x206)]?_0x41e683:_0x214b4f[_0x24b9c6(0x1fb)]?_0x10712b:_0x3b21f7,_0x50c4b9=path[_0x24b9c6(0x1f7)](_0x588550[_0x24b9c6(0x21b)](_0x24b9c6(0x223),_0x24b9c6(0x215)),''+_0x4097fa);_0x214b4f['extraction']&&(!fs[_0x24b9c6(0x1f8)](_0x588550[_0x24b9c6(0x21b)](_0x24b9c6(0x223),_0x24b9c6(0x215)))&&fs[_0x24b9c6(0x205)](_0x588550[_0x24b9c6(0x21b)](_0x24b9c6(0x223),_0x24b9c6(0x215)),{'recursive':!![]}),extractFloorplan(_0xb7fc1,_0x50c4b9,{'dx2':path[_0x24b9c6(0x1f7)](_0x588550,_0x1d3e73)}));const _0x4d7e1e=_0x214b4f['initialization']?_0x41e683:_0x214b4f[_0x24b9c6(0x1fb)]?_0x10712b:_0x3b21f7,_0x5156f4=path['join'](_0x588550['replace']('dwg',_0x24b9c6(0x202)),''+_0x4bd24f);_0x214b4f[_0x24b9c6(0x208)]&&(!fs[_0x24b9c6(0x1f8)](_0x588550[_0x24b9c6(0x21b)](_0x24b9c6(0x223),_0x24b9c6(0x202)))&&fs[_0x24b9c6(0x205)](_0x588550[_0x24b9c6(0x21b)]('dwg','svg'),{'recursive':!![]}),dwgToSvg(_0x4d7e1e,_0x5156f4,{'f':_0x24b9c6(0x202),'last':'','extents':'','rl':_0x24b9c6(0x20b),'tl':_0x24b9c6(0x216)})),_0x36e27f['status'](0xc8)['json']({'initial_output_path':_0x214b4f['initialization']?_0x41e683:_0x214b4f[_0x24b9c6(0x1fb)]?_0x10712b:_0x3b21f7,'update_output_path':_0x214b4f[_0x24b9c6(0x1fb)]?_0x10712b:null,'extracted_output_path':_0x214b4f[_0x24b9c6(0x1f9)]?_0x50c4b9:null,'drawing_output_path':_0x214b4f[_0x24b9c6(0x208)]?_0x5156f4:null});}),router['post'](a3_0x17f65c(0x20e),(_0x4bb5f8,_0x4a3282)=>{const _0x2c7b83=a3_0x17f65c,{jsonConfigFilename:_0x195114,contentLocation:_0x254e42}=_0x4bb5f8['body'],_0x942993=_0x4bb5f8[_0x2c7b83(0x21d)][_0x2c7b83(0x200)];if(!_0x195114||!_0x254e42||!_0x942993)return _0x4a3282[_0x2c7b83(0x1f3)](0x190)[_0x2c7b83(0x1fd)]({'error':_0x2c7b83(0x212)});try{let _0x290911;try{_0x290911=typeof _0x942993===_0x2c7b83(0x220)?JSON[_0x2c7b83(0x21a)](_0x942993):_0x942993;}catch(_0x10114f){return _0x4a3282['status'](0x190)['json']({'error':_0x2c7b83(0x1ff)});}const _0x549095=_0x254e42[_0x2c7b83(0x1f6)]('/'),_0x2cfcbb=_0x549095[_0x2c7b83(0x20f)](0x0,-0x1)[_0x2c7b83(0x1f7)]('/'),_0x34bec3=_0x195114,_0x50f1fe=path[_0x2c7b83(0x1f7)](_0x2cfcbb,_0x34bec3);fs[_0x2c7b83(0x222)](_0x50f1fe,JSON[_0x2c7b83(0x207)](_0x290911,null,0x2)),_0x4a3282['status'](0xc8)['json']({'success':!![],'message':_0x2c7b83(0x1f2),'filePath':_0x50f1fe});}catch(_0x2102c8){console['error'](_0x2c7b83(0x1fa),_0x2102c8),_0x4a3282[_0x2c7b83(0x1f3)](0x1f4)[_0x2c7b83(0x1fd)]({'error':_0x2c7b83(0x21c),'details':_0x2102c8['message']});}}),module[a3_0x17f65c(0x203)]=router;