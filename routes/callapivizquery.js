const a3_0x5b3abd=a3_0x1afc;(function(_0x3780fb,_0x2b714c){const _0x17acb8=a3_0x1afc,_0x3d67b8=_0x3780fb();while(!![]){try{const _0x41d9c0=parseInt(_0x17acb8(0x19b))/0x1*(parseInt(_0x17acb8(0x19f))/0x2)+-parseInt(_0x17acb8(0x195))/0x3+-parseInt(_0x17acb8(0x188))/0x4*(-parseInt(_0x17acb8(0x190))/0x5)+parseInt(_0x17acb8(0x199))/0x6*(-parseInt(_0x17acb8(0x1ae))/0x7)+-parseInt(_0x17acb8(0x193))/0x8+parseInt(_0x17acb8(0x18e))/0x9+parseInt(_0x17acb8(0x1b6))/0xa;if(_0x41d9c0===_0x2b714c)break;else _0x3d67b8['push'](_0x3d67b8['shift']());}catch(_0x3c4cb0){_0x3d67b8['push'](_0x3d67b8['shift']());}}}(a3_0x519c,0x6759d));const config=require('../CADViewer_config.json'),cvjs_debug=config['cvjs_debug'],fs=require('fs'),path=require('path'),{dwgToSvg,initializeFloorplan,updateFloorplan,extractFloorplan}=require(a3_0x5b3abd(0x1ad)),express=require('express'),router=express[a3_0x5b3abd(0x18d)](),{getHotConfig}=require(a3_0x5b3abd(0x1b2));router[a3_0x5b3abd(0x1b5)]('',(_0x5de2fb,_0x1b3c90)=>{const _0x2b8fa9=a3_0x5b3abd,{action:_0x386edc,jsonConfigFilename:_0x3e16a4,contentLocation:_0x35f770}=_0x5de2fb[_0x2b8fa9(0x189)],_0x212460=_0x35f770['split']('/'),_0x3fa85a=_0x212460[_0x212460['length']-0x1],_0xb5b493=_0x3fa85a['split']('.')[_0x2b8fa9(0x1a0)](),_0x20c972=_0x212460['slice'](0x0,-0x1)['join']('/');console[_0x2b8fa9(0x198)](path[_0x2b8fa9(0x1b4)](_0x20c972,_0x3e16a4));if(!fs[_0x2b8fa9(0x1a8)](path[_0x2b8fa9(0x1b4)](_0x20c972,_0x3e16a4)))return _0x1b3c90[_0x2b8fa9(0x1aa)](0x190)[_0x2b8fa9(0x192)]({'error':'Configuration\x20file\x20not\x20found'});const _0x53fdb1=path[_0x2b8fa9(0x1b4)](_0x20c972,''+_0x3fa85a[_0x2b8fa9(0x197)]('.'+_0xb5b493,_0x2b8fa9(0x194))),_0x34c9d0=path[_0x2b8fa9(0x1b4)](_0x20c972,''+_0x3fa85a[_0x2b8fa9(0x197)]('.'+_0xb5b493,_0x2b8fa9(0x19c)));_0x386edc['initialization']&&initializeFloorplan(_0x35f770,_0x34c9d0,{'cde':path['join'](_0x20c972,_0x3e16a4[_0x2b8fa9(0x197)](_0x2b8fa9(0x1a7),_0x2b8fa9(0x1b1)))});_0x386edc[_0x2b8fa9(0x191)]&&updateFloorplan(_0x34c9d0,_0x53fdb1,{'du2':path[_0x2b8fa9(0x1b4)](_0x20c972,_0x3e16a4['replace'](_0x2b8fa9(0x1a7),_0x2b8fa9(0x18b)))});let _0x333523=null;_0x386edc[_0x2b8fa9(0x19e)]&&(_0x333523=_0x53fdb1['replace']('.'+_0xb5b493,'.json')['replace'](_0x2b8fa9(0x1a2),'json/property'),extractFloorplan(_0x53fdb1,_0x333523,{'dx2':path['join'](_0x20c972,_0x3e16a4[_0x2b8fa9(0x197)]('.json',_0x2b8fa9(0x1b1)))}));let _0x3cfb13=null;_0x386edc['createDrawing']&&(_0x3cfb13=_0x53fdb1[_0x2b8fa9(0x197)]('.'+_0xb5b493,'.svg')['replace']('dwg',_0x2b8fa9(0x1a1)),dwgToSvg(_0x53fdb1,_0x3cfb13,{'f':_0x2b8fa9(0x1a1),'last':'','extents':'','rl':'VizQuery_Space','tl':_0x2b8fa9(0x1ab)})),_0x1b3c90['status'](0xc8)[_0x2b8fa9(0x192)]({'initial_output_path':_0x53fdb1,'initial_output_tmp_path':_0x34c9d0,'extracted_output_path':_0x333523,'svg_output_path':_0x3cfb13});}),router[a3_0x5b3abd(0x1b5)](a3_0x5b3abd(0x19a),(_0x488a1f,_0x505cf5)=>{const _0x22f752=a3_0x5b3abd,{jsonConfigFilename:_0x1ae82f,contentLocation:_0x30d7ee}=_0x488a1f[_0x22f752(0x189)],_0x37de9a=_0x488a1f[_0x22f752(0x189)][_0x22f752(0x1a9)];if(!_0x1ae82f||!_0x30d7ee||!_0x37de9a)return _0x505cf5[_0x22f752(0x1aa)](0x190)[_0x22f752(0x192)]({'error':_0x22f752(0x19d)});try{let _0x27b660;try{_0x27b660=typeof _0x37de9a===_0x22f752(0x1ac)?JSON[_0x22f752(0x18a)](_0x37de9a):_0x37de9a;}catch(_0x35a946){return _0x505cf5[_0x22f752(0x1aa)](0x190)[_0x22f752(0x192)]({'error':_0x22f752(0x18c)});}if(!_0x27b660[_0x22f752(0x196)]||!_0x27b660['Parameters']||!Array[_0x22f752(0x1a5)](_0x27b660[_0x22f752(0x196)]))return _0x505cf5[_0x22f752(0x1aa)](0x190)[_0x22f752(0x192)]({'error':_0x22f752(0x1b7)});const _0x3ae3f2=_0x30d7ee[_0x22f752(0x1b0)]('/'),_0x14173e=_0x3ae3f2[_0x22f752(0x1a4)](0x0,-0x1)[_0x22f752(0x1b4)]('/'),_0x2e5b4f=_0x1ae82f,_0x4658f2=path[_0x22f752(0x1b4)](_0x14173e,_0x2e5b4f);fs['writeFileSync'](_0x4658f2,JSON[_0x22f752(0x18f)](_0x27b660,null,0x2)),_0x505cf5[_0x22f752(0x1aa)](0xc8)[_0x22f752(0x192)]({'success':!![],'message':_0x22f752(0x1a3),'filePath':_0x4658f2});}catch(_0x19fc39){console[_0x22f752(0x1b3)](_0x22f752(0x1af),_0x19fc39),_0x505cf5[_0x22f752(0x1aa)](0x1f4)['json']({'error':'Failed\x20to\x20save\x20configuration\x20file','details':_0x19fc39['message']});}}),module[a3_0x5b3abd(0x1a6)]=router;function a3_0x1afc(_0x4c7a56,_0x29f63c){const _0x519ce3=a3_0x519c();return a3_0x1afc=function(_0x1afc9c,_0x369654){_0x1afc9c=_0x1afc9c-0x188;let _0x449094=_0x519ce3[_0x1afc9c];return _0x449094;},a3_0x1afc(_0x4c7a56,_0x29f63c);}function a3_0x519c(){const _0x46d901=['4UrUYdZ','body','parse','-changes.json','Invalid\x20JSON\x20data','Router','1983699mInmKL','stringify','1834540NTKPfY','update','json','4767992YbQCZn','-new.dwg','1033893iSSzUh','Areas','replace','log','593850ZgMLwJ','/config-file','324980pwBMUV','-temp-name.dwg','Missing\x20required\x20parameters:\x20jsonConfigFilename,\x20contentLocation\x20or\x20configData','extraction','2NLurUp','pop','svg','dwg','Configuration\x20file\x20saved\x20successfully','slice','isArray','exports','.json','existsSync','configData','status','VizQuery_ID','string','../libs/autoexchange','21awPJac','Error\x20saving\x20configuration\x20file:','split','-init.json','../libs/config','error','join','post','7485810PSFdfM','Invalid\x20config\x20structure:\x20must\x20contain\x20Areas\x20array\x20and\x20Parameters\x20object'];a3_0x519c=function(){return _0x46d901;};return a3_0x519c();}