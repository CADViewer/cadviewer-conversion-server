const a3_0x393535=a3_0xa56e;function a3_0x52a6(){const _0x4c34f6=['3333444CSvWgE','existsSync','update','slice','8JusuWS','Initialization\x20configuration\x20file\x20not\x20found','length','2225460lclRqK','join','pop','1311794xOzyaw','svg','replace','json/property','configData','split','parse','body','Router','Error\x20saving\x20configuration\x20file:','status','extraction','mkdirSync','post','7QpqISQ','createDrawing','1tQRzhJ','Update\x20configuration\x20file\x20not\x20found','stringify','Extraction\x20configuration\x20file\x20not\x20found','19540380ornYPU','initialization','message','json','error','1874496vLVYfU','../libs/config','express','path','5765841orndqU','string','writeFileSync','Missing\x20required\x20parameters:\x20jsonConfigFilename,\x20contentLocation\x20or\x20configData','cvjs_debug','VizQuery_Space','dwg','exports','/config-file','2743600oCCGGc','Invalid\x20JSON\x20data'];a3_0x52a6=function(){return _0x4c34f6;};return a3_0x52a6();}(function(_0x383fbe,_0x11b294){const _0x47e8d4=a3_0xa56e,_0x13ea7b=_0x383fbe();while(!![]){try{const _0x223b1c=-parseInt(_0x47e8d4(0x1c5))/0x1*(-parseInt(_0x47e8d4(0x1b5))/0x2)+-parseInt(_0x47e8d4(0x1ce))/0x3+parseInt(_0x47e8d4(0x1b2))/0x4+parseInt(_0x47e8d4(0x1db))/0x5+parseInt(_0x47e8d4(0x1ab))/0x6*(parseInt(_0x47e8d4(0x1c3))/0x7)+parseInt(_0x47e8d4(0x1af))/0x8*(parseInt(_0x47e8d4(0x1d2))/0x9)+-parseInt(_0x47e8d4(0x1c9))/0xa;if(_0x223b1c===_0x11b294)break;else _0x13ea7b['push'](_0x13ea7b['shift']());}catch(_0xf53faf){_0x13ea7b['push'](_0x13ea7b['shift']());}}}(a3_0x52a6,0x5c5df));function a3_0xa56e(_0x21e505,_0x17178b){const _0x52a66b=a3_0x52a6();return a3_0xa56e=function(_0xa56e9b,_0x4fa584){_0xa56e9b=_0xa56e9b-0x1aa;let _0x1e1a3f=_0x52a66b[_0xa56e9b];return _0x1e1a3f;},a3_0xa56e(_0x21e505,_0x17178b);}const config=require('../CADViewer_config.json'),cvjs_debug=config[a3_0x393535(0x1d6)],fs=require('fs'),path=require(a3_0x393535(0x1d1)),{dwgToSvg,initializeFloorplan,updateFloorplan,extractFloorplan}=require('../libs/autoexchange'),express=require(a3_0x393535(0x1d0)),router=express[a3_0x393535(0x1bd)](),{getHotConfig}=require(a3_0x393535(0x1cf));router[a3_0x393535(0x1c2)]('',(_0x4ae513,_0x3dd7db)=>{const _0x209756=a3_0x393535,{filename:_0xe70114,action:_0x3214c6,contentLocation:_0x114d2e,initOutputFilename:_0x1e8e52,initConfigFilename:_0x20f2eb,updateOutputFilename:_0x1cf9e6,updateConfigFilename:_0x176058,extractConfigFilename:_0x23569c,extractOutputFilename:_0x510299,drawingOutputFilename:_0xca8b22}=_0x4ae513['body'];_0x3214c6[_0x209756(0x1ca)]&&(_0x3214c6[_0x209756(0x1c0)]=![]);const _0x2028ac=_0x114d2e[_0x209756(0x1ba)]('/'),_0x387fcf=_0x2028ac[_0x2028ac[_0x209756(0x1b1)]-0x1],_0x239b6e=_0x387fcf[_0x209756(0x1ba)]('.')[_0x209756(0x1b4)](),_0x4b2cd9=_0x2028ac[_0x209756(0x1ae)](0x0,-0x1)[_0x209756(0x1b3)]('/');if(_0x3214c6[_0x209756(0x1ca)]){if(!fs['existsSync'](path[_0x209756(0x1b3)](_0x4b2cd9,_0x20f2eb)))return _0x3dd7db[_0x209756(0x1bf)](0x190)['json']({'error':_0x209756(0x1b0)});}if(_0x3214c6[_0x209756(0x1ad)]){if(!fs['existsSync'](path[_0x209756(0x1b3)](_0x4b2cd9,_0x176058)))return _0x3dd7db['status'](0x190)[_0x209756(0x1cc)]({'error':_0x209756(0x1c6)});}if(_0x3214c6['extraction']){if(!fs[_0x209756(0x1ac)](path['join'](_0x4b2cd9,_0x23569c)))return _0x3dd7db[_0x209756(0x1bf)](0x190)['json']({'error':_0x209756(0x1c8)});}const _0x44f1fb=path['join'](_0x4b2cd9,''+_0x1e8e52);_0x3214c6[_0x209756(0x1ca)]&&initializeFloorplan(_0x114d2e,_0x44f1fb,{'cde':path['join'](_0x4b2cd9,_0x20f2eb)});const _0x4d3ca5=_0x3214c6[_0x209756(0x1ca)]?_0x44f1fb:_0x114d2e,_0x29eb9f=path['join'](_0x4b2cd9,''+_0x1cf9e6);_0x3214c6['update']&&updateFloorplan(_0x4d3ca5,_0x29eb9f,{'du2':path[_0x209756(0x1b3)](_0x4b2cd9,_0x176058)});const _0x28d5d1=_0x3214c6['initialization']?_0x44f1fb:_0x3214c6[_0x209756(0x1ad)]?_0x29eb9f:_0x114d2e,_0x557b50=path[_0x209756(0x1b3)](_0x4b2cd9['replace']('dwg','json/property'),''+_0x510299);_0x3214c6[_0x209756(0x1c0)]&&(!fs[_0x209756(0x1ac)](_0x4b2cd9[_0x209756(0x1b7)]('dwg',_0x209756(0x1b8)))&&fs['mkdirSync'](_0x4b2cd9[_0x209756(0x1b7)]('dwg',_0x209756(0x1b8)),{'recursive':!![]}),extractFloorplan(_0x28d5d1,_0x557b50,{'dx2':path['join'](_0x4b2cd9,_0x23569c)}));const _0x3211bb=_0x3214c6[_0x209756(0x1ca)]?_0x44f1fb:_0x3214c6[_0x209756(0x1ad)]?_0x29eb9f:_0x114d2e,_0x154f1b=path['join'](_0x4b2cd9['replace']('dwg',_0x209756(0x1b6)),''+_0xca8b22);_0x3214c6[_0x209756(0x1c4)]&&(!fs[_0x209756(0x1ac)](_0x4b2cd9['replace']('dwg','svg'))&&fs[_0x209756(0x1c1)](_0x4b2cd9[_0x209756(0x1b7)](_0x209756(0x1d8),_0x209756(0x1b6)),{'recursive':!![]}),dwgToSvg(_0x3211bb,_0x154f1b,{'f':_0x209756(0x1b6),'last':'','extents':'','rl':_0x209756(0x1d7),'tl':'VizQuery_ID'})),_0x3dd7db['status'](0xc8)['json']({'initial_output_path':_0x3214c6['initialization']?_0x44f1fb:_0x3214c6[_0x209756(0x1ad)]?_0x29eb9f:_0x114d2e,'update_output_path':_0x3214c6['update']?_0x29eb9f:null,'extracted_output_path':_0x3214c6[_0x209756(0x1c0)]?_0x557b50:null,'drawing_output_path':_0x3214c6[_0x209756(0x1c4)]?_0x154f1b:null});}),router[a3_0x393535(0x1c2)](a3_0x393535(0x1da),(_0x4c1bd3,_0x45bb4b)=>{const _0x58d905=a3_0x393535,{jsonConfigFilename:_0x42c68d,contentLocation:_0x118638}=_0x4c1bd3[_0x58d905(0x1bc)],_0x25b3ed=_0x4c1bd3[_0x58d905(0x1bc)][_0x58d905(0x1b9)];if(!_0x42c68d||!_0x118638||!_0x25b3ed)return _0x45bb4b[_0x58d905(0x1bf)](0x190)[_0x58d905(0x1cc)]({'error':_0x58d905(0x1d5)});try{let _0x4a46fd;try{_0x4a46fd=typeof _0x25b3ed===_0x58d905(0x1d3)?JSON[_0x58d905(0x1bb)](_0x25b3ed):_0x25b3ed;}catch(_0x373389){return _0x45bb4b[_0x58d905(0x1bf)](0x190)[_0x58d905(0x1cc)]({'error':_0x58d905(0x1aa)});}const _0x1fee5b=_0x118638[_0x58d905(0x1ba)]('/'),_0x477ccb=_0x1fee5b[_0x58d905(0x1ae)](0x0,-0x1)[_0x58d905(0x1b3)]('/'),_0x1563d1=_0x42c68d,_0x5c58ee=path[_0x58d905(0x1b3)](_0x477ccb,_0x1563d1);fs[_0x58d905(0x1d4)](_0x5c58ee,JSON[_0x58d905(0x1c7)](_0x4a46fd,null,0x2)),_0x45bb4b[_0x58d905(0x1bf)](0xc8)['json']({'success':!![],'message':'Configuration\x20file\x20saved\x20successfully','filePath':_0x5c58ee});}catch(_0x1f10c7){console[_0x58d905(0x1cd)](_0x58d905(0x1be),_0x1f10c7),_0x45bb4b[_0x58d905(0x1bf)](0x1f4)[_0x58d905(0x1cc)]({'error':'Failed\x20to\x20save\x20configuration\x20file','details':_0x1f10c7[_0x58d905(0x1cb)]});}}),module[a3_0x393535(0x1d9)]=router;