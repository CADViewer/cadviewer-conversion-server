const a3_0x33ccf9=a3_0x9eda;(function(_0x989327,_0xaaf3e6){const _0x5c4dec=a3_0x9eda,_0x55ba72=_0x989327();while(!![]){try{const _0x3db171=-parseInt(_0x5c4dec(0xeb))/0x1*(-parseInt(_0x5c4dec(0xe8))/0x2)+parseInt(_0x5c4dec(0xdc))/0x3+-parseInt(_0x5c4dec(0xf6))/0x4+parseInt(_0x5c4dec(0xdb))/0x5*(-parseInt(_0x5c4dec(0xed))/0x6)+-parseInt(_0x5c4dec(0xf9))/0x7+parseInt(_0x5c4dec(0xda))/0x8+parseInt(_0x5c4dec(0xf2))/0x9*(parseInt(_0x5c4dec(0xde))/0xa);if(_0x3db171===_0xaaf3e6)break;else _0x55ba72['push'](_0x55ba72['shift']());}catch(_0x1b4261){_0x55ba72['push'](_0x55ba72['shift']());}}}(a3_0x5351,0xc1e09));function a3_0x5351(){const _0x4f19b5=['json/property','1008664gHJWyz','3110315ubtdOO','173805jpHrWh','Router','36151670NMakAo','createDrawing','pop','replace','parse','Invalid\x20JSON\x20data','svg','existsSync','Missing\x20required\x20parameters:\x20jsonConfigFilename,\x20contentLocation\x20or\x20configData','Error\x20saving\x20configuration\x20file:','4906ncKRhN','cvjs_debug','message','25zbVyll','Update\x20configuration\x20file\x20not\x20found','12cnbgaI','string','Configuration\x20file\x20saved\x20successfully','join','dwg','9UsxvAq','/config-file','extraction','status','1663732kOQMen','VizQuery_ID','Failed\x20to\x20save\x20configuration\x20file','9844310bfdZql','error','path','post','../CADViewer_config.json','../libs/config','initialization','writeFileSync','Initialization\x20configuration\x20file\x20not\x20found','update','split','express','json','../libs/autoexchange','slice','stringify','body'];a3_0x5351=function(){return _0x4f19b5;};return a3_0x5351();}function a3_0x9eda(_0x3b781c,_0x342466){const _0x535132=a3_0x5351();return a3_0x9eda=function(_0x9eda4f,_0x2dcbba){_0x9eda4f=_0x9eda4f-0xcc;let _0x4c36e3=_0x535132[_0x9eda4f];return _0x4c36e3;},a3_0x9eda(_0x3b781c,_0x342466);}const config=require(a3_0x33ccf9(0xcc)),cvjs_debug=config[a3_0x33ccf9(0xe9)],fs=require('fs'),path=require(a3_0x33ccf9(0xfb)),{dwgToSvg,initializeFloorplan,updateFloorplan,extractFloorplan}=require(a3_0x33ccf9(0xd5)),express=require(a3_0x33ccf9(0xd3)),router=express[a3_0x33ccf9(0xdd)](),{getHotConfig}=require(a3_0x33ccf9(0xcd));router[a3_0x33ccf9(0xfc)]('',(_0x4dd0a2,_0x566455)=>{const _0x5c602b=a3_0x33ccf9,{filename:_0x44cbe3,action:_0x2d260f,contentLocation:_0x3bbf5b,initOutputFilename:_0x34f353,initConfigFilename:_0x3eb5b1,updateOutputFilename:_0x1f4b2d,updateConfigFilename:_0x4e2c41,extractConfigFilename:_0x29497f,extractOutputFilename:_0x748b53,drawingOutputFilename:_0x27eed5}=_0x4dd0a2[_0x5c602b(0xd8)];_0x2d260f[_0x5c602b(0xce)]&&(_0x2d260f[_0x5c602b(0xf4)]=![]);const _0x10df6c=_0x3bbf5b[_0x5c602b(0xd2)]('/'),_0x430bfd=_0x10df6c[_0x10df6c['length']-0x1],_0x4da068=_0x430bfd[_0x5c602b(0xd2)]('.')[_0x5c602b(0xe0)](),_0x40a50e=_0x10df6c[_0x5c602b(0xd6)](0x0,-0x1)['join']('/');if(_0x2d260f[_0x5c602b(0xce)]){if(!fs[_0x5c602b(0xe5)](path[_0x5c602b(0xf0)](_0x40a50e,_0x3eb5b1)))return _0x566455[_0x5c602b(0xf5)](0x190)[_0x5c602b(0xd4)]({'error':_0x5c602b(0xd0)});}if(_0x2d260f[_0x5c602b(0xd1)]){if(!fs[_0x5c602b(0xe5)](path[_0x5c602b(0xf0)](_0x40a50e,_0x4e2c41)))return _0x566455['status'](0x190)[_0x5c602b(0xd4)]({'error':_0x5c602b(0xec)});}if(_0x2d260f['extraction']){if(!fs['existsSync'](path[_0x5c602b(0xf0)](_0x40a50e,_0x29497f)))return _0x566455[_0x5c602b(0xf5)](0x190)[_0x5c602b(0xd4)]({'error':'Extraction\x20configuration\x20file\x20not\x20found'});}const _0x39d210=path[_0x5c602b(0xf0)](_0x40a50e,''+_0x34f353);_0x2d260f[_0x5c602b(0xce)]&&initializeFloorplan(_0x3bbf5b,_0x39d210,{'cde':path[_0x5c602b(0xf0)](_0x40a50e,_0x3eb5b1)});const _0x4995e7=_0x2d260f['initialization']?_0x39d210:_0x3bbf5b,_0x2abf4a=path[_0x5c602b(0xf0)](_0x40a50e,''+_0x1f4b2d);_0x2d260f[_0x5c602b(0xd1)]&&updateFloorplan(_0x4995e7,_0x2abf4a,{'du2':path[_0x5c602b(0xf0)](_0x40a50e,_0x4e2c41)});const _0x396262=_0x2d260f[_0x5c602b(0xce)]?_0x39d210:_0x2d260f[_0x5c602b(0xd1)]?_0x2abf4a:_0x3bbf5b,_0x4928d2=path[_0x5c602b(0xf0)](_0x40a50e[_0x5c602b(0xe1)]('dwg',_0x5c602b(0xd9)),''+_0x748b53);_0x2d260f['extraction']&&(!fs[_0x5c602b(0xe5)](_0x40a50e[_0x5c602b(0xe1)](_0x5c602b(0xf1),_0x5c602b(0xd9)))&&fs['mkdirSync'](_0x40a50e[_0x5c602b(0xe1)](_0x5c602b(0xf1),'json/property'),{'recursive':!![]}),extractFloorplan(_0x396262,_0x4928d2,{'dx2':path[_0x5c602b(0xf0)](_0x40a50e,_0x29497f)}));const _0x3a3644=_0x2d260f[_0x5c602b(0xce)]?_0x39d210:_0x2d260f['update']?_0x2abf4a:_0x3bbf5b,_0x339b22=path[_0x5c602b(0xf0)](_0x40a50e[_0x5c602b(0xe1)](_0x5c602b(0xf1),_0x5c602b(0xe4)),''+_0x27eed5);_0x2d260f[_0x5c602b(0xdf)]&&(!fs['existsSync'](_0x40a50e['replace'](_0x5c602b(0xf1),_0x5c602b(0xe4)))&&fs['mkdirSync'](_0x40a50e[_0x5c602b(0xe1)](_0x5c602b(0xf1),_0x5c602b(0xe4)),{'recursive':!![]}),dwgToSvg(_0x3a3644,_0x339b22,{'f':_0x5c602b(0xe4),'last':'','extents':'','rl':'VizQuery_Space','tl':_0x5c602b(0xf7)})),_0x566455[_0x5c602b(0xf5)](0xc8)['json']({'initial_output_path':_0x2d260f['initialization']?_0x39d210:_0x2d260f['update']?_0x2abf4a:_0x3bbf5b,'update_output_path':_0x2d260f['update']?_0x2abf4a:null,'extracted_output_path':_0x2d260f[_0x5c602b(0xf4)]?_0x4928d2:null,'drawing_output_path':_0x2d260f[_0x5c602b(0xdf)]?_0x339b22:null});}),router[a3_0x33ccf9(0xfc)](a3_0x33ccf9(0xf3),(_0x36fbee,_0x167e9a)=>{const _0x4beaf7=a3_0x33ccf9,{jsonConfigFilename:_0x4df139,contentLocation:_0x341a06}=_0x36fbee['body'],_0x3c33b5=_0x36fbee[_0x4beaf7(0xd8)]['configData'];if(!_0x4df139||!_0x341a06||!_0x3c33b5)return _0x167e9a[_0x4beaf7(0xf5)](0x190)[_0x4beaf7(0xd4)]({'error':_0x4beaf7(0xe6)});try{let _0x4a6020;try{_0x4a6020=typeof _0x3c33b5===_0x4beaf7(0xee)?JSON[_0x4beaf7(0xe2)](_0x3c33b5):_0x3c33b5;}catch(_0x294edf){return _0x167e9a[_0x4beaf7(0xf5)](0x190)[_0x4beaf7(0xd4)]({'error':_0x4beaf7(0xe3)});}const _0x33dc04=_0x341a06[_0x4beaf7(0xd2)]('/'),_0x28f212=_0x33dc04[_0x4beaf7(0xd6)](0x0,-0x1)[_0x4beaf7(0xf0)]('/'),_0x35164d=_0x4df139,_0x39d7ca=path[_0x4beaf7(0xf0)](_0x28f212,_0x35164d);fs[_0x4beaf7(0xcf)](_0x39d7ca,JSON[_0x4beaf7(0xd7)](_0x4a6020,null,0x2)),_0x167e9a[_0x4beaf7(0xf5)](0xc8)[_0x4beaf7(0xd4)]({'success':!![],'message':_0x4beaf7(0xef),'filePath':_0x39d7ca});}catch(_0x28bf0b){console[_0x4beaf7(0xfa)](_0x4beaf7(0xe7),_0x28bf0b),_0x167e9a[_0x4beaf7(0xf5)](0x1f4)[_0x4beaf7(0xd4)]({'error':_0x4beaf7(0xf8),'details':_0x28bf0b[_0x4beaf7(0xea)]});}}),module['exports']=router;