function a8_0x3489(){const _0x3dd59c=['body','reduce','970677pzoYYX','rmdirSync','mkdirSync','Path\x20is\x20required','folder_name','folderLocation','map','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','39918LhhYNG','Folder\x20name\x20is\x20required','unlinkSync','log','2beqbWq','20kFNuFg','\x20files','8630111uPNGPO','Error!\x20Something\x20went\x20wrong.','readdirSync','existsSync','execute','exports','multer','renameSync','path','email','send','verifyToken','2724ZqWKxB','325990SjLdtJ','length','./uploads/','promise','delete','../libs/mysql.js','1157387lAstug','56472ovSCRe','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','188ddyTnw','130WhDEBs','./uploads','77790bSZBZz','status','crypto','post','originalname','forEach','/files','json','express','array','size','96EKVJqJ','user'];a8_0x3489=function(){return _0x3dd59c;};return a8_0x3489();}const a8_0x3f596c=a8_0x1d8a;(function(_0x37e4aa,_0x530300){const _0x180549=a8_0x1d8a,_0x298c9c=_0x37e4aa();while(!![]){try{const _0x5a5bd0=-parseInt(_0x180549(0x1a9))/0x1*(parseInt(_0x180549(0x182))/0x2)+parseInt(_0x180549(0x1a5))/0x3*(-parseInt(_0x180549(0x18b))/0x4)+-parseInt(_0x180549(0x18c))/0x5*(-parseInt(_0x180549(0x18e))/0x6)+parseInt(_0x180549(0x1ac))/0x7+parseInt(_0x180549(0x199))/0x8*(parseInt(_0x180549(0x19d))/0x9)+-parseInt(_0x180549(0x1aa))/0xa*(parseInt(_0x180549(0x188))/0xb)+parseInt(_0x180549(0x181))/0xc*(-parseInt(_0x180549(0x189))/0xd);if(_0x5a5bd0===_0x530300)break;else _0x298c9c['push'](_0x298c9c['shift']());}catch(_0x200854){_0x298c9c['push'](_0x298c9c['shift']());}}}(a8_0x3489,0xaee11));const multer=require(a8_0x3f596c(0x17b)),fs=require('fs'),{randomUUID}=require(a8_0x3f596c(0x190)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require('../CADViewer_config.json'),conn=require(a8_0x3f596c(0x187)),verifyToken=require('../libs/jwt')[a8_0x3f596c(0x180)],dir=a8_0x3f596c(0x18d);!fs[a8_0x3f596c(0x1af)](dir)&&fs[a8_0x3f596c(0x19f)](dir);function a8_0x1d8a(_0x1ab9b8,_0x363df1){const _0x348995=a8_0x3489();return a8_0x1d8a=function(_0x1d8a7c,_0x5573de){_0x1d8a7c=_0x1d8a7c-0x179;let _0x2c49d0=_0x348995[_0x1d8a7c];return _0x2c49d0;},a8_0x1d8a(_0x1ab9b8,_0x363df1);}const express=require(a8_0x3f596c(0x196)),router=express['Router'](),config=require('../CADViewer_config.json'),storage=multer['diskStorage']({'destination':function(_0x2de3cd,_0x23600b,_0x429d9c){_0x429d9c(null,'uploads');}}),upload=multer({'storage':storage});router[a8_0x3f596c(0x191)](a8_0x3f596c(0x194),upload[a8_0x3f596c(0x197)]('files'),verifyToken,async(_0x40f431,_0x5915a3,_0x32bba3)=>{const _0x2f1d12=a8_0x3f596c,_0x5a11aa=_0x40f431['files'],{global:_0x391288,path:_0x17a077}=_0x40f431['body'],_0xe713c0=config['folderLocation'];console[_0x2f1d12(0x1a8)]({'global':_0x391288}),console['log'](_0x5a11aa),console[_0x2f1d12(0x1a8)]({'user':_0x40f431['user']});if(_0x391288){_0x5a11aa['forEach'](_0x383543=>{const _0x2117bb=_0x2f1d12;fs['renameSync'](_0x383543[_0x2117bb(0x17d)],(_0x17a077||_0xe713c0)+'/'+_0x383543[_0x2117bb(0x192)]);}),_0x5915a3[_0x2f1d12(0x17f)]({'files':_0x5a11aa[_0x2f1d12(0x1a3)](_0x465563=>({..._0x465563,'path':(_0x17a077||_0xe713c0)+'/'+_0x465563['originalname']}))});return;}let _0x42e77b;try{const [_0x49e95a]=await conn[_0x2f1d12(0x185)]()[_0x2f1d12(0x179)](_0x2f1d12(0x18a),[_0x40f431[_0x2f1d12(0x19a)][_0x2f1d12(0x17e)]]);_0x49e95a[_0x2f1d12(0x183)]>0x0&&(_0x42e77b=_0x49e95a[0x0]);}catch(_0x492076){console[_0x2f1d12(0x1a8)]({'err':_0x492076}),_0x5915a3[_0x2f1d12(0x18f)](0x1f4)[_0x2f1d12(0x195)]({'error':_0x2f1d12(0x1ad)});return;}if(!_0x42e77b){_0x5915a3['status'](0x191)[_0x2f1d12(0x195)]({'error':'Invalid\x20user'});return;}let _0x13e757=_0x42e77b[_0x2f1d12(0x1a1)];if(!_0x13e757){_0x13e757=randomUUID();try{await conn['promise']()[_0x2f1d12(0x179)]('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x13e757,_0x40f431[_0x2f1d12(0x19a)]['email']]);}catch(_0x40a9a1){console[_0x2f1d12(0x1a8)]({'err':_0x40a9a1}),_0x5915a3[_0x2f1d12(0x18f)](0x1f4)['json']({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x258a55=_0x2f1d12(0x184)+_0x13e757;!fs['existsSync'](_0x258a55)&&fs[_0x2f1d12(0x19f)](_0x258a55);if(!_0x5a11aa){const _0x5a0baa=new Error('Please\x20upload\x20a\x20file');return _0x5a0baa['httpStatusCode']=0x190,_0x32bba3(_0x5a0baa);}const _0x372b60=fs[_0x2f1d12(0x1ae)](_0x258a55)[_0x2f1d12(0x183)]+_0x5a11aa[_0x2f1d12(0x183)];console[_0x2f1d12(0x1a8)]({'numberOfSize':_0x372b60});if(_0x372b60>userFolderMaximumFiles)return _0x5915a3[_0x2f1d12(0x18f)](0x190)[_0x2f1d12(0x195)]({'error':_0x2f1d12(0x1a4)+userFolderMaximumFiles+_0x2f1d12(0x1ab)});const _0xe10ec1=fs[_0x2f1d12(0x1ae)](_0x258a55)['reduce']((_0x13f415,_0x5556be)=>_0x13f415+fs['statSync'](_0x258a55+'/'+_0x5556be)[_0x2f1d12(0x198)],0x0),_0x318d2c=_0x5a11aa[_0x2f1d12(0x19c)]((_0x4e54da,_0x2ab28c)=>_0x4e54da+_0x2ab28c['size'],0x0);console[_0x2f1d12(0x1a8)]({'totalSize':_0xe10ec1,'uploadedSize':_0x318d2c});if(_0x318d2c+_0xe10ec1>userFolderMaximumSizeInMB*0x400*0x400)return _0x5915a3[_0x2f1d12(0x18f)](0x190)[_0x2f1d12(0x195)]({'error':_0x2f1d12(0x1a4)+userFolderMaximumSizeInMB+'\x20MB\x20of\x20files'});_0x5a11aa[_0x2f1d12(0x193)](_0x2f6b4c=>{const _0xae139d=_0x2f1d12;fs[_0xae139d(0x17c)](_0x2f6b4c[_0xae139d(0x17d)],_0x258a55+'/'+_0x2f6b4c[_0xae139d(0x192)]);}),_0x5915a3[_0x2f1d12(0x17f)]({'files':_0x5a11aa[_0x2f1d12(0x1a3)](_0x1c0b38=>({..._0x1c0b38,'path':_0x258a55+'/'+_0x1c0b38[_0x2f1d12(0x192)]}))});}),router[a8_0x3f596c(0x191)]('/folder',verifyToken,async(_0x2ed6bb,_0x1fc9b8)=>{const _0x137317=a8_0x3f596c,{path:_0x2efbde,folder_name:_0x198c92}=_0x2ed6bb[_0x137317(0x19b)],_0x4e20d9=config[_0x137317(0x1a2)];console['log']({'path':_0x2efbde,'folder_name':_0x198c92});if(!_0x2efbde)return _0x1fc9b8[_0x137317(0x18f)](0x190)[_0x137317(0x195)]({'error':_0x137317(0x1a0)});if(!_0x198c92)return _0x1fc9b8['status'](0x190)[_0x137317(0x195)]({'error':_0x137317(0x1a6)});const _0x2498ae=_0x2efbde+'/'+_0x198c92;!fs[_0x137317(0x1af)](_0x2498ae)&&fs[_0x137317(0x19f)](_0x2498ae),_0x1fc9b8['send']({'path':_0x2498ae});}),router[a8_0x3f596c(0x186)]('/remove',verifyToken,async(_0x42377e,_0x19d2b0)=>{const _0x7c7a08=a8_0x3f596c,{isFolder:_0x39c175,path:_0x18c511}=_0x42377e[_0x7c7a08(0x19b)];!_0x39c175?fs[_0x7c7a08(0x1a7)](_0x18c511):fs[_0x7c7a08(0x19e)](_0x18c511,{'recursive':!![]}),_0x19d2b0['send']({'success':!![]});}),module[a8_0x3f596c(0x17a)]=router;