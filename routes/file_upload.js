function a8_0x55cc(_0x5097a3,_0x256de4){const _0x504181=a8_0x5041();return a8_0x55cc=function(_0x55cc99,_0x1ca357){_0x55cc99=_0x55cc99-0x1a0;let _0x580165=_0x504181[_0x55cc99];return _0x580165;},a8_0x55cc(_0x5097a3,_0x256de4);}const a8_0x2ae08c=a8_0x55cc;function a8_0x5041(){const _0x4f20c7=['6231384MXPJtA','10186456jpbRHx','22585JZxwEF','verifyToken','65601AOvtQf','send','statSync','3940230IExxdc','httpStatusCode','folderLocation','/folder','renameSync','382802zlhIdJ','delete','mkdirSync','promise','execute','readdirSync','./uploads','path','Invalid\x20user','user','rmdirSync','Please\x20upload\x20a\x20file','./uploads/','multer','../libs/mysql.js','email','\x20files','Router','exports','length','reduce','../libs/jwt','Folder\x20name\x20is\x20required','crypto','unlinkSync','json','post','originalname','\x20MB\x20of\x20files','size','Error!\x20Something\x20went\x20wrong.','38CsDjjz','forEach','22944KTYUwA','map','status','existsSync','log','/remove','172zUOQYJ','uploads','../CADViewer_config.json','30nyDXzU','Path\x20is\x20required','body','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20'];a8_0x5041=function(){return _0x4f20c7;};return a8_0x5041();}(function(_0x2870d6,_0x2b41d5){const _0x89e3c4=a8_0x55cc,_0x59bb2e=_0x2870d6();while(!![]){try{const _0x192371=-parseInt(_0x89e3c4(0x1ae))/0x1+-parseInt(_0x89e3c4(0x1ac))/0x2*(-parseInt(_0x89e3c4(0x1bf))/0x3)+-parseInt(_0x89e3c4(0x1b4))/0x4*(parseInt(_0x89e3c4(0x1bd))/0x5)+parseInt(_0x89e3c4(0x1b7))/0x6*(parseInt(_0x89e3c4(0x1c7))/0x7)+parseInt(_0x89e3c4(0x1bc))/0x8+-parseInt(_0x89e3c4(0x1bb))/0x9+-parseInt(_0x89e3c4(0x1c2))/0xa;if(_0x192371===_0x2b41d5)break;else _0x59bb2e['push'](_0x59bb2e['shift']());}catch(_0x5031db){_0x59bb2e['push'](_0x59bb2e['shift']());}}}(a8_0x5041,0xa0ccc));const multer=require(a8_0x2ae08c(0x1d4)),fs=require('fs'),{randomUUID}=require(a8_0x2ae08c(0x1a4)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0x2ae08c(0x1b6)),conn=require(a8_0x2ae08c(0x1d5)),verifyToken=require(a8_0x2ae08c(0x1a2))[a8_0x2ae08c(0x1be)],dir=a8_0x2ae08c(0x1cd);!fs['existsSync'](dir)&&fs[a8_0x2ae08c(0x1c9)](dir);const express=require('express'),router=express[a8_0x2ae08c(0x1d8)](),config=require(a8_0x2ae08c(0x1b6)),storage=multer['diskStorage']({'destination':function(_0xa51041,_0xbc8020,_0x2e2f8e){const _0x134325=a8_0x2ae08c;_0x2e2f8e(null,_0x134325(0x1b5));}}),upload=multer({'storage':storage});router[a8_0x2ae08c(0x1a7)]('/files',upload['array']('files'),verifyToken,async(_0x36efb9,_0x2cb608,_0x2b5381)=>{const _0x39af4c=a8_0x2ae08c,_0x42939a=_0x36efb9['files'],{global:_0x4f82f7,path:_0x440253}=_0x36efb9[_0x39af4c(0x1b9)],_0x384212=config[_0x39af4c(0x1c4)];console[_0x39af4c(0x1b2)]({'global':_0x4f82f7}),console[_0x39af4c(0x1b2)](_0x42939a),console[_0x39af4c(0x1b2)]({'user':_0x36efb9[_0x39af4c(0x1d0)]});if(_0x4f82f7){_0x42939a[_0x39af4c(0x1ad)](_0x462c06=>{const _0x163295=_0x39af4c;fs[_0x163295(0x1c6)](_0x462c06['path'],(_0x440253||_0x384212)+'/'+_0x462c06['originalname']);}),_0x2cb608[_0x39af4c(0x1c0)]({'files':_0x42939a[_0x39af4c(0x1af)](_0x206cb2=>({..._0x206cb2,'path':(_0x440253||_0x384212)+'/'+_0x206cb2['originalname']}))});return;}let _0xceecde;try{const [_0x902989]=await conn[_0x39af4c(0x1ca)]()[_0x39af4c(0x1cb)]('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x36efb9[_0x39af4c(0x1d0)][_0x39af4c(0x1d6)]]);_0x902989['length']>0x0&&(_0xceecde=_0x902989[0x0]);}catch(_0x33255d){console[_0x39af4c(0x1b2)]({'err':_0x33255d}),_0x2cb608['status'](0x1f4)[_0x39af4c(0x1a6)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0xceecde){_0x2cb608[_0x39af4c(0x1b0)](0x191)['json']({'error':_0x39af4c(0x1cf)});return;}let _0x2b4afd=_0xceecde['folder_name'];if(!_0x2b4afd){_0x2b4afd=randomUUID();try{await conn[_0x39af4c(0x1ca)]()[_0x39af4c(0x1cb)]('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x2b4afd,_0x36efb9[_0x39af4c(0x1d0)]['email']]);}catch(_0x4a9d42){console[_0x39af4c(0x1b2)]({'err':_0x4a9d42}),_0x2cb608[_0x39af4c(0x1b0)](0x1f4)[_0x39af4c(0x1a6)]({'error':_0x39af4c(0x1ab)});return;}}const _0x5e156c=_0x39af4c(0x1d3)+_0x2b4afd;!fs[_0x39af4c(0x1b1)](_0x5e156c)&&fs['mkdirSync'](_0x5e156c);if(!_0x42939a){const _0x5cefe6=new Error(_0x39af4c(0x1d2));return _0x5cefe6[_0x39af4c(0x1c3)]=0x190,_0x2b5381(_0x5cefe6);}const _0x5bf158=fs[_0x39af4c(0x1cc)](_0x5e156c)['length']+_0x42939a[_0x39af4c(0x1a0)];console[_0x39af4c(0x1b2)]({'numberOfSize':_0x5bf158});if(_0x5bf158>userFolderMaximumFiles)return _0x2cb608[_0x39af4c(0x1b0)](0x190)[_0x39af4c(0x1a6)]({'error':_0x39af4c(0x1ba)+userFolderMaximumFiles+_0x39af4c(0x1d7)});const _0x455f24=fs[_0x39af4c(0x1cc)](_0x5e156c)['reduce']((_0x1bbf67,_0x1347dd)=>_0x1bbf67+fs[_0x39af4c(0x1c1)](_0x5e156c+'/'+_0x1347dd)[_0x39af4c(0x1aa)],0x0),_0x17fa39=_0x42939a[_0x39af4c(0x1a1)]((_0x25e4fb,_0x5f561c)=>_0x25e4fb+_0x5f561c['size'],0x0);console[_0x39af4c(0x1b2)]({'totalSize':_0x455f24,'uploadedSize':_0x17fa39});if(_0x17fa39+_0x455f24>userFolderMaximumSizeInMB*0x400*0x400)return _0x2cb608[_0x39af4c(0x1b0)](0x190)[_0x39af4c(0x1a6)]({'error':_0x39af4c(0x1ba)+userFolderMaximumSizeInMB+_0x39af4c(0x1a9)});_0x42939a[_0x39af4c(0x1ad)](_0x1841c0=>{const _0x29965c=_0x39af4c;fs['renameSync'](_0x1841c0[_0x29965c(0x1ce)],_0x5e156c+'/'+_0x1841c0['originalname']);}),_0x2cb608[_0x39af4c(0x1c0)]({'files':_0x42939a[_0x39af4c(0x1af)](_0x193bf1=>({..._0x193bf1,'path':_0x5e156c+'/'+_0x193bf1[_0x39af4c(0x1a8)]}))});}),router[a8_0x2ae08c(0x1a7)](a8_0x2ae08c(0x1c5),verifyToken,async(_0x3bef64,_0x9dcfed)=>{const _0x194d50=a8_0x2ae08c,{path:_0x3f78f7,folder_name:_0x3da737}=_0x3bef64['body'],_0x5910ff=config[_0x194d50(0x1c4)];console[_0x194d50(0x1b2)]({'path':_0x3f78f7,'folder_name':_0x3da737});if(!_0x3f78f7)return _0x9dcfed[_0x194d50(0x1b0)](0x190)[_0x194d50(0x1a6)]({'error':_0x194d50(0x1b8)});if(!_0x3da737)return _0x9dcfed[_0x194d50(0x1b0)](0x190)[_0x194d50(0x1a6)]({'error':_0x194d50(0x1a3)});const _0x16d2c1=_0x3f78f7+'/'+_0x3da737;!fs['existsSync'](_0x16d2c1)&&fs[_0x194d50(0x1c9)](_0x16d2c1),_0x9dcfed[_0x194d50(0x1c0)]({'path':_0x16d2c1});}),router[a8_0x2ae08c(0x1c8)](a8_0x2ae08c(0x1b3),verifyToken,async(_0x324891,_0x4b7ede)=>{const _0x58a927=a8_0x2ae08c,{isFolder:_0x334c59,path:_0x2f16f0}=_0x324891[_0x58a927(0x1b9)];!_0x334c59?fs[_0x58a927(0x1a5)](_0x2f16f0):fs[_0x58a927(0x1d1)](_0x2f16f0,{'recursive':!![]}),_0x4b7ede[_0x58a927(0x1c0)]({'success':!![]});}),module[a8_0x2ae08c(0x1d9)]=router;