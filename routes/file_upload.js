function a8_0x3fc4(_0x14e4c0,_0x144eea){const _0x272a3e=a8_0x272a();return a8_0x3fc4=function(_0x3fc497,_0x302945){_0x3fc497=_0x3fc497-0xa6;let _0x75851b=_0x272a3e[_0x3fc497];return _0x75851b;},a8_0x3fc4(_0x14e4c0,_0x144eea);}const a8_0x1535bd=a8_0x3fc4;(function(_0x3f3361,_0x53b273){const _0x479cce=a8_0x3fc4,_0x4947bf=_0x3f3361();while(!![]){try{const _0x3c62b5=-parseInt(_0x479cce(0xd9))/0x1*(parseInt(_0x479cce(0xb3))/0x2)+-parseInt(_0x479cce(0xc0))/0x3*(-parseInt(_0x479cce(0xbe))/0x4)+-parseInt(_0x479cce(0xaf))/0x5*(parseInt(_0x479cce(0xbd))/0x6)+parseInt(_0x479cce(0xd5))/0x7*(-parseInt(_0x479cce(0xd8))/0x8)+parseInt(_0x479cce(0xdb))/0x9*(-parseInt(_0x479cce(0xa8))/0xa)+-parseInt(_0x479cce(0xdc))/0xb+parseInt(_0x479cce(0xba))/0xc;if(_0x3c62b5===_0x53b273)break;else _0x4947bf['push'](_0x4947bf['shift']());}catch(_0xfff1c5){_0x4947bf['push'](_0x4947bf['shift']());}}}(a8_0x272a,0x809a6));const multer=require(a8_0x1535bd(0xcb)),fs=require('fs'),{randomUUID}=require(a8_0x1535bd(0xc7)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0x1535bd(0xb2)),conn=require(a8_0x1535bd(0xb1)),verifyToken=require(a8_0x1535bd(0xad))[a8_0x1535bd(0xc1)],dir=a8_0x1535bd(0xd0);function a8_0x272a(){const _0x2264b5=['1673613uHtmps','1033725bTkoPw','unlinkSync','rmdirSync','Please\x20upload\x20a\x20file','mkdirSync','folderLocation','reduce','body','40MvwWws','user','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','uploads','log','../libs/jwt','email','63680jxLYUM','post','../libs/mysql.js','../CADViewer_config.json','12048CfXxAx','execute','json','./uploads/','statSync','map','length','28526832wrEXHv','/folder','status','186bYZGqf','4Dvhvad','promise','666168HbSdbJ','verifyToken','/remove','\x20MB\x20of\x20files','Invalid\x20user','array','forEach','crypto','existsSync','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','httpStatusCode','multer','\x20files','size','originalname','files','./uploads','Error!\x20Something\x20went\x20wrong.','copyFileSync','readdirSync','path','5710733CvycbR','diskStorage','send','8LIMFls','4axUlZn','Folder\x20name\x20is\x20required'];a8_0x272a=function(){return _0x2264b5;};return a8_0x272a();}!fs[a8_0x1535bd(0xc8)](dir)&&fs[a8_0x1535bd(0xe0)](dir);const express=require('express'),router=express['Router'](),config=require(a8_0x1535bd(0xb2)),storage=multer[a8_0x1535bd(0xd6)]({'destination':function(_0x3899cc,_0x3a6f75,_0x5d7f3b){const _0x4fe044=a8_0x1535bd;_0x5d7f3b(null,_0x4fe044(0xab));}}),upload=multer({'storage':storage});router[a8_0x1535bd(0xb0)]('/files',upload[a8_0x1535bd(0xc5)](a8_0x1535bd(0xcf)),verifyToken,async(_0x92ad68,_0x1104f3,_0x1e8a72)=>{const _0x5929ca=a8_0x1535bd,_0x58a0d3=_0x92ad68['files'],{global:_0x1b56bc,path:_0x1151b0}=_0x92ad68['body'],_0x48dd45=config[_0x5929ca(0xe1)];console[_0x5929ca(0xac)]({'global':_0x1b56bc}),console[_0x5929ca(0xac)](_0x58a0d3),console['log']({'user':_0x92ad68[_0x5929ca(0xa9)]});if(_0x1b56bc){_0x58a0d3[_0x5929ca(0xc6)](_0x3a7ac7=>{const _0x567c9b=_0x5929ca;fs[_0x567c9b(0xd2)](_0x3a7ac7[_0x567c9b(0xd4)],(_0x1151b0||_0x48dd45)+'/'+_0x3a7ac7['originalname']),fs['unlinkSync'](_0x3a7ac7['path']);}),_0x1104f3['send']({'files':_0x58a0d3['map'](_0x5eddf0=>({..._0x5eddf0,'path':(_0x1151b0||_0x48dd45)+'/'+_0x5eddf0[_0x5929ca(0xce)]}))});return;}let _0x106318;try{const [_0x18a30b]=await conn[_0x5929ca(0xbf)]()[_0x5929ca(0xb4)]('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x92ad68[_0x5929ca(0xa9)][_0x5929ca(0xae)]]);_0x18a30b[_0x5929ca(0xb9)]>0x0&&(_0x106318=_0x18a30b[0x0]);}catch(_0x2145dc){console[_0x5929ca(0xac)]({'err':_0x2145dc}),_0x1104f3[_0x5929ca(0xbc)](0x1f4)['json']({'error':_0x5929ca(0xd1)});return;}if(!_0x106318){_0x1104f3[_0x5929ca(0xbc)](0x191)[_0x5929ca(0xb5)]({'error':_0x5929ca(0xc4)});return;}let _0x5b8496=_0x106318['folder_name'];if(!_0x5b8496){_0x5b8496=randomUUID();try{await conn[_0x5929ca(0xbf)]()['execute'](_0x5929ca(0xaa),[_0x5b8496,_0x92ad68[_0x5929ca(0xa9)][_0x5929ca(0xae)]]);}catch(_0x12825a){console[_0x5929ca(0xac)]({'err':_0x12825a}),_0x1104f3[_0x5929ca(0xbc)](0x1f4)[_0x5929ca(0xb5)]({'error':_0x5929ca(0xd1)});return;}}const _0x56765d=_0x5929ca(0xb6)+_0x5b8496;!fs[_0x5929ca(0xc8)](_0x56765d)&&fs[_0x5929ca(0xe0)](_0x56765d);if(!_0x58a0d3){const _0x336199=new Error(_0x5929ca(0xdf));return _0x336199[_0x5929ca(0xca)]=0x190,_0x1e8a72(_0x336199);}const _0x414e8b=fs[_0x5929ca(0xd3)](_0x56765d)[_0x5929ca(0xb9)]+_0x58a0d3['length'];console[_0x5929ca(0xac)]({'numberOfSize':_0x414e8b});if(_0x414e8b>userFolderMaximumFiles)return _0x1104f3['status'](0x190)[_0x5929ca(0xb5)]({'error':_0x5929ca(0xc9)+userFolderMaximumFiles+_0x5929ca(0xcc)});const _0x4942ad=fs['readdirSync'](_0x56765d)[_0x5929ca(0xa6)]((_0x24597b,_0x16687a)=>_0x24597b+fs[_0x5929ca(0xb7)](_0x56765d+'/'+_0x16687a)[_0x5929ca(0xcd)],0x0),_0x3516d4=_0x58a0d3[_0x5929ca(0xa6)]((_0x42dbf8,_0x3a788d)=>_0x42dbf8+_0x3a788d[_0x5929ca(0xcd)],0x0);console[_0x5929ca(0xac)]({'totalSize':_0x4942ad,'uploadedSize':_0x3516d4});if(_0x3516d4+_0x4942ad>userFolderMaximumSizeInMB*0x400*0x400)return _0x1104f3[_0x5929ca(0xbc)](0x190)[_0x5929ca(0xb5)]({'error':_0x5929ca(0xc9)+userFolderMaximumSizeInMB+_0x5929ca(0xc3)});_0x58a0d3[_0x5929ca(0xc6)](_0x4f16e2=>{const _0x24cb00=_0x5929ca;fs['copyFileSync'](_0x4f16e2[_0x24cb00(0xd4)],_0x56765d+'/'+_0x4f16e2['originalname']),fs[_0x24cb00(0xdd)](_0x4f16e2['path']);}),_0x1104f3['send']({'files':_0x58a0d3[_0x5929ca(0xb8)](_0x100e49=>({..._0x100e49,'path':_0x56765d+'/'+_0x100e49[_0x5929ca(0xce)]}))});}),router['post'](a8_0x1535bd(0xbb),verifyToken,async(_0x58eac3,_0x338baa)=>{const _0x3d21a9=a8_0x1535bd,{path:_0x3e4b1a,folder_name:_0x137f8c}=_0x58eac3[_0x3d21a9(0xa7)];console[_0x3d21a9(0xac)]({'path':_0x3e4b1a,'folder_name':_0x137f8c});if(!_0x3e4b1a)return _0x338baa[_0x3d21a9(0xbc)](0x190)['json']({'error':'Path\x20is\x20required'});if(!_0x137f8c)return _0x338baa[_0x3d21a9(0xbc)](0x190)['json']({'error':_0x3d21a9(0xda)});const _0x202c22=_0x3e4b1a+'/'+_0x137f8c;!fs[_0x3d21a9(0xc8)](_0x202c22)&&fs[_0x3d21a9(0xe0)](_0x202c22),_0x338baa[_0x3d21a9(0xd7)]({'path':_0x202c22});}),router['delete'](a8_0x1535bd(0xc2),verifyToken,async(_0x2f35b7,_0x4b2353)=>{const _0x41a18b=a8_0x1535bd,{isFolder:_0xf321b9,path:_0x3c4782}=_0x2f35b7[_0x41a18b(0xa7)];!_0xf321b9?fs[_0x41a18b(0xdd)](_0x3c4782):fs[_0x41a18b(0xde)](_0x3c4782,{'recursive':!![]}),_0x4b2353[_0x41a18b(0xd7)]({'success':!![]});}),module['exports']=router;