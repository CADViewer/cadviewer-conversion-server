function a8_0x1bd1(_0x437441,_0x1290fb){const _0x347207=a8_0x3472();return a8_0x1bd1=function(_0x1bd169,_0x47961c){_0x1bd169=_0x1bd169-0xea;let _0x247cae=_0x347207[_0x1bd169];return _0x247cae;},a8_0x1bd1(_0x437441,_0x1290fb);}const a8_0x2cc29e=a8_0x1bd1;function a8_0x3472(){const _0x2fdd00=['Path\x20is\x20required','folder_name','3198598hDoRtJ','log','statSync','user','execute','4716EKHaUJ','files','array','post','10591lcxUJH','\x20MB\x20of\x20files','json','Router','existsSync','1986600UbdsnY','uploads','express','readdirSync','564906qRlteL','diskStorage','3921PFRDiC','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','originalname','path','length','Please\x20upload\x20a\x20file','size','httpStatusCode','email','status','../CADViewer_config.json','Error!\x20Something\x20went\x20wrong.','reduce','/files','../libs/mysql.js','4337757fHDmie','../libs/jwt','verifyToken','folderLocation','10445842oUJYUa','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','forEach','45coHLJN','Invalid\x20user','1tclQjy','/folder','/remove','map','./uploads','body','./uploads/','renameSync','872iVHHiA','send','crypto','Folder\x20name\x20is\x20required','unlinkSync'];a8_0x3472=function(){return _0x2fdd00;};return a8_0x3472();}(function(_0x52a93c,_0x3bff4b){const _0x2119e7=a8_0x1bd1,_0x3cc0c1=_0x52a93c();while(!![]){try{const _0x19ddf1=-parseInt(_0x2119e7(0xfc))/0x1*(-parseInt(_0x2119e7(0x10b))/0x2)+-parseInt(_0x2119e7(0x11f))/0x3*(parseInt(_0x2119e7(0x110))/0x4)+parseInt(_0x2119e7(0xfa))/0x5*(parseInt(_0x2119e7(0x11d))/0x6)+parseInt(_0x2119e7(0x114))/0x7*(parseInt(_0x2119e7(0x104))/0x8)+parseInt(_0x2119e7(0xf3))/0x9+parseInt(_0x2119e7(0x119))/0xa+-parseInt(_0x2119e7(0xf7))/0xb;if(_0x19ddf1===_0x3bff4b)break;else _0x3cc0c1['push'](_0x3cc0c1['shift']());}catch(_0x2dc75c){_0x3cc0c1['push'](_0x3cc0c1['shift']());}}}(a8_0x3472,0xc3b61));const multer=require('multer'),fs=require('fs'),{randomUUID}=require(a8_0x2cc29e(0x106)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0x2cc29e(0xee)),conn=require(a8_0x2cc29e(0xf2)),verifyToken=require(a8_0x2cc29e(0xf4))[a8_0x2cc29e(0xf5)],dir=a8_0x2cc29e(0x100);!fs[a8_0x2cc29e(0x118)](dir)&&fs['mkdirSync'](dir);const express=require(a8_0x2cc29e(0x11b)),router=express[a8_0x2cc29e(0x117)](),config=require(a8_0x2cc29e(0xee)),storage=multer[a8_0x2cc29e(0x11e)]({'destination':function(_0x3e816d,_0x4cde46,_0x4681b8){const _0x41b79d=a8_0x2cc29e;_0x4681b8(null,_0x41b79d(0x11a));}}),upload=multer({'storage':storage});router[a8_0x2cc29e(0x113)](a8_0x2cc29e(0xf1),upload[a8_0x2cc29e(0x112)](a8_0x2cc29e(0x111)),verifyToken,async(_0x4a2235,_0x343e60,_0x200fc8)=>{const _0x5b4393=a8_0x2cc29e,_0xe4f44d=_0x4a2235['files'],{global:_0x4759c1,path:_0x226b7d}=_0x4a2235[_0x5b4393(0x101)],_0x3f0842=config[_0x5b4393(0xf6)];console[_0x5b4393(0x10c)]({'global':_0x4759c1}),console[_0x5b4393(0x10c)](_0xe4f44d),console[_0x5b4393(0x10c)]({'user':_0x4a2235[_0x5b4393(0x10e)]});if(_0x4759c1){_0xe4f44d[_0x5b4393(0xf9)](_0x27179f=>{const _0x2dea70=_0x5b4393;fs['renameSync'](_0x27179f[_0x2dea70(0x123)],(_0x226b7d||_0x3f0842)+'/'+_0x27179f[_0x2dea70(0x122)]);}),_0x343e60[_0x5b4393(0x105)]({'files':_0xe4f44d['map'](_0x5c01b1=>({..._0x5c01b1,'path':(_0x226b7d||_0x3f0842)+'/'+_0x5c01b1[_0x5b4393(0x122)]}))});return;}let _0x21ea56;try{const [_0x140355]=await conn['promise']()[_0x5b4393(0x10f)](_0x5b4393(0xf8),[_0x4a2235['user'][_0x5b4393(0xec)]]);_0x140355[_0x5b4393(0x124)]>0x0&&(_0x21ea56=_0x140355[0x0]);}catch(_0x1c9c9b){console['log']({'err':_0x1c9c9b}),_0x343e60[_0x5b4393(0xed)](0x1f4)[_0x5b4393(0x116)]({'error':_0x5b4393(0xef)});return;}if(!_0x21ea56){_0x343e60[_0x5b4393(0xed)](0x191)[_0x5b4393(0x116)]({'error':_0x5b4393(0xfb)});return;}let _0x46e782=_0x21ea56[_0x5b4393(0x10a)];if(!_0x46e782){_0x46e782=randomUUID();try{await conn['promise']()[_0x5b4393(0x10f)](_0x5b4393(0x120),[_0x46e782,_0x4a2235[_0x5b4393(0x10e)]['email']]);}catch(_0x433c1a){console[_0x5b4393(0x10c)]({'err':_0x433c1a}),_0x343e60[_0x5b4393(0xed)](0x1f4)[_0x5b4393(0x116)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x1eecc1=_0x5b4393(0x102)+_0x46e782;!fs[_0x5b4393(0x118)](_0x1eecc1)&&fs['mkdirSync'](_0x1eecc1);if(!_0xe4f44d){const _0x47dd97=new Error(_0x5b4393(0x125));return _0x47dd97[_0x5b4393(0xeb)]=0x190,_0x200fc8(_0x47dd97);}const _0x265cab=fs[_0x5b4393(0x11c)](_0x1eecc1)[_0x5b4393(0x124)]+_0xe4f44d[_0x5b4393(0x124)];console[_0x5b4393(0x10c)]({'numberOfSize':_0x265cab});if(_0x265cab>userFolderMaximumFiles)return _0x343e60[_0x5b4393(0xed)](0x190)[_0x5b4393(0x116)]({'error':_0x5b4393(0x121)+userFolderMaximumFiles+'\x20files'});const _0x3bf7f4=fs[_0x5b4393(0x11c)](_0x1eecc1)[_0x5b4393(0xf0)]((_0x15d09b,_0x78fc8c)=>_0x15d09b+fs[_0x5b4393(0x10d)](_0x1eecc1+'/'+_0x78fc8c)['size'],0x0),_0x5d5945=_0xe4f44d[_0x5b4393(0xf0)]((_0x119beb,_0x10147c)=>_0x119beb+_0x10147c[_0x5b4393(0xea)],0x0);console[_0x5b4393(0x10c)]({'totalSize':_0x3bf7f4,'uploadedSize':_0x5d5945});if(_0x5d5945+_0x3bf7f4>userFolderMaximumSizeInMB*0x400*0x400)return _0x343e60['status'](0x190)['json']({'error':'You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20'+userFolderMaximumSizeInMB+_0x5b4393(0x115)});_0xe4f44d['forEach'](_0x34ece9=>{const _0x10d498=_0x5b4393;fs[_0x10d498(0x103)](_0x34ece9[_0x10d498(0x123)],_0x1eecc1+'/'+_0x34ece9['originalname']);}),_0x343e60[_0x5b4393(0x105)]({'files':_0xe4f44d[_0x5b4393(0xff)](_0x1db91a=>({..._0x1db91a,'path':_0x1eecc1+'/'+_0x1db91a[_0x5b4393(0x122)]}))});}),router[a8_0x2cc29e(0x113)](a8_0x2cc29e(0xfd),verifyToken,async(_0xc7dd30,_0x459823)=>{const _0x58209c=a8_0x2cc29e,{path:_0xdb5491,folder_name:_0x5a2a72}=_0xc7dd30[_0x58209c(0x101)],_0x1dd5c3=config[_0x58209c(0xf6)];console[_0x58209c(0x10c)]({'path':_0xdb5491,'folder_name':_0x5a2a72});if(!_0xdb5491)return _0x459823['status'](0x190)['json']({'error':_0x58209c(0x109)});if(!_0x5a2a72)return _0x459823[_0x58209c(0xed)](0x190)['json']({'error':_0x58209c(0x107)});const _0x6c0009=_0xdb5491+'/'+_0x5a2a72;!fs[_0x58209c(0x118)](_0x6c0009)&&fs['mkdirSync'](_0x6c0009),_0x459823[_0x58209c(0x105)]({'path':_0x6c0009});}),router['delete'](a8_0x2cc29e(0xfe),verifyToken,async(_0x80d0a2,_0x4a987f)=>{const _0x145dc3=a8_0x2cc29e,{isFolder:_0x47f0ff,path:_0x296959}=_0x80d0a2[_0x145dc3(0x101)];!_0x47f0ff?fs[_0x145dc3(0x108)](_0x296959):fs['rmdirSync'](_0x296959,{'recursive':!![]}),_0x4a987f['send']({'success':!![]});}),module['exports']=router;