function a8_0x3dc8(){const _0x50821d=['size','exports','../CADViewer_config.json','245MnbyrQ','array','folderLocation','promise','Error!\x20Something\x20went\x20wrong.','680rPvcDI','3082SvMYwN','266YUNWwB','path','folder_name','body','statSync','post','Please\x20upload\x20a\x20file','Folder\x20name\x20is\x20required','100312lUnMmv','status','originalname','6852VloMVI','readdirSync','Path\x20is\x20required','/remove','rmdirSync','log','unlinkSync','execute','17811UMCCnP','./uploads','delete','../libs/mysql.js','multer','./uploads/','1907832qROoLd','express','forEach','crypto','\x20MB\x20of\x20files','Invalid\x20user','email','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','send','json','existsSync','/files','605571AiTQos','diskStorage','uploads','length','user','1796JtmPiw','19580aUtafs','mkdirSync','5645OkIBkW','/folder','renameSync','files','httpStatusCode'];a8_0x3dc8=function(){return _0x50821d;};return a8_0x3dc8();}const a8_0x8b3bb6=a8_0x427f;(function(_0x354bc2,_0x283df0){const _0x48a3b5=a8_0x427f,_0x540ce9=_0x354bc2();while(!![]){try{const _0x521b79=parseInt(_0x48a3b5(0xa9))/0x1*(-parseInt(_0x48a3b5(0xa8))/0x2)+parseInt(_0x48a3b5(0x92))/0x3+parseInt(_0x48a3b5(0x97))/0x4*(-parseInt(_0x48a3b5(0x9a))/0x5)+parseInt(_0x48a3b5(0xc2))/0x6+parseInt(_0x48a3b5(0xa2))/0x7*(-parseInt(_0x48a3b5(0xb1))/0x8)+parseInt(_0x48a3b5(0xbc))/0x9*(parseInt(_0x48a3b5(0xa7))/0xa)+-parseInt(_0x48a3b5(0x98))/0xb*(-parseInt(_0x48a3b5(0xb4))/0xc);if(_0x521b79===_0x283df0)break;else _0x540ce9['push'](_0x540ce9['shift']());}catch(_0x570f55){_0x540ce9['push'](_0x540ce9['shift']());}}}(a8_0x3dc8,0x4ced1));function a8_0x427f(_0x2cc8a0,_0x3d6526){const _0x3dc8b9=a8_0x3dc8();return a8_0x427f=function(_0x427f89,_0x3e7575){_0x427f89=_0x427f89-0x91;let _0x5c30f3=_0x3dc8b9[_0x427f89];return _0x5c30f3;},a8_0x427f(_0x2cc8a0,_0x3d6526);}const multer=require(a8_0x8b3bb6(0xc0)),fs=require('fs'),{randomUUID}=require(a8_0x8b3bb6(0xc5)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0x8b3bb6(0xa1)),conn=require(a8_0x8b3bb6(0xbf)),verifyToken=require('../libs/jwt')['verifyToken'],dir=a8_0x8b3bb6(0xbd);!fs['existsSync'](dir)&&fs[a8_0x8b3bb6(0x99)](dir);const express=require(a8_0x8b3bb6(0xc3)),router=express['Router'](),config=require('../CADViewer_config.json'),storage=multer[a8_0x8b3bb6(0x93)]({'destination':function(_0x1e9245,_0x3609c7,_0x36a611){const _0x3a3eb1=a8_0x8b3bb6;_0x36a611(null,_0x3a3eb1(0x94));}}),upload=multer({'storage':storage});router[a8_0x8b3bb6(0xae)](a8_0x8b3bb6(0x91),upload[a8_0x8b3bb6(0xa3)](a8_0x8b3bb6(0x9d)),verifyToken,async(_0x506aca,_0xbc27b8,_0xf58641)=>{const _0x13a74c=a8_0x8b3bb6,_0x1a49e4=_0x506aca[_0x13a74c(0x9d)],{global:_0x5e1bb8,path:_0x192ed6}=_0x506aca['body'],_0x54011f=config[_0x13a74c(0xa4)];console[_0x13a74c(0xb9)]({'global':_0x5e1bb8}),console[_0x13a74c(0xb9)](_0x1a49e4),console[_0x13a74c(0xb9)]({'user':_0x506aca['user']});if(_0x5e1bb8){_0x1a49e4[_0x13a74c(0xc4)](_0x1530b4=>{const _0x93a10=_0x13a74c;fs[_0x93a10(0x9c)](_0x1530b4[_0x93a10(0xaa)],(_0x192ed6||_0x54011f)+'/'+_0x1530b4[_0x93a10(0xb3)]);}),_0xbc27b8[_0x13a74c(0xca)]({'files':_0x1a49e4['map'](_0x35bcd7=>({..._0x35bcd7,'path':(_0x192ed6||_0x54011f)+'/'+_0x35bcd7[_0x13a74c(0xb3)]}))});return;}let _0x243c5e;try{const [_0x4dbcb9]=await conn[_0x13a74c(0xa5)]()['execute'](_0x13a74c(0xc9),[_0x506aca['user'][_0x13a74c(0xc8)]]);_0x4dbcb9['length']>0x0&&(_0x243c5e=_0x4dbcb9[0x0]);}catch(_0x56a368){console[_0x13a74c(0xb9)]({'err':_0x56a368}),_0xbc27b8[_0x13a74c(0xb2)](0x1f4)[_0x13a74c(0xcb)]({'error':_0x13a74c(0xa6)});return;}if(!_0x243c5e){_0xbc27b8[_0x13a74c(0xb2)](0x191)[_0x13a74c(0xcb)]({'error':_0x13a74c(0xc7)});return;}let _0x153582=_0x243c5e[_0x13a74c(0xab)];if(!_0x153582){_0x153582=randomUUID();try{await conn[_0x13a74c(0xa5)]()[_0x13a74c(0xbb)]('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x153582,_0x506aca[_0x13a74c(0x96)][_0x13a74c(0xc8)]]);}catch(_0xadfb19){console[_0x13a74c(0xb9)]({'err':_0xadfb19}),_0xbc27b8['status'](0x1f4)[_0x13a74c(0xcb)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x540995=_0x13a74c(0xc1)+_0x153582;!fs[_0x13a74c(0xcc)](_0x540995)&&fs[_0x13a74c(0x99)](_0x540995);if(!_0x1a49e4){const _0x2c5e2d=new Error(_0x13a74c(0xaf));return _0x2c5e2d[_0x13a74c(0x9e)]=0x190,_0xf58641(_0x2c5e2d);}const _0x48ee6f=fs['readdirSync'](_0x540995)['length']+_0x1a49e4[_0x13a74c(0x95)];console['log']({'numberOfSize':_0x48ee6f});if(_0x48ee6f>userFolderMaximumFiles)return _0xbc27b8['status'](0x190)[_0x13a74c(0xcb)]({'error':'You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20'+userFolderMaximumFiles+'\x20files'});const _0x26d68a=fs[_0x13a74c(0xb5)](_0x540995)['reduce']((_0x228dc4,_0x407baa)=>_0x228dc4+fs[_0x13a74c(0xad)](_0x540995+'/'+_0x407baa)['size'],0x0),_0x43b30b=_0x1a49e4['reduce']((_0x289fab,_0x2f9f44)=>_0x289fab+_0x2f9f44[_0x13a74c(0x9f)],0x0);console[_0x13a74c(0xb9)]({'totalSize':_0x26d68a,'uploadedSize':_0x43b30b});if(_0x43b30b+_0x26d68a>userFolderMaximumSizeInMB*0x400*0x400)return _0xbc27b8[_0x13a74c(0xb2)](0x190)[_0x13a74c(0xcb)]({'error':'You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20'+userFolderMaximumSizeInMB+_0x13a74c(0xc6)});_0x1a49e4[_0x13a74c(0xc4)](_0x208f73=>{const _0x486f6c=_0x13a74c;fs[_0x486f6c(0x9c)](_0x208f73['path'],_0x540995+'/'+_0x208f73[_0x486f6c(0xb3)]);}),_0xbc27b8[_0x13a74c(0xca)]({'files':_0x1a49e4['map'](_0x3a1c03=>({..._0x3a1c03,'path':_0x540995+'/'+_0x3a1c03[_0x13a74c(0xb3)]}))});}),router[a8_0x8b3bb6(0xae)](a8_0x8b3bb6(0x9b),verifyToken,async(_0x1fd1ec,_0x1395c0)=>{const _0x1c0e1f=a8_0x8b3bb6,{path:_0x2d3034,folder_name:_0x2f535d}=_0x1fd1ec[_0x1c0e1f(0xac)],_0x4424c8=config['folderLocation'];console[_0x1c0e1f(0xb9)]({'path':_0x2d3034,'folder_name':_0x2f535d});if(!_0x2d3034)return _0x1395c0[_0x1c0e1f(0xb2)](0x190)[_0x1c0e1f(0xcb)]({'error':_0x1c0e1f(0xb6)});if(!_0x2f535d)return _0x1395c0[_0x1c0e1f(0xb2)](0x190)[_0x1c0e1f(0xcb)]({'error':_0x1c0e1f(0xb0)});const _0x365c8a=_0x2d3034+'/'+_0x2f535d;!fs[_0x1c0e1f(0xcc)](_0x365c8a)&&fs[_0x1c0e1f(0x99)](_0x365c8a),_0x1395c0[_0x1c0e1f(0xca)]({'path':_0x365c8a});}),router[a8_0x8b3bb6(0xbe)](a8_0x8b3bb6(0xb7),verifyToken,async(_0x1b8621,_0xc1eddf)=>{const _0x5cea9b=a8_0x8b3bb6,{isFolder:_0xef7004,path:_0x500eab}=_0x1b8621[_0x5cea9b(0xac)];!_0xef7004?fs[_0x5cea9b(0xba)](_0x500eab):fs[_0x5cea9b(0xb8)](_0x500eab,{'recursive':!![]}),_0xc1eddf[_0x5cea9b(0xca)]({'success':!![]});}),module[a8_0x8b3bb6(0xa0)]=router;