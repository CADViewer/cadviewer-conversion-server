function a8_0x460d(_0x30b341,_0x3d4d56){const _0x3c05f9=a8_0x3c05();return a8_0x460d=function(_0x460d13,_0xdde657){_0x460d13=_0x460d13-0x19b;let _0x524abc=_0x3c05f9[_0x460d13];return _0x524abc;},a8_0x460d(_0x30b341,_0x3d4d56);}const a8_0x14a383=a8_0x460d;(function(_0x204f43,_0x884144){const _0x4c27dd=a8_0x460d,_0x635356=_0x204f43();while(!![]){try{const _0x1256ce=parseInt(_0x4c27dd(0x1a3))/0x1+-parseInt(_0x4c27dd(0x1b2))/0x2*(-parseInt(_0x4c27dd(0x1b8))/0x3)+-parseInt(_0x4c27dd(0x1b3))/0x4+-parseInt(_0x4c27dd(0x19d))/0x5*(parseInt(_0x4c27dd(0x1ac))/0x6)+-parseInt(_0x4c27dd(0x1c3))/0x7+-parseInt(_0x4c27dd(0x1a5))/0x8+-parseInt(_0x4c27dd(0x1a7))/0x9*(-parseInt(_0x4c27dd(0x1c4))/0xa);if(_0x1256ce===_0x884144)break;else _0x635356['push'](_0x635356['shift']());}catch(_0x28a86c){_0x635356['push'](_0x635356['shift']());}}}(a8_0x3c05,0x7b64a));const multer=require(a8_0x14a383(0x1b4)),fs=require('fs'),{randomUUID}=require('crypto'),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0x14a383(0x1ad)),conn=require(a8_0x14a383(0x1cc)),verifyToken=require('../libs/jwt')['verifyToken'],dir=a8_0x14a383(0x1b6);!fs[a8_0x14a383(0x19c)](dir)&&fs[a8_0x14a383(0x1ce)](dir);function a8_0x3c05(){const _0x3ef494=['./uploads/','execute','Error!\x20Something\x20went\x20wrong.','map','files','post','folderLocation','reduce','email','670796KSeVkJ','15087230yibzUF','originalname','\x20files','Invalid\x20user','\x20MB\x20of\x20files','uploads','path','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','../libs/mysql.js','length','mkdirSync','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','forEach','log','send','delete','existsSync','1821620MTMmio','/remove','body','Please\x20upload\x20a\x20file','exports','unlinkSync','26741DZkfkl','readdirSync','6404808ENnRdb','promise','9VfYmAq','/files','/folder','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','status','12bdhMBr','../CADViewer_config.json','Path\x20is\x20required','renameSync','folder_name','size','135636tejZYG','1417684cfGiOS','multer','diskStorage','./uploads','json','42rFPMiE','user'];a8_0x3c05=function(){return _0x3ef494;};return a8_0x3c05();}const express=require('express'),router=express['Router'](),config=require(a8_0x14a383(0x1ad)),storage=multer[a8_0x14a383(0x1b5)]({'destination':function(_0x1131e3,_0xe161c7,_0xf196f9){const _0x40f5ac=a8_0x14a383;_0xf196f9(null,_0x40f5ac(0x1c9));}}),upload=multer({'storage':storage});router['post'](a8_0x14a383(0x1a8),upload['array']('files'),verifyToken,async(_0x533914,_0xd70022,_0x330744)=>{const _0x3d39ac=a8_0x14a383,_0x3b5149=_0x533914[_0x3d39ac(0x1be)],{global:_0x2e5fdc,path:_0x3eb212}=_0x533914[_0x3d39ac(0x19f)],_0x2550c5=config[_0x3d39ac(0x1c0)];console[_0x3d39ac(0x1d1)]({'global':_0x2e5fdc}),console[_0x3d39ac(0x1d1)](_0x3b5149),console['log']({'user':_0x533914['user']});if(_0x2e5fdc){_0x3b5149[_0x3d39ac(0x1d0)](_0x19fd8c=>{const _0x4f7edf=_0x3d39ac;fs[_0x4f7edf(0x1af)](_0x19fd8c[_0x4f7edf(0x1ca)],(_0x3eb212||_0x2550c5)+'/'+_0x19fd8c[_0x4f7edf(0x1c5)]);}),_0xd70022[_0x3d39ac(0x1d2)]({'files':_0x3b5149[_0x3d39ac(0x1bd)](_0x143193=>({..._0x143193,'path':(_0x3eb212||_0x2550c5)+'/'+_0x143193[_0x3d39ac(0x1c5)]}))});return;}let _0x5d84d3;try{const [_0x270765]=await conn[_0x3d39ac(0x1a6)]()[_0x3d39ac(0x1bb)](_0x3d39ac(0x1cb),[_0x533914[_0x3d39ac(0x1b9)][_0x3d39ac(0x1c2)]]);_0x270765[_0x3d39ac(0x1cd)]>0x0&&(_0x5d84d3=_0x270765[0x0]);}catch(_0xe31d01){console[_0x3d39ac(0x1d1)]({'err':_0xe31d01}),_0xd70022[_0x3d39ac(0x1ab)](0x1f4)[_0x3d39ac(0x1b7)]({'error':_0x3d39ac(0x1bc)});return;}if(!_0x5d84d3){_0xd70022[_0x3d39ac(0x1ab)](0x191)[_0x3d39ac(0x1b7)]({'error':_0x3d39ac(0x1c7)});return;}let _0x5b696f=_0x5d84d3[_0x3d39ac(0x1b0)];if(!_0x5b696f){_0x5b696f=randomUUID();try{await conn[_0x3d39ac(0x1a6)]()['execute'](_0x3d39ac(0x1cf),[_0x5b696f,_0x533914['user'][_0x3d39ac(0x1c2)]]);}catch(_0x571090){console[_0x3d39ac(0x1d1)]({'err':_0x571090}),_0xd70022['status'](0x1f4)[_0x3d39ac(0x1b7)]({'error':_0x3d39ac(0x1bc)});return;}}const _0x2ddf76=_0x3d39ac(0x1ba)+_0x5b696f;!fs[_0x3d39ac(0x19c)](_0x2ddf76)&&fs[_0x3d39ac(0x1ce)](_0x2ddf76);if(!_0x3b5149){const _0x1b5b8a=new Error(_0x3d39ac(0x1a0));return _0x1b5b8a['httpStatusCode']=0x190,_0x330744(_0x1b5b8a);}const _0x3a60f8=fs[_0x3d39ac(0x1a4)](_0x2ddf76)[_0x3d39ac(0x1cd)]+_0x3b5149['length'];console[_0x3d39ac(0x1d1)]({'numberOfSize':_0x3a60f8});if(_0x3a60f8>userFolderMaximumFiles)return _0xd70022['status'](0x190)[_0x3d39ac(0x1b7)]({'error':'You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20'+userFolderMaximumFiles+_0x3d39ac(0x1c6)});const _0x2855f4=fs[_0x3d39ac(0x1a4)](_0x2ddf76)[_0x3d39ac(0x1c1)]((_0x49375b,_0x336216)=>_0x49375b+fs['statSync'](_0x2ddf76+'/'+_0x336216)[_0x3d39ac(0x1b1)],0x0),_0x1da663=_0x3b5149[_0x3d39ac(0x1c1)]((_0x210d1f,_0x77aabd)=>_0x210d1f+_0x77aabd[_0x3d39ac(0x1b1)],0x0);console[_0x3d39ac(0x1d1)]({'totalSize':_0x2855f4,'uploadedSize':_0x1da663});if(_0x1da663+_0x2855f4>userFolderMaximumSizeInMB*0x400*0x400)return _0xd70022['status'](0x190)[_0x3d39ac(0x1b7)]({'error':_0x3d39ac(0x1aa)+userFolderMaximumSizeInMB+_0x3d39ac(0x1c8)});_0x3b5149['forEach'](_0x140e82=>{const _0x5a113b=_0x3d39ac;fs[_0x5a113b(0x1af)](_0x140e82[_0x5a113b(0x1ca)],_0x2ddf76+'/'+_0x140e82[_0x5a113b(0x1c5)]);}),_0xd70022[_0x3d39ac(0x1d2)]({'files':_0x3b5149['map'](_0x4a8221=>({..._0x4a8221,'path':_0x2ddf76+'/'+_0x4a8221['originalname']}))});}),router[a8_0x14a383(0x1bf)](a8_0x14a383(0x1a9),verifyToken,async(_0x4df7f4,_0x9cea80)=>{const _0x390001=a8_0x14a383,{path:_0x3b1ff4,folder_name:_0x327da0}=_0x4df7f4[_0x390001(0x19f)],_0xdae0dd=config[_0x390001(0x1c0)];console[_0x390001(0x1d1)]({'path':_0x3b1ff4,'folder_name':_0x327da0});if(!_0x3b1ff4)return _0x9cea80['status'](0x190)[_0x390001(0x1b7)]({'error':_0x390001(0x1ae)});if(!_0x327da0)return _0x9cea80['status'](0x190)[_0x390001(0x1b7)]({'error':'Folder\x20name\x20is\x20required'});const _0x121a5a=_0x3b1ff4+'/'+_0x327da0;!fs['existsSync'](_0x121a5a)&&fs[_0x390001(0x1ce)](_0x121a5a),_0x9cea80['send']({'path':_0x121a5a});}),router[a8_0x14a383(0x19b)](a8_0x14a383(0x19e),verifyToken,async(_0x1e946b,_0x39e351)=>{const _0x56d8d6=a8_0x14a383,{isFolder:_0x5667b4,path:_0x3c7f7d}=_0x1e946b[_0x56d8d6(0x19f)];!_0x5667b4?fs[_0x56d8d6(0x1a2)](_0x3c7f7d):fs['rmdirSync'](_0x3c7f7d,{'recursive':!![]}),_0x39e351[_0x56d8d6(0x1d2)]({'success':!![]});}),module[a8_0x14a383(0x1a1)]=router;