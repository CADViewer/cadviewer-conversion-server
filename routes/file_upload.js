function a8_0x21a3(_0x115e7c,_0x432a6d){const _0x68adf1=a8_0x68ad();return a8_0x21a3=function(_0x21a38c,_0x15668d){_0x21a38c=_0x21a38c-0x163;let _0x34d721=_0x68adf1[_0x21a38c];return _0x34d721;},a8_0x21a3(_0x115e7c,_0x432a6d);}const a8_0x12e214=a8_0x21a3;(function(_0x3a7412,_0x455822){const _0x38eaae=a8_0x21a3,_0x1b9048=_0x3a7412();while(!![]){try{const _0x367ace=parseInt(_0x38eaae(0x178))/0x1*(-parseInt(_0x38eaae(0x168))/0x2)+-parseInt(_0x38eaae(0x183))/0x3+parseInt(_0x38eaae(0x16c))/0x4*(-parseInt(_0x38eaae(0x16a))/0x5)+parseInt(_0x38eaae(0x17f))/0x6+-parseInt(_0x38eaae(0x193))/0x7+parseInt(_0x38eaae(0x17b))/0x8+parseInt(_0x38eaae(0x18f))/0x9*(parseInt(_0x38eaae(0x164))/0xa);if(_0x367ace===_0x455822)break;else _0x1b9048['push'](_0x1b9048['shift']());}catch(_0x13b211){_0x1b9048['push'](_0x1b9048['shift']());}}}(a8_0x68ad,0x73d04));function a8_0x68ad(){const _0x36c46b=['You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','copyFileSync','crypto','json','delete','/remove','Please\x20upload\x20a\x20file','path','../CADViewer_config.json','statSync','10VCPTNA','\x20MB\x20of\x20files','execute','multer','1509818zvojne','unlinkSync','222195UyzLwO','folderLocation','52FhoZSR','forEach','Router','files','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','Invalid\x20user','folder_name','status','./uploads/','originalname','size','reduce','1ZivobQ','readdirSync','mkdirSync','6293064LrhDZA','httpStatusCode','array','body','3125250QxDSSC','existsSync','map','express','2255532YekJAF','user','\x20files','./uploads','log','../libs/mysql.js','exports','send','rmdirSync','promise','Error!\x20Something\x20went\x20wrong.','Folder\x20name\x20is\x20required','17352207DVMLCG','email','length','post','4736893DCFKKM','../libs/jwt'];a8_0x68ad=function(){return _0x36c46b;};return a8_0x68ad();}const multer=require(a8_0x12e214(0x167)),fs=require('fs'),{randomUUID}=require(a8_0x12e214(0x197)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0x12e214(0x19d)),conn=require(a8_0x12e214(0x188)),verifyToken=require(a8_0x12e214(0x194))['verifyToken'],dir=a8_0x12e214(0x186);!fs['existsSync'](dir)&&fs[a8_0x12e214(0x17a)](dir);const express=require(a8_0x12e214(0x182)),router=express[a8_0x12e214(0x16e)](),config=require(a8_0x12e214(0x19d)),storage=multer['diskStorage']({'destination':function(_0x430690,_0x363a14,_0x419d3e){_0x419d3e(null,'uploads');}}),upload=multer({'storage':storage});router[a8_0x12e214(0x192)]('/files',upload[a8_0x12e214(0x17d)](a8_0x12e214(0x16f)),verifyToken,async(_0x157163,_0x4e770e,_0x9ca9b5)=>{const _0xf5a89f=a8_0x12e214,_0x380717=_0x157163[_0xf5a89f(0x16f)],{global:_0x3a5381,path:_0x1bf860}=_0x157163['body'],_0x5d1d72=config[_0xf5a89f(0x16b)];console[_0xf5a89f(0x187)]({'global':_0x3a5381}),console['log'](_0x380717),console[_0xf5a89f(0x187)]({'user':_0x157163[_0xf5a89f(0x184)]});if(_0x3a5381){_0x380717[_0xf5a89f(0x16d)](_0x17d0a5=>{const _0x1ef18c=_0xf5a89f;fs[_0x1ef18c(0x196)](_0x17d0a5[_0x1ef18c(0x19c)],(_0x1bf860||_0x5d1d72)+'/'+_0x17d0a5[_0x1ef18c(0x175)]),fs['unlinkSync'](_0x17d0a5[_0x1ef18c(0x19c)]);}),_0x4e770e[_0xf5a89f(0x18a)]({'files':_0x380717['map'](_0x44d481=>({..._0x44d481,'path':(_0x1bf860||_0x5d1d72)+'/'+_0x44d481['originalname']}))});return;}let _0x135561;try{const [_0x260001]=await conn[_0xf5a89f(0x18c)]()[_0xf5a89f(0x166)]('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x157163[_0xf5a89f(0x184)][_0xf5a89f(0x190)]]);_0x260001[_0xf5a89f(0x191)]>0x0&&(_0x135561=_0x260001[0x0]);}catch(_0x255cfe){console[_0xf5a89f(0x187)]({'err':_0x255cfe}),_0x4e770e[_0xf5a89f(0x173)](0x1f4)[_0xf5a89f(0x198)]({'error':_0xf5a89f(0x18d)});return;}if(!_0x135561){_0x4e770e[_0xf5a89f(0x173)](0x191)[_0xf5a89f(0x198)]({'error':_0xf5a89f(0x171)});return;}let _0x36e450=_0x135561[_0xf5a89f(0x172)];if(!_0x36e450){_0x36e450=randomUUID();try{await conn['promise']()['execute'](_0xf5a89f(0x170),[_0x36e450,_0x157163['user']['email']]);}catch(_0x10e7f6){console[_0xf5a89f(0x187)]({'err':_0x10e7f6}),_0x4e770e[_0xf5a89f(0x173)](0x1f4)['json']({'error':_0xf5a89f(0x18d)});return;}}const _0x225310=_0xf5a89f(0x174)+_0x36e450;!fs[_0xf5a89f(0x180)](_0x225310)&&fs[_0xf5a89f(0x17a)](_0x225310);if(!_0x380717){const _0x2b863a=new Error(_0xf5a89f(0x19b));return _0x2b863a[_0xf5a89f(0x17c)]=0x190,_0x9ca9b5(_0x2b863a);}const _0x331963=fs[_0xf5a89f(0x179)](_0x225310)[_0xf5a89f(0x191)]+_0x380717[_0xf5a89f(0x191)];console[_0xf5a89f(0x187)]({'numberOfSize':_0x331963});if(_0x331963>userFolderMaximumFiles)return _0x4e770e['status'](0x190)[_0xf5a89f(0x198)]({'error':'You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20'+userFolderMaximumFiles+_0xf5a89f(0x185)});const _0x2bec78=fs[_0xf5a89f(0x179)](_0x225310)[_0xf5a89f(0x177)]((_0x5a56ba,_0x22ffe5)=>_0x5a56ba+fs[_0xf5a89f(0x163)](_0x225310+'/'+_0x22ffe5)['size'],0x0),_0x17a78b=_0x380717[_0xf5a89f(0x177)]((_0xa11e4,_0x124072)=>_0xa11e4+_0x124072[_0xf5a89f(0x176)],0x0);console['log']({'totalSize':_0x2bec78,'uploadedSize':_0x17a78b});if(_0x17a78b+_0x2bec78>userFolderMaximumSizeInMB*0x400*0x400)return _0x4e770e[_0xf5a89f(0x173)](0x190)['json']({'error':_0xf5a89f(0x195)+userFolderMaximumSizeInMB+_0xf5a89f(0x165)});_0x380717[_0xf5a89f(0x16d)](_0x2c7ec6=>{const _0x3b5f84=_0xf5a89f;fs['copyFileSync'](_0x2c7ec6[_0x3b5f84(0x19c)],_0x225310+'/'+_0x2c7ec6[_0x3b5f84(0x175)]),fs[_0x3b5f84(0x169)](_0x2c7ec6[_0x3b5f84(0x19c)]);}),_0x4e770e[_0xf5a89f(0x18a)]({'files':_0x380717[_0xf5a89f(0x181)](_0x48da42=>({..._0x48da42,'path':_0x225310+'/'+_0x48da42[_0xf5a89f(0x175)]}))});}),router[a8_0x12e214(0x192)]('/folder',verifyToken,async(_0x31c17e,_0x40a5e8)=>{const _0x3d5443=a8_0x12e214,{path:_0x157914,folder_name:_0x2c8476}=_0x31c17e[_0x3d5443(0x17e)];console[_0x3d5443(0x187)]({'path':_0x157914,'folder_name':_0x2c8476});if(!_0x157914)return _0x40a5e8[_0x3d5443(0x173)](0x190)[_0x3d5443(0x198)]({'error':'Path\x20is\x20required'});if(!_0x2c8476)return _0x40a5e8[_0x3d5443(0x173)](0x190)['json']({'error':_0x3d5443(0x18e)});const _0x2d4364=_0x157914+'/'+_0x2c8476;!fs[_0x3d5443(0x180)](_0x2d4364)&&fs[_0x3d5443(0x17a)](_0x2d4364),_0x40a5e8[_0x3d5443(0x18a)]({'path':_0x2d4364});}),router[a8_0x12e214(0x199)](a8_0x12e214(0x19a),verifyToken,async(_0x13f1cb,_0x5111d2)=>{const _0x3a4927=a8_0x12e214,{isFolder:_0x51f363,path:_0x25f069}=_0x13f1cb['body'];!_0x51f363?fs[_0x3a4927(0x169)](_0x25f069):fs[_0x3a4927(0x18b)](_0x25f069,{'recursive':!![]}),_0x5111d2['send']({'success':!![]});}),module[a8_0x12e214(0x189)]=router;