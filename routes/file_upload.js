function a8_0x2418(_0x39f392,_0x331ec4){const _0x9c01d9=a8_0x9c01();return a8_0x2418=function(_0x24180c,_0x106b5a){_0x24180c=_0x24180c-0x7f;let _0x298f55=_0x9c01d9[_0x24180c];return _0x298f55;},a8_0x2418(_0x39f392,_0x331ec4);}function a8_0x9c01(){const _0x3fd76c=['body','statSync','Please\x20upload\x20a\x20file','json','execute','multer','/files','email','forEach','copyFileSync','../CADViewer_config.json','reduce','Invalid\x20user','129EyhMQM','/remove','\x20files','179062lcmEoZ','8331417hWcYld','mkdirSync','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','exports','unlinkSync','delete','Router','path','23948GhvAPv','express','array','\x20MB\x20of\x20files','../libs/mysql.js','originalname','./uploads','user','send','6RLeSSy','2947560utqNfE','./uploads/','7DBeaYl','files','readdirSync','length','crypto','status','post','log','rmdirSync','existsSync','httpStatusCode','diskStorage','7909unIhDZ','/folder','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','4476920ZZklSn','6188903WaOumy','size','Folder\x20name\x20is\x20required','folderLocation','map','3530IYZitS','Error!\x20Something\x20went\x20wrong.','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','promise'];a8_0x9c01=function(){return _0x3fd76c;};return a8_0x9c01();}const a8_0x30e42d=a8_0x2418;(function(_0x3b3875,_0x4664ab){const _0x4bc118=a8_0x2418,_0x2492e8=_0x3b3875();while(!![]){try{const _0x4396ad=-parseInt(_0x4bc118(0x8c))/0x1*(parseInt(_0x4bc118(0xb5))/0x2)+parseInt(_0x4bc118(0xb2))/0x3*(parseInt(_0x4bc118(0x80))/0x4)+parseInt(_0x4bc118(0x8a))/0x5+parseInt(_0x4bc118(0x89))/0x6*(parseInt(_0x4bc118(0x9c))/0x7)+parseInt(_0x4bc118(0x9b))/0x8+-parseInt(_0x4bc118(0xb6))/0x9+-parseInt(_0x4bc118(0xa1))/0xa*(parseInt(_0x4bc118(0x98))/0xb);if(_0x4396ad===_0x4664ab)break;else _0x2492e8['push'](_0x2492e8['shift']());}catch(_0xfd0b23){_0x2492e8['push'](_0x2492e8['shift']());}}}(a8_0x9c01,0x7646c));const multer=require(a8_0x30e42d(0xaa)),fs=require('fs'),{randomUUID}=require(a8_0x30e42d(0x90)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0x30e42d(0xaf)),conn=require(a8_0x30e42d(0x84)),verifyToken=require('../libs/jwt')['verifyToken'],dir=a8_0x30e42d(0x86);!fs[a8_0x30e42d(0x95)](dir)&&fs[a8_0x30e42d(0xb7)](dir);const express=require(a8_0x30e42d(0x81)),router=express[a8_0x30e42d(0xbc)](),config=require(a8_0x30e42d(0xaf)),storage=multer[a8_0x30e42d(0x97)]({'destination':function(_0x30edb8,_0x3bab45,_0x362f54){_0x362f54(null,'uploads');}}),upload=multer({'storage':storage});router[a8_0x30e42d(0x92)](a8_0x30e42d(0xab),upload[a8_0x30e42d(0x82)](a8_0x30e42d(0x8d)),verifyToken,async(_0x304eda,_0x2a16c7,_0x5a557f)=>{const _0x2c72f0=a8_0x30e42d,_0x2a924b=_0x304eda[_0x2c72f0(0x8d)],{global:_0x4159a4,path:_0x2b76e0}=_0x304eda[_0x2c72f0(0xa5)],_0x40d701=config[_0x2c72f0(0x9f)];console[_0x2c72f0(0x93)]({'global':_0x4159a4}),console[_0x2c72f0(0x93)](_0x2a924b),console[_0x2c72f0(0x93)]({'user':_0x304eda[_0x2c72f0(0x87)]});if(_0x4159a4){_0x2a924b[_0x2c72f0(0xad)](_0x404b88=>{const _0x5a32d7=_0x2c72f0;fs['copyFileSync'](_0x404b88[_0x5a32d7(0x7f)],(_0x2b76e0||_0x40d701)+'/'+_0x404b88[_0x5a32d7(0x85)]),fs[_0x5a32d7(0xba)](_0x404b88[_0x5a32d7(0x7f)]);}),_0x2a16c7[_0x2c72f0(0x88)]({'files':_0x2a924b[_0x2c72f0(0xa0)](_0x132d77=>({..._0x132d77,'path':(_0x2b76e0||_0x40d701)+'/'+_0x132d77[_0x2c72f0(0x85)]}))});return;}let _0x10e124;try{const [_0x1434b8]=await conn[_0x2c72f0(0xa4)]()[_0x2c72f0(0xa9)](_0x2c72f0(0xa3),[_0x304eda['user'][_0x2c72f0(0xac)]]);_0x1434b8[_0x2c72f0(0x8f)]>0x0&&(_0x10e124=_0x1434b8[0x0]);}catch(_0x2c544b){console[_0x2c72f0(0x93)]({'err':_0x2c544b}),_0x2a16c7[_0x2c72f0(0x91)](0x1f4)[_0x2c72f0(0xa8)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x10e124){_0x2a16c7[_0x2c72f0(0x91)](0x191)['json']({'error':_0x2c72f0(0xb1)});return;}let _0x1a6331=_0x10e124['folder_name'];if(!_0x1a6331){_0x1a6331=randomUUID();try{await conn['promise']()[_0x2c72f0(0xa9)](_0x2c72f0(0xb8),[_0x1a6331,_0x304eda[_0x2c72f0(0x87)]['email']]);}catch(_0x334c51){console[_0x2c72f0(0x93)]({'err':_0x334c51}),_0x2a16c7['status'](0x1f4)[_0x2c72f0(0xa8)]({'error':_0x2c72f0(0xa2)});return;}}const _0xcf032d=_0x2c72f0(0x8b)+_0x1a6331;!fs[_0x2c72f0(0x95)](_0xcf032d)&&fs['mkdirSync'](_0xcf032d);if(!_0x2a924b){const _0x283660=new Error(_0x2c72f0(0xa7));return _0x283660[_0x2c72f0(0x96)]=0x190,_0x5a557f(_0x283660);}const _0x39b5e5=fs[_0x2c72f0(0x8e)](_0xcf032d)[_0x2c72f0(0x8f)]+_0x2a924b[_0x2c72f0(0x8f)];console[_0x2c72f0(0x93)]({'numberOfSize':_0x39b5e5});if(_0x39b5e5>userFolderMaximumFiles)return _0x2a16c7[_0x2c72f0(0x91)](0x190)['json']({'error':_0x2c72f0(0x9a)+userFolderMaximumFiles+_0x2c72f0(0xb4)});const _0xb3f6a2=fs['readdirSync'](_0xcf032d)['reduce']((_0x55e03e,_0x28c29c)=>_0x55e03e+fs[_0x2c72f0(0xa6)](_0xcf032d+'/'+_0x28c29c)[_0x2c72f0(0x9d)],0x0),_0x331604=_0x2a924b[_0x2c72f0(0xb0)]((_0x5955a9,_0x210f97)=>_0x5955a9+_0x210f97[_0x2c72f0(0x9d)],0x0);console[_0x2c72f0(0x93)]({'totalSize':_0xb3f6a2,'uploadedSize':_0x331604});if(_0x331604+_0xb3f6a2>userFolderMaximumSizeInMB*0x400*0x400)return _0x2a16c7[_0x2c72f0(0x91)](0x190)[_0x2c72f0(0xa8)]({'error':'You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20'+userFolderMaximumSizeInMB+_0x2c72f0(0x83)});_0x2a924b[_0x2c72f0(0xad)](_0x455b4b=>{const _0x37c9dc=_0x2c72f0;fs[_0x37c9dc(0xae)](_0x455b4b[_0x37c9dc(0x7f)],_0xcf032d+'/'+_0x455b4b[_0x37c9dc(0x85)]),fs[_0x37c9dc(0xba)](_0x455b4b[_0x37c9dc(0x7f)]);}),_0x2a16c7[_0x2c72f0(0x88)]({'files':_0x2a924b['map'](_0x2ca874=>({..._0x2ca874,'path':_0xcf032d+'/'+_0x2ca874[_0x2c72f0(0x85)]}))});}),router[a8_0x30e42d(0x92)](a8_0x30e42d(0x99),verifyToken,async(_0x1265bf,_0x28da27)=>{const _0x17cd4e=a8_0x30e42d,{path:_0x540038,folder_name:_0x52bdb2}=_0x1265bf['body'];console[_0x17cd4e(0x93)]({'path':_0x540038,'folder_name':_0x52bdb2});if(!_0x540038)return _0x28da27['status'](0x190)['json']({'error':'Path\x20is\x20required'});if(!_0x52bdb2)return _0x28da27[_0x17cd4e(0x91)](0x190)[_0x17cd4e(0xa8)]({'error':_0x17cd4e(0x9e)});const _0x222966=_0x540038+'/'+_0x52bdb2;!fs[_0x17cd4e(0x95)](_0x222966)&&fs['mkdirSync'](_0x222966),_0x28da27[_0x17cd4e(0x88)]({'path':_0x222966});}),router[a8_0x30e42d(0xbb)](a8_0x30e42d(0xb3),verifyToken,async(_0x5c7540,_0x54cf44)=>{const _0x2df54b=a8_0x30e42d,{isFolder:_0x3d298f,path:_0x4f668e}=_0x5c7540['body'];!_0x3d298f?fs[_0x2df54b(0xba)](_0x4f668e):fs[_0x2df54b(0x94)](_0x4f668e,{'recursive':!![]}),_0x54cf44['send']({'success':!![]});}),module[a8_0x30e42d(0xb9)]=router;