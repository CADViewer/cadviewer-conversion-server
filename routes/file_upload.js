function a8_0x1aaa(_0x482423,_0x2d3334){const _0x43efdd=a8_0x43ef();return a8_0x1aaa=function(_0x1aaaf1,_0x393bc3){_0x1aaaf1=_0x1aaaf1-0x14b;let _0x16a4a3=_0x43efdd[_0x1aaaf1];return _0x16a4a3;},a8_0x1aaa(_0x482423,_0x2d3334);}const a8_0x5119f5=a8_0x1aaa;(function(_0x6d1b92,_0x1c0256){const _0x84f937=a8_0x1aaa,_0x17f2aa=_0x6d1b92();while(!![]){try{const _0x3ca0fc=-parseInt(_0x84f937(0x17e))/0x1+parseInt(_0x84f937(0x16c))/0x2+parseInt(_0x84f937(0x17b))/0x3+-parseInt(_0x84f937(0x173))/0x4+parseInt(_0x84f937(0x17a))/0x5+parseInt(_0x84f937(0x15a))/0x6*(parseInt(_0x84f937(0x16d))/0x7)+parseInt(_0x84f937(0x168))/0x8*(-parseInt(_0x84f937(0x15d))/0x9);if(_0x3ca0fc===_0x1c0256)break;else _0x17f2aa['push'](_0x17f2aa['shift']());}catch(_0x4b8b08){_0x17f2aa['push'](_0x17f2aa['shift']());}}}(a8_0x43ef,0x57843));function a8_0x43ef(){const _0x2dfcde=['168832pMyoIp','1413321nFQbJN','folderLocation','size','map','uploads','./uploads','1165400paHtMd','status','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','\x20MB\x20of\x20files','Invalid\x20user','verifyToken','post','2333545OffSwt','1720254XDaJxs','exports','promise','505568FVDMFN','log','./uploads/','mkdirSync','array','../libs/jwt','reduce','email','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','forEach','crypto','path','\x20files','/remove','statSync','files','Router','express','diskStorage','length','json','rmdirSync','unlinkSync','18XxawxU','execute','originalname','178407DrdUBQ','send','existsSync','readdirSync','Error!\x20Something\x20went\x20wrong.','/folder','renameSync','../CADViewer_config.json','user','Path\x20is\x20required','folder_name','232GCKcRN','Please\x20upload\x20a\x20file','/files','body'];a8_0x43ef=function(){return _0x2dfcde;};return a8_0x43ef();}const multer=require('multer'),fs=require('fs'),{randomUUID}=require(a8_0x5119f5(0x14d)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0x5119f5(0x164)),conn=require('../libs/mysql.js'),verifyToken=require(a8_0x5119f5(0x183))[a8_0x5119f5(0x178)],dir=a8_0x5119f5(0x172);!fs['existsSync'](dir)&&fs[a8_0x5119f5(0x181)](dir);const express=require(a8_0x5119f5(0x154)),router=express[a8_0x5119f5(0x153)](),config=require(a8_0x5119f5(0x164)),storage=multer[a8_0x5119f5(0x155)]({'destination':function(_0x58b245,_0x52a114,_0x2e59d8){const _0x361157=a8_0x5119f5;_0x2e59d8(null,_0x361157(0x171));}}),upload=multer({'storage':storage});router['post'](a8_0x5119f5(0x16a),upload[a8_0x5119f5(0x182)](a8_0x5119f5(0x152)),verifyToken,async(_0x2a9cf3,_0x1f537d,_0x95ceb2)=>{const _0x2bee91=a8_0x5119f5,_0x191439=_0x2a9cf3[_0x2bee91(0x152)],{global:_0x32cb2a,path:_0x3a5a5c}=_0x2a9cf3[_0x2bee91(0x16b)],_0x53ba11=config[_0x2bee91(0x16e)];console['log']({'global':_0x32cb2a}),console[_0x2bee91(0x17f)](_0x191439),console[_0x2bee91(0x17f)]({'user':_0x2a9cf3[_0x2bee91(0x165)]});if(_0x32cb2a){_0x191439['forEach'](_0x49c30d=>{const _0x23fba2=_0x2bee91;fs[_0x23fba2(0x163)](_0x49c30d[_0x23fba2(0x14e)],(_0x3a5a5c||_0x53ba11)+'/'+_0x49c30d['originalname']);}),_0x1f537d[_0x2bee91(0x15e)]({'files':_0x191439[_0x2bee91(0x170)](_0x48296d=>({..._0x48296d,'path':(_0x3a5a5c||_0x53ba11)+'/'+_0x48296d[_0x2bee91(0x15c)]}))});return;}let _0x26dc8e;try{const [_0x7a92ee]=await conn[_0x2bee91(0x17d)]()[_0x2bee91(0x15b)](_0x2bee91(0x175),[_0x2a9cf3[_0x2bee91(0x165)][_0x2bee91(0x185)]]);_0x7a92ee['length']>0x0&&(_0x26dc8e=_0x7a92ee[0x0]);}catch(_0x479350){console[_0x2bee91(0x17f)]({'err':_0x479350}),_0x1f537d['status'](0x1f4)[_0x2bee91(0x157)]({'error':_0x2bee91(0x161)});return;}if(!_0x26dc8e){_0x1f537d[_0x2bee91(0x174)](0x191)[_0x2bee91(0x157)]({'error':_0x2bee91(0x177)});return;}let _0x5e0c5b=_0x26dc8e[_0x2bee91(0x167)];if(!_0x5e0c5b){_0x5e0c5b=randomUUID();try{await conn[_0x2bee91(0x17d)]()[_0x2bee91(0x15b)]('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x5e0c5b,_0x2a9cf3['user']['email']]);}catch(_0x26dcbf){console[_0x2bee91(0x17f)]({'err':_0x26dcbf}),_0x1f537d[_0x2bee91(0x174)](0x1f4)[_0x2bee91(0x157)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x47fa3e=_0x2bee91(0x180)+_0x5e0c5b;!fs[_0x2bee91(0x15f)](_0x47fa3e)&&fs[_0x2bee91(0x181)](_0x47fa3e);if(!_0x191439){const _0x409998=new Error(_0x2bee91(0x169));return _0x409998['httpStatusCode']=0x190,_0x95ceb2(_0x409998);}const _0x355b24=fs[_0x2bee91(0x160)](_0x47fa3e)['length']+_0x191439[_0x2bee91(0x156)];console[_0x2bee91(0x17f)]({'numberOfSize':_0x355b24});if(_0x355b24>userFolderMaximumFiles)return _0x1f537d[_0x2bee91(0x174)](0x190)[_0x2bee91(0x157)]({'error':_0x2bee91(0x14b)+userFolderMaximumFiles+_0x2bee91(0x14f)});const _0x52828f=fs['readdirSync'](_0x47fa3e)[_0x2bee91(0x184)]((_0x2d5c5a,_0x165b24)=>_0x2d5c5a+fs[_0x2bee91(0x151)](_0x47fa3e+'/'+_0x165b24)[_0x2bee91(0x16f)],0x0),_0x56829c=_0x191439['reduce']((_0x5db0fd,_0x4d8ca3)=>_0x5db0fd+_0x4d8ca3[_0x2bee91(0x16f)],0x0);console['log']({'totalSize':_0x52828f,'uploadedSize':_0x56829c});if(_0x56829c+_0x52828f>userFolderMaximumSizeInMB*0x400*0x400)return _0x1f537d[_0x2bee91(0x174)](0x190)[_0x2bee91(0x157)]({'error':_0x2bee91(0x14b)+userFolderMaximumSizeInMB+_0x2bee91(0x176)});_0x191439[_0x2bee91(0x14c)](_0x4b070f=>{const _0x36b695=_0x2bee91;fs[_0x36b695(0x163)](_0x4b070f[_0x36b695(0x14e)],_0x47fa3e+'/'+_0x4b070f[_0x36b695(0x15c)]);}),_0x1f537d['send']({'files':_0x191439[_0x2bee91(0x170)](_0x4b3761=>({..._0x4b3761,'path':_0x47fa3e+'/'+_0x4b3761[_0x2bee91(0x15c)]}))});}),router[a8_0x5119f5(0x179)](a8_0x5119f5(0x162),verifyToken,async(_0x5601dd,_0x34cf52)=>{const _0x461dbf=a8_0x5119f5,{path:_0x3168b5,folder_name:_0x2c595c}=_0x5601dd['body'],_0x26adac=config[_0x461dbf(0x16e)];console[_0x461dbf(0x17f)]({'path':_0x3168b5,'folder_name':_0x2c595c});if(!_0x3168b5)return _0x34cf52[_0x461dbf(0x174)](0x190)[_0x461dbf(0x157)]({'error':_0x461dbf(0x166)});if(!_0x2c595c)return _0x34cf52[_0x461dbf(0x174)](0x190)[_0x461dbf(0x157)]({'error':'Folder\x20name\x20is\x20required'});const _0x4d9ff4=_0x3168b5+'/'+_0x2c595c;!fs[_0x461dbf(0x15f)](_0x4d9ff4)&&fs[_0x461dbf(0x181)](_0x4d9ff4),_0x34cf52[_0x461dbf(0x15e)]({'path':_0x4d9ff4});}),router['delete'](a8_0x5119f5(0x150),verifyToken,async(_0x16dc25,_0x2f125a)=>{const _0x483493=a8_0x5119f5,{isFolder:_0x269c58,path:_0x503c24}=_0x16dc25['body'];!_0x269c58?fs[_0x483493(0x159)](_0x503c24):fs[_0x483493(0x158)](_0x503c24,{'recursive':!![]}),_0x2f125a[_0x483493(0x15e)]({'success':!![]});}),module[a8_0x5119f5(0x17c)]=router;