function a8_0x5485(){const _0x472ba4=['/files','Error!\x20Something\x20went\x20wrong.','Invalid\x20user','promise','308856KMsKMB','2803030CVfngc','../libs/mysql.js','15181WCfmHo','length','send','rmdirSync','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','delete','Please\x20upload\x20a\x20file','files','log','existsSync','httpStatusCode','execute','654BfVKZP','post','verifyToken','statSync','./uploads','mkdirSync','express','1164756badXsR','crypto','email','originalname','81BtrWpx','body','map','exports','json','\x20MB\x20of\x20files','status','renameSync','/remove','reduce','Folder\x20name\x20is\x20required','../CADViewer_config.json','forEach','size','Path\x20is\x20required','../libs/jwt','array','11695uLmDTw','folderLocation','readdirSync','unlinkSync','folder_name','18sEogfC','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','path','1264851IadRDn','./uploads/','uploads','user','660867sYoCLk','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20'];a8_0x5485=function(){return _0x472ba4;};return a8_0x5485();}const a8_0x5e4612=a8_0x3e81;function a8_0x3e81(_0x535fb7,_0x30c989){const _0x5485e6=a8_0x5485();return a8_0x3e81=function(_0x3e818f,_0x45d4d6){_0x3e818f=_0x3e818f-0x120;let _0x24d333=_0x5485e6[_0x3e818f];return _0x24d333;},a8_0x3e81(_0x535fb7,_0x30c989);}(function(_0x3134dc,_0x557b89){const _0x447092=a8_0x3e81,_0x5cf62e=_0x3134dc();while(!![]){try{const _0xcbb98f=parseInt(_0x447092(0x121))/0x1*(parseInt(_0x447092(0x14e))/0x2)+-parseInt(_0x447092(0x155))/0x3+parseInt(_0x447092(0x134))/0x4+-parseInt(_0x447092(0x149))/0x5*(parseInt(_0x447092(0x12d))/0x6)+parseInt(_0x447092(0x151))/0x7+-parseInt(_0x447092(0x15b))/0x8*(-parseInt(_0x447092(0x138))/0x9)+-parseInt(_0x447092(0x15c))/0xa;if(_0xcbb98f===_0x557b89)break;else _0x5cf62e['push'](_0x5cf62e['shift']());}catch(_0x131960){_0x5cf62e['push'](_0x5cf62e['shift']());}}}(a8_0x5485,0x30eef));const multer=require('multer'),fs=require('fs'),{randomUUID}=require(a8_0x5e4612(0x135)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0x5e4612(0x143)),conn=require(a8_0x5e4612(0x120)),verifyToken=require(a8_0x5e4612(0x147))[a8_0x5e4612(0x12f)],dir=a8_0x5e4612(0x131);!fs['existsSync'](dir)&&fs[a8_0x5e4612(0x132)](dir);const express=require(a8_0x5e4612(0x133)),router=express['Router'](),config=require(a8_0x5e4612(0x143)),storage=multer['diskStorage']({'destination':function(_0x380df1,_0x53c7bc,_0x242a54){const _0x5eed5b=a8_0x5e4612;_0x242a54(null,_0x5eed5b(0x153));}}),upload=multer({'storage':storage});router['post'](a8_0x5e4612(0x157),upload[a8_0x5e4612(0x148)](a8_0x5e4612(0x128)),verifyToken,async(_0xa85785,_0x3d3d71,_0x2809d8)=>{const _0xce9f48=a8_0x5e4612,_0x4c3bfd=_0xa85785[_0xce9f48(0x128)],{global:_0x575e16,path:_0x512cb0}=_0xa85785['body'],_0x54ed30=config[_0xce9f48(0x14a)];console[_0xce9f48(0x129)]({'global':_0x575e16}),console[_0xce9f48(0x129)](_0x4c3bfd),console[_0xce9f48(0x129)]({'user':_0xa85785[_0xce9f48(0x154)]});if(_0x575e16){_0x4c3bfd[_0xce9f48(0x144)](_0x36be56=>{const _0x137891=_0xce9f48;fs[_0x137891(0x13f)](_0x36be56[_0x137891(0x150)],(_0x512cb0||_0x54ed30)+'/'+_0x36be56[_0x137891(0x137)]);}),_0x3d3d71['send']({'files':_0x4c3bfd['map'](_0x1484b0=>({..._0x1484b0,'path':(_0x512cb0||_0x54ed30)+'/'+_0x1484b0[_0xce9f48(0x137)]}))});return;}let _0x2f9dfe;try{const [_0x2968bb]=await conn[_0xce9f48(0x15a)]()[_0xce9f48(0x12c)](_0xce9f48(0x14f),[_0xa85785[_0xce9f48(0x154)]['email']]);_0x2968bb['length']>0x0&&(_0x2f9dfe=_0x2968bb[0x0]);}catch(_0x52abe4){console[_0xce9f48(0x129)]({'err':_0x52abe4}),_0x3d3d71[_0xce9f48(0x13e)](0x1f4)[_0xce9f48(0x13c)]({'error':_0xce9f48(0x158)});return;}if(!_0x2f9dfe){_0x3d3d71[_0xce9f48(0x13e)](0x191)[_0xce9f48(0x13c)]({'error':_0xce9f48(0x159)});return;}let _0x37579e=_0x2f9dfe[_0xce9f48(0x14d)];if(!_0x37579e){_0x37579e=randomUUID();try{await conn['promise']()[_0xce9f48(0x12c)](_0xce9f48(0x125),[_0x37579e,_0xa85785[_0xce9f48(0x154)][_0xce9f48(0x136)]]);}catch(_0xd1920b){console[_0xce9f48(0x129)]({'err':_0xd1920b}),_0x3d3d71[_0xce9f48(0x13e)](0x1f4)[_0xce9f48(0x13c)]({'error':_0xce9f48(0x158)});return;}}const _0x173670=_0xce9f48(0x152)+_0x37579e;!fs[_0xce9f48(0x12a)](_0x173670)&&fs[_0xce9f48(0x132)](_0x173670);if(!_0x4c3bfd){const _0xc9e098=new Error(_0xce9f48(0x127));return _0xc9e098[_0xce9f48(0x12b)]=0x190,_0x2809d8(_0xc9e098);}const _0x2943fc=fs[_0xce9f48(0x14b)](_0x173670)[_0xce9f48(0x122)]+_0x4c3bfd[_0xce9f48(0x122)];console[_0xce9f48(0x129)]({'numberOfSize':_0x2943fc});if(_0x2943fc>userFolderMaximumFiles)return _0x3d3d71['status'](0x190)[_0xce9f48(0x13c)]({'error':_0xce9f48(0x156)+userFolderMaximumFiles+'\x20files'});const _0x137ed4=fs[_0xce9f48(0x14b)](_0x173670)[_0xce9f48(0x141)]((_0x5dec0c,_0x522239)=>_0x5dec0c+fs[_0xce9f48(0x130)](_0x173670+'/'+_0x522239)[_0xce9f48(0x145)],0x0),_0x6a555b=_0x4c3bfd[_0xce9f48(0x141)]((_0x3e72a2,_0xaa846c)=>_0x3e72a2+_0xaa846c[_0xce9f48(0x145)],0x0);console[_0xce9f48(0x129)]({'totalSize':_0x137ed4,'uploadedSize':_0x6a555b});if(_0x6a555b+_0x137ed4>userFolderMaximumSizeInMB*0x400*0x400)return _0x3d3d71[_0xce9f48(0x13e)](0x190)[_0xce9f48(0x13c)]({'error':_0xce9f48(0x156)+userFolderMaximumSizeInMB+_0xce9f48(0x13d)});_0x4c3bfd[_0xce9f48(0x144)](_0x444f2f=>{const _0x3ea82d=_0xce9f48;fs[_0x3ea82d(0x13f)](_0x444f2f['path'],_0x173670+'/'+_0x444f2f[_0x3ea82d(0x137)]);}),_0x3d3d71[_0xce9f48(0x123)]({'files':_0x4c3bfd[_0xce9f48(0x13a)](_0x39d89e=>({..._0x39d89e,'path':_0x173670+'/'+_0x39d89e[_0xce9f48(0x137)]}))});}),router[a8_0x5e4612(0x12e)]('/folder',verifyToken,async(_0x12484c,_0x5e15bd)=>{const _0x3bd9d4=a8_0x5e4612,{path:_0x5eac24,folder_name:_0x393281}=_0x12484c[_0x3bd9d4(0x139)],_0x46a941=config[_0x3bd9d4(0x14a)];console[_0x3bd9d4(0x129)]({'path':_0x5eac24,'folder_name':_0x393281});if(!_0x5eac24)return _0x5e15bd[_0x3bd9d4(0x13e)](0x190)[_0x3bd9d4(0x13c)]({'error':_0x3bd9d4(0x146)});if(!_0x393281)return _0x5e15bd[_0x3bd9d4(0x13e)](0x190)[_0x3bd9d4(0x13c)]({'error':_0x3bd9d4(0x142)});const _0x3f2f14=_0x5eac24+'/'+_0x393281;!fs[_0x3bd9d4(0x12a)](_0x3f2f14)&&fs[_0x3bd9d4(0x132)](_0x3f2f14),_0x5e15bd[_0x3bd9d4(0x123)]({'path':_0x3f2f14});}),router[a8_0x5e4612(0x126)](a8_0x5e4612(0x140),verifyToken,async(_0x19e9bc,_0x44e63d)=>{const _0x154eb0=a8_0x5e4612,{isFolder:_0x338d98,path:_0x32b4da}=_0x19e9bc[_0x154eb0(0x139)];!_0x338d98?fs[_0x154eb0(0x14c)](_0x32b4da):fs[_0x154eb0(0x124)](_0x32b4da,{'recursive':!![]}),_0x44e63d[_0x154eb0(0x123)]({'success':!![]});}),module[a8_0x5e4612(0x13b)]=router;