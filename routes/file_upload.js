function a8_0x39c9(_0x17bf06,_0x283548){const _0x3f1cdf=a8_0x3f1c();return a8_0x39c9=function(_0x39c908,_0x40d039){_0x39c908=_0x39c908-0x100;let _0x5e3cb3=_0x3f1cdf[_0x39c908];return _0x5e3cb3;},a8_0x39c9(_0x17bf06,_0x283548);}const a8_0x42a991=a8_0x39c9;(function(_0x5b5faf,_0x14ea0e){const _0x23fd1c=a8_0x39c9,_0x4847e0=_0x5b5faf();while(!![]){try{const _0x7c5458=parseInt(_0x23fd1c(0x10c))/0x1+-parseInt(_0x23fd1c(0x12b))/0x2*(-parseInt(_0x23fd1c(0x12f))/0x3)+-parseInt(_0x23fd1c(0x11b))/0x4+-parseInt(_0x23fd1c(0x10f))/0x5*(parseInt(_0x23fd1c(0x120))/0x6)+parseInt(_0x23fd1c(0x127))/0x7+parseInt(_0x23fd1c(0x116))/0x8+parseInt(_0x23fd1c(0x118))/0x9*(parseInt(_0x23fd1c(0x101))/0xa);if(_0x7c5458===_0x14ea0e)break;else _0x4847e0['push'](_0x4847e0['shift']());}catch(_0x38b6db){_0x4847e0['push'](_0x4847e0['shift']());}}}(a8_0x3f1c,0xee2d9));const multer=require(a8_0x42a991(0x10b)),fs=require('fs'),{randomUUID}=require(a8_0x42a991(0x134)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0x42a991(0x113)),conn=require(a8_0x42a991(0x111)),verifyToken=require(a8_0x42a991(0x103))['verifyToken'],dir='./uploads';!fs[a8_0x42a991(0x122)](dir)&&fs[a8_0x42a991(0x125)](dir);const express=require(a8_0x42a991(0x136)),router=express['Router'](),config=require(a8_0x42a991(0x113)),storage=multer['diskStorage']({'destination':function(_0x2a610f,_0x586064,_0x1bef2f){const _0x3932ac=a8_0x42a991;_0x1bef2f(null,_0x3932ac(0x10e));}}),upload=multer({'storage':storage});function a8_0x3f1c(){const _0x33c81f=['67533sHUgWm','/files','exports','reduce','array','crypto','Invalid\x20user','express','json','unlinkSync','1290VDpKew','Folder\x20name\x20is\x20required','../libs/jwt','map','log','send','length','user','readdirSync','\x20files','multer','1338837gtHooy','status','uploads','5uFnjLr','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','../libs/mysql.js','folderLocation','../CADViewer_config.json','execute','forEach','7978192cbJLud','promise','139347LppYbD','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','copyFileSync','6839088Ytowzg','post','originalname','email','files','10620054xAVlat','\x20MB\x20of\x20files','existsSync','./uploads/','httpStatusCode','mkdirSync','path','223272rXcAei','statSync','Path\x20is\x20required','body','8KknStC','Error!\x20Something\x20went\x20wrong.','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','size'];a8_0x3f1c=function(){return _0x33c81f;};return a8_0x3f1c();}router[a8_0x42a991(0x11c)](a8_0x42a991(0x130),upload[a8_0x42a991(0x133)]('files'),verifyToken,async(_0x1fc6fe,_0x327aa8,_0x17afbf)=>{const _0x3e6ca7=a8_0x42a991,_0x337ea5=_0x1fc6fe[_0x3e6ca7(0x11f)],{global:_0x1a839a,path:_0x50bd99}=_0x1fc6fe['body'],_0x3f25bc=config[_0x3e6ca7(0x112)];console[_0x3e6ca7(0x105)]({'global':_0x1a839a}),console[_0x3e6ca7(0x105)](_0x337ea5),console[_0x3e6ca7(0x105)]({'user':_0x1fc6fe[_0x3e6ca7(0x108)]});if(_0x1a839a){_0x337ea5['forEach'](_0x2e35bc=>{const _0x3b90af=_0x3e6ca7;fs['copyFileSync'](_0x2e35bc[_0x3b90af(0x126)],(_0x50bd99||_0x3f25bc)+'/'+_0x2e35bc['originalname']),fs[_0x3b90af(0x100)](_0x2e35bc[_0x3b90af(0x126)]);}),_0x327aa8[_0x3e6ca7(0x106)]({'files':_0x337ea5[_0x3e6ca7(0x104)](_0x485855=>({..._0x485855,'path':(_0x50bd99||_0x3f25bc)+'/'+_0x485855[_0x3e6ca7(0x11d)]}))});return;}let _0x23ff54;try{const [_0x29213d]=await conn[_0x3e6ca7(0x117)]()[_0x3e6ca7(0x114)](_0x3e6ca7(0x12d),[_0x1fc6fe[_0x3e6ca7(0x108)][_0x3e6ca7(0x11e)]]);_0x29213d[_0x3e6ca7(0x107)]>0x0&&(_0x23ff54=_0x29213d[0x0]);}catch(_0x139a51){console[_0x3e6ca7(0x105)]({'err':_0x139a51}),_0x327aa8[_0x3e6ca7(0x10d)](0x1f4)[_0x3e6ca7(0x137)]({'error':_0x3e6ca7(0x12c)});return;}if(!_0x23ff54){_0x327aa8[_0x3e6ca7(0x10d)](0x191)['json']({'error':_0x3e6ca7(0x135)});return;}let _0x129ee5=_0x23ff54['folder_name'];if(!_0x129ee5){_0x129ee5=randomUUID();try{await conn[_0x3e6ca7(0x117)]()[_0x3e6ca7(0x114)](_0x3e6ca7(0x119),[_0x129ee5,_0x1fc6fe['user'][_0x3e6ca7(0x11e)]]);}catch(_0x56b59){console[_0x3e6ca7(0x105)]({'err':_0x56b59}),_0x327aa8['status'](0x1f4)['json']({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x4aa077=_0x3e6ca7(0x123)+_0x129ee5;!fs['existsSync'](_0x4aa077)&&fs['mkdirSync'](_0x4aa077);if(!_0x337ea5){const _0x1f35ca=new Error('Please\x20upload\x20a\x20file');return _0x1f35ca[_0x3e6ca7(0x124)]=0x190,_0x17afbf(_0x1f35ca);}const _0x43c2cd=fs[_0x3e6ca7(0x109)](_0x4aa077)['length']+_0x337ea5[_0x3e6ca7(0x107)];console[_0x3e6ca7(0x105)]({'numberOfSize':_0x43c2cd});if(_0x43c2cd>userFolderMaximumFiles)return _0x327aa8[_0x3e6ca7(0x10d)](0x190)[_0x3e6ca7(0x137)]({'error':_0x3e6ca7(0x110)+userFolderMaximumFiles+_0x3e6ca7(0x10a)});const _0x2d465a=fs['readdirSync'](_0x4aa077)['reduce']((_0x463f43,_0x485e50)=>_0x463f43+fs[_0x3e6ca7(0x128)](_0x4aa077+'/'+_0x485e50)[_0x3e6ca7(0x12e)],0x0),_0x4f6236=_0x337ea5[_0x3e6ca7(0x132)]((_0xba2d67,_0x3654c7)=>_0xba2d67+_0x3654c7['size'],0x0);console[_0x3e6ca7(0x105)]({'totalSize':_0x2d465a,'uploadedSize':_0x4f6236});if(_0x4f6236+_0x2d465a>userFolderMaximumSizeInMB*0x400*0x400)return _0x327aa8['status'](0x190)[_0x3e6ca7(0x137)]({'error':_0x3e6ca7(0x110)+userFolderMaximumSizeInMB+_0x3e6ca7(0x121)});_0x337ea5[_0x3e6ca7(0x115)](_0x202054=>{const _0x8ed94d=_0x3e6ca7;fs[_0x8ed94d(0x11a)](_0x202054['path'],_0x4aa077+'/'+_0x202054[_0x8ed94d(0x11d)]),fs['unlinkSync'](_0x202054[_0x8ed94d(0x126)]);}),_0x327aa8[_0x3e6ca7(0x106)]({'files':_0x337ea5[_0x3e6ca7(0x104)](_0x4329fd=>({..._0x4329fd,'path':_0x4aa077+'/'+_0x4329fd[_0x3e6ca7(0x11d)]}))});}),router[a8_0x42a991(0x11c)]('/folder',verifyToken,async(_0x5ea096,_0x1f2ebe)=>{const _0x397f1c=a8_0x42a991,{path:_0x27ccb4,folder_name:_0x46fb17}=_0x5ea096['body'];console['log']({'path':_0x27ccb4,'folder_name':_0x46fb17});if(!_0x27ccb4)return _0x1f2ebe[_0x397f1c(0x10d)](0x190)[_0x397f1c(0x137)]({'error':_0x397f1c(0x129)});if(!_0x46fb17)return _0x1f2ebe[_0x397f1c(0x10d)](0x190)[_0x397f1c(0x137)]({'error':_0x397f1c(0x102)});const _0x2fbbf4=_0x27ccb4+'/'+_0x46fb17;!fs[_0x397f1c(0x122)](_0x2fbbf4)&&fs[_0x397f1c(0x125)](_0x2fbbf4),_0x1f2ebe[_0x397f1c(0x106)]({'path':_0x2fbbf4});}),router['delete']('/remove',verifyToken,async(_0x5acda5,_0xbcc7eb)=>{const _0x4d78f9=a8_0x42a991,{isFolder:_0x286dc4,path:_0x361f55}=_0x5acda5[_0x4d78f9(0x12a)];!_0x286dc4?fs[_0x4d78f9(0x100)](_0x361f55):fs['rmdirSync'](_0x361f55,{'recursive':!![]}),_0xbcc7eb[_0x4d78f9(0x106)]({'success':!![]});}),module[a8_0x42a991(0x131)]=router;