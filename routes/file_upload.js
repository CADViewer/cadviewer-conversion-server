function a8_0x3c9e(){const _0x5dfd4c=['originalname','crypto','path','delete','rmdirSync','251616gUZfOG','4072838ozTpYR','\x20MB\x20of\x20files','./uploads','/remove','615604SAkMje','707193StWiEh','log','Router','multer','httpStatusCode','24uBpgOW','length','4BPjklS','email','forEach','copyFileSync','post','../libs/mysql.js','promise','Invalid\x20user','execute','mkdirSync','map','5lscNhO','/folder','existsSync','./uploads/','20bkHMOk','Error!\x20Something\x20went\x20wrong.','files','3437SoMTQd','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','Folder\x20name\x20is\x20required','readdirSync','diskStorage','status','express','exports','2388bazSlP','59060YYerxS','size','folder_name','Path\x20is\x20required','unlinkSync','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','user','/files','send','reduce','json','../libs/jwt','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','uploads','1812016LmmeMi','../CADViewer_config.json','body','Please\x20upload\x20a\x20file'];a8_0x3c9e=function(){return _0x5dfd4c;};return a8_0x3c9e();}function a8_0x23fa(_0x22af34,_0x407eed){const _0x3c9ebe=a8_0x3c9e();return a8_0x23fa=function(_0x23fac5,_0x63a14f){_0x23fac5=_0x23fac5-0xa2;let _0x2fc9f1=_0x3c9ebe[_0x23fac5];return _0x2fc9f1;},a8_0x23fa(_0x22af34,_0x407eed);}const a8_0xb14bd9=a8_0x23fa;(function(_0x46b7ed,_0x1b45df){const _0x409e0e=a8_0x23fa,_0x3cf8b8=_0x46b7ed();while(!![]){try{const _0x13b1e5=-parseInt(_0x409e0e(0xa6))/0x1*(parseInt(_0x409e0e(0xc1))/0x2)+-parseInt(_0x409e0e(0xd8))/0x3+parseInt(_0x409e0e(0xdd))/0x4*(parseInt(_0x409e0e(0xb1))/0x5)+-parseInt(_0x409e0e(0xc0))/0x6*(parseInt(_0x409e0e(0xb8))/0x7)+-parseInt(_0x409e0e(0xcf))/0x8+-parseInt(_0x409e0e(0xde))/0x9*(parseInt(_0x409e0e(0xb5))/0xa)+-parseInt(_0x409e0e(0xd9))/0xb*(-parseInt(_0x409e0e(0xa4))/0xc);if(_0x13b1e5===_0x1b45df)break;else _0x3cf8b8['push'](_0x3cf8b8['shift']());}catch(_0x29cd62){_0x3cf8b8['push'](_0x3cf8b8['shift']());}}}(a8_0x3c9e,0x1bac7));const multer=require(a8_0xb14bd9(0xa2)),fs=require('fs'),{randomUUID}=require(a8_0xb14bd9(0xd4)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0xb14bd9(0xd0)),conn=require(a8_0xb14bd9(0xab)),verifyToken=require(a8_0xb14bd9(0xcc))['verifyToken'],dir=a8_0xb14bd9(0xdb);!fs[a8_0xb14bd9(0xb3)](dir)&&fs['mkdirSync'](dir);const express=require(a8_0xb14bd9(0xbe)),router=express[a8_0xb14bd9(0xe0)](),config=require(a8_0xb14bd9(0xd0)),storage=multer[a8_0xb14bd9(0xbc)]({'destination':function(_0x521cb0,_0x1d58f0,_0x44e9d8){const _0x2e8266=a8_0xb14bd9;_0x44e9d8(null,_0x2e8266(0xce));}}),upload=multer({'storage':storage});router[a8_0xb14bd9(0xaa)](a8_0xb14bd9(0xc8),upload['array'](a8_0xb14bd9(0xb7)),verifyToken,async(_0x45cbb8,_0x4741a5,_0x3b18e6)=>{const _0x632501=a8_0xb14bd9,_0x2d5f41=_0x45cbb8[_0x632501(0xb7)],{global:_0x333b13,path:_0x1c2d89}=_0x45cbb8[_0x632501(0xd1)],_0x3845fd=config['folderLocation'];console[_0x632501(0xdf)]({'global':_0x333b13}),console[_0x632501(0xdf)](_0x2d5f41),console[_0x632501(0xdf)]({'user':_0x45cbb8[_0x632501(0xc7)]});if(_0x333b13){_0x2d5f41[_0x632501(0xa8)](_0x3f26fa=>{const _0x4acbb1=_0x632501;fs['copyFileSync'](_0x3f26fa[_0x4acbb1(0xd5)],(_0x1c2d89||_0x3845fd)+'/'+_0x3f26fa[_0x4acbb1(0xd3)]),fs[_0x4acbb1(0xc5)](_0x3f26fa['path']);}),_0x4741a5[_0x632501(0xc9)]({'files':_0x2d5f41['map'](_0x3fb176=>({..._0x3fb176,'path':(_0x1c2d89||_0x3845fd)+'/'+_0x3fb176['originalname']}))});return;}let _0x815366;try{const [_0x47a5f7]=await conn['promise']()[_0x632501(0xae)](_0x632501(0xcd),[_0x45cbb8['user'][_0x632501(0xa7)]]);_0x47a5f7[_0x632501(0xa5)]>0x0&&(_0x815366=_0x47a5f7[0x0]);}catch(_0x747e44){console['log']({'err':_0x747e44}),_0x4741a5['status'](0x1f4)[_0x632501(0xcb)]({'error':_0x632501(0xb6)});return;}if(!_0x815366){_0x4741a5[_0x632501(0xbd)](0x191)[_0x632501(0xcb)]({'error':_0x632501(0xad)});return;}let _0x226170=_0x815366[_0x632501(0xc3)];if(!_0x226170){_0x226170=randomUUID();try{await conn[_0x632501(0xac)]()[_0x632501(0xae)](_0x632501(0xb9),[_0x226170,_0x45cbb8['user'][_0x632501(0xa7)]]);}catch(_0x322c7f){console['log']({'err':_0x322c7f}),_0x4741a5['status'](0x1f4)['json']({'error':_0x632501(0xb6)});return;}}const _0x1a9045=_0x632501(0xb4)+_0x226170;!fs['existsSync'](_0x1a9045)&&fs[_0x632501(0xaf)](_0x1a9045);if(!_0x2d5f41){const _0x1636e5=new Error(_0x632501(0xd2));return _0x1636e5[_0x632501(0xa3)]=0x190,_0x3b18e6(_0x1636e5);}const _0x8e2777=fs[_0x632501(0xbb)](_0x1a9045)[_0x632501(0xa5)]+_0x2d5f41[_0x632501(0xa5)];console[_0x632501(0xdf)]({'numberOfSize':_0x8e2777});if(_0x8e2777>userFolderMaximumFiles)return _0x4741a5[_0x632501(0xbd)](0x190)['json']({'error':_0x632501(0xc6)+userFolderMaximumFiles+'\x20files'});const _0x206bce=fs[_0x632501(0xbb)](_0x1a9045)[_0x632501(0xca)]((_0x2c3ff8,_0xc7a8a1)=>_0x2c3ff8+fs['statSync'](_0x1a9045+'/'+_0xc7a8a1)['size'],0x0),_0x1280af=_0x2d5f41['reduce']((_0x4b5427,_0x26ffc6)=>_0x4b5427+_0x26ffc6[_0x632501(0xc2)],0x0);console[_0x632501(0xdf)]({'totalSize':_0x206bce,'uploadedSize':_0x1280af});if(_0x1280af+_0x206bce>userFolderMaximumSizeInMB*0x400*0x400)return _0x4741a5[_0x632501(0xbd)](0x190)[_0x632501(0xcb)]({'error':_0x632501(0xc6)+userFolderMaximumSizeInMB+_0x632501(0xda)});_0x2d5f41[_0x632501(0xa8)](_0x38acd1=>{const _0x39c97c=_0x632501;fs[_0x39c97c(0xa9)](_0x38acd1[_0x39c97c(0xd5)],_0x1a9045+'/'+_0x38acd1[_0x39c97c(0xd3)]),fs[_0x39c97c(0xc5)](_0x38acd1[_0x39c97c(0xd5)]);}),_0x4741a5['send']({'files':_0x2d5f41[_0x632501(0xb0)](_0x203aea=>({..._0x203aea,'path':_0x1a9045+'/'+_0x203aea[_0x632501(0xd3)]}))});}),router[a8_0xb14bd9(0xaa)](a8_0xb14bd9(0xb2),verifyToken,async(_0x5eaa21,_0x426165)=>{const _0x563028=a8_0xb14bd9,{path:_0x1a2fd4,folder_name:_0x59be7e}=_0x5eaa21['body'];console[_0x563028(0xdf)]({'path':_0x1a2fd4,'folder_name':_0x59be7e});if(!_0x1a2fd4)return _0x426165[_0x563028(0xbd)](0x190)[_0x563028(0xcb)]({'error':_0x563028(0xc4)});if(!_0x59be7e)return _0x426165[_0x563028(0xbd)](0x190)['json']({'error':_0x563028(0xba)});const _0x16170e=_0x1a2fd4+'/'+_0x59be7e;!fs[_0x563028(0xb3)](_0x16170e)&&fs[_0x563028(0xaf)](_0x16170e),_0x426165['send']({'path':_0x16170e});}),router[a8_0xb14bd9(0xd6)](a8_0xb14bd9(0xdc),verifyToken,async(_0x44b657,_0x532340)=>{const _0xe34a0c=a8_0xb14bd9,{isFolder:_0x2c9b86,path:_0x342cf5}=_0x44b657[_0xe34a0c(0xd1)];!_0x2c9b86?fs[_0xe34a0c(0xc5)](_0x342cf5):fs[_0xe34a0c(0xd7)](_0x342cf5,{'recursive':!![]}),_0x532340[_0xe34a0c(0xc9)]({'success':!![]});}),module[a8_0xb14bd9(0xbf)]=router;