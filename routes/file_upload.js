function a8_0x11f2(_0x2e5048,_0x5a142a){const _0x4048c6=a8_0x4048();return a8_0x11f2=function(_0x11f27c,_0x44230c){_0x11f27c=_0x11f27c-0x72;let _0x20cda6=_0x4048c6[_0x11f27c];return _0x20cda6;},a8_0x11f2(_0x2e5048,_0x5a142a);}const a8_0x5a239a=a8_0x11f2;(function(_0x3aa42e,_0x321cd3){const _0x2c9eb7=a8_0x11f2,_0xcc0a49=_0x3aa42e();while(!![]){try{const _0x292c1b=parseInt(_0x2c9eb7(0x84))/0x1+-parseInt(_0x2c9eb7(0xa8))/0x2*(parseInt(_0x2c9eb7(0x7b))/0x3)+-parseInt(_0x2c9eb7(0x76))/0x4*(-parseInt(_0x2c9eb7(0x81))/0x5)+parseInt(_0x2c9eb7(0xa1))/0x6+parseInt(_0x2c9eb7(0x7e))/0x7*(parseInt(_0x2c9eb7(0xa7))/0x8)+-parseInt(_0x2c9eb7(0x8b))/0x9+-parseInt(_0x2c9eb7(0x97))/0xa;if(_0x292c1b===_0x321cd3)break;else _0xcc0a49['push'](_0xcc0a49['shift']());}catch(_0x2dd479){_0xcc0a49['push'](_0xcc0a49['shift']());}}}(a8_0x4048,0xc0f4a));const multer=require(a8_0x5a239a(0x9f)),fs=require('fs'),{randomUUID}=require('crypto'),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0x5a239a(0x98)),conn=require('../libs/mysql.js'),verifyToken=require(a8_0x5a239a(0xab))[a8_0x5a239a(0x74)],dir=a8_0x5a239a(0x87);!fs[a8_0x5a239a(0x96)](dir)&&fs[a8_0x5a239a(0x89)](dir);const express=require(a8_0x5a239a(0xa2)),router=express['Router'](),config=require(a8_0x5a239a(0x98)),storage=multer[a8_0x5a239a(0xa0)]({'destination':function(_0x5c53ef,_0x531f3c,_0x379d61){_0x379d61(null,'uploads');}}),upload=multer({'storage':storage});router['post'](a8_0x5a239a(0x72),upload['array'](a8_0x5a239a(0x8e)),verifyToken,async(_0x13b337,_0x34aee1,_0x39b2b8)=>{const _0x13d626=a8_0x5a239a,_0x53ffd3=_0x13b337[_0x13d626(0x8e)],{global:_0x95447a,path:_0x591329}=_0x13b337[_0x13d626(0x90)],_0x146526=config[_0x13d626(0x9a)];console[_0x13d626(0x92)]({'global':_0x95447a}),console['log'](_0x53ffd3),console['log']({'user':_0x13b337['user']});if(_0x95447a){_0x53ffd3['forEach'](_0x269fbb=>{const _0x243e8b=_0x13d626;fs[_0x243e8b(0xa9)](_0x269fbb[_0x243e8b(0x91)],(_0x591329||_0x146526)+'/'+_0x269fbb[_0x243e8b(0x85)]),fs['unlinkSync'](_0x269fbb['path']);}),_0x34aee1['send']({'files':_0x53ffd3[_0x13d626(0x79)](_0x3a9764=>({..._0x3a9764,'path':(_0x591329||_0x146526)+'/'+_0x3a9764[_0x13d626(0x85)]}))});return;}let _0x59b228;try{const [_0x2cc777]=await conn['promise']()[_0x13d626(0x9d)](_0x13d626(0x75),[_0x13b337[_0x13d626(0x94)]['email']]);_0x2cc777[_0x13d626(0x77)]>0x0&&(_0x59b228=_0x2cc777[0x0]);}catch(_0x1e4611){console[_0x13d626(0x92)]({'err':_0x1e4611}),_0x34aee1[_0x13d626(0xa4)](0x1f4)[_0x13d626(0x9b)]({'error':_0x13d626(0xa3)});return;}if(!_0x59b228){_0x34aee1[_0x13d626(0xa4)](0x191)['json']({'error':'Invalid\x20user'});return;}let _0x2927d8=_0x59b228[_0x13d626(0x99)];if(!_0x2927d8){_0x2927d8=randomUUID();try{await conn[_0x13d626(0xa6)]()[_0x13d626(0x9d)](_0x13d626(0x88),[_0x2927d8,_0x13b337['user'][_0x13d626(0x93)]]);}catch(_0x55644d){console[_0x13d626(0x92)]({'err':_0x55644d}),_0x34aee1[_0x13d626(0xa4)](0x1f4)[_0x13d626(0x9b)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x3e41a1=_0x13d626(0x7d)+_0x2927d8;!fs[_0x13d626(0x96)](_0x3e41a1)&&fs[_0x13d626(0x89)](_0x3e41a1);if(!_0x53ffd3){const _0xee986f=new Error(_0x13d626(0x8f));return _0xee986f[_0x13d626(0x9e)]=0x190,_0x39b2b8(_0xee986f);}const _0x326792=fs[_0x13d626(0xaa)](_0x3e41a1)[_0x13d626(0x77)]+_0x53ffd3['length'];console[_0x13d626(0x92)]({'numberOfSize':_0x326792});if(_0x326792>userFolderMaximumFiles)return _0x34aee1[_0x13d626(0xa4)](0x190)[_0x13d626(0x9b)]({'error':_0x13d626(0x83)+userFolderMaximumFiles+_0x13d626(0x82)});const _0x895e8e=fs['readdirSync'](_0x3e41a1)['reduce']((_0x1a04b8,_0x133685)=>_0x1a04b8+fs['statSync'](_0x3e41a1+'/'+_0x133685)[_0x13d626(0x78)],0x0),_0x5d3fe8=_0x53ffd3[_0x13d626(0x7a)]((_0xc67150,_0x52b0e3)=>_0xc67150+_0x52b0e3[_0x13d626(0x78)],0x0);console[_0x13d626(0x92)]({'totalSize':_0x895e8e,'uploadedSize':_0x5d3fe8});if(_0x5d3fe8+_0x895e8e>userFolderMaximumSizeInMB*0x400*0x400)return _0x34aee1[_0x13d626(0xa4)](0x190)[_0x13d626(0x9b)]({'error':_0x13d626(0x83)+userFolderMaximumSizeInMB+_0x13d626(0x9c)});_0x53ffd3[_0x13d626(0x73)](_0x27bcc5=>{const _0x24977e=_0x13d626;fs[_0x24977e(0xa9)](_0x27bcc5[_0x24977e(0x91)],_0x3e41a1+'/'+_0x27bcc5[_0x24977e(0x85)]),fs['unlinkSync'](_0x27bcc5[_0x24977e(0x91)]);}),_0x34aee1['send']({'files':_0x53ffd3[_0x13d626(0x79)](_0x57f6b0=>({..._0x57f6b0,'path':_0x3e41a1+'/'+_0x57f6b0[_0x13d626(0x85)]}))});}),router[a8_0x5a239a(0x86)](a8_0x5a239a(0x8d),verifyToken,async(_0x57dbc0,_0x2ca95f)=>{const _0x3c1039=a8_0x5a239a,{path:_0x4b06a7,folder_name:_0x3b0b9f}=_0x57dbc0[_0x3c1039(0x90)];console[_0x3c1039(0x92)]({'path':_0x4b06a7,'folder_name':_0x3b0b9f});if(!_0x4b06a7)return _0x2ca95f[_0x3c1039(0xa4)](0x190)['json']({'error':_0x3c1039(0x8a)});if(!_0x3b0b9f)return _0x2ca95f[_0x3c1039(0xa4)](0x190)[_0x3c1039(0x9b)]({'error':_0x3c1039(0x80)});const _0x4938f8=_0x4b06a7+'/'+_0x3b0b9f;!fs[_0x3c1039(0x96)](_0x4938f8)&&fs['mkdirSync'](_0x4938f8),_0x2ca95f[_0x3c1039(0x7c)]({'path':_0x4938f8});}),router['delete'](a8_0x5a239a(0xa5),verifyToken,async(_0x5c0420,_0x2398c8)=>{const _0x3405c7=a8_0x5a239a,{isFolder:_0x11a4da,path:_0x2e3566}=_0x5c0420['body'];!_0x11a4da?fs[_0x3405c7(0x95)](_0x2e3566):fs[_0x3405c7(0x8c)](_0x2e3566,{'recursive':!![]}),_0x2398c8[_0x3405c7(0x7c)]({'success':!![]});}),module[a8_0x5a239a(0x7f)]=router;function a8_0x4048(){const _0x11a5d3=['unlinkSync','existsSync','27485850ONEaQj','../CADViewer_config.json','folder_name','folderLocation','json','\x20MB\x20of\x20files','execute','httpStatusCode','multer','diskStorage','5875062nESvCH','express','Error!\x20Something\x20went\x20wrong.','status','/remove','promise','160656cmzDkZ','2RFsQha','copyFileSync','readdirSync','../libs/jwt','/files','forEach','verifyToken','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','4qUwaxY','length','size','map','reduce','201573VnlIWM','send','./uploads/','63aqrqol','exports','Folder\x20name\x20is\x20required','7217855fVxYqK','\x20files','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','1283521ZaRnTv','originalname','post','./uploads','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','mkdirSync','Path\x20is\x20required','2527965BfccsY','rmdirSync','/folder','files','Please\x20upload\x20a\x20file','body','path','log','email','user'];a8_0x4048=function(){return _0x11a5d3;};return a8_0x4048();}