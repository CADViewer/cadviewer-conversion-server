function a8_0x2f44(){const _0x2c8c85=['SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','32590iNaAbe','statSync','3427209ikvWdy','email','198SEoXVQ','send','reduce','multer','\x20files','folder_name','../libs/jwt','copyFileSync','../CADViewer_config.json','status','Router','files','log','/folder','7897560uLlFHm','Error!\x20Something\x20went\x20wrong.','1021QMgKBo','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','crypto','json','originalname','rmdirSync','user','post','map','promise','6509032YoAJKw','12MMwfRA','verifyToken','uploads','folderLocation','exports','httpStatusCode','readdirSync','express','Please\x20upload\x20a\x20file','844xQsnkD','Invalid\x20user','../libs/mysql.js','/files','./uploads','mkdirSync','existsSync','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','size','body','path','unlinkSync','execute','184rKehzt','length','4955104vhrdTL','/remove','88056Dyzchc','forEach'];a8_0x2f44=function(){return _0x2c8c85;};return a8_0x2f44();}const a8_0x1a6876=a8_0x51bf;function a8_0x51bf(_0x2ae1a9,_0x1db31d){const _0x2f4410=a8_0x2f44();return a8_0x51bf=function(_0x51bffb,_0x206c12){_0x51bffb=_0x51bffb-0x17d;let _0x7c8227=_0x2f4410[_0x51bffb];return _0x7c8227;},a8_0x51bf(_0x2ae1a9,_0x1db31d);}(function(_0x5dcf01,_0x31d723){const _0x35f200=a8_0x51bf,_0x3b77de=_0x5dcf01();while(!![]){try{const _0x5bd210=-parseInt(_0x35f200(0x190))/0x1*(-parseInt(_0x35f200(0x1a4))/0x2)+-parseInt(_0x35f200(0x17e))/0x3+parseInt(_0x35f200(0x19a))/0x4+-parseInt(_0x35f200(0x18e))/0x5+-parseInt(_0x35f200(0x19b))/0x6*(-parseInt(_0x35f200(0x1b3))/0x7)+parseInt(_0x35f200(0x1b1))/0x8*(parseInt(_0x35f200(0x1b5))/0x9)+-parseInt(_0x35f200(0x1b8))/0xa*(parseInt(_0x35f200(0x180))/0xb);if(_0x5bd210===_0x31d723)break;else _0x3b77de['push'](_0x3b77de['shift']());}catch(_0x1da7b6){_0x3b77de['push'](_0x3b77de['shift']());}}}(a8_0x2f44,0xe032f));const multer=require(a8_0x1a6876(0x183)),fs=require('fs'),{randomUUID}=require(a8_0x1a6876(0x192)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0x1a6876(0x188)),conn=require(a8_0x1a6876(0x1a6)),verifyToken=require(a8_0x1a6876(0x186))[a8_0x1a6876(0x19c)],dir=a8_0x1a6876(0x1a8);!fs[a8_0x1a6876(0x1aa)](dir)&&fs['mkdirSync'](dir);const express=require(a8_0x1a6876(0x1a2)),router=express[a8_0x1a6876(0x18a)](),config=require('../CADViewer_config.json'),storage=multer['diskStorage']({'destination':function(_0x586cb4,_0xced70b,_0x16d1b7){const _0x54d7f5=a8_0x1a6876;_0x16d1b7(null,_0x54d7f5(0x19d));}}),upload=multer({'storage':storage});router['post'](a8_0x1a6876(0x1a7),upload['array'](a8_0x1a6876(0x18b)),verifyToken,async(_0x59f46c,_0x54ea28,_0x74b2a0)=>{const _0x5db1e1=a8_0x1a6876,_0x902efe=_0x59f46c[_0x5db1e1(0x18b)],{global:_0x42c728,path:_0x498402}=_0x59f46c[_0x5db1e1(0x1ad)],_0x362af3=config[_0x5db1e1(0x19e)];console[_0x5db1e1(0x18c)]({'global':_0x42c728}),console[_0x5db1e1(0x18c)](_0x902efe),console[_0x5db1e1(0x18c)]({'user':_0x59f46c[_0x5db1e1(0x196)]});if(_0x42c728){_0x902efe[_0x5db1e1(0x1b6)](_0x18bde7=>{const _0x353a1e=_0x5db1e1;fs[_0x353a1e(0x187)](_0x18bde7['path'],(_0x498402||_0x362af3)+'/'+_0x18bde7[_0x353a1e(0x194)]),fs['unlinkSync'](_0x18bde7['path']);}),_0x54ea28['send']({'files':_0x902efe[_0x5db1e1(0x198)](_0x1ae1a3=>({..._0x1ae1a3,'path':(_0x498402||_0x362af3)+'/'+_0x1ae1a3[_0x5db1e1(0x194)]}))});return;}let _0x49e8fe;try{const [_0x5325fb]=await conn[_0x5db1e1(0x199)]()['execute'](_0x5db1e1(0x1b7),[_0x59f46c[_0x5db1e1(0x196)]['email']]);_0x5325fb['length']>0x0&&(_0x49e8fe=_0x5325fb[0x0]);}catch(_0x48332c){console[_0x5db1e1(0x18c)]({'err':_0x48332c}),_0x54ea28[_0x5db1e1(0x189)](0x1f4)[_0x5db1e1(0x193)]({'error':_0x5db1e1(0x18f)});return;}if(!_0x49e8fe){_0x54ea28[_0x5db1e1(0x189)](0x191)['json']({'error':_0x5db1e1(0x1a5)});return;}let _0x2c926d=_0x49e8fe[_0x5db1e1(0x185)];if(!_0x2c926d){_0x2c926d=randomUUID();try{await conn[_0x5db1e1(0x199)]()[_0x5db1e1(0x1b0)](_0x5db1e1(0x191),[_0x2c926d,_0x59f46c[_0x5db1e1(0x196)][_0x5db1e1(0x17f)]]);}catch(_0x107b5c){console[_0x5db1e1(0x18c)]({'err':_0x107b5c}),_0x54ea28['status'](0x1f4)[_0x5db1e1(0x193)]({'error':_0x5db1e1(0x18f)});return;}}const _0x407660='./uploads/'+_0x2c926d;!fs[_0x5db1e1(0x1aa)](_0x407660)&&fs['mkdirSync'](_0x407660);if(!_0x902efe){const _0x432f8f=new Error(_0x5db1e1(0x1a3));return _0x432f8f[_0x5db1e1(0x1a0)]=0x190,_0x74b2a0(_0x432f8f);}const _0x5b6d5a=fs[_0x5db1e1(0x1a1)](_0x407660)['length']+_0x902efe[_0x5db1e1(0x1b2)];console[_0x5db1e1(0x18c)]({'numberOfSize':_0x5b6d5a});if(_0x5b6d5a>userFolderMaximumFiles)return _0x54ea28[_0x5db1e1(0x189)](0x190)[_0x5db1e1(0x193)]({'error':_0x5db1e1(0x1ab)+userFolderMaximumFiles+_0x5db1e1(0x184)});const _0x3fdba2=fs[_0x5db1e1(0x1a1)](_0x407660)['reduce']((_0x4daafb,_0x4016c6)=>_0x4daafb+fs[_0x5db1e1(0x17d)](_0x407660+'/'+_0x4016c6)[_0x5db1e1(0x1ac)],0x0),_0x16e952=_0x902efe[_0x5db1e1(0x182)]((_0x209309,_0x1d20b7)=>_0x209309+_0x1d20b7[_0x5db1e1(0x1ac)],0x0);console['log']({'totalSize':_0x3fdba2,'uploadedSize':_0x16e952});if(_0x16e952+_0x3fdba2>userFolderMaximumSizeInMB*0x400*0x400)return _0x54ea28[_0x5db1e1(0x189)](0x190)['json']({'error':'You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20'+userFolderMaximumSizeInMB+'\x20MB\x20of\x20files'});_0x902efe['forEach'](_0x1e52d4=>{const _0x2a145e=_0x5db1e1;fs['copyFileSync'](_0x1e52d4['path'],_0x407660+'/'+_0x1e52d4[_0x2a145e(0x194)]),fs[_0x2a145e(0x1af)](_0x1e52d4[_0x2a145e(0x1ae)]);}),_0x54ea28['send']({'files':_0x902efe[_0x5db1e1(0x198)](_0x5b5ad7=>({..._0x5b5ad7,'path':_0x407660+'/'+_0x5b5ad7[_0x5db1e1(0x194)]}))});}),router[a8_0x1a6876(0x197)](a8_0x1a6876(0x18d),verifyToken,async(_0x2c859f,_0x2d2004)=>{const _0x36c64a=a8_0x1a6876,{path:_0x17f76a,folder_name:_0x42446e}=_0x2c859f[_0x36c64a(0x1ad)];console[_0x36c64a(0x18c)]({'path':_0x17f76a,'folder_name':_0x42446e});if(!_0x17f76a)return _0x2d2004[_0x36c64a(0x189)](0x190)[_0x36c64a(0x193)]({'error':'Path\x20is\x20required'});if(!_0x42446e)return _0x2d2004['status'](0x190)[_0x36c64a(0x193)]({'error':'Folder\x20name\x20is\x20required'});const _0x1462f0=_0x17f76a+'/'+_0x42446e;!fs[_0x36c64a(0x1aa)](_0x1462f0)&&fs[_0x36c64a(0x1a9)](_0x1462f0),_0x2d2004[_0x36c64a(0x181)]({'path':_0x1462f0});}),router['delete'](a8_0x1a6876(0x1b4),verifyToken,async(_0x162ff4,_0x1d57d3)=>{const _0x16d271=a8_0x1a6876,{isFolder:_0x4cba55,path:_0x324c7f}=_0x162ff4[_0x16d271(0x1ad)];!_0x4cba55?fs['unlinkSync'](_0x324c7f):fs[_0x16d271(0x195)](_0x324c7f,{'recursive':!![]}),_0x1d57d3[_0x16d271(0x181)]({'success':!![]});}),module[a8_0x1a6876(0x19f)]=router;