function a8_0x39f5(_0x172819,_0x25b69d){const _0x2822a0=a8_0x2822();return a8_0x39f5=function(_0x39f5c8,_0x1adbe9){_0x39f5c8=_0x39f5c8-0x1c2;let _0x478063=_0x2822a0[_0x39f5c8];return _0x478063;},a8_0x39f5(_0x172819,_0x25b69d);}const a8_0x22486c=a8_0x39f5;(function(_0x1dbe77,_0x560b9f){const _0x3bf76f=a8_0x39f5,_0x41d428=_0x1dbe77();while(!![]){try{const _0x4503bb=parseInt(_0x3bf76f(0x1f5))/0x1*(parseInt(_0x3bf76f(0x1d1))/0x2)+parseInt(_0x3bf76f(0x1da))/0x3+-parseInt(_0x3bf76f(0x1ea))/0x4+-parseInt(_0x3bf76f(0x1f7))/0x5*(parseInt(_0x3bf76f(0x1c2))/0x6)+-parseInt(_0x3bf76f(0x1cc))/0x7*(parseInt(_0x3bf76f(0x1ee))/0x8)+parseInt(_0x3bf76f(0x1d8))/0x9+parseInt(_0x3bf76f(0x1e7))/0xa*(-parseInt(_0x3bf76f(0x1e2))/0xb);if(_0x4503bb===_0x560b9f)break;else _0x41d428['push'](_0x41d428['shift']());}catch(_0x5dfc4d){_0x41d428['push'](_0x41d428['shift']());}}}(a8_0x2822,0xa5509));const multer=require(a8_0x22486c(0x1cb)),fs=require('fs'),{randomUUID}=require('crypto'),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0x22486c(0x1f4)),conn=require('../libs/mysql.js'),verifyToken=require(a8_0x22486c(0x1c5))[a8_0x22486c(0x1ed)],dir=a8_0x22486c(0x1d9);function a8_0x2822(){const _0x47a9bd=['exports','1624304pElCVZ','mkdirSync','Router','verifyToken','88oMQtAO','Invalid\x20user','\x20MB\x20of\x20files','user','/files','length','../CADViewer_config.json','5bzysPE','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','195esRtXw','Folder\x20name\x20is\x20required','Error!\x20Something\x20went\x20wrong.','Path\x20is\x20required','body','49446qXaMGt','files','send','../libs/jwt','rmdirSync','uploads','post','/folder','reduce','multer','410746oOJBZs','httpStatusCode','log','express','copyFileSync','513952QHvaDv','./uploads/','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','execute','path','json','status','12120246eXNloO','./uploads','2210877SVyWga','promise','originalname','folderLocation','existsSync','statSync','readdirSync','\x20files','14503181MnydVf','delete','unlinkSync','forEach','map','10qTtult','Please\x20upload\x20a\x20file'];a8_0x2822=function(){return _0x47a9bd;};return a8_0x2822();}!fs[a8_0x22486c(0x1de)](dir)&&fs[a8_0x22486c(0x1eb)](dir);const express=require(a8_0x22486c(0x1cf)),router=express[a8_0x22486c(0x1ec)](),config=require(a8_0x22486c(0x1f4)),storage=multer['diskStorage']({'destination':function(_0x448805,_0x257785,_0x35c1e9){const _0x3fbf0a=a8_0x22486c;_0x35c1e9(null,_0x3fbf0a(0x1c7));}}),upload=multer({'storage':storage});router[a8_0x22486c(0x1c8)](a8_0x22486c(0x1f2),upload['array']('files'),verifyToken,async(_0x1b1dc0,_0x497416,_0x43c69e)=>{const _0x45b92e=a8_0x22486c,_0x6e2647=_0x1b1dc0[_0x45b92e(0x1c3)],{global:_0x57ec54,path:_0x660eec}=_0x1b1dc0[_0x45b92e(0x1fb)],_0x1190a7=config[_0x45b92e(0x1dd)];console[_0x45b92e(0x1ce)]({'global':_0x57ec54}),console[_0x45b92e(0x1ce)](_0x6e2647),console[_0x45b92e(0x1ce)]({'user':_0x1b1dc0['user']});if(_0x57ec54){_0x6e2647[_0x45b92e(0x1e5)](_0x2a02c5=>{const _0x46793d=_0x45b92e;fs['copyFileSync'](_0x2a02c5[_0x46793d(0x1d5)],(_0x660eec||_0x1190a7)+'/'+_0x2a02c5[_0x46793d(0x1dc)]),fs[_0x46793d(0x1e4)](_0x2a02c5['path']);}),_0x497416[_0x45b92e(0x1c4)]({'files':_0x6e2647[_0x45b92e(0x1e6)](_0x1fa441=>({..._0x1fa441,'path':(_0x660eec||_0x1190a7)+'/'+_0x1fa441[_0x45b92e(0x1dc)]}))});return;}let _0x233ea5;try{const [_0x1dfeb6]=await conn[_0x45b92e(0x1db)]()[_0x45b92e(0x1d4)]('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x1b1dc0['user']['email']]);_0x1dfeb6[_0x45b92e(0x1f3)]>0x0&&(_0x233ea5=_0x1dfeb6[0x0]);}catch(_0x3ffb0c){console[_0x45b92e(0x1ce)]({'err':_0x3ffb0c}),_0x497416['status'](0x1f4)[_0x45b92e(0x1d6)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x233ea5){_0x497416[_0x45b92e(0x1d7)](0x191)[_0x45b92e(0x1d6)]({'error':_0x45b92e(0x1ef)});return;}let _0x113d6a=_0x233ea5['folder_name'];if(!_0x113d6a){_0x113d6a=randomUUID();try{await conn[_0x45b92e(0x1db)]()[_0x45b92e(0x1d4)](_0x45b92e(0x1f6),[_0x113d6a,_0x1b1dc0[_0x45b92e(0x1f1)]['email']]);}catch(_0x177f17){console[_0x45b92e(0x1ce)]({'err':_0x177f17}),_0x497416[_0x45b92e(0x1d7)](0x1f4)[_0x45b92e(0x1d6)]({'error':_0x45b92e(0x1f9)});return;}}const _0x19a441=_0x45b92e(0x1d2)+_0x113d6a;!fs['existsSync'](_0x19a441)&&fs['mkdirSync'](_0x19a441);if(!_0x6e2647){const _0x13a7c7=new Error(_0x45b92e(0x1e8));return _0x13a7c7[_0x45b92e(0x1cd)]=0x190,_0x43c69e(_0x13a7c7);}const _0x39d006=fs[_0x45b92e(0x1e0)](_0x19a441)['length']+_0x6e2647[_0x45b92e(0x1f3)];console[_0x45b92e(0x1ce)]({'numberOfSize':_0x39d006});if(_0x39d006>userFolderMaximumFiles)return _0x497416['status'](0x190)[_0x45b92e(0x1d6)]({'error':_0x45b92e(0x1d3)+userFolderMaximumFiles+_0x45b92e(0x1e1)});const _0x223195=fs[_0x45b92e(0x1e0)](_0x19a441)[_0x45b92e(0x1ca)]((_0x1f90fe,_0x1b3ffb)=>_0x1f90fe+fs[_0x45b92e(0x1df)](_0x19a441+'/'+_0x1b3ffb)['size'],0x0),_0x3e9a73=_0x6e2647[_0x45b92e(0x1ca)]((_0x34dc2e,_0x56eed5)=>_0x34dc2e+_0x56eed5['size'],0x0);console[_0x45b92e(0x1ce)]({'totalSize':_0x223195,'uploadedSize':_0x3e9a73});if(_0x3e9a73+_0x223195>userFolderMaximumSizeInMB*0x400*0x400)return _0x497416[_0x45b92e(0x1d7)](0x190)[_0x45b92e(0x1d6)]({'error':_0x45b92e(0x1d3)+userFolderMaximumSizeInMB+_0x45b92e(0x1f0)});_0x6e2647[_0x45b92e(0x1e5)](_0x4edb4c=>{const _0x42aec0=_0x45b92e;fs[_0x42aec0(0x1d0)](_0x4edb4c[_0x42aec0(0x1d5)],_0x19a441+'/'+_0x4edb4c[_0x42aec0(0x1dc)]),fs['unlinkSync'](_0x4edb4c['path']);}),_0x497416[_0x45b92e(0x1c4)]({'files':_0x6e2647['map'](_0x49b7a8=>({..._0x49b7a8,'path':_0x19a441+'/'+_0x49b7a8[_0x45b92e(0x1dc)]}))});}),router['post'](a8_0x22486c(0x1c9),verifyToken,async(_0x159056,_0x16e09e)=>{const _0x2429c7=a8_0x22486c,{path:_0x18f3f1,folder_name:_0x43ad45}=_0x159056[_0x2429c7(0x1fb)];console[_0x2429c7(0x1ce)]({'path':_0x18f3f1,'folder_name':_0x43ad45});if(!_0x18f3f1)return _0x16e09e[_0x2429c7(0x1d7)](0x190)[_0x2429c7(0x1d6)]({'error':_0x2429c7(0x1fa)});if(!_0x43ad45)return _0x16e09e[_0x2429c7(0x1d7)](0x190)[_0x2429c7(0x1d6)]({'error':_0x2429c7(0x1f8)});const _0x348c9f=_0x18f3f1+'/'+_0x43ad45;!fs[_0x2429c7(0x1de)](_0x348c9f)&&fs[_0x2429c7(0x1eb)](_0x348c9f),_0x16e09e[_0x2429c7(0x1c4)]({'path':_0x348c9f});}),router[a8_0x22486c(0x1e3)]('/remove',verifyToken,async(_0x4b08a8,_0x186e43)=>{const _0xd7e1a3=a8_0x22486c,{isFolder:_0x4ae5e7,path:_0xf29304}=_0x4b08a8[_0xd7e1a3(0x1fb)];!_0x4ae5e7?fs[_0xd7e1a3(0x1e4)](_0xf29304):fs[_0xd7e1a3(0x1c6)](_0xf29304,{'recursive':!![]}),_0x186e43[_0xd7e1a3(0x1c4)]({'success':!![]});}),module[a8_0x22486c(0x1e9)]=router;