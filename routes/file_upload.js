function a8_0x400d(_0x265d0b,_0x228092){const _0x3738c1=a8_0x3738();return a8_0x400d=function(_0x400d10,_0x12644f){_0x400d10=_0x400d10-0x1b4;let _0xa3f62e=_0x3738c1[_0x400d10];return _0xa3f62e;},a8_0x400d(_0x265d0b,_0x228092);}const a8_0x2ac266=a8_0x400d;(function(_0x2642e0,_0x3489ee){const _0x37798f=a8_0x400d,_0x4692f7=_0x2642e0();while(!![]){try{const _0x4f1911=-parseInt(_0x37798f(0x1db))/0x1*(parseInt(_0x37798f(0x1d5))/0x2)+parseInt(_0x37798f(0x1de))/0x3*(parseInt(_0x37798f(0x1c2))/0x4)+-parseInt(_0x37798f(0x1d8))/0x5+parseInt(_0x37798f(0x1c5))/0x6*(parseInt(_0x37798f(0x1e1))/0x7)+-parseInt(_0x37798f(0x1c6))/0x8*(-parseInt(_0x37798f(0x1be))/0x9)+-parseInt(_0x37798f(0x1d2))/0xa*(-parseInt(_0x37798f(0x1cb))/0xb)+-parseInt(_0x37798f(0x1d0))/0xc;if(_0x4f1911===_0x3489ee)break;else _0x4692f7['push'](_0x4692f7['shift']());}catch(_0x43e2d0){_0x4692f7['push'](_0x4692f7['shift']());}}}(a8_0x3738,0xaedae));const multer=require(a8_0x2ac266(0x1e3)),fs=require('fs'),{randomUUID}=require(a8_0x2ac266(0x1cd)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require('../CADViewer_config.json'),conn=require('../libs/mysql.js'),verifyToken=require('../libs/jwt')[a8_0x2ac266(0x1ee)],dir=a8_0x2ac266(0x1da);!fs[a8_0x2ac266(0x1c3)](dir)&&fs[a8_0x2ac266(0x1eb)](dir);const express=require(a8_0x2ac266(0x1ea)),router=express['Router'](),config=require(a8_0x2ac266(0x1bb)),storage=multer[a8_0x2ac266(0x1dc)]({'destination':function(_0x17d962,_0x1264ca,_0xd92ca2){const _0x278332=a8_0x2ac266;_0xd92ca2(null,_0x278332(0x1c1));}}),upload=multer({'storage':storage});router[a8_0x2ac266(0x1b5)](a8_0x2ac266(0x1b9),upload['array'](a8_0x2ac266(0x1c0)),verifyToken,async(_0x2dabb5,_0x2c408b,_0x2c9490)=>{const _0x577451=a8_0x2ac266,_0x408d83=_0x2dabb5[_0x577451(0x1c0)],{global:_0x35822e,path:_0x2a7467}=_0x2dabb5[_0x577451(0x1c7)],_0x30463a=config[_0x577451(0x1cc)];console[_0x577451(0x1e8)]({'global':_0x35822e}),console['log'](_0x408d83),console['log']({'user':_0x2dabb5[_0x577451(0x1ba)]});if(_0x35822e){_0x408d83[_0x577451(0x1e2)](_0x1b7131=>{const _0x2a5244=_0x577451;fs[_0x2a5244(0x1d1)](_0x1b7131[_0x2a5244(0x1d6)],(_0x2a7467||_0x30463a)+'/'+_0x1b7131[_0x2a5244(0x1dd)]);}),_0x2c408b[_0x577451(0x1d3)]({'files':_0x408d83[_0x577451(0x1b4)](_0x15d3ab=>({..._0x15d3ab,'path':(_0x2a7467||_0x30463a)+'/'+_0x15d3ab['originalname']}))});return;}let _0x45e47a;try{const [_0x41dd96]=await conn[_0x577451(0x1bf)]()[_0x577451(0x1d4)]('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x2dabb5[_0x577451(0x1ba)]['email']]);_0x41dd96[_0x577451(0x1d7)]>0x0&&(_0x45e47a=_0x41dd96[0x0]);}catch(_0x499c70){console['log']({'err':_0x499c70}),_0x2c408b['status'](0x1f4)[_0x577451(0x1e4)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x45e47a){_0x2c408b[_0x577451(0x1d9)](0x191)[_0x577451(0x1e4)]({'error':_0x577451(0x1e7)});return;}let _0xb31cea=_0x45e47a[_0x577451(0x1e5)];if(!_0xb31cea){_0xb31cea=randomUUID();try{await conn[_0x577451(0x1bf)]()[_0x577451(0x1d4)](_0x577451(0x1ca),[_0xb31cea,_0x2dabb5[_0x577451(0x1ba)][_0x577451(0x1ce)]]);}catch(_0x151c34){console[_0x577451(0x1e8)]({'err':_0x151c34}),_0x2c408b[_0x577451(0x1d9)](0x1f4)['json']({'error':_0x577451(0x1e9)});return;}}const _0x102a67='./uploads/'+_0xb31cea;!fs[_0x577451(0x1c3)](_0x102a67)&&fs[_0x577451(0x1eb)](_0x102a67);if(!_0x408d83){const _0x482a0e=new Error(_0x577451(0x1c8));return _0x482a0e['httpStatusCode']=0x190,_0x2c9490(_0x482a0e);}const _0x50bbf6=fs[_0x577451(0x1ed)](_0x102a67)['length']+_0x408d83['length'];console['log']({'numberOfSize':_0x50bbf6});if(_0x50bbf6>userFolderMaximumFiles)return _0x2c408b['status'](0x190)[_0x577451(0x1e4)]({'error':_0x577451(0x1c4)+userFolderMaximumFiles+_0x577451(0x1bc)});const _0x167e00=fs[_0x577451(0x1ed)](_0x102a67)[_0x577451(0x1b8)]((_0x691258,_0xb8fae5)=>_0x691258+fs[_0x577451(0x1df)](_0x102a67+'/'+_0xb8fae5)[_0x577451(0x1b6)],0x0),_0x415e35=_0x408d83[_0x577451(0x1b8)]((_0x472a8e,_0x22bede)=>_0x472a8e+_0x22bede[_0x577451(0x1b6)],0x0);console['log']({'totalSize':_0x167e00,'uploadedSize':_0x415e35});if(_0x415e35+_0x167e00>userFolderMaximumSizeInMB*0x400*0x400)return _0x2c408b[_0x577451(0x1d9)](0x190)[_0x577451(0x1e4)]({'error':'You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20'+userFolderMaximumSizeInMB+_0x577451(0x1ec)});_0x408d83[_0x577451(0x1e2)](_0x2c480a=>{const _0x38d127=_0x577451;fs[_0x38d127(0x1d1)](_0x2c480a[_0x38d127(0x1d6)],_0x102a67+'/'+_0x2c480a[_0x38d127(0x1dd)]);}),_0x2c408b['send']({'files':_0x408d83[_0x577451(0x1b4)](_0x35de4d=>({..._0x35de4d,'path':_0x102a67+'/'+_0x35de4d[_0x577451(0x1dd)]}))});}),router[a8_0x2ac266(0x1b5)](a8_0x2ac266(0x1bd),verifyToken,async(_0x300ee7,_0x3c47af)=>{const _0x4b9372=a8_0x2ac266,{path:_0x57060b,folder_name:_0x276381}=_0x300ee7['body'],_0x23b28d=config[_0x4b9372(0x1cc)];console[_0x4b9372(0x1e8)]({'path':_0x57060b,'folder_name':_0x276381});if(!_0x57060b)return _0x3c47af[_0x4b9372(0x1d9)](0x190)['json']({'error':'Path\x20is\x20required'});if(!_0x276381)return _0x3c47af[_0x4b9372(0x1d9)](0x190)['json']({'error':_0x4b9372(0x1cf)});const _0x3a2473=_0x57060b+'/'+_0x276381;!fs[_0x4b9372(0x1c3)](_0x3a2473)&&fs['mkdirSync'](_0x3a2473),_0x3c47af[_0x4b9372(0x1d3)]({'path':_0x3a2473});}),router['delete'](a8_0x2ac266(0x1e0),verifyToken,async(_0x4da57e,_0x12459b)=>{const _0x44d62b=a8_0x2ac266,{isFolder:_0x73ef6b,path:_0x1c6476}=_0x4da57e[_0x44d62b(0x1c7)];!_0x73ef6b?fs[_0x44d62b(0x1c9)](_0x1c6476):fs[_0x44d62b(0x1e6)](_0x1c6476,{'recursive':!![]}),_0x12459b[_0x44d62b(0x1d3)]({'success':!![]});}),module[a8_0x2ac266(0x1b7)]=router;function a8_0x3738(){const _0xf08433=['forEach','multer','json','folder_name','rmdirSync','Invalid\x20user','log','Error!\x20Something\x20went\x20wrong.','express','mkdirSync','\x20MB\x20of\x20files','readdirSync','verifyToken','map','post','size','exports','reduce','/files','user','../CADViewer_config.json','\x20files','/folder','5444847UzvmHc','promise','files','uploads','4CHJVGI','existsSync','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','6OXQvHl','16xhaphD','body','Please\x20upload\x20a\x20file','unlinkSync','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','319Kicxfk','folderLocation','crypto','email','Folder\x20name\x20is\x20required','9822768Fzwzyp','renameSync','299100axRVxi','send','execute','62ZcaHLc','path','length','4147655nPwYhn','status','./uploads','36295bVAnJe','diskStorage','originalname','593481IOKUrh','statSync','/remove','8499841Zpheyc'];a8_0x3738=function(){return _0xf08433;};return a8_0x3738();}