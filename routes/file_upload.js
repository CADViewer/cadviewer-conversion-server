function a9_0x361f(_0x10d9c6,_0x2dd041){const _0x51e4e8=a9_0x51e4();return a9_0x361f=function(_0x361f51,_0x4d3878){_0x361f51=_0x361f51-0x1df;let _0x5db421=_0x51e4e8[_0x361f51];return _0x5db421;},a9_0x361f(_0x10d9c6,_0x2dd041);}const a9_0x22a946=a9_0x361f;(function(_0x54b60c,_0x31a277){const _0x56edec=a9_0x361f,_0x26030e=_0x54b60c();while(!![]){try{const _0x346096=parseInt(_0x56edec(0x219))/0x1+-parseInt(_0x56edec(0x20b))/0x2*(-parseInt(_0x56edec(0x1ec))/0x3)+-parseInt(_0x56edec(0x1f3))/0x4*(-parseInt(_0x56edec(0x205))/0x5)+parseInt(_0x56edec(0x1ff))/0x6*(-parseInt(_0x56edec(0x1e4))/0x7)+-parseInt(_0x56edec(0x217))/0x8+parseInt(_0x56edec(0x203))/0x9*(parseInt(_0x56edec(0x1ef))/0xa)+-parseInt(_0x56edec(0x204))/0xb*(parseInt(_0x56edec(0x1ee))/0xc);if(_0x346096===_0x31a277)break;else _0x26030e['push'](_0x26030e['shift']());}catch(_0x2426a8){_0x26030e['push'](_0x26030e['shift']());}}}(a9_0x51e4,0xf1833));const multer=require(a9_0x22a946(0x206)),fs=require('fs'),{randomUUID}=require(a9_0x22a946(0x1fd)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a9_0x22a946(0x213)),conn=require(a9_0x22a946(0x1fb)),verifyToken=require(a9_0x22a946(0x1f4))[a9_0x22a946(0x214)],dir=a9_0x22a946(0x21c);!fs[a9_0x22a946(0x1e2)](dir)&&fs[a9_0x22a946(0x1f8)](dir);const express=require(a9_0x22a946(0x215)),router=express[a9_0x22a946(0x207)](),config=require(a9_0x22a946(0x213)),storage=multer[a9_0x22a946(0x210)]({'destination':function(_0x2ff42e,_0x1263e3,_0x1adfca){const _0x5891cb=a9_0x22a946;_0x1adfca(null,_0x5891cb(0x21d));}}),upload=multer({'storage':storage});function a9_0x51e4(){const _0x4dd533=['44FviFWU','../libs/jwt','/folder','forEach','email','mkdirSync','files','statSync','../libs/mysql.js','Invalid\x20user','crypto','log','5217582pcVyeg','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','Error!\x20Something\x20went\x20wrong.','Please\x20upload\x20a\x20file','117mhiFok','23689303xQzlQv','178635KNxkjm','multer','Router','status','\x20MB\x20of\x20files','unlinkSync','130KsjLvF','folder_name','user','folderLocation','\x20files','diskStorage','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','promise','../CADViewer_config.json','verifyToken','express','originalname','6181200xchvIW','copyFileSync','1383715VjszZg','json','post','./uploads','uploads','Folder\x20name\x20is\x20required','execute','map','size','existsSync','length','7dllfaG','/remove','httpStatusCode','reduce','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','/files','delete','rmdirSync','81318qFlaxk','path','12yRndYX','958810teElRO','send','body','exports'];a9_0x51e4=function(){return _0x4dd533;};return a9_0x51e4();}router[a9_0x22a946(0x21b)](a9_0x22a946(0x1e9),upload['array'](a9_0x22a946(0x1f9)),verifyToken,async(_0x2782a3,_0x567e8b,_0x260618)=>{const _0x54fc82=a9_0x22a946,_0x45fcc0=_0x2782a3[_0x54fc82(0x1f9)],{global:_0x4e7f26,path:_0x2ef8f2}=_0x2782a3[_0x54fc82(0x1f1)],_0x4d8388=config[_0x54fc82(0x20e)];console['log']({'global':_0x4e7f26}),console['log'](_0x45fcc0),console['log']({'user':_0x2782a3[_0x54fc82(0x20d)]});if(_0x4e7f26){_0x45fcc0[_0x54fc82(0x1f6)](_0x5ad430=>{const _0xdb65fc=_0x54fc82;fs[_0xdb65fc(0x218)](_0x5ad430[_0xdb65fc(0x1ed)],(_0x2ef8f2||_0x4d8388)+'/'+_0x5ad430[_0xdb65fc(0x216)]),fs[_0xdb65fc(0x20a)](_0x5ad430['path']);}),_0x567e8b[_0x54fc82(0x1f0)]({'files':_0x45fcc0[_0x54fc82(0x1e0)](_0x3a08dc=>({..._0x3a08dc,'path':(_0x2ef8f2||_0x4d8388)+'/'+_0x3a08dc[_0x54fc82(0x216)]}))});return;}let _0x252de1;try{const [_0x100ccc]=await conn[_0x54fc82(0x212)]()[_0x54fc82(0x1df)](_0x54fc82(0x211),[_0x2782a3['user'][_0x54fc82(0x1f7)]]);_0x100ccc[_0x54fc82(0x1e3)]>0x0&&(_0x252de1=_0x100ccc[0x0]);}catch(_0x3cfff2){console[_0x54fc82(0x1fe)]({'err':_0x3cfff2}),_0x567e8b['status'](0x1f4)['json']({'error':_0x54fc82(0x201)});return;}if(!_0x252de1){_0x567e8b[_0x54fc82(0x208)](0x191)[_0x54fc82(0x21a)]({'error':_0x54fc82(0x1fc)});return;}let _0x35fb06=_0x252de1[_0x54fc82(0x20c)];if(!_0x35fb06){_0x35fb06=randomUUID();try{await conn['promise']()[_0x54fc82(0x1df)](_0x54fc82(0x1e8),[_0x35fb06,_0x2782a3['user']['email']]);}catch(_0x54a052){console['log']({'err':_0x54a052}),_0x567e8b[_0x54fc82(0x208)](0x1f4)[_0x54fc82(0x21a)]({'error':_0x54fc82(0x201)});return;}}const _0x37775d='./uploads/'+_0x35fb06;!fs[_0x54fc82(0x1e2)](_0x37775d)&&fs[_0x54fc82(0x1f8)](_0x37775d);if(!_0x45fcc0){const _0x14c678=new Error(_0x54fc82(0x202));return _0x14c678[_0x54fc82(0x1e6)]=0x190,_0x260618(_0x14c678);}const _0x4c7d25=fs['readdirSync'](_0x37775d)['length']+_0x45fcc0[_0x54fc82(0x1e3)];console[_0x54fc82(0x1fe)]({'numberOfSize':_0x4c7d25});if(_0x4c7d25>userFolderMaximumFiles)return _0x567e8b[_0x54fc82(0x208)](0x190)[_0x54fc82(0x21a)]({'error':_0x54fc82(0x200)+userFolderMaximumFiles+_0x54fc82(0x20f)});const _0x1cae32=fs['readdirSync'](_0x37775d)[_0x54fc82(0x1e7)]((_0x588adf,_0x22735b)=>_0x588adf+fs[_0x54fc82(0x1fa)](_0x37775d+'/'+_0x22735b)[_0x54fc82(0x1e1)],0x0),_0x31d87b=_0x45fcc0[_0x54fc82(0x1e7)]((_0x11d285,_0x4f62ea)=>_0x11d285+_0x4f62ea['size'],0x0);console['log']({'totalSize':_0x1cae32,'uploadedSize':_0x31d87b});if(_0x31d87b+_0x1cae32>userFolderMaximumSizeInMB*0x400*0x400)return _0x567e8b[_0x54fc82(0x208)](0x190)[_0x54fc82(0x21a)]({'error':_0x54fc82(0x200)+userFolderMaximumSizeInMB+_0x54fc82(0x209)});_0x45fcc0[_0x54fc82(0x1f6)](_0x452fd7=>{const _0x2d354e=_0x54fc82;fs[_0x2d354e(0x218)](_0x452fd7[_0x2d354e(0x1ed)],_0x37775d+'/'+_0x452fd7[_0x2d354e(0x216)]),fs[_0x2d354e(0x20a)](_0x452fd7[_0x2d354e(0x1ed)]);}),_0x567e8b[_0x54fc82(0x1f0)]({'files':_0x45fcc0[_0x54fc82(0x1e0)](_0x2c7dbd=>({..._0x2c7dbd,'path':_0x37775d+'/'+_0x2c7dbd[_0x54fc82(0x216)]}))});}),router[a9_0x22a946(0x21b)](a9_0x22a946(0x1f5),verifyToken,async(_0x1a0ec6,_0x34651c)=>{const _0x175026=a9_0x22a946,{path:_0x1527d1,folder_name:_0x236fe0}=_0x1a0ec6['body'];console['log']({'path':_0x1527d1,'folder_name':_0x236fe0});if(!_0x1527d1)return _0x34651c[_0x175026(0x208)](0x190)[_0x175026(0x21a)]({'error':'Path\x20is\x20required'});if(!_0x236fe0)return _0x34651c['status'](0x190)[_0x175026(0x21a)]({'error':_0x175026(0x21e)});const _0x231337=_0x1527d1+'/'+_0x236fe0;!fs[_0x175026(0x1e2)](_0x231337)&&fs[_0x175026(0x1f8)](_0x231337),_0x34651c[_0x175026(0x1f0)]({'path':_0x231337});}),router[a9_0x22a946(0x1ea)](a9_0x22a946(0x1e5),verifyToken,async(_0x45bfeb,_0x4a50af)=>{const _0x15ae46=a9_0x22a946,{isFolder:_0x59dd98,path:_0x5c4f94}=_0x45bfeb[_0x15ae46(0x1f1)];!_0x59dd98?fs[_0x15ae46(0x20a)](_0x5c4f94):fs[_0x15ae46(0x1eb)](_0x5c4f94,{'recursive':!![]}),_0x4a50af[_0x15ae46(0x1f0)]({'success':!![]});}),module[a9_0x22a946(0x1f2)]=router;