function a9_0x5241(){const _0xdd5cf9=['copyFileSync','post','array','55GyLIKN','uploads','402070rwExss','existsSync','statSync','Error!\x20Something\x20went\x20wrong.','483690hmlGgg','promise','delete','status','json','1sGapDD','user','httpStatusCode','verifyToken','9KVpIAG','/folder','\x20MB\x20of\x20files','729276sGSJkj','folderLocation','email','path','unlinkSync','send','map','../CADViewer_config.json','../libs/mysql.js','mkdirSync','diskStorage','Folder\x20name\x20is\x20required','length','7679888CZJevn','forEach','./uploads/','2226316uBhpxj','log','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','multer','Router','688702drgQcg','exports','body','42pvfmpf','Please\x20upload\x20a\x20file','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','reduce','size','Invalid\x20user','Path\x20is\x20required','readdirSync','originalname','2632146DjKcaw','/remove','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','/files','execute'];a9_0x5241=function(){return _0xdd5cf9;};return a9_0x5241();}const a9_0xdd0eb7=a9_0x1bec;(function(_0x38907e,_0x258241){const _0x5d1b0e=a9_0x1bec,_0x53f948=_0x38907e();while(!![]){try{const _0x130843=parseInt(_0x5d1b0e(0xad))/0x1*(parseInt(_0x5d1b0e(0xc4))/0x2)+-parseInt(_0x5d1b0e(0xd5))/0x3+-parseInt(_0x5d1b0e(0xb4))/0x4+parseInt(_0x5d1b0e(0xa4))/0x5+-parseInt(_0x5d1b0e(0xcc))/0x6*(parseInt(_0x5d1b0e(0xc9))/0x7)+-parseInt(_0x5d1b0e(0xc1))/0x8*(-parseInt(_0x5d1b0e(0xb1))/0x9)+-parseInt(_0x5d1b0e(0xa8))/0xa*(-parseInt(_0x5d1b0e(0xa2))/0xb);if(_0x130843===_0x258241)break;else _0x53f948['push'](_0x53f948['shift']());}catch(_0x5fcace){_0x53f948['push'](_0x53f948['shift']());}}}(a9_0x5241,0x9df58));const multer=require(a9_0xdd0eb7(0xc7)),fs=require('fs'),{randomUUID}=require('crypto'),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a9_0xdd0eb7(0xbb)),conn=require(a9_0xdd0eb7(0xbc)),verifyToken=require('../libs/jwt')[a9_0xdd0eb7(0xb0)],dir='./uploads';!fs['existsSync'](dir)&&fs[a9_0xdd0eb7(0xbd)](dir);function a9_0x1bec(_0x154c8f,_0x5dba3c){const _0x524149=a9_0x5241();return a9_0x1bec=function(_0x1bec7b,_0x48ab86){_0x1bec7b=_0x1bec7b-0xa0;let _0x33e9fc=_0x524149[_0x1bec7b];return _0x33e9fc;},a9_0x1bec(_0x154c8f,_0x5dba3c);}const express=require('express'),router=express[a9_0xdd0eb7(0xc8)](),config=require(a9_0xdd0eb7(0xbb)),storage=multer[a9_0xdd0eb7(0xbe)]({'destination':function(_0x206d7,_0x554c88,_0x281fa8){const _0x2c6fe6=a9_0xdd0eb7;_0x281fa8(null,_0x2c6fe6(0xa3));}}),upload=multer({'storage':storage});router[a9_0xdd0eb7(0xa0)](a9_0xdd0eb7(0xd8),upload[a9_0xdd0eb7(0xa1)]('files'),verifyToken,async(_0x5760ca,_0x2bf822,_0x1ce296)=>{const _0x9f1f8d=a9_0xdd0eb7,_0x45fff7=_0x5760ca['files'],{global:_0x40c6ce,path:_0x52a90f}=_0x5760ca['body'],_0xaf0fc0=config[_0x9f1f8d(0xb5)];console[_0x9f1f8d(0xc5)]({'global':_0x40c6ce}),console[_0x9f1f8d(0xc5)](_0x45fff7),console[_0x9f1f8d(0xc5)]({'user':_0x5760ca[_0x9f1f8d(0xae)]});if(_0x40c6ce){_0x45fff7[_0x9f1f8d(0xc2)](_0x40ff4f=>{const _0x392c2a=_0x9f1f8d;fs[_0x392c2a(0xda)](_0x40ff4f[_0x392c2a(0xb7)],(_0x52a90f||_0xaf0fc0)+'/'+_0x40ff4f[_0x392c2a(0xd4)]),fs[_0x392c2a(0xb8)](_0x40ff4f[_0x392c2a(0xb7)]);}),_0x2bf822['send']({'files':_0x45fff7['map'](_0x1458bd=>({..._0x1458bd,'path':(_0x52a90f||_0xaf0fc0)+'/'+_0x1458bd[_0x9f1f8d(0xd4)]}))});return;}let _0x412ccc;try{const [_0x5e4f1e]=await conn[_0x9f1f8d(0xa9)]()['execute'](_0x9f1f8d(0xc6),[_0x5760ca[_0x9f1f8d(0xae)][_0x9f1f8d(0xb6)]]);_0x5e4f1e['length']>0x0&&(_0x412ccc=_0x5e4f1e[0x0]);}catch(_0x3654e3){console[_0x9f1f8d(0xc5)]({'err':_0x3654e3}),_0x2bf822[_0x9f1f8d(0xab)](0x1f4)[_0x9f1f8d(0xac)]({'error':_0x9f1f8d(0xa7)});return;}if(!_0x412ccc){_0x2bf822[_0x9f1f8d(0xab)](0x191)[_0x9f1f8d(0xac)]({'error':_0x9f1f8d(0xd1)});return;}let _0x13fa25=_0x412ccc['folder_name'];if(!_0x13fa25){_0x13fa25=randomUUID();try{await conn[_0x9f1f8d(0xa9)]()[_0x9f1f8d(0xd9)](_0x9f1f8d(0xce),[_0x13fa25,_0x5760ca[_0x9f1f8d(0xae)][_0x9f1f8d(0xb6)]]);}catch(_0x62902e){console[_0x9f1f8d(0xc5)]({'err':_0x62902e}),_0x2bf822[_0x9f1f8d(0xab)](0x1f4)['json']({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x58f503=_0x9f1f8d(0xc3)+_0x13fa25;!fs[_0x9f1f8d(0xa5)](_0x58f503)&&fs[_0x9f1f8d(0xbd)](_0x58f503);if(!_0x45fff7){const _0x5c4271=new Error(_0x9f1f8d(0xcd));return _0x5c4271[_0x9f1f8d(0xaf)]=0x190,_0x1ce296(_0x5c4271);}const _0x4eb950=fs[_0x9f1f8d(0xd3)](_0x58f503)[_0x9f1f8d(0xc0)]+_0x45fff7['length'];console[_0x9f1f8d(0xc5)]({'numberOfSize':_0x4eb950});if(_0x4eb950>userFolderMaximumFiles)return _0x2bf822['status'](0x190)[_0x9f1f8d(0xac)]({'error':'You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20'+userFolderMaximumFiles+'\x20files'});const _0x109ddc=fs[_0x9f1f8d(0xd3)](_0x58f503)[_0x9f1f8d(0xcf)]((_0xa29e9f,_0x590256)=>_0xa29e9f+fs[_0x9f1f8d(0xa6)](_0x58f503+'/'+_0x590256)[_0x9f1f8d(0xd0)],0x0),_0x42ace5=_0x45fff7[_0x9f1f8d(0xcf)]((_0x1ce158,_0x1417b3)=>_0x1ce158+_0x1417b3[_0x9f1f8d(0xd0)],0x0);console[_0x9f1f8d(0xc5)]({'totalSize':_0x109ddc,'uploadedSize':_0x42ace5});if(_0x42ace5+_0x109ddc>userFolderMaximumSizeInMB*0x400*0x400)return _0x2bf822['status'](0x190)[_0x9f1f8d(0xac)]({'error':_0x9f1f8d(0xd7)+userFolderMaximumSizeInMB+_0x9f1f8d(0xb3)});_0x45fff7[_0x9f1f8d(0xc2)](_0xf1df5f=>{const _0xbad8b2=_0x9f1f8d;fs['copyFileSync'](_0xf1df5f[_0xbad8b2(0xb7)],_0x58f503+'/'+_0xf1df5f[_0xbad8b2(0xd4)]),fs[_0xbad8b2(0xb8)](_0xf1df5f[_0xbad8b2(0xb7)]);}),_0x2bf822[_0x9f1f8d(0xb9)]({'files':_0x45fff7[_0x9f1f8d(0xba)](_0x193607=>({..._0x193607,'path':_0x58f503+'/'+_0x193607[_0x9f1f8d(0xd4)]}))});}),router[a9_0xdd0eb7(0xa0)](a9_0xdd0eb7(0xb2),verifyToken,async(_0x590ba3,_0x118a4b)=>{const _0x7f702c=a9_0xdd0eb7,{path:_0x2b585f,folder_name:_0x3a5482}=_0x590ba3['body'];console['log']({'path':_0x2b585f,'folder_name':_0x3a5482});if(!_0x2b585f)return _0x118a4b[_0x7f702c(0xab)](0x190)[_0x7f702c(0xac)]({'error':_0x7f702c(0xd2)});if(!_0x3a5482)return _0x118a4b[_0x7f702c(0xab)](0x190)[_0x7f702c(0xac)]({'error':_0x7f702c(0xbf)});const _0xc621ed=_0x2b585f+'/'+_0x3a5482;!fs[_0x7f702c(0xa5)](_0xc621ed)&&fs[_0x7f702c(0xbd)](_0xc621ed),_0x118a4b[_0x7f702c(0xb9)]({'path':_0xc621ed});}),router[a9_0xdd0eb7(0xaa)](a9_0xdd0eb7(0xd6),verifyToken,async(_0x1c6544,_0x22907a)=>{const _0x4f9993=a9_0xdd0eb7,{isFolder:_0x91ce17,path:_0x13e5c7}=_0x1c6544[_0x4f9993(0xcb)];!_0x91ce17?fs[_0x4f9993(0xb8)](_0x13e5c7):fs['rmdirSync'](_0x13e5c7,{'recursive':!![]}),_0x22907a[_0x4f9993(0xb9)]({'success':!![]});}),module[a9_0xdd0eb7(0xca)]=router;