const a8_0x4a8836=a8_0x19af;(function(_0x452b4f,_0x5813ea){const _0x2685df=a8_0x19af,_0x7a1b80=_0x452b4f();while(!![]){try{const _0x29301c=parseInt(_0x2685df(0x101))/0x1+parseInt(_0x2685df(0x123))/0x2*(-parseInt(_0x2685df(0x113))/0x3)+-parseInt(_0x2685df(0x12b))/0x4*(parseInt(_0x2685df(0x10b))/0x5)+parseInt(_0x2685df(0xfc))/0x6*(-parseInt(_0x2685df(0xf9))/0x7)+parseInt(_0x2685df(0x106))/0x8*(parseInt(_0x2685df(0x12e))/0x9)+-parseInt(_0x2685df(0x108))/0xa+parseInt(_0x2685df(0x129))/0xb;if(_0x29301c===_0x5813ea)break;else _0x7a1b80['push'](_0x7a1b80['shift']());}catch(_0x3c50a8){_0x7a1b80['push'](_0x7a1b80['shift']());}}}(a8_0x448a,0x5ebff));const multer=require('multer'),fs=require('fs'),{randomUUID}=require(a8_0x4a8836(0x11c)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0x4a8836(0x103)),conn=require(a8_0x4a8836(0x100)),verifyToken=require(a8_0x4a8836(0x11f))['verifyToken'],dir=a8_0x4a8836(0x116);!fs[a8_0x4a8836(0xf7)](dir)&&fs[a8_0x4a8836(0x115)](dir);const express=require(a8_0x4a8836(0x111)),router=express[a8_0x4a8836(0x110)](),config=require(a8_0x4a8836(0x103)),storage=multer[a8_0x4a8836(0x121)]({'destination':function(_0x266450,_0x5ebc88,_0x4ace84){_0x4ace84(null,'uploads');}}),upload=multer({'storage':storage});function a8_0x19af(_0x5f28a2,_0x42a88a){const _0x448a63=a8_0x448a();return a8_0x19af=function(_0x19afe9,_0x2ec931){_0x19afe9=_0x19afe9-0xf4;let _0x4df409=_0x448a63[_0x19afe9];return _0x4df409;},a8_0x19af(_0x5f28a2,_0x42a88a);}router['post'](a8_0x4a8836(0x127),upload[a8_0x4a8836(0x118)](a8_0x4a8836(0xff)),verifyToken,async(_0x4c6398,_0x5d8052,_0x1002c9)=>{const _0x3a74f7=a8_0x4a8836,_0x56150b=_0x4c6398['files'],{global:_0x303cab,path:_0xe33812}=_0x4c6398[_0x3a74f7(0x128)],_0xdb343d=config[_0x3a74f7(0x112)];console[_0x3a74f7(0x10a)]({'global':_0x303cab}),console[_0x3a74f7(0x10a)](_0x56150b),console[_0x3a74f7(0x10a)]({'user':_0x4c6398[_0x3a74f7(0x117)]});if(_0x303cab){_0x56150b[_0x3a74f7(0x107)](_0x2ea3c0=>{const _0x533c54=_0x3a74f7;fs[_0x533c54(0x10d)](_0x2ea3c0['path'],(_0xe33812||_0xdb343d)+'/'+_0x2ea3c0[_0x533c54(0xfb)]);}),_0x5d8052[_0x3a74f7(0x11e)]({'files':_0x56150b[_0x3a74f7(0x12a)](_0x3f669f=>({..._0x3f669f,'path':(_0xe33812||_0xdb343d)+'/'+_0x3f669f[_0x3a74f7(0xfb)]}))});return;}let _0x5e075e;try{const [_0x54dbc2]=await conn['promise']()[_0x3a74f7(0x125)](_0x3a74f7(0x11d),[_0x4c6398[_0x3a74f7(0x117)][_0x3a74f7(0xf6)]]);_0x54dbc2[_0x3a74f7(0x124)]>0x0&&(_0x5e075e=_0x54dbc2[0x0]);}catch(_0x231196){console[_0x3a74f7(0x10a)]({'err':_0x231196}),_0x5d8052[_0x3a74f7(0x114)](0x1f4)[_0x3a74f7(0x10c)]({'error':_0x3a74f7(0x126)});return;}if(!_0x5e075e){_0x5d8052[_0x3a74f7(0x114)](0x191)['json']({'error':_0x3a74f7(0x119)});return;}let _0x2099d5=_0x5e075e[_0x3a74f7(0xfe)];if(!_0x2099d5){_0x2099d5=randomUUID();try{await conn[_0x3a74f7(0x11b)]()[_0x3a74f7(0x125)](_0x3a74f7(0x120),[_0x2099d5,_0x4c6398[_0x3a74f7(0x117)][_0x3a74f7(0xf6)]]);}catch(_0x667283){console[_0x3a74f7(0x10a)]({'err':_0x667283}),_0x5d8052[_0x3a74f7(0x114)](0x1f4)[_0x3a74f7(0x10c)]({'error':_0x3a74f7(0x126)});return;}}const _0x387c7e=_0x3a74f7(0x11a)+_0x2099d5;!fs['existsSync'](_0x387c7e)&&fs['mkdirSync'](_0x387c7e);if(!_0x56150b){const _0x3f8299=new Error('Please\x20upload\x20a\x20file');return _0x3f8299[_0x3a74f7(0x10f)]=0x190,_0x1002c9(_0x3f8299);}const _0x3e3c6c=fs['readdirSync'](_0x387c7e)[_0x3a74f7(0x124)]+_0x56150b[_0x3a74f7(0x124)];console[_0x3a74f7(0x10a)]({'numberOfSize':_0x3e3c6c});if(_0x3e3c6c>userFolderMaximumFiles)return _0x5d8052['status'](0x190)[_0x3a74f7(0x10c)]({'error':_0x3a74f7(0xf8)+userFolderMaximumFiles+_0x3a74f7(0x102)});const _0x4abc7a=fs[_0x3a74f7(0xf5)](_0x387c7e)['reduce']((_0x16c8b2,_0x501e2d)=>_0x16c8b2+fs['statSync'](_0x387c7e+'/'+_0x501e2d)[_0x3a74f7(0x109)],0x0),_0x3d2e93=_0x56150b[_0x3a74f7(0x105)]((_0x2c9c57,_0x29196f)=>_0x2c9c57+_0x29196f['size'],0x0);console[_0x3a74f7(0x10a)]({'totalSize':_0x4abc7a,'uploadedSize':_0x3d2e93});if(_0x3d2e93+_0x4abc7a>userFolderMaximumSizeInMB*0x400*0x400)return _0x5d8052[_0x3a74f7(0x114)](0x190)[_0x3a74f7(0x10c)]({'error':_0x3a74f7(0xf8)+userFolderMaximumSizeInMB+'\x20MB\x20of\x20files'});_0x56150b[_0x3a74f7(0x107)](_0x4eaa99=>{const _0xd4e016=_0x3a74f7;fs[_0xd4e016(0x10d)](_0x4eaa99[_0xd4e016(0xfa)],_0x387c7e+'/'+_0x4eaa99[_0xd4e016(0xfb)]);}),_0x5d8052[_0x3a74f7(0x11e)]({'files':_0x56150b[_0x3a74f7(0x12a)](_0x54f3a2=>({..._0x54f3a2,'path':_0x387c7e+'/'+_0x54f3a2[_0x3a74f7(0xfb)]}))});}),router[a8_0x4a8836(0xf4)](a8_0x4a8836(0xfd),verifyToken,async(_0xe2159a,_0x41b53b)=>{const _0x33a3cb=a8_0x4a8836,{path:_0x8343ac,folder_name:_0x3b5bd9}=_0xe2159a['body'],_0x6bb54b=config['folderLocation'];console[_0x33a3cb(0x10a)]({'path':_0x8343ac,'folder_name':_0x3b5bd9});if(!_0x8343ac)return _0x41b53b['status'](0x190)[_0x33a3cb(0x10c)]({'error':_0x33a3cb(0x122)});if(!_0x3b5bd9)return _0x41b53b[_0x33a3cb(0x114)](0x190)[_0x33a3cb(0x10c)]({'error':_0x33a3cb(0x12f)});const _0x4de1d0=_0x8343ac+'/'+_0x3b5bd9;!fs[_0x33a3cb(0xf7)](_0x4de1d0)&&fs[_0x33a3cb(0x115)](_0x4de1d0),_0x41b53b[_0x33a3cb(0x11e)]({'path':_0x4de1d0});}),router[a8_0x4a8836(0x104)](a8_0x4a8836(0x12d),verifyToken,async(_0x4be58e,_0x389924)=>{const _0x264c76=a8_0x4a8836,{isFolder:_0x26ad7e,path:_0x47bbce}=_0x4be58e[_0x264c76(0x128)];!_0x26ad7e?fs[_0x264c76(0x10e)](_0x47bbce):fs[_0x264c76(0x12c)](_0x47bbce,{'recursive':!![]}),_0x389924['send']({'success':!![]});}),module['exports']=router;function a8_0x448a(){const _0x1cb9d6=['../libs/jwt','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','diskStorage','Path\x20is\x20required','2EqnSJk','length','execute','Error!\x20Something\x20went\x20wrong.','/files','body','5418402xkMFsh','map','10860kvCKdO','rmdirSync','/remove','4642443qKWpXA','Folder\x20name\x20is\x20required','post','readdirSync','email','existsSync','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','105tskaaS','path','originalname','104514VDUmxp','/folder','folder_name','files','../libs/mysql.js','66365bvVCPQ','\x20files','../CADViewer_config.json','delete','reduce','8OosECE','forEach','849450TUNVtR','size','log','590bxhEQX','json','renameSync','unlinkSync','httpStatusCode','Router','express','folderLocation','60237iNLLqW','status','mkdirSync','./uploads','user','array','Invalid\x20user','./uploads/','promise','crypto','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','send'];a8_0x448a=function(){return _0x1cb9d6;};return a8_0x448a();}