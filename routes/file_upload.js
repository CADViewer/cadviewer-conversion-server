function a8_0x168b(){const _0x561a85=['\x20files','forEach','map','folder_name','1917080qbdmmk','crypto','files','httpStatusCode','renameSync','multer','path','Router','reduce','./uploads','313WVTaXC','2951703wKoXas','readdirSync','log','276WZjILC','status','existsSync','execute','unlinkSync','Error!\x20Something\x20went\x20wrong.','json','1294ODIUIe','size','100688XSvQIT','user','email','delete','body','length','Folder\x20name\x20is\x20required','send','folderLocation','statSync','rmdirSync','express','/files','6713531nWXPAX','288Nguwbk','30TmpgLi','uploads','mkdirSync','originalname','array','post','15284WivklI','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','../libs/mysql.js','promise','Please\x20upload\x20a\x20file','/folder','8797560cfQYjF','diskStorage','./uploads/'];a8_0x168b=function(){return _0x561a85;};return a8_0x168b();}const a8_0x2787b8=a8_0x6192;(function(_0x1d3efe,_0xb5841e){const _0x2ce4f0=a8_0x6192,_0x4922c8=_0x1d3efe();while(!![]){try{const _0x2a0db5=parseInt(_0x2ce4f0(0xbf))/0x1*(parseInt(_0x2ce4f0(0xca))/0x2)+-parseInt(_0x2ce4f0(0xc3))/0x3*(parseInt(_0x2ce4f0(0xa8))/0x4)+-parseInt(_0x2ce4f0(0xb5))/0x5+parseInt(_0x2ce4f0(0xa1))/0x6*(parseInt(_0x2ce4f0(0xcc))/0x7)+-parseInt(_0x2ce4f0(0xae))/0x8+-parseInt(_0x2ce4f0(0xc0))/0x9+parseInt(_0x2ce4f0(0xa2))/0xa*(parseInt(_0x2ce4f0(0xa0))/0xb);if(_0x2a0db5===_0xb5841e)break;else _0x4922c8['push'](_0x4922c8['shift']());}catch(_0x11414c){_0x4922c8['push'](_0x4922c8['shift']());}}}(a8_0x168b,0x89090));function a8_0x6192(_0x3788ff,_0x4871cf){const _0x168bf1=a8_0x168b();return a8_0x6192=function(_0x619203,_0x3aa649){_0x619203=_0x619203-0xa0;let _0x57cf70=_0x168bf1[_0x619203];return _0x57cf70;},a8_0x6192(_0x3788ff,_0x4871cf);}const multer=require(a8_0x2787b8(0xba)),fs=require('fs'),{randomUUID}=require(a8_0x2787b8(0xb6)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require('../CADViewer_config.json'),conn=require(a8_0x2787b8(0xaa)),verifyToken=require('../libs/jwt')['verifyToken'],dir=a8_0x2787b8(0xbe);!fs[a8_0x2787b8(0xc5)](dir)&&fs['mkdirSync'](dir);const express=require(a8_0x2787b8(0xd7)),router=express[a8_0x2787b8(0xbc)](),config=require('../CADViewer_config.json'),storage=multer[a8_0x2787b8(0xaf)]({'destination':function(_0x416758,_0x8a5389,_0x1d152b){const _0xf047ce=a8_0x2787b8;_0x1d152b(null,_0xf047ce(0xa3));}}),upload=multer({'storage':storage});router[a8_0x2787b8(0xa7)](a8_0x2787b8(0xd8),upload[a8_0x2787b8(0xa6)](a8_0x2787b8(0xb7)),verifyToken,async(_0x3c2e0f,_0x1db4dd,_0x5094f2)=>{const _0x5ee66f=a8_0x2787b8,_0x39a5aa=_0x3c2e0f[_0x5ee66f(0xb7)],{global:_0x222970,path:_0x47962f}=_0x3c2e0f[_0x5ee66f(0xd0)],_0xbef7e=config['folderLocation'];console[_0x5ee66f(0xc2)]({'global':_0x222970}),console[_0x5ee66f(0xc2)](_0x39a5aa),console[_0x5ee66f(0xc2)]({'user':_0x3c2e0f['user']});if(_0x222970){_0x39a5aa[_0x5ee66f(0xb2)](_0x42038f=>{const _0x2eab4b=_0x5ee66f;fs[_0x2eab4b(0xb9)](_0x42038f[_0x2eab4b(0xbb)],(_0x47962f||_0xbef7e)+'/'+_0x42038f[_0x2eab4b(0xa5)]);}),_0x1db4dd[_0x5ee66f(0xd3)]({'files':_0x39a5aa['map'](_0x938bb3=>({..._0x938bb3,'path':(_0x47962f||_0xbef7e)+'/'+_0x938bb3['originalname']}))});return;}let _0x21e66d;try{const [_0x4e0a58]=await conn[_0x5ee66f(0xab)]()[_0x5ee66f(0xc6)]('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x3c2e0f[_0x5ee66f(0xcd)]['email']]);_0x4e0a58[_0x5ee66f(0xd1)]>0x0&&(_0x21e66d=_0x4e0a58[0x0]);}catch(_0x42a3ba){console[_0x5ee66f(0xc2)]({'err':_0x42a3ba}),_0x1db4dd[_0x5ee66f(0xc4)](0x1f4)[_0x5ee66f(0xc9)]({'error':_0x5ee66f(0xc8)});return;}if(!_0x21e66d){_0x1db4dd[_0x5ee66f(0xc4)](0x191)['json']({'error':'Invalid\x20user'});return;}let _0x3d9e09=_0x21e66d[_0x5ee66f(0xb4)];if(!_0x3d9e09){_0x3d9e09=randomUUID();try{await conn['promise']()[_0x5ee66f(0xc6)]('UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?',[_0x3d9e09,_0x3c2e0f[_0x5ee66f(0xcd)][_0x5ee66f(0xce)]]);}catch(_0xb5bdaf){console['log']({'err':_0xb5bdaf}),_0x1db4dd[_0x5ee66f(0xc4)](0x1f4)[_0x5ee66f(0xc9)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x105be9=_0x5ee66f(0xb0)+_0x3d9e09;!fs[_0x5ee66f(0xc5)](_0x105be9)&&fs[_0x5ee66f(0xa4)](_0x105be9);if(!_0x39a5aa){const _0xa6b894=new Error(_0x5ee66f(0xac));return _0xa6b894[_0x5ee66f(0xb8)]=0x190,_0x5094f2(_0xa6b894);}const _0x1641db=fs[_0x5ee66f(0xc1)](_0x105be9)[_0x5ee66f(0xd1)]+_0x39a5aa[_0x5ee66f(0xd1)];console[_0x5ee66f(0xc2)]({'numberOfSize':_0x1641db});if(_0x1641db>userFolderMaximumFiles)return _0x1db4dd[_0x5ee66f(0xc4)](0x190)[_0x5ee66f(0xc9)]({'error':_0x5ee66f(0xa9)+userFolderMaximumFiles+_0x5ee66f(0xb1)});const _0xc25ccb=fs[_0x5ee66f(0xc1)](_0x105be9)[_0x5ee66f(0xbd)]((_0x54488c,_0x578f55)=>_0x54488c+fs[_0x5ee66f(0xd5)](_0x105be9+'/'+_0x578f55)[_0x5ee66f(0xcb)],0x0),_0x5b79f9=_0x39a5aa[_0x5ee66f(0xbd)]((_0x66fa89,_0x547497)=>_0x66fa89+_0x547497[_0x5ee66f(0xcb)],0x0);console[_0x5ee66f(0xc2)]({'totalSize':_0xc25ccb,'uploadedSize':_0x5b79f9});if(_0x5b79f9+_0xc25ccb>userFolderMaximumSizeInMB*0x400*0x400)return _0x1db4dd[_0x5ee66f(0xc4)](0x190)[_0x5ee66f(0xc9)]({'error':_0x5ee66f(0xa9)+userFolderMaximumSizeInMB+'\x20MB\x20of\x20files'});_0x39a5aa[_0x5ee66f(0xb2)](_0x5645d3=>{const _0x5a97a4=_0x5ee66f;fs[_0x5a97a4(0xb9)](_0x5645d3[_0x5a97a4(0xbb)],_0x105be9+'/'+_0x5645d3['originalname']);}),_0x1db4dd[_0x5ee66f(0xd3)]({'files':_0x39a5aa[_0x5ee66f(0xb3)](_0x2f0bee=>({..._0x2f0bee,'path':_0x105be9+'/'+_0x2f0bee['originalname']}))});}),router[a8_0x2787b8(0xa7)](a8_0x2787b8(0xad),verifyToken,async(_0x4a97ba,_0x24e1c3)=>{const _0x3aceb6=a8_0x2787b8,{path:_0x209f6d,folder_name:_0x37ea7c}=_0x4a97ba[_0x3aceb6(0xd0)],_0xd5d846=config[_0x3aceb6(0xd4)];console[_0x3aceb6(0xc2)]({'path':_0x209f6d,'folder_name':_0x37ea7c});if(!_0x209f6d)return _0x24e1c3[_0x3aceb6(0xc4)](0x190)[_0x3aceb6(0xc9)]({'error':'Path\x20is\x20required'});if(!_0x37ea7c)return _0x24e1c3[_0x3aceb6(0xc4)](0x190)[_0x3aceb6(0xc9)]({'error':_0x3aceb6(0xd2)});const _0xc6effc=_0x209f6d+'/'+_0x37ea7c;!fs['existsSync'](_0xc6effc)&&fs[_0x3aceb6(0xa4)](_0xc6effc),_0x24e1c3[_0x3aceb6(0xd3)]({'path':_0xc6effc});}),router[a8_0x2787b8(0xcf)]('/remove',verifyToken,async(_0x425044,_0x6edae5)=>{const _0x5ce2cd=a8_0x2787b8,{isFolder:_0xa77148,path:_0x442154}=_0x425044[_0x5ce2cd(0xd0)];!_0xa77148?fs[_0x5ce2cd(0xc7)](_0x442154):fs[_0x5ce2cd(0xd6)](_0x442154,{'recursive':!![]}),_0x6edae5[_0x5ce2cd(0xd3)]({'success':!![]});}),module['exports']=router;