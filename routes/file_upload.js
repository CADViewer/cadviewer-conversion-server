function a8_0x5ce6(){const _0x1bd7a8=['status','Path\x20is\x20required','multer','originalname','crypto','./uploads/','folderLocation','Error!\x20Something\x20went\x20wrong.','\x20MB\x20of\x20files','email','Folder\x20name\x20is\x20required','size','/files','folder_name','promise','/remove','post','httpStatusCode','Please\x20upload\x20a\x20file','reduce','191768WvXSxO','11Dcvyyt','36366NLUBhI','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','user','delete','4498440dYxlUO','266WbckAn','files','length','renameSync','Invalid\x20user','map','body','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','8211RusPsd','1088766mnIDqK','1190JiHKcs','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','../libs/jwt','../CADViewer_config.json','mkdirSync','express','json','forEach','send','path','execute','existsSync','11316290MnJUBR','exports','../libs/mysql.js','readdirSync','Router','verifyToken','./uploads','32SMpmsj','log','2609820CGmNON'];a8_0x5ce6=function(){return _0x1bd7a8;};return a8_0x5ce6();}const a8_0xd30694=a8_0x1d29;(function(_0x1d2bb1,_0x69af0e){const _0x325dd7=a8_0x1d29,_0x5ee1cd=_0x1d2bb1();while(!![]){try{const _0x265df5=parseInt(_0x325dd7(0x141))/0x1*(parseInt(_0x325dd7(0x139))/0x2)+parseInt(_0x325dd7(0x158))/0x3+parseInt(_0x325dd7(0x132))/0x4+-parseInt(_0x325dd7(0x138))/0x5+parseInt(_0x325dd7(0x134))/0x6*(-parseInt(_0x325dd7(0x143))/0x7)+-parseInt(_0x325dd7(0x156))/0x8*(parseInt(_0x325dd7(0x142))/0x9)+parseInt(_0x325dd7(0x14f))/0xa*(parseInt(_0x325dd7(0x133))/0xb);if(_0x265df5===_0x69af0e)break;else _0x5ee1cd['push'](_0x5ee1cd['shift']());}catch(_0x55c80a){_0x5ee1cd['push'](_0x5ee1cd['shift']());}}}(a8_0x5ce6,0xb1a44));const multer=require(a8_0xd30694(0x120)),fs=require('fs'),{randomUUID}=require(a8_0xd30694(0x122)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a8_0xd30694(0x146)),conn=require(a8_0xd30694(0x151)),verifyToken=require(a8_0xd30694(0x145))[a8_0xd30694(0x154)],dir=a8_0xd30694(0x155);function a8_0x1d29(_0x198b5a,_0x2f5253){const _0x5ce66a=a8_0x5ce6();return a8_0x1d29=function(_0x1d2991,_0x3f1429){_0x1d2991=_0x1d2991-0x11f;let _0x157eb6=_0x5ce66a[_0x1d2991];return _0x157eb6;},a8_0x1d29(_0x198b5a,_0x2f5253);}!fs['existsSync'](dir)&&fs[a8_0xd30694(0x147)](dir);const express=require(a8_0xd30694(0x148)),router=express[a8_0xd30694(0x153)](),config=require(a8_0xd30694(0x146)),storage=multer['diskStorage']({'destination':function(_0x1dcd3d,_0x258636,_0x3ff8c2){_0x3ff8c2(null,'uploads');}}),upload=multer({'storage':storage});router[a8_0xd30694(0x12e)](a8_0xd30694(0x12a),upload['array'](a8_0xd30694(0x13a)),verifyToken,async(_0x597157,_0x1a97fa,_0xa5dfa3)=>{const _0x5dba2c=a8_0xd30694,_0x43bcb6=_0x597157[_0x5dba2c(0x13a)],{global:_0x5e9bac,path:_0x4db3bb}=_0x597157['body'],_0x32bc65=config['folderLocation'];console[_0x5dba2c(0x157)]({'global':_0x5e9bac}),console[_0x5dba2c(0x157)](_0x43bcb6),console[_0x5dba2c(0x157)]({'user':_0x597157[_0x5dba2c(0x136)]});if(_0x5e9bac){_0x43bcb6[_0x5dba2c(0x14a)](_0x1c2cc3=>{const _0x2a7584=_0x5dba2c;fs[_0x2a7584(0x13c)](_0x1c2cc3[_0x2a7584(0x14c)],(_0x4db3bb||_0x32bc65)+'/'+_0x1c2cc3[_0x2a7584(0x121)]);}),_0x1a97fa[_0x5dba2c(0x14b)]({'files':_0x43bcb6['map'](_0x45cbfe=>({..._0x45cbfe,'path':(_0x4db3bb||_0x32bc65)+'/'+_0x45cbfe['originalname']}))});return;}let _0x4c414d;try{const [_0x3a781a]=await conn['promise']()['execute'](_0x5dba2c(0x140),[_0x597157[_0x5dba2c(0x136)][_0x5dba2c(0x127)]]);_0x3a781a[_0x5dba2c(0x13b)]>0x0&&(_0x4c414d=_0x3a781a[0x0]);}catch(_0x169b24){console[_0x5dba2c(0x157)]({'err':_0x169b24}),_0x1a97fa['status'](0x1f4)[_0x5dba2c(0x149)]({'error':_0x5dba2c(0x125)});return;}if(!_0x4c414d){_0x1a97fa[_0x5dba2c(0x159)](0x191)[_0x5dba2c(0x149)]({'error':_0x5dba2c(0x13d)});return;}let _0x1590f6=_0x4c414d[_0x5dba2c(0x12b)];if(!_0x1590f6){_0x1590f6=randomUUID();try{await conn[_0x5dba2c(0x12c)]()[_0x5dba2c(0x14d)](_0x5dba2c(0x144),[_0x1590f6,_0x597157['user']['email']]);}catch(_0x50d4e8){console['log']({'err':_0x50d4e8}),_0x1a97fa[_0x5dba2c(0x159)](0x1f4)[_0x5dba2c(0x149)]({'error':_0x5dba2c(0x125)});return;}}const _0x158e52=_0x5dba2c(0x123)+_0x1590f6;!fs[_0x5dba2c(0x14e)](_0x158e52)&&fs[_0x5dba2c(0x147)](_0x158e52);if(!_0x43bcb6){const _0x2b5772=new Error(_0x5dba2c(0x130));return _0x2b5772[_0x5dba2c(0x12f)]=0x190,_0xa5dfa3(_0x2b5772);}const _0x519730=fs['readdirSync'](_0x158e52)[_0x5dba2c(0x13b)]+_0x43bcb6[_0x5dba2c(0x13b)];console[_0x5dba2c(0x157)]({'numberOfSize':_0x519730});if(_0x519730>userFolderMaximumFiles)return _0x1a97fa[_0x5dba2c(0x159)](0x190)['json']({'error':_0x5dba2c(0x135)+userFolderMaximumFiles+'\x20files'});const _0x386128=fs[_0x5dba2c(0x152)](_0x158e52)[_0x5dba2c(0x131)]((_0x4e6ace,_0x32ff27)=>_0x4e6ace+fs['statSync'](_0x158e52+'/'+_0x32ff27)['size'],0x0),_0x2dd4da=_0x43bcb6[_0x5dba2c(0x131)]((_0x5b20fc,_0x2a96eb)=>_0x5b20fc+_0x2a96eb[_0x5dba2c(0x129)],0x0);console[_0x5dba2c(0x157)]({'totalSize':_0x386128,'uploadedSize':_0x2dd4da});if(_0x2dd4da+_0x386128>userFolderMaximumSizeInMB*0x400*0x400)return _0x1a97fa[_0x5dba2c(0x159)](0x190)[_0x5dba2c(0x149)]({'error':_0x5dba2c(0x135)+userFolderMaximumSizeInMB+_0x5dba2c(0x126)});_0x43bcb6['forEach'](_0x133915=>{const _0x1e8e4a=_0x5dba2c;fs[_0x1e8e4a(0x13c)](_0x133915['path'],_0x158e52+'/'+_0x133915[_0x1e8e4a(0x121)]);}),_0x1a97fa[_0x5dba2c(0x14b)]({'files':_0x43bcb6[_0x5dba2c(0x13e)](_0x17ba90=>({..._0x17ba90,'path':_0x158e52+'/'+_0x17ba90[_0x5dba2c(0x121)]}))});}),router[a8_0xd30694(0x12e)]('/folder',verifyToken,async(_0x3a357c,_0x3c404b)=>{const _0x3bb637=a8_0xd30694,{path:_0x480518,folder_name:_0x3bfd51}=_0x3a357c[_0x3bb637(0x13f)],_0x55c78a=config[_0x3bb637(0x124)];console['log']({'path':_0x480518,'folder_name':_0x3bfd51});if(!_0x480518)return _0x3c404b['status'](0x190)[_0x3bb637(0x149)]({'error':_0x3bb637(0x11f)});if(!_0x3bfd51)return _0x3c404b[_0x3bb637(0x159)](0x190)[_0x3bb637(0x149)]({'error':_0x3bb637(0x128)});const _0x2225d5=_0x480518+'/'+_0x3bfd51;!fs['existsSync'](_0x2225d5)&&fs[_0x3bb637(0x147)](_0x2225d5),_0x3c404b[_0x3bb637(0x14b)]({'path':_0x2225d5});}),router[a8_0xd30694(0x137)](a8_0xd30694(0x12d),verifyToken,async(_0x5f785f,_0x3aeab3)=>{const _0x3937f1=a8_0xd30694,{isFolder:_0x4386f2,path:_0x1f8799}=_0x5f785f['body'];!_0x4386f2?fs['unlinkSync'](_0x1f8799):fs['rmdirSync'](_0x1f8799,{'recursive':!![]}),_0x3aeab3[_0x3937f1(0x14b)]({'success':!![]});}),module[a8_0xd30694(0x150)]=router;