function a8_0x33f6(){const _0x1d1223=['express','/remove','16pCtaft','46NejwaV','2863510RsaTBK','existsSync','folderLocation','multer','folder_name','3279033wqivQU','forEach','uploads','statSync','copyFileSync','\x20MB\x20of\x20files','size','43411UAkZAh','send','rmdirSync','106736nRLVlJ','mkdirSync','reduce','/files','files','8596090MxzmuH','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','array','Router','email','../libs/mysql.js','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','Please\x20upload\x20a\x20file','user','originalname','promise','log','map','status','4981140xUlDFu','12ToeXAN','delete','verifyToken','Path\x20is\x20required','Error!\x20Something\x20went\x20wrong.','11dlWBzj','8vCezvZ','readdirSync','execute','exports','./uploads/','./uploads','Folder\x20name\x20is\x20required','path','body','json','crypto','length','336552CrReMJ','unlinkSync'];a8_0x33f6=function(){return _0x1d1223;};return a8_0x33f6();}const a8_0x4ec46c=a8_0x37be;function a8_0x37be(_0x1da78c,_0x4b118f){const _0x33f615=a8_0x33f6();return a8_0x37be=function(_0x37bee5,_0xc856ee){_0x37bee5=_0x37bee5-0x164;let _0x272cb8=_0x33f615[_0x37bee5];return _0x272cb8;},a8_0x37be(_0x1da78c,_0x4b118f);}(function(_0x42bac9,_0x98b340){const _0x5ed1f9=a8_0x37be,_0x457e35=_0x42bac9();while(!![]){try{const _0x1af2de=-parseInt(_0x5ed1f9(0x18d))/0x1*(parseInt(_0x5ed1f9(0x180))/0x2)+parseInt(_0x5ed1f9(0x17b))/0x3+-parseInt(_0x5ed1f9(0x16f))/0x4*(-parseInt(_0x5ed1f9(0x181))/0x5)+parseInt(_0x5ed1f9(0x169))/0x6*(parseInt(_0x5ed1f9(0x190))/0x7)+parseInt(_0x5ed1f9(0x17f))/0x8*(-parseInt(_0x5ed1f9(0x186))/0x9)+parseInt(_0x5ed1f9(0x195))/0xa+-parseInt(_0x5ed1f9(0x16e))/0xb*(-parseInt(_0x5ed1f9(0x168))/0xc);if(_0x1af2de===_0x98b340)break;else _0x457e35['push'](_0x457e35['shift']());}catch(_0x2cbb46){_0x457e35['push'](_0x457e35['shift']());}}}(a8_0x33f6,0xcc04d));const multer=require(a8_0x4ec46c(0x184)),fs=require('fs'),{randomUUID}=require(a8_0x4ec46c(0x179)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require('../CADViewer_config.json'),conn=require(a8_0x4ec46c(0x19a)),verifyToken=require('../libs/jwt')[a8_0x4ec46c(0x16b)],dir=a8_0x4ec46c(0x174);!fs[a8_0x4ec46c(0x182)](dir)&&fs[a8_0x4ec46c(0x191)](dir);const express=require(a8_0x4ec46c(0x17d)),router=express[a8_0x4ec46c(0x198)](),config=require('../CADViewer_config.json'),storage=multer['diskStorage']({'destination':function(_0x64e5b,_0x2c5692,_0x192d75){const _0x2d6cd2=a8_0x4ec46c;_0x192d75(null,_0x2d6cd2(0x188));}}),upload=multer({'storage':storage});router['post'](a8_0x4ec46c(0x193),upload[a8_0x4ec46c(0x197)]('files'),verifyToken,async(_0x4c6ca4,_0x46912f,_0x3d0500)=>{const _0x286d9c=a8_0x4ec46c,_0x2df55a=_0x4c6ca4[_0x286d9c(0x194)],{global:_0x1add78,path:_0x24ef6c}=_0x4c6ca4['body'],_0x56e451=config[_0x286d9c(0x183)];console[_0x286d9c(0x165)]({'global':_0x1add78}),console[_0x286d9c(0x165)](_0x2df55a),console['log']({'user':_0x4c6ca4[_0x286d9c(0x19d)]});if(_0x1add78){_0x2df55a[_0x286d9c(0x187)](_0x5a6e2c=>{const _0x3e7888=_0x286d9c;fs[_0x3e7888(0x18a)](_0x5a6e2c[_0x3e7888(0x176)],(_0x24ef6c||_0x56e451)+'/'+_0x5a6e2c['originalname']),fs[_0x3e7888(0x17c)](_0x5a6e2c[_0x3e7888(0x176)]);}),_0x46912f['send']({'files':_0x2df55a[_0x286d9c(0x166)](_0x31ec6c=>({..._0x31ec6c,'path':(_0x24ef6c||_0x56e451)+'/'+_0x31ec6c[_0x286d9c(0x19e)]}))});return;}let _0x15dd38;try{const [_0x4d13b8]=await conn[_0x286d9c(0x164)]()['execute']('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x4c6ca4['user'][_0x286d9c(0x199)]]);_0x4d13b8[_0x286d9c(0x17a)]>0x0&&(_0x15dd38=_0x4d13b8[0x0]);}catch(_0x29c19d){console[_0x286d9c(0x165)]({'err':_0x29c19d}),_0x46912f[_0x286d9c(0x167)](0x1f4)[_0x286d9c(0x178)]({'error':_0x286d9c(0x16d)});return;}if(!_0x15dd38){_0x46912f['status'](0x191)['json']({'error':'Invalid\x20user'});return;}let _0x599ac7=_0x15dd38[_0x286d9c(0x185)];if(!_0x599ac7){_0x599ac7=randomUUID();try{await conn[_0x286d9c(0x164)]()[_0x286d9c(0x171)](_0x286d9c(0x19b),[_0x599ac7,_0x4c6ca4['user'][_0x286d9c(0x199)]]);}catch(_0x12810c){console['log']({'err':_0x12810c}),_0x46912f[_0x286d9c(0x167)](0x1f4)[_0x286d9c(0x178)]({'error':_0x286d9c(0x16d)});return;}}const _0x507f2e=_0x286d9c(0x173)+_0x599ac7;!fs['existsSync'](_0x507f2e)&&fs[_0x286d9c(0x191)](_0x507f2e);if(!_0x2df55a){const _0x27b4b1=new Error(_0x286d9c(0x19c));return _0x27b4b1['httpStatusCode']=0x190,_0x3d0500(_0x27b4b1);}const _0x520d53=fs[_0x286d9c(0x170)](_0x507f2e)[_0x286d9c(0x17a)]+_0x2df55a[_0x286d9c(0x17a)];console[_0x286d9c(0x165)]({'numberOfSize':_0x520d53});if(_0x520d53>userFolderMaximumFiles)return _0x46912f[_0x286d9c(0x167)](0x190)[_0x286d9c(0x178)]({'error':_0x286d9c(0x196)+userFolderMaximumFiles+'\x20files'});const _0x214879=fs['readdirSync'](_0x507f2e)[_0x286d9c(0x192)]((_0x2c941d,_0x49c7c7)=>_0x2c941d+fs[_0x286d9c(0x189)](_0x507f2e+'/'+_0x49c7c7)[_0x286d9c(0x18c)],0x0),_0x5c117b=_0x2df55a[_0x286d9c(0x192)]((_0x515896,_0x2c6858)=>_0x515896+_0x2c6858[_0x286d9c(0x18c)],0x0);console['log']({'totalSize':_0x214879,'uploadedSize':_0x5c117b});if(_0x5c117b+_0x214879>userFolderMaximumSizeInMB*0x400*0x400)return _0x46912f[_0x286d9c(0x167)](0x190)['json']({'error':_0x286d9c(0x196)+userFolderMaximumSizeInMB+_0x286d9c(0x18b)});_0x2df55a[_0x286d9c(0x187)](_0x248cc3=>{const _0x3dbe0c=_0x286d9c;fs['copyFileSync'](_0x248cc3[_0x3dbe0c(0x176)],_0x507f2e+'/'+_0x248cc3[_0x3dbe0c(0x19e)]),fs[_0x3dbe0c(0x17c)](_0x248cc3[_0x3dbe0c(0x176)]);}),_0x46912f['send']({'files':_0x2df55a[_0x286d9c(0x166)](_0x262eb2=>({..._0x262eb2,'path':_0x507f2e+'/'+_0x262eb2[_0x286d9c(0x19e)]}))});}),router['post']('/folder',verifyToken,async(_0x1cbdab,_0x1b6d3e)=>{const _0xb3fe8b=a8_0x4ec46c,{path:_0x1d9853,folder_name:_0x4ceb51}=_0x1cbdab[_0xb3fe8b(0x177)];console[_0xb3fe8b(0x165)]({'path':_0x1d9853,'folder_name':_0x4ceb51});if(!_0x1d9853)return _0x1b6d3e[_0xb3fe8b(0x167)](0x190)[_0xb3fe8b(0x178)]({'error':_0xb3fe8b(0x16c)});if(!_0x4ceb51)return _0x1b6d3e['status'](0x190)[_0xb3fe8b(0x178)]({'error':_0xb3fe8b(0x175)});const _0x3dc7c5=_0x1d9853+'/'+_0x4ceb51;!fs['existsSync'](_0x3dc7c5)&&fs['mkdirSync'](_0x3dc7c5),_0x1b6d3e[_0xb3fe8b(0x18e)]({'path':_0x3dc7c5});}),router[a8_0x4ec46c(0x16a)](a8_0x4ec46c(0x17e),verifyToken,async(_0x3711cb,_0x1f8a92)=>{const _0x3ef299=a8_0x4ec46c,{isFolder:_0x48bb73,path:_0x457068}=_0x3711cb['body'];!_0x48bb73?fs[_0x3ef299(0x17c)](_0x457068):fs[_0x3ef299(0x18f)](_0x457068,{'recursive':!![]}),_0x1f8a92[_0x3ef299(0x18e)]({'success':!![]});}),module[a8_0x4ec46c(0x172)]=router;