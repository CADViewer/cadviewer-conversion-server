const a2_0x4b3e04=a2_0x497b;function a2_0x497b(_0x510696,_0x39ac77){const _0x530e63=a2_0x530e();return a2_0x497b=function(_0x497bdf,_0x4a7f5f){_0x497bdf=_0x497bdf-0xc9;let _0x314ba1=_0x530e63[_0x497bdf];return _0x314ba1;},a2_0x497b(_0x510696,_0x39ac77);}function a2_0x530e(){const _0x452429=['21018dwGNTp','2380ikFnbv','Invalid\x20token','json','707739jTGyxg','authorization','user','headers','exports','1582PPLmya','27LrLlSK','status','verify','split','3903790nMNaPd','125Angfkq','8426584HUipro','492GizJDr','68708QEXbLR','jwtSecretKey','712657EDdeAV','1033kwzmxE','../CADViewer_config.json'];a2_0x530e=function(){return _0x452429;};return a2_0x530e();}(function(_0x39d798,_0x397169){const _0x26d8d5=a2_0x497b,_0x5ad81a=_0x39d798();while(!![]){try{const _0x2197ad=parseInt(_0x26d8d5(0xd0))/0x1*(parseInt(_0x26d8d5(0xd3))/0x2)+parseInt(_0x26d8d5(0xd6))/0x3+parseInt(_0x26d8d5(0xcd))/0x4*(parseInt(_0x26d8d5(0xca))/0x5)+-parseInt(_0x26d8d5(0xd2))/0x6*(parseInt(_0x26d8d5(0xdb))/0x7)+parseInt(_0x26d8d5(0xcb))/0x8+-parseInt(_0x26d8d5(0xdc))/0x9*(-parseInt(_0x26d8d5(0xc9))/0xa)+parseInt(_0x26d8d5(0xcf))/0xb*(-parseInt(_0x26d8d5(0xcc))/0xc);if(_0x2197ad===_0x397169)break;else _0x5ad81a['push'](_0x5ad81a['shift']());}catch(_0x2dc0f2){_0x5ad81a['push'](_0x5ad81a['shift']());}}}(a2_0x530e,0xa3d93));const jwt=require('jsonwebtoken'),config=require(a2_0x4b3e04(0xd1)),verifyToken=(_0x323e5f,_0x5cd1bd,_0x4fa1e1)=>{const _0x2b8bd8=a2_0x4b3e04,_0x549dda=_0x323e5f[_0x2b8bd8(0xd9)][_0x2b8bd8(0xd7)],_0x32496d=_0x549dda&&_0x549dda[_0x2b8bd8(0xdf)]('\x20')[0x1];if(!_0x32496d)return _0x5cd1bd[_0x2b8bd8(0xdd)](0x191)[_0x2b8bd8(0xd5)]({'error':'Access\x20denied.\x20No\x20token\x20provided'});try{const _0x384819=jwt[_0x2b8bd8(0xde)](_0x32496d,config['jwtSecretKey']);_0x323e5f[_0x2b8bd8(0xd8)]=_0x384819,_0x4fa1e1();}catch(_0x48df89){_0x5cd1bd['status'](0x190)['json']({'error':_0x2b8bd8(0xd4)});}},verifyTokenOptional=(_0xd2c5cf,_0x120ebc,_0x347d59)=>{const _0x3d8ee1=a2_0x4b3e04,_0x5793b5=_0xd2c5cf[_0x3d8ee1(0xd9)][_0x3d8ee1(0xd7)],_0x5808f3=_0x5793b5&&_0x5793b5['split']('\x20')[0x1];if(!_0x5808f3){_0x347d59();return;}try{const _0x3d102b=jwt[_0x3d8ee1(0xde)](_0x5808f3,config[_0x3d8ee1(0xce)]);_0xd2c5cf[_0x3d8ee1(0xd8)]=_0x3d102b,_0x347d59();}catch(_0x5aa182){_0x120ebc[_0x3d8ee1(0xdd)](0x190)[_0x3d8ee1(0xd5)]({'error':'Invalid\x20token'});}};module[a2_0x4b3e04(0xda)]={'verifyToken':verifyToken,'verifyTokenOptional':verifyTokenOptional};