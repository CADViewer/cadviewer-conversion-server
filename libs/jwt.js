function a2_0x1966(){const _0x2d978e=['status','2976705NZDJAO','headers','../CADViewer_config.json','7122QFJWFf','authorization','262346jsuufh','Access\x20denied.\x20No\x20token\x20provided','Invalid\x20token','jwtSecretKey','2560424WPDujN','verify','user','4501Kcfrts','2XumFNE','exports','split','881298IIFNVh','json','3183732Wxafsc','1705794PSYTYm'];a2_0x1966=function(){return _0x2d978e;};return a2_0x1966();}const a2_0x2fdb23=a2_0x312f;function a2_0x312f(_0x598ea6,_0x59391f){const _0x1966d1=a2_0x1966();return a2_0x312f=function(_0x312ff9,_0x5f03af){_0x312ff9=_0x312ff9-0xd6;let _0x36db39=_0x1966d1[_0x312ff9];return _0x36db39;},a2_0x312f(_0x598ea6,_0x59391f);}(function(_0x5e2b89,_0x2afddc){const _0x51d5c4=a2_0x312f,_0x2552df=_0x5e2b89();while(!![]){try{const _0x1164cf=parseInt(_0x51d5c4(0xe2))/0x1+parseInt(_0x51d5c4(0xea))/0x2*(parseInt(_0x51d5c4(0xdb))/0x3)+-parseInt(_0x51d5c4(0xda))/0x4+-parseInt(_0x51d5c4(0xdd))/0x5+-parseInt(_0x51d5c4(0xe0))/0x6*(-parseInt(_0x51d5c4(0xe9))/0x7)+parseInt(_0x51d5c4(0xe6))/0x8+-parseInt(_0x51d5c4(0xd8))/0x9;if(_0x1164cf===_0x2afddc)break;else _0x2552df['push'](_0x2552df['shift']());}catch(_0x935aa){_0x2552df['push'](_0x2552df['shift']());}}}(a2_0x1966,0x67c52));const jwt=require('jsonwebtoken'),config=require(a2_0x2fdb23(0xdf)),verifyToken=(_0x364993,_0x356276,_0x4e3be6)=>{const _0x2af1e2=a2_0x2fdb23,_0x2fd640=_0x364993[_0x2af1e2(0xde)][_0x2af1e2(0xe1)],_0x132e41=_0x2fd640&&_0x2fd640[_0x2af1e2(0xd7)]('\x20')[0x1];if(!_0x132e41)return _0x356276[_0x2af1e2(0xdc)](0x191)[_0x2af1e2(0xd9)]({'error':_0x2af1e2(0xe3)});try{const _0x216d88=jwt[_0x2af1e2(0xe7)](_0x132e41,config[_0x2af1e2(0xe5)]);_0x364993[_0x2af1e2(0xe8)]=_0x216d88,_0x4e3be6();}catch(_0x260be8){_0x356276[_0x2af1e2(0xdc)](0x190)[_0x2af1e2(0xd9)]({'error':_0x2af1e2(0xe4)});}},verifyTokenOptional=(_0x3cfd57,_0x11fe51,_0x50b1ba)=>{const _0x5fbe1=a2_0x2fdb23,_0x50c34f=_0x3cfd57[_0x5fbe1(0xde)][_0x5fbe1(0xe1)],_0x5059f5=_0x50c34f&&_0x50c34f[_0x5fbe1(0xd7)]('\x20')[0x1];if(!_0x5059f5){_0x50b1ba();return;}try{const _0x468809=jwt[_0x5fbe1(0xe7)](_0x5059f5,config[_0x5fbe1(0xe5)]);_0x3cfd57['user']=_0x468809,_0x50b1ba();}catch(_0x5d1987){_0x11fe51[_0x5fbe1(0xdc)](0x190)[_0x5fbe1(0xd9)]({'error':_0x5fbe1(0xe4)});}};module[a2_0x2fdb23(0xd6)]={'verifyToken':verifyToken,'verifyTokenOptional':verifyTokenOptional};