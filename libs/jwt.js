function a2_0x2110(){const _0x2339e5=['4708955VmsPcR','authorization','Invalid\x20token','Access\x20denied.\x20No\x20token\x20provided','split','exports','88uRROIN','verify','13NtFraY','1325227RaQYuz','headers','json','2730hJkJNY','35pEGlbp','456XSmUpb','status','user','15532FzycgC','6nyihSW','1191386UhPQue','2Mawfhr','903684wOknAC','963592pgcNxC','jsonwebtoken','../CADViewer_config.json','21447UkJZaK'];a2_0x2110=function(){return _0x2339e5;};return a2_0x2110();}const a2_0x2b31f4=a2_0x52c2;(function(_0x12f285,_0xdbf7b8){const _0x33808f=a2_0x52c2,_0x1f75d6=_0x12f285();while(!![]){try{const _0x236e49=-parseInt(_0x33808f(0x84))/0x1*(parseInt(_0x33808f(0x8f))/0x2)+parseInt(_0x33808f(0x89))/0x3*(parseInt(_0x33808f(0x8c))/0x4)+-parseInt(_0x33808f(0x95))/0x5*(-parseInt(_0x33808f(0x8d))/0x6)+parseInt(_0x33808f(0x88))/0x7*(parseInt(_0x33808f(0x91))/0x8)+-parseInt(_0x33808f(0x94))/0x9*(parseInt(_0x33808f(0x87))/0xa)+-parseInt(_0x33808f(0x81))/0xb*(-parseInt(_0x33808f(0x90))/0xc)+-parseInt(_0x33808f(0x83))/0xd*(-parseInt(_0x33808f(0x8e))/0xe);if(_0x236e49===_0xdbf7b8)break;else _0x1f75d6['push'](_0x1f75d6['shift']());}catch(_0x170cab){_0x1f75d6['push'](_0x1f75d6['shift']());}}}(a2_0x2110,0xce8c5));function a2_0x52c2(_0x3912e9,_0x4f48f4){const _0x211017=a2_0x2110();return a2_0x52c2=function(_0x52c2a4,_0x3ee5a8){_0x52c2a4=_0x52c2a4-0x7e;let _0x112c5c=_0x211017[_0x52c2a4];return _0x112c5c;},a2_0x52c2(_0x3912e9,_0x4f48f4);}const jwt=require(a2_0x2b31f4(0x92)),config=require(a2_0x2b31f4(0x93)),verifyToken=(_0x2ec623,_0x23bd41,_0xf7bc21)=>{const _0x1329aa=a2_0x2b31f4,_0x5da6ee=_0x2ec623[_0x1329aa(0x85)]['authorization'],_0x49b6f6=_0x5da6ee&&_0x5da6ee[_0x1329aa(0x7f)]('\x20')[0x1];if(!_0x49b6f6)return _0x23bd41[_0x1329aa(0x8a)](0x191)[_0x1329aa(0x86)]({'error':_0x1329aa(0x7e)});try{const _0x16d0c2=jwt[_0x1329aa(0x82)](_0x49b6f6,config['jwtSecretKey']);_0x2ec623['user']=_0x16d0c2,_0xf7bc21();}catch(_0x2996ba){_0x23bd41['status'](0x190)[_0x1329aa(0x86)]({'error':'Invalid\x20token'});}},verifyTokenOptional=(_0x445fca,_0x15f59a,_0x206c21)=>{const _0x52e12b=a2_0x2b31f4,_0x4a7d13=_0x445fca[_0x52e12b(0x85)][_0x52e12b(0x96)],_0x5d681d=_0x4a7d13&&_0x4a7d13['split']('\x20')[0x1];if(!_0x5d681d){_0x206c21();return;}try{const _0x131f48=jwt[_0x52e12b(0x82)](_0x5d681d,config['jwtSecretKey']);_0x445fca[_0x52e12b(0x8b)]=_0x131f48,_0x206c21();}catch(_0x304796){_0x15f59a[_0x52e12b(0x8a)](0x190)[_0x52e12b(0x86)]({'error':_0x52e12b(0x97)});}};module[a2_0x2b31f4(0x80)]={'verifyToken':verifyToken,'verifyTokenOptional':verifyTokenOptional};