const a2_0x6d241c=a2_0x1ea9;function a2_0x29e6(){const _0x295941=['1530DqgIRo','3445945xnCARB','jwtSecretKey','233851HkvxSQ','Invalid\x20token','exports','22240rAZTMs','../CADViewer_config.json','2009VmrgtF','6sjHDKv','status','jsonwebtoken','split','1156611JqMRqm','5175546vobjta','42381fGqZav','json','18327760ZqfTPR','Access\x20denied.\x20No\x20token\x20provided','headers','verify','4BXHvrc'];a2_0x29e6=function(){return _0x295941;};return a2_0x29e6();}function a2_0x1ea9(_0x48b8eb,_0x1412be){const _0x29e6fc=a2_0x29e6();return a2_0x1ea9=function(_0x1ea957,_0x4e2f19){_0x1ea957=_0x1ea957-0x11a;let _0xaa3575=_0x29e6fc[_0x1ea957];return _0xaa3575;},a2_0x1ea9(_0x48b8eb,_0x1412be);}(function(_0x370c93,_0x3da804){const _0x18d2d1=a2_0x1ea9,_0x328fce=_0x370c93();while(!![]){try{const _0x38e070=-parseInt(_0x18d2d1(0x121))/0x1*(parseInt(_0x18d2d1(0x127))/0x2)+parseInt(_0x18d2d1(0x12b))/0x3*(-parseInt(_0x18d2d1(0x11d))/0x4)+parseInt(_0x18d2d1(0x11f))/0x5+-parseInt(_0x18d2d1(0x12c))/0x6+parseInt(_0x18d2d1(0x126))/0x7*(parseInt(_0x18d2d1(0x124))/0x8)+parseInt(_0x18d2d1(0x12d))/0x9*(-parseInt(_0x18d2d1(0x11e))/0xa)+parseInt(_0x18d2d1(0x12f))/0xb;if(_0x38e070===_0x3da804)break;else _0x328fce['push'](_0x328fce['shift']());}catch(_0x41cc67){_0x328fce['push'](_0x328fce['shift']());}}}(a2_0x29e6,0x75eeb));const jwt=require(a2_0x6d241c(0x129)),config=require(a2_0x6d241c(0x125)),verifyToken=(_0x20b54a,_0x175eed,_0x2ee4f8)=>{const _0x22a867=a2_0x6d241c,_0x27a45c=_0x20b54a[_0x22a867(0x11b)]['authorization'],_0x574cd8=_0x27a45c&&_0x27a45c['split']('\x20')[0x1];if(!_0x574cd8)return _0x175eed[_0x22a867(0x128)](0x191)[_0x22a867(0x12e)]({'error':_0x22a867(0x11a)});try{const _0x4c382a=jwt[_0x22a867(0x11c)](_0x574cd8,config[_0x22a867(0x120)]);_0x20b54a['user']=_0x4c382a,_0x2ee4f8();}catch(_0x54ddb4){_0x175eed[_0x22a867(0x128)](0x190)[_0x22a867(0x12e)]({'error':_0x22a867(0x122)});}},verifyTokenOptional=(_0x412a05,_0x3bbd13,_0x5a9a58)=>{const _0x1b941d=a2_0x6d241c,_0x4d0d94=_0x412a05[_0x1b941d(0x11b)]['authorization'],_0x22cc58=_0x4d0d94&&_0x4d0d94[_0x1b941d(0x12a)]('\x20')[0x1];if(!_0x22cc58){_0x5a9a58();return;}try{const _0x49b629=jwt[_0x1b941d(0x11c)](_0x22cc58,config[_0x1b941d(0x120)]);_0x412a05['user']=_0x49b629,_0x5a9a58();}catch(_0x3dd494){_0x3bbd13[_0x1b941d(0x128)](0x190)['json']({'error':_0x1b941d(0x122)});}};module[a2_0x6d241c(0x123)]={'verifyToken':verifyToken,'verifyTokenOptional':verifyTokenOptional};