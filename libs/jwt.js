const a2_0x4afb0a=a2_0x4e1c;function a2_0x4e1c(_0x5e2b01,_0x53332e){const _0x5a4def=a2_0x5a4d();return a2_0x4e1c=function(_0x4e1cab,_0x315df7){_0x4e1cab=_0x4e1cab-0xa6;let _0x3fc35b=_0x5a4def[_0x4e1cab];return _0x3fc35b;},a2_0x4e1c(_0x5e2b01,_0x53332e);}(function(_0x32a0cc,_0xde6530){const _0x14dca3=a2_0x4e1c,_0x27cd97=_0x32a0cc();while(!![]){try{const _0x177ad0=-parseInt(_0x14dca3(0xad))/0x1+parseInt(_0x14dca3(0xb5))/0x2+parseInt(_0x14dca3(0xa6))/0x3+parseInt(_0x14dca3(0xb8))/0x4*(-parseInt(_0x14dca3(0xb1))/0x5)+-parseInt(_0x14dca3(0xa9))/0x6*(-parseInt(_0x14dca3(0xb4))/0x7)+-parseInt(_0x14dca3(0xae))/0x8+-parseInt(_0x14dca3(0xb3))/0x9;if(_0x177ad0===_0xde6530)break;else _0x27cd97['push'](_0x27cd97['shift']());}catch(_0x4c5efc){_0x27cd97['push'](_0x27cd97['shift']());}}}(a2_0x5a4d,0xbf2a3));function a2_0x5a4d(){const _0x169ee4=['18524aTtKzp','user','2824503nbATzu','verify','status','6lEKlAt','exports','split','json','653351FYDfCP','7222856ZouVqc','Access\x20denied.\x20No\x20token\x20provided','jsonwebtoken','460dPdFgp','jwtSecretKey','448416RoyJpI','10611335uAzVgh','715378zYtnMs','authorization','Invalid\x20token'];a2_0x5a4d=function(){return _0x169ee4;};return a2_0x5a4d();}const jwt=require(a2_0x4afb0a(0xb0)),config=require('../CADViewer_config.json'),verifyToken=(_0x5a0de9,_0x459802,_0x1b6cf3)=>{const _0x423262=a2_0x4afb0a,_0xc84da7=_0x5a0de9['headers'][_0x423262(0xb6)],_0xc55270=_0xc84da7&&_0xc84da7[_0x423262(0xab)]('\x20')[0x1];if(!_0xc55270)return _0x459802[_0x423262(0xa8)](0x191)[_0x423262(0xac)]({'error':_0x423262(0xaf)});try{const _0x2cfc8e=jwt[_0x423262(0xa7)](_0xc55270,config['jwtSecretKey']);_0x5a0de9[_0x423262(0xb9)]=_0x2cfc8e,_0x1b6cf3();}catch(_0x17d385){_0x459802[_0x423262(0xa8)](0x190)[_0x423262(0xac)]({'error':'Invalid\x20token'});}},verifyTokenOptional=(_0xf1bf3c,_0x5cb334,_0x6b94de)=>{const _0x232480=a2_0x4afb0a,_0x47b28a=_0xf1bf3c['headers'][_0x232480(0xb6)],_0x2574ca=_0x47b28a&&_0x47b28a[_0x232480(0xab)]('\x20')[0x1];if(!_0x2574ca){_0x6b94de();return;}try{const _0xf34f79=jwt[_0x232480(0xa7)](_0x2574ca,config[_0x232480(0xb2)]);_0xf1bf3c[_0x232480(0xb9)]=_0xf34f79,_0x6b94de();}catch(_0x433641){_0x5cb334[_0x232480(0xa8)](0x190)[_0x232480(0xac)]({'error':_0x232480(0xb7)});}};module[a2_0x4afb0a(0xaa)]={'verifyToken':verifyToken,'verifyTokenOptional':verifyTokenOptional};