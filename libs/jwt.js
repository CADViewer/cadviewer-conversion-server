const a4_0x4e9251=a4_0x3376;function a4_0x3376(_0x1a2d56,_0x3ce5e9){const _0x1fce4d=a4_0x1fce();return a4_0x3376=function(_0x3376fd,_0x4012eb){_0x3376fd=_0x3376fd-0xf9;let _0x3f3d8f=_0x1fce4d[_0x3376fd];return _0x3f3d8f;},a4_0x3376(_0x1a2d56,_0x3ce5e9);}(function(_0x5a4c65,_0x44f2f9){const _0x5b0896=a4_0x3376,_0x18da1c=_0x5a4c65();while(!![]){try{const _0x21bcbf=parseInt(_0x5b0896(0x10c))/0x1+-parseInt(_0x5b0896(0xfd))/0x2*(parseInt(_0x5b0896(0x107))/0x3)+parseInt(_0x5b0896(0x106))/0x4+parseInt(_0x5b0896(0x10a))/0x5+-parseInt(_0x5b0896(0x105))/0x6*(-parseInt(_0x5b0896(0x104))/0x7)+-parseInt(_0x5b0896(0xfe))/0x8+-parseInt(_0x5b0896(0xfb))/0x9*(-parseInt(_0x5b0896(0x109))/0xa);if(_0x21bcbf===_0x44f2f9)break;else _0x18da1c['push'](_0x18da1c['shift']());}catch(_0x192cd9){_0x18da1c['push'](_0x18da1c['shift']());}}}(a4_0x1fce,0x4ac6d));const jwt=require(a4_0x4e9251(0x10b)),config=require(a4_0x4e9251(0x10d)),verifyToken=(_0x164069,_0x394202,_0x1d4a66)=>{const _0x5a7af5=a4_0x4e9251,_0x5028fc=_0x164069['headers'][_0x5a7af5(0x103)],_0xce36c9=_0x5028fc&&_0x5028fc[_0x5a7af5(0x108)]('\x20')[0x1];if(!_0xce36c9)return _0x394202[_0x5a7af5(0xfc)](0x191)[_0x5a7af5(0x101)]({'error':_0x5a7af5(0x102)});try{const _0xc71a50=jwt[_0x5a7af5(0xff)](_0xce36c9,config[_0x5a7af5(0xfa)]);_0x164069[_0x5a7af5(0x100)]=_0xc71a50,_0x1d4a66();}catch(_0x1d0556){_0x394202[_0x5a7af5(0xfc)](0x190)['json']({'error':_0x5a7af5(0x10e)});}},verifyTokenOptional=(_0x1e95a7,_0x2eb8e2,_0x287aff)=>{const _0x2eb794=a4_0x4e9251,_0x309155=_0x1e95a7[_0x2eb794(0xf9)][_0x2eb794(0x103)],_0x5234c6=_0x309155&&_0x309155['split']('\x20')[0x1];if(!_0x5234c6){_0x287aff();return;}try{const _0x17775c=jwt['verify'](_0x5234c6,config[_0x2eb794(0xfa)]);_0x1e95a7[_0x2eb794(0x100)]=_0x17775c,_0x287aff();}catch(_0x3115aa){_0x2eb8e2[_0x2eb794(0xfc)](0x190)[_0x2eb794(0x101)]({'error':_0x2eb794(0x10e)});}};function a4_0x1fce(){const _0x3bcd2c=['247972WdDQlt','3KYJcjl','split','1144670tyIavZ','1110970XDkZpQ','jsonwebtoken','95994WVQAUA','../CADViewer_config.json','Invalid\x20token','headers','jwtSecretKey','45AgoonQ','status','899018KDIEFQ','3767792piWgIO','verify','user','json','Access\x20denied.\x20No\x20token\x20provided','authorization','7588ERYkXF','1518JQAEhd'];a4_0x1fce=function(){return _0x3bcd2c;};return a4_0x1fce();}module['exports']={'verifyToken':verifyToken,'verifyTokenOptional':verifyTokenOptional};