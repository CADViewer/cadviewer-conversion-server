const a2_0x45d96e=a2_0x4fd3;function a2_0x4fd3(_0x6aa82a,_0x57ffb4){const _0x40f832=a2_0x40f8();return a2_0x4fd3=function(_0x4fd393,_0x501a94){_0x4fd393=_0x4fd393-0xe4;let _0x35c42a=_0x40f832[_0x4fd393];return _0x35c42a;},a2_0x4fd3(_0x6aa82a,_0x57ffb4);}(function(_0x51f407,_0x2a28fa){const _0x234558=a2_0x4fd3,_0x41c66a=_0x51f407();while(!![]){try{const _0x489108=parseInt(_0x234558(0xf4))/0x1+-parseInt(_0x234558(0xeb))/0x2*(parseInt(_0x234558(0xf7))/0x3)+parseInt(_0x234558(0xe9))/0x4+parseInt(_0x234558(0xe4))/0x5*(-parseInt(_0x234558(0xe6))/0x6)+parseInt(_0x234558(0xf5))/0x7*(-parseInt(_0x234558(0xed))/0x8)+-parseInt(_0x234558(0xf1))/0x9+parseInt(_0x234558(0xf0))/0xa;if(_0x489108===_0x2a28fa)break;else _0x41c66a['push'](_0x41c66a['shift']());}catch(_0x24fdac){_0x41c66a['push'](_0x41c66a['shift']());}}}(a2_0x40f8,0x77f20));const jwt=require('jsonwebtoken'),config=require('../CADViewer_config.json'),verifyToken=(_0x34a473,_0x4207dd,_0x4225df)=>{const _0x5b6ccd=a2_0x4fd3,_0x3631a4=_0x34a473[_0x5b6ccd(0xe8)][_0x5b6ccd(0xee)],_0x158fad=_0x3631a4&&_0x3631a4[_0x5b6ccd(0xe7)]('\x20')[0x1];if(!_0x158fad)return _0x4207dd[_0x5b6ccd(0xef)](0x191)[_0x5b6ccd(0xf3)]({'error':'Access\x20denied.\x20No\x20token\x20provided'});try{const _0x338fb8=jwt[_0x5b6ccd(0xf6)](_0x158fad,config['jwtSecretKey']);_0x34a473[_0x5b6ccd(0xea)]=_0x338fb8,_0x4225df();}catch(_0x1f91b7){_0x4207dd['status'](0x190)['json']({'error':_0x5b6ccd(0xf2)});}},verifyTokenOptional=(_0x2014dd,_0x541a0e,_0x954942)=>{const _0x155b85=a2_0x4fd3,_0x1a5dc8=_0x2014dd[_0x155b85(0xe8)]['authorization'],_0x1b005e=_0x1a5dc8&&_0x1a5dc8[_0x155b85(0xe7)]('\x20')[0x1];if(!_0x1b005e){_0x954942();return;}try{const _0x4f5a54=jwt[_0x155b85(0xf6)](_0x1b005e,config[_0x155b85(0xec)]);_0x2014dd[_0x155b85(0xea)]=_0x4f5a54,_0x954942();}catch(_0x4e6b94){_0x541a0e['status'](0x190)[_0x155b85(0xf3)]({'error':_0x155b85(0xf2)});}};function a2_0x40f8(){const _0x4108c6=['jwtSecretKey','2635264MPyvIW','authorization','status','16306570VHHAbT','1262088zklboK','Invalid\x20token','json','343793OytVSt','7FMGrPC','verify','15EYZIYr','4276865rVprhu','exports','6JggiqN','split','headers','2202056bGvZZm','user','283462jFWRIC'];a2_0x40f8=function(){return _0x4108c6;};return a2_0x40f8();}module[a2_0x45d96e(0xe5)]={'verifyToken':verifyToken,'verifyTokenOptional':verifyTokenOptional};