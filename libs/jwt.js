function a2_0x3ce9(_0x24bf46,_0x3f7347){const _0x9fabc6=a2_0x9fab();return a2_0x3ce9=function(_0x3ce926,_0x10e725){_0x3ce926=_0x3ce926-0x7f;let _0x5afd63=_0x9fabc6[_0x3ce926];return _0x5afd63;},a2_0x3ce9(_0x24bf46,_0x3f7347);}const a2_0x51bc00=a2_0x3ce9;(function(_0x52f4a9,_0x3091cb){const _0xd3b2ef=a2_0x3ce9,_0x3c2c45=_0x52f4a9();while(!![]){try{const _0x325b64=parseInt(_0xd3b2ef(0x90))/0x1*(parseInt(_0xd3b2ef(0x81))/0x2)+parseInt(_0xd3b2ef(0x8f))/0x3*(-parseInt(_0xd3b2ef(0x91))/0x4)+parseInt(_0xd3b2ef(0x8d))/0x5+-parseInt(_0xd3b2ef(0x8b))/0x6+parseInt(_0xd3b2ef(0x85))/0x7+parseInt(_0xd3b2ef(0x88))/0x8+-parseInt(_0xd3b2ef(0x80))/0x9;if(_0x325b64===_0x3091cb)break;else _0x3c2c45['push'](_0x3c2c45['shift']());}catch(_0x46ff40){_0x3c2c45['push'](_0x3c2c45['shift']());}}}(a2_0x9fab,0xa9937));function a2_0x9fab(){const _0x1a13a2=['2236530gjIess','split','4872765cdJyKc','authorization','10719Eihqrt','1yshMIy','428RfIRPi','headers','../CADViewer_config.json','9042912yrgbov','136516HZTOfq','status','json','verify','8885835TTwkFc','user','Access\x20denied.\x20No\x20token\x20provided','1137608vrvAWK','jwtSecretKey','Invalid\x20token'];a2_0x9fab=function(){return _0x1a13a2;};return a2_0x9fab();}const jwt=require('jsonwebtoken'),config=require(a2_0x51bc00(0x7f)),verifyToken=(_0x205e2c,_0x1578c4,_0x2ebca7)=>{const _0x432af6=a2_0x51bc00,_0x18f36b=_0x205e2c[_0x432af6(0x92)][_0x432af6(0x8e)],_0x310bf6=_0x18f36b&&_0x18f36b[_0x432af6(0x8c)]('\x20')[0x1];if(!_0x310bf6)return _0x1578c4['status'](0x191)[_0x432af6(0x83)]({'error':_0x432af6(0x87)});try{const _0x5f37b5=jwt['verify'](_0x310bf6,config[_0x432af6(0x89)]);_0x205e2c['user']=_0x5f37b5,_0x2ebca7();}catch(_0x536c58){_0x1578c4[_0x432af6(0x82)](0x190)[_0x432af6(0x83)]({'error':_0x432af6(0x8a)});}},verifyTokenOptional=(_0x577e8c,_0x1df27c,_0x5c2f80)=>{const _0x3cdfd1=a2_0x51bc00,_0xade33b=_0x577e8c['headers'][_0x3cdfd1(0x8e)],_0x3dc2c8=_0xade33b&&_0xade33b[_0x3cdfd1(0x8c)]('\x20')[0x1];if(!_0x3dc2c8){_0x5c2f80();return;}try{const _0x117269=jwt[_0x3cdfd1(0x84)](_0x3dc2c8,config[_0x3cdfd1(0x89)]);_0x577e8c[_0x3cdfd1(0x86)]=_0x117269,_0x5c2f80();}catch(_0x259a0d){_0x1df27c[_0x3cdfd1(0x82)](0x190)[_0x3cdfd1(0x83)]({'error':'Invalid\x20token'});}};module['exports']={'verifyToken':verifyToken,'verifyTokenOptional':verifyTokenOptional};