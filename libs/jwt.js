const a3_0x22219e=a3_0x3ce1;function a3_0x3ce1(_0x2870f5,_0x1ac3c8){const _0x569296=a3_0x5692();return a3_0x3ce1=function(_0x3ce1d8,_0x1b7721){_0x3ce1d8=_0x3ce1d8-0x1e2;let _0x1f35d9=_0x569296[_0x3ce1d8];return _0x1f35d9;},a3_0x3ce1(_0x2870f5,_0x1ac3c8);}(function(_0xf9917d,_0x550d49){const _0x4b5645=a3_0x3ce1,_0xdaa098=_0xf9917d();while(!![]){try{const _0x1ce478=parseInt(_0x4b5645(0x1f1))/0x1*(parseInt(_0x4b5645(0x1f0))/0x2)+parseInt(_0x4b5645(0x1e6))/0x3+-parseInt(_0x4b5645(0x1e9))/0x4+-parseInt(_0x4b5645(0x1f6))/0x5*(-parseInt(_0x4b5645(0x1e8))/0x6)+parseInt(_0x4b5645(0x1f3))/0x7*(-parseInt(_0x4b5645(0x1ed))/0x8)+-parseInt(_0x4b5645(0x1e3))/0x9+-parseInt(_0x4b5645(0x1f4))/0xa*(-parseInt(_0x4b5645(0x1ef))/0xb);if(_0x1ce478===_0x550d49)break;else _0xdaa098['push'](_0xdaa098['shift']());}catch(_0x1586a4){_0xdaa098['push'](_0xdaa098['shift']());}}}(a3_0x5692,0x99845));const jwt=require(a3_0x22219e(0x1e2)),config=require('../CADViewer_config.json'),verifyToken=(_0x2ba01b,_0x20dd5e,_0xa8ef89)=>{const _0x4c8d2d=a3_0x22219e,_0x24b7b8=_0x2ba01b[_0x4c8d2d(0x1ea)]['authorization'],_0x37b3f7=_0x24b7b8&&_0x24b7b8['split']('\x20')[0x1];if(!_0x37b3f7)return _0x20dd5e[_0x4c8d2d(0x1eb)](0x191)[_0x4c8d2d(0x1f2)]({'error':_0x4c8d2d(0x1e5)});try{const _0x33b117=jwt[_0x4c8d2d(0x1e4)](_0x37b3f7,config['jwtSecretKey']);_0x2ba01b['user']=_0x33b117,_0xa8ef89();}catch(_0x41ce35){_0x20dd5e[_0x4c8d2d(0x1eb)](0x190)['json']({'error':'Invalid\x20token'});}},verifyTokenOptional=(_0x2e833e,_0xbf93da,_0x3111c1)=>{const _0x468337=a3_0x22219e,_0x17f265=_0x2e833e['headers']['authorization'],_0x2f9ca0=_0x17f265&&_0x17f265[_0x468337(0x1f5)]('\x20')[0x1];if(!_0x2f9ca0){_0x3111c1();return;}try{const _0xddc9d0=jwt[_0x468337(0x1e4)](_0x2f9ca0,config[_0x468337(0x1ec)]);_0x2e833e[_0x468337(0x1e7)]=_0xddc9d0,_0x3111c1();}catch(_0x13fe32){_0xbf93da[_0x468337(0x1eb)](0x190)[_0x468337(0x1f2)]({'error':_0x468337(0x1f7)});}};function a3_0x5692(){const _0x175dad=['9700947gtpuQc','verify','Access\x20denied.\x20No\x20token\x20provided','2450109qOVeYQ','user','24nzOIsw','2873588tsUWvM','headers','status','jwtSecretKey','3380560okPDrX','exports','10067926oINKRH','289626AHHXGj','6WbMeAs','json','7JokxhB','10waIzUW','split','308510nCsfYy','Invalid\x20token','jsonwebtoken'];a3_0x5692=function(){return _0x175dad;};return a3_0x5692();}module[a3_0x22219e(0x1ee)]={'verifyToken':verifyToken,'verifyTokenOptional':verifyTokenOptional};