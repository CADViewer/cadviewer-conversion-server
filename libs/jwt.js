const a2_0x513d8c=a2_0x26e4;function a2_0x3c43(){const _0x5a9288=['741256ySTQaj','604108lFEuJH','authorization','48598QTxbtU','jwtSecretKey','json','110856dLasse','6rnyiOg','Access\x20denied.\x20No\x20token\x20provided','../CADViewer_config.json','7UXtvZo','1809450fsIkQu','60tagAZA','split','Invalid\x20token','headers','1608LrxFUf','4137666ryJyVY','369EbLiAC','verify','user','exports','100460kTZiQP','status'];a2_0x3c43=function(){return _0x5a9288;};return a2_0x3c43();}function a2_0x26e4(_0x1fc25c,_0x377394){const _0x3c4375=a2_0x3c43();return a2_0x26e4=function(_0x26e4f0,_0x4f354a){_0x26e4f0=_0x26e4f0-0x6b;let _0x23272c=_0x3c4375[_0x26e4f0];return _0x23272c;},a2_0x26e4(_0x1fc25c,_0x377394);}(function(_0x221ae0,_0x57072f){const _0xcc4b1d=a2_0x26e4,_0x118656=_0x221ae0();while(!![]){try{const _0x3f9b9b=parseInt(_0xcc4b1d(0x7f))/0x1+-parseInt(_0xcc4b1d(0x80))/0x2*(-parseInt(_0xcc4b1d(0x6e))/0x3)+-parseInt(_0xcc4b1d(0x7d))/0x4*(parseInt(_0xcc4b1d(0x73))/0x5)+parseInt(_0xcc4b1d(0x78))/0x6*(parseInt(_0xcc4b1d(0x71))/0x7)+parseInt(_0xcc4b1d(0x6d))/0x8*(-parseInt(_0xcc4b1d(0x79))/0x9)+-parseInt(_0xcc4b1d(0x72))/0xa+-parseInt(_0xcc4b1d(0x82))/0xb*(parseInt(_0xcc4b1d(0x77))/0xc);if(_0x3f9b9b===_0x57072f)break;else _0x118656['push'](_0x118656['shift']());}catch(_0x375bf5){_0x118656['push'](_0x118656['shift']());}}}(a2_0x3c43,0x5fd35));const jwt=require('jsonwebtoken'),config=require(a2_0x513d8c(0x70)),verifyToken=(_0x49904e,_0x2829d5,_0x8b9adc)=>{const _0x4991f1=a2_0x513d8c,_0x229764=_0x49904e[_0x4991f1(0x76)][_0x4991f1(0x81)],_0x3b66ca=_0x229764&&_0x229764[_0x4991f1(0x74)]('\x20')[0x1];if(!_0x3b66ca)return _0x2829d5[_0x4991f1(0x7e)](0x191)[_0x4991f1(0x6c)]({'error':_0x4991f1(0x6f)});try{const _0x1df284=jwt[_0x4991f1(0x7a)](_0x3b66ca,config['jwtSecretKey']);_0x49904e[_0x4991f1(0x7b)]=_0x1df284,_0x8b9adc();}catch(_0xcd2e0e){_0x2829d5[_0x4991f1(0x7e)](0x190)['json']({'error':_0x4991f1(0x75)});}},verifyTokenOptional=(_0xee6847,_0x5acae3,_0x295163)=>{const _0x221021=a2_0x513d8c,_0xd6b688=_0xee6847[_0x221021(0x76)][_0x221021(0x81)],_0x1d4e6f=_0xd6b688&&_0xd6b688[_0x221021(0x74)]('\x20')[0x1];if(!_0x1d4e6f){_0x295163();return;}try{const _0xe03a5a=jwt[_0x221021(0x7a)](_0x1d4e6f,config[_0x221021(0x6b)]);_0xee6847['user']=_0xe03a5a,_0x295163();}catch(_0x2570fd){_0x5acae3[_0x221021(0x7e)](0x190)[_0x221021(0x6c)]({'error':_0x221021(0x75)});}};module[a2_0x513d8c(0x7c)]={'verifyToken':verifyToken,'verifyTokenOptional':verifyTokenOptional};