const a2_0x418da7=a2_0x3a37;function a2_0x4ed4(){const _0x3ddc15=['1005760HZQizC','json','2034AMFWqN','325392zGEndk','verify','14234880CSXRLj','exports','jsonwebtoken','authorization','jwtSecretKey','26Tmvcbm','status','Invalid\x20token','4343TDxlvC','10613528simwuo','492vJSqSu','194OFCDCz','Access\x20denied.\x20No\x20token\x20provided','10WqLLjs','split','user','headers','9dtGCAf','6833964HnXnBc','../CADViewer_config.json','7Pzzlwo'];a2_0x4ed4=function(){return _0x3ddc15;};return a2_0x4ed4();}(function(_0x941606,_0x393946){const _0x4937de=a2_0x3a37,_0x2ba41a=_0x941606();while(!![]){try{const _0x5c73b5=-parseInt(_0x4937de(0xbf))/0x1*(parseInt(_0x4937de(0xc2))/0x2)+-parseInt(_0x4937de(0xb4))/0x3*(-parseInt(_0x4937de(0xc1))/0x4)+-parseInt(_0x4937de(0xb2))/0x5+parseInt(_0x4937de(0xc9))/0x6*(-parseInt(_0x4937de(0xb1))/0x7)+-parseInt(_0x4937de(0xc0))/0x8*(-parseInt(_0x4937de(0xc8))/0x9)+-parseInt(_0x4937de(0xc4))/0xa*(-parseInt(_0x4937de(0xb7))/0xb)+-parseInt(_0x4937de(0xb5))/0xc*(-parseInt(_0x4937de(0xbc))/0xd);if(_0x5c73b5===_0x393946)break;else _0x2ba41a['push'](_0x2ba41a['shift']());}catch(_0x1ad694){_0x2ba41a['push'](_0x2ba41a['shift']());}}}(a2_0x4ed4,0xf3674));function a2_0x3a37(_0x4fb75b,_0x33bb5c){const _0x4ed4c6=a2_0x4ed4();return a2_0x3a37=function(_0x3a37b0,_0x206f87){_0x3a37b0=_0x3a37b0-0xb1;let _0x2a316b=_0x4ed4c6[_0x3a37b0];return _0x2a316b;},a2_0x3a37(_0x4fb75b,_0x33bb5c);}const jwt=require(a2_0x418da7(0xb9)),config=require(a2_0x418da7(0xca)),verifyToken=(_0x3519d2,_0x30b2e8,_0x1ee2f2)=>{const _0x2f63b7=a2_0x418da7,_0x574fc3=_0x3519d2[_0x2f63b7(0xc7)][_0x2f63b7(0xba)],_0x411b8f=_0x574fc3&&_0x574fc3['split']('\x20')[0x1];if(!_0x411b8f)return _0x30b2e8[_0x2f63b7(0xbd)](0x191)[_0x2f63b7(0xb3)]({'error':_0x2f63b7(0xc3)});try{const _0x14e1ee=jwt['verify'](_0x411b8f,config[_0x2f63b7(0xbb)]);_0x3519d2[_0x2f63b7(0xc6)]=_0x14e1ee,_0x1ee2f2();}catch(_0x18babb){_0x30b2e8[_0x2f63b7(0xbd)](0x190)[_0x2f63b7(0xb3)]({'error':_0x2f63b7(0xbe)});}},verifyTokenOptional=(_0x1bc58d,_0x5ad8c1,_0x2e2767)=>{const _0xd1abbc=a2_0x418da7,_0x3104bb=_0x1bc58d[_0xd1abbc(0xc7)]['authorization'],_0x5ce1ed=_0x3104bb&&_0x3104bb[_0xd1abbc(0xc5)]('\x20')[0x1];if(!_0x5ce1ed){_0x2e2767();return;}try{const _0x2b399d=jwt[_0xd1abbc(0xb6)](_0x5ce1ed,config[_0xd1abbc(0xbb)]);_0x1bc58d['user']=_0x2b399d,_0x2e2767();}catch(_0x3b9391){_0x5ad8c1[_0xd1abbc(0xbd)](0x190)['json']({'error':_0xd1abbc(0xbe)});}};module[a2_0x418da7(0xb8)]={'verifyToken':verifyToken,'verifyTokenOptional':verifyTokenOptional};