const a4_0x3c98a5=a4_0x512b;function a4_0x185b(){const _0xf0942b=['52BOJRqk','../CADViewer_config.json','exports','500275zncyIo','json','status','jwtSecretKey','user','4744350JFLpmd','split','292665fNjflL','2496690myPrqF','50068368yqsthG','9730544PQHIQc','Invalid\x20token','6qLwJpw','3942379PStIVA','Access\x20denied.\x20No\x20token\x20provided','verify','authorization'];a4_0x185b=function(){return _0xf0942b;};return a4_0x185b();}function a4_0x512b(_0x1a3b45,_0x429fe6){const _0x185b20=a4_0x185b();return a4_0x512b=function(_0x512b02,_0x35775b){_0x512b02=_0x512b02-0x187;let _0x3d6dc4=_0x185b20[_0x512b02];return _0x3d6dc4;},a4_0x512b(_0x1a3b45,_0x429fe6);}(function(_0x311f41,_0x34d7b4){const _0x3f2cfb=a4_0x512b,_0x3ac28f=_0x311f41();while(!![]){try{const _0x587b2b=-parseInt(_0x3f2cfb(0x191))/0x1+-parseInt(_0x3f2cfb(0x199))/0x2+-parseInt(_0x3f2cfb(0x196))/0x3+-parseInt(_0x3f2cfb(0x18e))/0x4*(parseInt(_0x3f2cfb(0x198))/0x5)+parseInt(_0x3f2cfb(0x189))/0x6*(parseInt(_0x3f2cfb(0x18a))/0x7)+-parseInt(_0x3f2cfb(0x187))/0x8+parseInt(_0x3f2cfb(0x19a))/0x9;if(_0x587b2b===_0x34d7b4)break;else _0x3ac28f['push'](_0x3ac28f['shift']());}catch(_0x49747c){_0x3ac28f['push'](_0x3ac28f['shift']());}}}(a4_0x185b,0xc7f58));const jwt=require('jsonwebtoken'),config=require(a4_0x3c98a5(0x18f)),verifyToken=(_0x419e18,_0x3f0524,_0x41cf6c)=>{const _0xd0386a=a4_0x3c98a5,_0x34ebdb=_0x419e18['headers'][_0xd0386a(0x18d)],_0x4d972f=_0x34ebdb&&_0x34ebdb[_0xd0386a(0x197)]('\x20')[0x1];if(!_0x4d972f)return _0x3f0524[_0xd0386a(0x193)](0x191)[_0xd0386a(0x192)]({'error':_0xd0386a(0x18b)});try{const _0xb90f1c=jwt[_0xd0386a(0x18c)](_0x4d972f,config[_0xd0386a(0x194)]);_0x419e18[_0xd0386a(0x195)]=_0xb90f1c,_0x41cf6c();}catch(_0x3c6927){_0x3f0524[_0xd0386a(0x193)](0x190)[_0xd0386a(0x192)]({'error':'Invalid\x20token'});}},verifyTokenOptional=(_0x573870,_0x2840ca,_0xdb9c90)=>{const _0x1fe439=a4_0x3c98a5,_0x2c09e7=_0x573870['headers'][_0x1fe439(0x18d)],_0x396e54=_0x2c09e7&&_0x2c09e7[_0x1fe439(0x197)]('\x20')[0x1];if(!_0x396e54){_0xdb9c90();return;}try{const _0x1849cf=jwt[_0x1fe439(0x18c)](_0x396e54,config[_0x1fe439(0x194)]);_0x573870[_0x1fe439(0x195)]=_0x1849cf,_0xdb9c90();}catch(_0x947684){_0x2840ca[_0x1fe439(0x193)](0x190)[_0x1fe439(0x192)]({'error':_0x1fe439(0x188)});}};module[a4_0x3c98a5(0x190)]={'verifyToken':verifyToken,'verifyTokenOptional':verifyTokenOptional};