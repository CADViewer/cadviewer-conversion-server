const a2_0x46f6df=a2_0x701d;(function(_0x279c95,_0x4df330){const _0x1c6038=a2_0x701d,_0x24d8ba=_0x279c95();while(!![]){try{const _0x3a850c=parseInt(_0x1c6038(0xfb))/0x1+-parseInt(_0x1c6038(0x111))/0x2+-parseInt(_0x1c6038(0x119))/0x3*(parseInt(_0x1c6038(0xf6))/0x4)+-parseInt(_0x1c6038(0xf7))/0x5*(parseInt(_0x1c6038(0xed))/0x6)+parseInt(_0x1c6038(0xee))/0x7*(parseInt(_0x1c6038(0x116))/0x8)+parseInt(_0x1c6038(0x10e))/0x9+parseInt(_0x1c6038(0xf3))/0xa*(parseInt(_0x1c6038(0x10f))/0xb);if(_0x3a850c===_0x4df330)break;else _0x24d8ba['push'](_0x24d8ba['shift']());}catch(_0x629418){_0x24d8ba['push'](_0x24d8ba['shift']());}}}(a2_0x1d21,0x3e070));const config=require(a2_0x46f6df(0xfa)),conn=require(a2_0x46f6df(0x11c)),transporter=require(a2_0x46f6df(0x114))[a2_0x46f6df(0x11d)],getWelcomeEmailTemplate=(_0xede42,_0xce54ae)=>{const _0x5e5cf6=a2_0x46f6df;return _0x5e5cf6(0xf4)+_0xce54ae+_0x5e5cf6(0x112)+_0xce54ae+_0x5e5cf6(0xfd);},sendWelcomeEmail=async(_0x26050c,_0x36f3a5)=>{const _0x20d87c=a2_0x46f6df;try{let _0x3935d0=config['frontendUrl'];_0x3935d0[_0x20d87c(0x11a)]('/')&&(_0x3935d0=_0x3935d0['slice'](0x0,-0x1));const _0x426835=_0x3935d0+'/validate-email/'+_0x36f3a5,_0x313ac6=getWelcomeEmailTemplate(_0x26050c,_0x426835),_0x544525={'from':config['smtpFrom'],'to':_0x26050c[_0x20d87c(0xef)],'subject':_0x20d87c(0x104),'text':_0x20d87c(0x104),'html':_0x313ac6};await transporter[_0x20d87c(0xf0)](_0x544525),console['log'](_0x20d87c(0x11e)+_0x26050c[_0x20d87c(0xef)]);}catch(_0x4b2266){console[_0x20d87c(0xf5)](_0x20d87c(0xeb)),console[_0x20d87c(0xf5)](_0x20d87c(0xfe)+_0x26050c['email']+':',_0x4b2266);throw _0x4b2266;}},getAccountDeletionPreventionTemplate=_0x5112d8=>{const _0x142929=a2_0x46f6df;return _0x142929(0x107)+(_0x5112d8[_0x142929(0x108)]||_0x5112d8['username'])+_0x142929(0xea);},sendAccountDeletionPreventionEmails=async()=>{const _0x352174=a2_0x46f6df;try{const [_0x3a1d30]=await conn[_0x352174(0xe8)]()['execute'](_0x352174(0x101),[config[_0x352174(0x118)]-config[_0x352174(0x115)]]);if(_0x3a1d30[_0x352174(0xe9)]===0x0){console[_0x352174(0xf5)](_0x352174(0x100));return;}for(const _0x237705 of _0x3a1d30){const _0xc90b81=getAccountDeletionPreventionTemplate(_0x237705),_0x5e56cf={'from':config[_0x352174(0xff)],'to':_0x237705[_0x352174(0xef)],'subject':_0x352174(0x11b),'text':'Your\x20CADViewer\x20demo\x20account\x20will\x20expire\x20in\x202\x20days.\x20Please\x20contact\x20an\x20administrator\x20if\x20you\x20wish\x20to\x20keep\x20your\x20account.','html':_0xc90b81};try{await transporter[_0x352174(0xf0)](_0x5e56cf),console[_0x352174(0xf5)](_0x352174(0x106)+_0x237705['email']);}catch(_0x288220){console['log'](_0x352174(0xeb)),console['log'](_0x352174(0xf1)+_0x237705['email']),console[_0x352174(0xf5)](_0x288220);}}}catch(_0x58ea3c){console[_0x352174(0xf5)](_0x352174(0xeb)),console[_0x352174(0xf5)](_0x352174(0x109)),console[_0x352174(0xf5)](_0x58ea3c);}},getFollowUpEmailTemplate=(_0x4c31a7,_0x583a5a,_0x5b0648)=>{const _0x1dfe9d=a2_0x46f6df,_0x1a259a={0x1:_0x1dfe9d(0x102),0x2:'6\x20hours',0x3:_0x1dfe9d(0x10b)}[_0x5b0648];return _0x1dfe9d(0xf9)+(_0x4c31a7[_0x1dfe9d(0x108)]||_0x4c31a7[_0x1dfe9d(0x117)])+_0x1dfe9d(0x10a)+_0x1a259a+_0x1dfe9d(0x10d)+_0x583a5a+_0x1dfe9d(0x112)+_0x583a5a+_0x1dfe9d(0xfd);},sendFollowUpEmails=async()=>{const _0x249cd7=a2_0x46f6df;try{const _0x360ec5=_0x249cd7(0x120),[_0x47c49e]=await conn[_0x249cd7(0xe8)]()['execute'](_0x360ec5);for(const _0x30b6a8 of _0x47c49e){const _0x45333a=config[_0x249cd7(0x113)]+_0x249cd7(0xfc)+_0x30b6a8[_0x249cd7(0xf8)],_0x47de21=getFollowUpEmailTemplate(_0x30b6a8,_0x45333a,_0x30b6a8['follow_up_count']+0x1),_0x2944bb={'from':config[_0x249cd7(0xff)],'to':_0x30b6a8[_0x249cd7(0xef)],'subject':_0x249cd7(0xec),'text':_0x249cd7(0x105),'html':_0x47de21};try{await transporter[_0x249cd7(0xf0)](_0x2944bb),await conn['promise']()['execute'](_0x249cd7(0x10c),[_0x30b6a8['id']]),console[_0x249cd7(0xf5)](_0x249cd7(0x110)+_0x30b6a8[_0x249cd7(0xef)]);}catch(_0x4698aa){console['error']('Failed\x20to\x20send\x20follow-up\x20email\x20to\x20'+_0x30b6a8[_0x249cd7(0xef)]+':',_0x4698aa);}}}catch(_0x3e8bd6){console[_0x249cd7(0xf2)](_0x249cd7(0x103),_0x3e8bd6);}};module[a2_0x46f6df(0x11f)]={'transporter':transporter,'sendFollowUpEmails':sendFollowUpEmails,'sendAccountDeletionPreventionEmails':sendAccountDeletionPreventionEmails,'sendWelcomeEmail':sendWelcomeEmail};function a2_0x701d(_0x2f1bbf,_0x18cc51){const _0x1d2174=a2_0x1d21();return a2_0x701d=function(_0x701d29,_0x2aae3a){_0x701d29=_0x701d29-0xe8;let _0x2d93bd=_0x1d2174[_0x701d29];return _0x2d93bd;},a2_0x701d(_0x2f1bbf,_0x18cc51);}function a2_0x1d21(){const _0x5a2096=['email','sendMail','Failed\x20to\x20send\x20email\x20to\x20','error','50lmllsA','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Welcome\x20to\x20CADViewer!</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20are\x20delighted\x20to\x20welcome\x20you\x20to\x20our\x20community.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','log','6656mXQKmZ','2915XVwBDP','validation_token','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>CADViewer\x20Email\x20Validation\x20Reminder</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20','../CADViewer_config.json','108876ZBqzhJ','/validate-email/','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20','Failed\x20to\x20send\x20welcome\x20email\x20to\x20','smtpFrom','No\x20users\x20to\x20notify\x20about\x20account\x20deletion','SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27demo_user\x27\x20AND\x20created_at\x20<\x20DATE_SUB(NOW(),\x20INTERVAL\x20?\x20DAY)','3\x20hours','Error\x20in\x20sendFollowUpEmails:','Welcome\x20to\x20CADViewer','Please\x20validate\x20your\x20CADViewer\x20email\x20address','Deletion\x20prevention\x20email\x20sent\x20to\x20','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Important:\x20Your\x20CADViewer\x20Account</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20','first_name','Error\x20while\x20fetching\x20users\x20for\x20account\x20deletion\x20prevention\x20emails',',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20noticed\x20that\x20you\x20haven\x27t\x20validated\x20your\x20email\x20address\x20yet.\x20It\x27s\x20been\x20','12\x20hours','UPDATE\x20users\x20SET\x20follow_up_count\x20=\x20follow_up_count\x20+\x201\x20WHERE\x20id\x20=\x20?','\x20since\x20you\x20registered.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','4517757PQXJbG','8866XeoNWO','Follow-up\x20email\x20sent\x20to\x20','67678xBFGCn','\x22\x20class=\x22button\x22>Validate\x20my\x20email\x20address</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20the\x20button\x20doesn\x27t\x20work,\x20you\x20can\x20copy\x20and\x20paste\x20this\x20link\x20in\x20your\x20browser:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22word-break:\x20break-all;\x22>','frontendUrl','./mail.js','demoUserRetentionDaysAlertBeforeDeletion','2088752wNjrYB','username','demoUserRetentionDays','747UYkUnJ','endsWith','Important:\x20Your\x20CADViewer\x20Account\x20Will\x20Expire\x20Soon','./mysql.js','transporter','Welcome\x20email\x20sent\x20to\x20','exports','\x0a\x20\x20\x20\x20\x20\x20SELECT\x20*\x0a\x20\x20\x20\x20\x20\x20FROM\x20users\x0a\x20\x20\x20\x20\x20\x20WHERE\x20is_enabled\x20=\x200\x0a\x20\x20\x20\x20\x20\x20AND\x20validation_token\x20IS\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20AND\x20follow_up_count\x20<\x203\x0a\x20\x20\x20\x20\x20\x20AND\x20created_at\x20<=\x20DATE_SUB(NOW(),\x20INTERVAL\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20CASE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x200\x20THEN\x203\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x201\x20THEN\x206\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x202\x20THEN\x2012\x0a\x20\x20\x20\x20\x20\x20\x20\x20END\x0a\x20\x20\x20\x20\x20\x20HOUR)\x0a\x20\x20\x20\x20','promise','length',',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20wanted\x20to\x20inform\x20you\x20that\x20your\x20demo\x20account\x20will\x20expire\x20in\x202\x20days\x20and\x20will\x20be\x20automatically\x20deleted.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20you\x20wish\x20to\x20keep\x20your\x20account\x20and\x20all\x20your\x20data,\x20please\x20contact\x20us\x20on\x20<a\x20href=\x22mailto:developer@tailormade.com\x22>developer@tailormade.com</a>\x20or\x20<a\x20href=\x22mailto:internationalsales@tailormade.com\x22>internationalsales@tailormade.com</a>\x20as\x20soon\x20as\x20possible.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Thank\x20you\x20for\x20using\x20CADViewer!</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20','===================error===================','CADViewer\x20Email\x20Validation\x20Reminder','1788NRLhfM','7osTRBL'];a2_0x1d21=function(){return _0x5a2096;};return a2_0x1d21();}