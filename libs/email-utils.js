const a3_0x530218=a3_0x463c;(function(_0x2cc91a,_0xdd492d){const _0x210c76=a3_0x463c,_0x5cd7cd=_0x2cc91a();while(!![]){try{const _0x369069=parseInt(_0x210c76(0x98))/0x1*(parseInt(_0x210c76(0x93))/0x2)+parseInt(_0x210c76(0x92))/0x3+parseInt(_0x210c76(0x88))/0x4+parseInt(_0x210c76(0x9f))/0x5*(parseInt(_0x210c76(0xa5))/0x6)+-parseInt(_0x210c76(0x9b))/0x7+parseInt(_0x210c76(0x95))/0x8*(-parseInt(_0x210c76(0x7f))/0x9)+-parseInt(_0x210c76(0x9a))/0xa;if(_0x369069===_0xdd492d)break;else _0x5cd7cd['push'](_0x5cd7cd['shift']());}catch(_0xb50d78){_0x5cd7cd['push'](_0x5cd7cd['shift']());}}}(a3_0x17e0,0x43a69));const config=require(a3_0x530218(0x86)),conn=require(a3_0x530218(0x83)),transporter=require(a3_0x530218(0xa0))['transporter'],getWelcomeEmailTemplate=(_0x18256c,_0x341fd8)=>{const _0x3fdc8f=a3_0x530218;return _0x3fdc8f(0xa6)+_0x341fd8+_0x3fdc8f(0x8a)+_0x341fd8+_0x3fdc8f(0xa4);},sendWelcomeEmail=async(_0x5b9b4c,_0x11d62f)=>{const _0x382380=a3_0x530218;try{let _0x568ade=config['frontendUrl'];_0x568ade['endsWith']('/')&&(_0x568ade=_0x568ade[_0x382380(0x84)](0x0,-0x1));const _0x11400a=_0x568ade+_0x382380(0x91)+_0x11d62f,_0x38f170=getWelcomeEmailTemplate(_0x5b9b4c,_0x11400a),_0x1723cf={'from':config[_0x382380(0x94)],'to':_0x5b9b4c[_0x382380(0xac)],'subject':'Welcome\x20to\x20CADViewer','text':_0x382380(0xb2),'html':_0x38f170};await transporter[_0x382380(0x81)](_0x1723cf),console[_0x382380(0xa9)](_0x382380(0x87)+_0x5b9b4c[_0x382380(0xac)]);}catch(_0x31d40a){console[_0x382380(0xa9)](_0x382380(0x82)),console[_0x382380(0xa9)](_0x382380(0xa2)+_0x5b9b4c['email']+':',_0x31d40a);throw _0x31d40a;}},getAccountDeletionPreventionTemplate=_0x550c9a=>{const _0x2ac241=a3_0x530218;return _0x2ac241(0x90)+(_0x550c9a[_0x2ac241(0xaf)]||_0x550c9a[_0x2ac241(0xad)])+',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20wanted\x20to\x20inform\x20you\x20that\x20your\x20demo\x20account\x20will\x20expire\x20in\x202\x20days\x20and\x20will\x20be\x20automatically\x20deleted.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20you\x20wish\x20to\x20keep\x20your\x20account\x20and\x20all\x20your\x20data,\x20please\x20contact\x20us\x20on\x20<a\x20href=\x22mailto:developer@tailormade.com\x22>developer@tailormade.com</a>\x20or\x20<a\x20href=\x22mailto:internationalsales@tailormade.com\x22>internationalsales@tailormade.com</a>\x20as\x20soon\x20as\x20possible.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Thank\x20you\x20for\x20using\x20CADViewer!</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20';},sendAccountDeletionPreventionEmails=async()=>{const _0x1f1fa3=a3_0x530218;try{const [_0xf254a8]=await conn[_0x1f1fa3(0x7e)]()[_0x1f1fa3(0xab)](_0x1f1fa3(0xb1),[config[_0x1f1fa3(0x9d)]-config[_0x1f1fa3(0xa3)]]);if(_0xf254a8[_0x1f1fa3(0x80)]===0x0){console[_0x1f1fa3(0xa9)](_0x1f1fa3(0xa1));return;}for(const _0x4db886 of _0xf254a8){const _0x46e377=getAccountDeletionPreventionTemplate(_0x4db886),_0xd3623e={'from':config[_0x1f1fa3(0x94)],'to':_0x4db886[_0x1f1fa3(0xac)],'subject':_0x1f1fa3(0x8e),'text':'Your\x20CADViewer\x20demo\x20account\x20will\x20expire\x20in\x202\x20days.\x20Please\x20contact\x20an\x20administrator\x20if\x20you\x20wish\x20to\x20keep\x20your\x20account.','html':_0x46e377};try{await transporter[_0x1f1fa3(0x81)](_0xd3623e),console['log']('Deletion\x20prevention\x20email\x20sent\x20to\x20'+_0x4db886[_0x1f1fa3(0xac)]);}catch(_0xd88e37){console[_0x1f1fa3(0xa9)]('===================error==================='),console[_0x1f1fa3(0xa9)](_0x1f1fa3(0x89)+_0x4db886[_0x1f1fa3(0xac)]),console[_0x1f1fa3(0xa9)](_0xd88e37);}}}catch(_0x4749cb){console[_0x1f1fa3(0xa9)](_0x1f1fa3(0x82)),console[_0x1f1fa3(0xa9)]('Error\x20while\x20fetching\x20users\x20for\x20account\x20deletion\x20prevention\x20emails'),console['log'](_0x4749cb);}},getFollowUpEmailTemplate=(_0x370c21,_0x31efc5,_0x1cbceb)=>{const _0x43edad=a3_0x530218,_0x2cbe26={0x1:'3\x20hours',0x2:_0x43edad(0xaa),0x3:_0x43edad(0x8f)}[_0x1cbceb];return _0x43edad(0xb0)+(_0x370c21[_0x43edad(0xaf)]||_0x370c21[_0x43edad(0xad)])+_0x43edad(0x96)+_0x2cbe26+_0x43edad(0xae)+_0x31efc5+_0x43edad(0x8a)+_0x31efc5+_0x43edad(0xa4);},sendFollowUpEmails=async()=>{const _0x7c9a24=a3_0x530218;try{const _0x4001bf=_0x7c9a24(0x8d),[_0x37e0c7]=await conn[_0x7c9a24(0x7e)]()[_0x7c9a24(0xab)](_0x4001bf);for(const _0xcdf34f of _0x37e0c7){const _0x2c4509=config['frontendUrl']+_0x7c9a24(0x91)+_0xcdf34f[_0x7c9a24(0xa7)],_0x22dde2=getFollowUpEmailTemplate(_0xcdf34f,_0x2c4509,_0xcdf34f[_0x7c9a24(0x9e)]+0x1),_0x4c07ef={'from':config['smtpFrom'],'to':_0xcdf34f[_0x7c9a24(0xac)],'subject':_0x7c9a24(0x8c),'text':'Please\x20validate\x20your\x20CADViewer\x20email\x20address','html':_0x22dde2};try{await transporter[_0x7c9a24(0x81)](_0x4c07ef),await conn['promise']()[_0x7c9a24(0xab)](_0x7c9a24(0x9c),[_0xcdf34f['id']]),console[_0x7c9a24(0xa9)](_0x7c9a24(0xa8)+_0xcdf34f['email']);}catch(_0x151e6a){console['error'](_0x7c9a24(0x85)+_0xcdf34f[_0x7c9a24(0xac)]+':',_0x151e6a);}}}catch(_0x174a26){console[_0x7c9a24(0x8b)](_0x7c9a24(0x99),_0x174a26);}};function a3_0x463c(_0x1f83ac,_0x3c48b3){const _0x17e0cf=a3_0x17e0();return a3_0x463c=function(_0x463c6d,_0x561268){_0x463c6d=_0x463c6d-0x7e;let _0x20349c=_0x17e0cf[_0x463c6d];return _0x20349c;},a3_0x463c(_0x1f83ac,_0x3c48b3);}module[a3_0x530218(0x97)]={'transporter':transporter,'sendFollowUpEmails':sendFollowUpEmails,'sendAccountDeletionPreventionEmails':sendAccountDeletionPreventionEmails,'sendWelcomeEmail':sendWelcomeEmail};function a3_0x17e0(){const _0x9eda07=['UPDATE\x20users\x20SET\x20follow_up_count\x20=\x20follow_up_count\x20+\x201\x20WHERE\x20id\x20=\x20?','demoUserRetentionDays','follow_up_count','151445gTXMGA','./mail.js','No\x20users\x20to\x20notify\x20about\x20account\x20deletion','Failed\x20to\x20send\x20welcome\x20email\x20to\x20','demoUserRetentionDaysAlertBeforeDeletion','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20','30GyQvji','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Welcome\x20to\x20CADViewer!</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20are\x20delighted\x20to\x20welcome\x20you\x20to\x20our\x20community.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','validation_token','Follow-up\x20email\x20sent\x20to\x20','log','6\x20hours','execute','email','username','\x20since\x20you\x20registered.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','first_name','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>CADViewer\x20Email\x20Validation\x20Reminder</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20','SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27demo_user\x27\x20AND\x20created_at\x20<\x20DATE_SUB(NOW(),\x20INTERVAL\x20?\x20DAY)','Welcome\x20to\x20CADViewer','promise','1633248tJFwjY','length','sendMail','===================error===================','./mysql.js','slice','Failed\x20to\x20send\x20follow-up\x20email\x20to\x20','../CADViewer_config.json','Welcome\x20email\x20sent\x20to\x20','844952HmCmSX','Failed\x20to\x20send\x20email\x20to\x20','\x22\x20class=\x22button\x22>Validate\x20my\x20email\x20address</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20the\x20button\x20doesn\x27t\x20work,\x20you\x20can\x20copy\x20and\x20paste\x20this\x20link\x20in\x20your\x20browser:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22word-break:\x20break-all;\x22>','error','CADViewer\x20Email\x20Validation\x20Reminder','\x0a\x20\x20\x20\x20\x20\x20SELECT\x20*\x0a\x20\x20\x20\x20\x20\x20FROM\x20users\x0a\x20\x20\x20\x20\x20\x20WHERE\x20is_enabled\x20=\x200\x0a\x20\x20\x20\x20\x20\x20AND\x20validation_token\x20IS\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20AND\x20follow_up_count\x20<\x203\x0a\x20\x20\x20\x20\x20\x20AND\x20created_at\x20<=\x20DATE_SUB(NOW(),\x20INTERVAL\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20CASE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x200\x20THEN\x203\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x201\x20THEN\x206\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x202\x20THEN\x2012\x0a\x20\x20\x20\x20\x20\x20\x20\x20END\x0a\x20\x20\x20\x20\x20\x20HOUR)\x0a\x20\x20\x20\x20','Important:\x20Your\x20CADViewer\x20Account\x20Will\x20Expire\x20Soon','12\x20hours','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Important:\x20Your\x20CADViewer\x20Account</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20','/validate-email/','870492tPONtA','16lNReKH','smtpFrom','8SLqbyx',',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20noticed\x20that\x20you\x20haven\x27t\x20validated\x20your\x20email\x20address\x20yet.\x20It\x27s\x20been\x20','exports','20011LMztpt','Error\x20in\x20sendFollowUpEmails:','975980MiEeyH','1797376GtSsGq'];a3_0x17e0=function(){return _0x9eda07;};return a3_0x17e0();}