function a2_0xbf4f(){const _0x36073b=['email','./mail.js','Welcome\x20email\x20sent\x20to\x20',',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20noticed\x20that\x20you\x20haven\x27t\x20validated\x20your\x20email\x20address\x20yet.\x20It\x27s\x20been\x20','username','exports','log','demoUserRetentionDaysAlertBeforeDeletion','2072982eBCeLa','144718EuxCWE','Error\x20while\x20fetching\x20users\x20for\x20account\x20deletion\x20prevention\x20emails','3\x20hours','Failed\x20to\x20send\x20follow-up\x20email\x20to\x20','execute',',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20wanted\x20to\x20inform\x20you\x20that\x20your\x20demo\x20account\x20will\x20expire\x20in\x202\x20days\x20and\x20will\x20be\x20automatically\x20deleted.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20you\x20wish\x20to\x20keep\x20your\x20account\x20and\x20all\x20your\x20data,\x20please\x20contact\x20us\x20on\x20<a\x20href=\x22mailto:developer@tailormade.com\x22>developer@tailormade.com</a>\x20or\x20<a\x20href=\x22mailto:internationalsales@tailormade.com\x22>internationalsales@tailormade.com</a>\x20as\x20soon\x20as\x20possible.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Thank\x20you\x20for\x20using\x20CADViewer!</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20','Please\x20validate\x20your\x20CADViewer\x20email\x20address','length','52lDggZj','\x22\x20class=\x22button\x22>Validate\x20my\x20email\x20address</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20the\x20button\x20doesn\x27t\x20work,\x20you\x20can\x20copy\x20and\x20paste\x20this\x20link\x20in\x20your\x20browser:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22word-break:\x20break-all;\x22>','6\x20hours','sendMail','promise','/validate-email/','1560892VscxyO','error','slice','449468GPgiUm','56PWgoam','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20','first_name','Your\x20CADViewer\x20demo\x20account\x20will\x20expire\x20in\x202\x20days.\x20Please\x20contact\x20an\x20administrator\x20if\x20you\x20wish\x20to\x20keep\x20your\x20account.','103030Ayozmz','Deletion\x20prevention\x20email\x20sent\x20to\x20','405OJVAgf','validation_token','Welcome\x20to\x20CADViewer','endsWith','6260880pXemKb','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Welcome\x20to\x20CADViewer!</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20are\x20delighted\x20to\x20welcome\x20you\x20to\x20our\x20community.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','smtpFrom','\x20since\x20you\x20registered.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','149300eCbkkf','frontendUrl','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>CADViewer\x20Email\x20Validation\x20Reminder</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20','===================error===================','Follow-up\x20email\x20sent\x20to\x20'];a2_0xbf4f=function(){return _0x36073b;};return a2_0xbf4f();}function a2_0x20c4(_0x1cf0e1,_0x3d487f){const _0xbf4f8a=a2_0xbf4f();return a2_0x20c4=function(_0x20c4cf,_0x1e48fb){_0x20c4cf=_0x20c4cf-0x67;let _0x1c8403=_0xbf4f8a[_0x20c4cf];return _0x1c8403;},a2_0x20c4(_0x1cf0e1,_0x3d487f);}const a2_0x4b0c4d=a2_0x20c4;(function(_0x192494,_0x3c864c){const _0x28891e=a2_0x20c4,_0x14dc37=_0x192494();while(!![]){try{const _0x3e8c49=-parseInt(_0x28891e(0x84))/0x1+parseInt(_0x28891e(0x81))/0x2+-parseInt(_0x28891e(0x72))/0x3+parseInt(_0x28891e(0x7b))/0x4*(-parseInt(_0x28891e(0x93))/0x5)+parseInt(_0x28891e(0x8f))/0x6+-parseInt(_0x28891e(0x73))/0x7*(parseInt(_0x28891e(0x85))/0x8)+parseInt(_0x28891e(0x8b))/0x9*(parseInt(_0x28891e(0x89))/0xa);if(_0x3e8c49===_0x3c864c)break;else _0x14dc37['push'](_0x14dc37['shift']());}catch(_0x239da5){_0x14dc37['push'](_0x14dc37['shift']());}}}(a2_0xbf4f,0x95f39));const config=require('../CADViewer_config.json'),conn=require('./mysql.js'),transporter=require(a2_0x4b0c4d(0x6b))['transporter'],getWelcomeEmailTemplate=(_0x2313e9,_0x2401fe)=>{const _0x1017be=a2_0x4b0c4d;return _0x1017be(0x90)+_0x2401fe+_0x1017be(0x7c)+_0x2401fe+_0x1017be(0x86);},sendWelcomeEmail=async(_0x7a0afb,_0x47f1d9)=>{const _0xad30b3=a2_0x4b0c4d;try{let _0x214817=config[_0xad30b3(0x94)];_0x214817[_0xad30b3(0x8e)]('/')&&(_0x214817=_0x214817[_0xad30b3(0x83)](0x0,-0x1));const _0x170426=_0x214817+'/validate-email/'+_0x47f1d9,_0x15c46b=getWelcomeEmailTemplate(_0x7a0afb,_0x170426),_0xf5ec40={'from':config[_0xad30b3(0x91)],'to':_0x7a0afb[_0xad30b3(0x6a)],'subject':_0xad30b3(0x8d),'text':_0xad30b3(0x8d),'html':_0x15c46b};await transporter['sendMail'](_0xf5ec40),console[_0xad30b3(0x70)](_0xad30b3(0x6c)+_0x7a0afb[_0xad30b3(0x6a)]);}catch(_0x3f974e){console['log'](_0xad30b3(0x68)),console[_0xad30b3(0x70)]('Failed\x20to\x20send\x20welcome\x20email\x20to\x20'+_0x7a0afb[_0xad30b3(0x6a)]+':',_0x3f974e);throw _0x3f974e;}},getAccountDeletionPreventionTemplate=_0x173565=>{const _0x30fc3a=a2_0x4b0c4d;return'\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Important:\x20Your\x20CADViewer\x20Account</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20'+(_0x173565['first_name']||_0x173565['username'])+_0x30fc3a(0x78);},sendAccountDeletionPreventionEmails=async()=>{const _0x4a2823=a2_0x4b0c4d;try{const [_0x42cfb8]=await conn[_0x4a2823(0x7f)]()['execute']('SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27demo_user\x27\x20AND\x20created_at\x20<\x20DATE_SUB(NOW(),\x20INTERVAL\x20?\x20DAY)',[config['demoUserRetentionDays']-config[_0x4a2823(0x71)]]);if(_0x42cfb8[_0x4a2823(0x7a)]===0x0){console[_0x4a2823(0x70)]('No\x20users\x20to\x20notify\x20about\x20account\x20deletion');return;}for(const _0x468275 of _0x42cfb8){const _0x291861=getAccountDeletionPreventionTemplate(_0x468275),_0x1e08ce={'from':config[_0x4a2823(0x91)],'to':_0x468275[_0x4a2823(0x6a)],'subject':'Important:\x20Your\x20CADViewer\x20Account\x20Will\x20Expire\x20Soon','text':_0x4a2823(0x88),'html':_0x291861};try{await transporter['sendMail'](_0x1e08ce),console[_0x4a2823(0x70)](_0x4a2823(0x8a)+_0x468275[_0x4a2823(0x6a)]);}catch(_0x4b91d8){console[_0x4a2823(0x70)](_0x4a2823(0x68)),console[_0x4a2823(0x70)]('Failed\x20to\x20send\x20email\x20to\x20'+_0x468275['email']),console[_0x4a2823(0x70)](_0x4b91d8);}}}catch(_0x4c0ddf){console[_0x4a2823(0x70)](_0x4a2823(0x68)),console[_0x4a2823(0x70)](_0x4a2823(0x74)),console[_0x4a2823(0x70)](_0x4c0ddf);}},getFollowUpEmailTemplate=(_0x57d922,_0x1c3d67,_0x28db24)=>{const _0x127ba9=a2_0x4b0c4d,_0x5a33b6={0x1:_0x127ba9(0x75),0x2:_0x127ba9(0x7d),0x3:'12\x20hours'}[_0x28db24];return _0x127ba9(0x67)+(_0x57d922[_0x127ba9(0x87)]||_0x57d922[_0x127ba9(0x6e)])+_0x127ba9(0x6d)+_0x5a33b6+_0x127ba9(0x92)+_0x1c3d67+_0x127ba9(0x7c)+_0x1c3d67+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20';},sendFollowUpEmails=async()=>{const _0xcb26a2=a2_0x4b0c4d;try{const _0x46ccce='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20*\x0a\x20\x20\x20\x20\x20\x20FROM\x20users\x0a\x20\x20\x20\x20\x20\x20WHERE\x20is_enabled\x20=\x200\x0a\x20\x20\x20\x20\x20\x20AND\x20validation_token\x20IS\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20AND\x20follow_up_count\x20<\x203\x0a\x20\x20\x20\x20\x20\x20AND\x20created_at\x20<=\x20DATE_SUB(NOW(),\x20INTERVAL\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20CASE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x200\x20THEN\x203\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x201\x20THEN\x206\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x202\x20THEN\x2012\x0a\x20\x20\x20\x20\x20\x20\x20\x20END\x0a\x20\x20\x20\x20\x20\x20HOUR)\x0a\x20\x20\x20\x20',[_0x32308f]=await conn[_0xcb26a2(0x7f)]()[_0xcb26a2(0x77)](_0x46ccce);for(const _0x4b5d76 of _0x32308f){const _0x157310=config[_0xcb26a2(0x94)]+_0xcb26a2(0x80)+_0x4b5d76[_0xcb26a2(0x8c)],_0xf2712a=getFollowUpEmailTemplate(_0x4b5d76,_0x157310,_0x4b5d76['follow_up_count']+0x1),_0x17f001={'from':config[_0xcb26a2(0x91)],'to':_0x4b5d76[_0xcb26a2(0x6a)],'subject':'CADViewer\x20Email\x20Validation\x20Reminder','text':_0xcb26a2(0x79),'html':_0xf2712a};try{await transporter[_0xcb26a2(0x7e)](_0x17f001),await conn[_0xcb26a2(0x7f)]()[_0xcb26a2(0x77)]('UPDATE\x20users\x20SET\x20follow_up_count\x20=\x20follow_up_count\x20+\x201\x20WHERE\x20id\x20=\x20?',[_0x4b5d76['id']]),console[_0xcb26a2(0x70)](_0xcb26a2(0x69)+_0x4b5d76[_0xcb26a2(0x6a)]);}catch(_0x54c9f4){console['error'](_0xcb26a2(0x76)+_0x4b5d76[_0xcb26a2(0x6a)]+':',_0x54c9f4);}}}catch(_0x478220){console[_0xcb26a2(0x82)]('Error\x20in\x20sendFollowUpEmails:',_0x478220);}};module[a2_0x4b0c4d(0x6f)]={'transporter':transporter,'sendFollowUpEmails':sendFollowUpEmails,'sendAccountDeletionPreventionEmails':sendAccountDeletionPreventionEmails,'sendWelcomeEmail':sendWelcomeEmail};