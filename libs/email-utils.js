const a3_0xdbfb5d=a3_0x1e8c;function a3_0x32ec(){const _0x190019=['180762sjrYXM','Follow-up\x20email\x20sent\x20to\x20','2030CAIAoJ','./mysql.js','demoUserRetentionDays','transporter','9jhRsiB','893700udSfcD','username','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>CADViewer\x20Email\x20Validation\x20Reminder</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20','Your\x20CADViewer\x20demo\x20account\x20will\x20expire\x20in\x202\x20days.\x20Please\x20contact\x20an\x20administrator\x20if\x20you\x20wish\x20to\x20keep\x20your\x20account.','===================error===================','email','validation_token','smtpFrom','9175804LeDglY','first_name','sendMail','frontendUrl','3\x20hours','5FQQXAa','5386340wERSFw','Failed\x20to\x20send\x20follow-up\x20email\x20to\x20','Welcome\x20to\x20CADViewer','UPDATE\x20users\x20SET\x20follow_up_count\x20=\x20follow_up_count\x20+\x201\x20WHERE\x20id\x20=\x20?','error','endsWith','\x22\x20class=\x22button\x22>Validate\x20my\x20email\x20address</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20the\x20button\x20doesn\x27t\x20work,\x20you\x20can\x20copy\x20and\x20paste\x20this\x20link\x20in\x20your\x20browser:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22word-break:\x20break-all;\x22>','log','SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27demo_user\x27\x20AND\x20created_at\x20<\x20DATE_SUB(NOW(),\x20INTERVAL\x20?\x20DAY)','CADViewer\x20Email\x20Validation\x20Reminder','28573eipvXq','Error\x20in\x20sendFollowUpEmails:','./mail.js','12\x20hours','promise','3430332nKcxYU','19056nhNpSA','execute','2jlgPjN','exports','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20','/validate-email/','Welcome\x20email\x20sent\x20to\x20','\x0a\x20\x20\x20\x20\x20\x20SELECT\x20*\x0a\x20\x20\x20\x20\x20\x20FROM\x20users\x0a\x20\x20\x20\x20\x20\x20WHERE\x20is_enabled\x20=\x200\x0a\x20\x20\x20\x20\x20\x20AND\x20validation_token\x20IS\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20AND\x20follow_up_count\x20<\x203\x0a\x20\x20\x20\x20\x20\x20AND\x20created_at\x20<=\x20DATE_SUB(NOW(),\x20INTERVAL\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20CASE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x200\x20THEN\x203\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x201\x20THEN\x206\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x202\x20THEN\x2012\x0a\x20\x20\x20\x20\x20\x20\x20\x20END\x0a\x20\x20\x20\x20\x20\x20HOUR)\x0a\x20\x20\x20\x20'];a3_0x32ec=function(){return _0x190019;};return a3_0x32ec();}function a3_0x1e8c(_0x13ce5a,_0x162ef0){const _0x32ec97=a3_0x32ec();return a3_0x1e8c=function(_0x1e8ca0,_0x24772b){_0x1e8ca0=_0x1e8ca0-0x14b;let _0x43200a=_0x32ec97[_0x1e8ca0];return _0x43200a;},a3_0x1e8c(_0x13ce5a,_0x162ef0);}(function(_0x56b587,_0xc63881){const _0x1589c3=a3_0x1e8c,_0x521dfa=_0x56b587();while(!![]){try{const _0x20ab12=-parseInt(_0x1589c3(0x16c))/0x1*(-parseInt(_0x1589c3(0x174))/0x2)+-parseInt(_0x1589c3(0x14d))/0x3+-parseInt(_0x1589c3(0x154))/0x4*(-parseInt(_0x1589c3(0x161))/0x5)+parseInt(_0x1589c3(0x171))/0x6+-parseInt(_0x1589c3(0x14f))/0x7*(parseInt(_0x1589c3(0x172))/0x8)+parseInt(_0x1589c3(0x153))/0x9*(-parseInt(_0x1589c3(0x162))/0xa)+parseInt(_0x1589c3(0x15c))/0xb;if(_0x20ab12===_0xc63881)break;else _0x521dfa['push'](_0x521dfa['shift']());}catch(_0x1cf6e2){_0x521dfa['push'](_0x521dfa['shift']());}}}(a3_0x32ec,0x59e58));const config=require('../CADViewer_config.json'),conn=require(a3_0xdbfb5d(0x150)),transporter=require(a3_0xdbfb5d(0x16e))[a3_0xdbfb5d(0x152)],getWelcomeEmailTemplate=(_0x2c6689,_0x1de8b)=>{const _0xd1646f=a3_0xdbfb5d;return'\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Welcome\x20to\x20CADViewer!</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20are\x20delighted\x20to\x20welcome\x20you\x20to\x20our\x20community.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0x1de8b+_0xd1646f(0x168)+_0x1de8b+_0xd1646f(0x176);},sendWelcomeEmail=async(_0x3a064d,_0x1ec825)=>{const _0x426866=a3_0xdbfb5d;try{let _0x49d6b2=config['frontendUrl'];_0x49d6b2[_0x426866(0x167)]('/')&&(_0x49d6b2=_0x49d6b2['slice'](0x0,-0x1));const _0x448ab5=_0x49d6b2+'/validate-email/'+_0x1ec825,_0x590163=getWelcomeEmailTemplate(_0x3a064d,_0x448ab5),_0x131114={'from':config[_0x426866(0x15b)],'to':_0x3a064d['email'],'subject':_0x426866(0x164),'text':_0x426866(0x164),'html':_0x590163};await transporter['sendMail'](_0x131114),console[_0x426866(0x169)](_0x426866(0x14b)+_0x3a064d[_0x426866(0x159)]);}catch(_0x21ba74){console[_0x426866(0x169)](_0x426866(0x158)),console[_0x426866(0x169)]('Failed\x20to\x20send\x20welcome\x20email\x20to\x20'+_0x3a064d[_0x426866(0x159)]+':',_0x21ba74);throw _0x21ba74;}},getAccountDeletionPreventionTemplate=_0x356408=>{const _0x3cd722=a3_0xdbfb5d;return'\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Important:\x20Your\x20CADViewer\x20Account</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20'+(_0x356408[_0x3cd722(0x15d)]||_0x356408[_0x3cd722(0x155)])+',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20wanted\x20to\x20inform\x20you\x20that\x20your\x20demo\x20account\x20will\x20expire\x20in\x202\x20days\x20and\x20will\x20be\x20automatically\x20deleted.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20you\x20wish\x20to\x20keep\x20your\x20account\x20and\x20all\x20your\x20data,\x20please\x20contact\x20us\x20on\x20<a\x20href=\x22mailto:developer@tailormade.com\x22>developer@tailormade.com</a>\x20or\x20<a\x20href=\x22mailto:internationalsales@tailormade.com\x22>internationalsales@tailormade.com</a>\x20as\x20soon\x20as\x20possible.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Thank\x20you\x20for\x20using\x20CADViewer!</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20';},sendAccountDeletionPreventionEmails=async()=>{const _0x36f147=a3_0xdbfb5d;try{const [_0x48e3a3]=await conn[_0x36f147(0x170)]()['execute'](_0x36f147(0x16a),[config[_0x36f147(0x151)]-config['demoUserRetentionDaysAlertBeforeDeletion']]);if(_0x48e3a3['length']===0x0){console[_0x36f147(0x169)]('No\x20users\x20to\x20notify\x20about\x20account\x20deletion');return;}for(const _0x4c9d60 of _0x48e3a3){const _0x262cc6=getAccountDeletionPreventionTemplate(_0x4c9d60),_0x5e8a56={'from':config['smtpFrom'],'to':_0x4c9d60[_0x36f147(0x159)],'subject':'Important:\x20Your\x20CADViewer\x20Account\x20Will\x20Expire\x20Soon','text':_0x36f147(0x157),'html':_0x262cc6};try{await transporter[_0x36f147(0x15e)](_0x5e8a56),console['log']('Deletion\x20prevention\x20email\x20sent\x20to\x20'+_0x4c9d60[_0x36f147(0x159)]);}catch(_0x10f615){console[_0x36f147(0x169)](_0x36f147(0x158)),console[_0x36f147(0x169)]('Failed\x20to\x20send\x20email\x20to\x20'+_0x4c9d60[_0x36f147(0x159)]),console['log'](_0x10f615);}}}catch(_0xa15ed7){console[_0x36f147(0x169)](_0x36f147(0x158)),console[_0x36f147(0x169)]('Error\x20while\x20fetching\x20users\x20for\x20account\x20deletion\x20prevention\x20emails'),console[_0x36f147(0x169)](_0xa15ed7);}},getFollowUpEmailTemplate=(_0x3fd6f9,_0xe7d830,_0x197b35)=>{const _0x2b111c=a3_0xdbfb5d,_0x2ef21f={0x1:_0x2b111c(0x160),0x2:'6\x20hours',0x3:_0x2b111c(0x16f)}[_0x197b35];return _0x2b111c(0x156)+(_0x3fd6f9[_0x2b111c(0x15d)]||_0x3fd6f9[_0x2b111c(0x155)])+',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20noticed\x20that\x20you\x20haven\x27t\x20validated\x20your\x20email\x20address\x20yet.\x20It\x27s\x20been\x20'+_0x2ef21f+'\x20since\x20you\x20registered.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'+_0xe7d830+'\x22\x20class=\x22button\x22>Validate\x20my\x20email\x20address</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20the\x20button\x20doesn\x27t\x20work,\x20you\x20can\x20copy\x20and\x20paste\x20this\x20link\x20in\x20your\x20browser:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22word-break:\x20break-all;\x22>'+_0xe7d830+_0x2b111c(0x176);},sendFollowUpEmails=async()=>{const _0x2e05f1=a3_0xdbfb5d;try{const _0x313385=_0x2e05f1(0x14c),[_0x53d1f1]=await conn[_0x2e05f1(0x170)]()['execute'](_0x313385);for(const _0x266a9f of _0x53d1f1){const _0x5c49d5=config[_0x2e05f1(0x15f)]+_0x2e05f1(0x177)+_0x266a9f[_0x2e05f1(0x15a)],_0x5c03b4=getFollowUpEmailTemplate(_0x266a9f,_0x5c49d5,_0x266a9f['follow_up_count']+0x1),_0x43c74d={'from':config[_0x2e05f1(0x15b)],'to':_0x266a9f['email'],'subject':_0x2e05f1(0x16b),'text':'Please\x20validate\x20your\x20CADViewer\x20email\x20address','html':_0x5c03b4};try{await transporter[_0x2e05f1(0x15e)](_0x43c74d),await conn[_0x2e05f1(0x170)]()[_0x2e05f1(0x173)](_0x2e05f1(0x165),[_0x266a9f['id']]),console[_0x2e05f1(0x169)](_0x2e05f1(0x14e)+_0x266a9f['email']);}catch(_0x4ce0ad){console[_0x2e05f1(0x166)](_0x2e05f1(0x163)+_0x266a9f[_0x2e05f1(0x159)]+':',_0x4ce0ad);}}}catch(_0x2930a2){console[_0x2e05f1(0x166)](_0x2e05f1(0x16d),_0x2930a2);}};module[a3_0xdbfb5d(0x175)]={'transporter':transporter,'sendFollowUpEmails':sendFollowUpEmails,'sendAccountDeletionPreventionEmails':sendAccountDeletionPreventionEmails,'sendWelcomeEmail':sendWelcomeEmail};