const a3_0x4419f3=a3_0x3cb1;function a3_0x497f(){const _0xbf1455=['CADViewer\x20Email\x20Validation\x20Reminder','./mysql.js',',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20noticed\x20that\x20you\x20haven\x27t\x20validated\x20your\x20email\x20address\x20yet.\x20It\x27s\x20been\x20','675042DqgrsU','execute','validation_token','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Important:\x20Your\x20CADViewer\x20Account</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20','error','4995280RTNrDG','/validate-email/','length','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>CADViewer\x20Email\x20Validation\x20Reminder</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20','Failed\x20to\x20send\x20follow-up\x20email\x20to\x20','Deletion\x20prevention\x20email\x20sent\x20to\x20','\x20since\x20you\x20registered.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','Error\x20in\x20sendFollowUpEmails:','===================error===================','Failed\x20to\x20send\x20welcome\x20email\x20to\x20','demoUserRetentionDaysAlertBeforeDeletion','Please\x20validate\x20your\x20CADViewer\x20email\x20address','endsWith','Welcome\x20to\x20CADViewer','smtpFrom','7685937vfkirr','206CEyLYS','1904840BTHIMu','promise','3\x20hours','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Welcome\x20to\x20CADViewer!</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20are\x20delighted\x20to\x20welcome\x20you\x20to\x20our\x20community.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','No\x20users\x20to\x20notify\x20about\x20account\x20deletion','525416ULgWAu','./mail.js','12\x20hours','Failed\x20to\x20send\x20email\x20to\x20','4899504FiyOMF','slice','SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27demo_user\x27\x20AND\x20created_at\x20<\x20DATE_SUB(NOW(),\x20INTERVAL\x20?\x20DAY)','Your\x20CADViewer\x20demo\x20account\x20will\x20expire\x20in\x202\x20days.\x20Please\x20contact\x20an\x20administrator\x20if\x20you\x20wish\x20to\x20keep\x20your\x20account.','3079hKDPIY','sendMail','Welcome\x20email\x20sent\x20to\x20','email','username','log','follow_up_count',',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20wanted\x20to\x20inform\x20you\x20that\x20your\x20demo\x20account\x20will\x20expire\x20in\x202\x20days\x20and\x20will\x20be\x20automatically\x20deleted.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20you\x20wish\x20to\x20keep\x20your\x20account\x20and\x20all\x20your\x20data,\x20please\x20contact\x20us\x20on\x20<a\x20href=\x22mailto:developer@tailormade.com\x22>developer@tailormade.com</a>\x20or\x20<a\x20href=\x22mailto:internationalsales@tailormade.com\x22>internationalsales@tailormade.com</a>\x20as\x20soon\x20as\x20possible.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Thank\x20you\x20for\x20using\x20CADViewer!</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20','Error\x20while\x20fetching\x20users\x20for\x20account\x20deletion\x20prevention\x20emails','frontendUrl','../CADViewer_config.json'];a3_0x497f=function(){return _0xbf1455;};return a3_0x497f();}(function(_0x45162b,_0x7110a7){const _0xb341ef=a3_0x3cb1,_0x1f53cc=_0x45162b();while(!![]){try{const _0x4dcfcb=parseInt(_0xb341ef(0x13c))/0x1*(-parseInt(_0xb341ef(0x12e))/0x2)+parseInt(_0xb341ef(0x14a))/0x3+-parseInt(_0xb341ef(0x134))/0x4+-parseInt(_0xb341ef(0x12f))/0x5+parseInt(_0xb341ef(0x138))/0x6+parseInt(_0xb341ef(0x12d))/0x7+-parseInt(_0xb341ef(0x11e))/0x8;if(_0x4dcfcb===_0x7110a7)break;else _0x1f53cc['push'](_0x1f53cc['shift']());}catch(_0x3718e3){_0x1f53cc['push'](_0x1f53cc['shift']());}}}(a3_0x497f,0xa7698));function a3_0x3cb1(_0x24d818,_0xa867bc){const _0x497f92=a3_0x497f();return a3_0x3cb1=function(_0x3cb115,_0x2ab8cf){_0x3cb115=_0x3cb115-0x11a;let _0xa660c9=_0x497f92[_0x3cb115];return _0xa660c9;},a3_0x3cb1(_0x24d818,_0xa867bc);}const config=require(a3_0x4419f3(0x146)),conn=require(a3_0x4419f3(0x148)),transporter=require(a3_0x4419f3(0x135))['transporter'],getWelcomeEmailTemplate=(_0x327045,_0x4ba266)=>{const _0x35dfbf=a3_0x4419f3;return _0x35dfbf(0x132)+_0x4ba266+'\x22\x20class=\x22button\x22>Validate\x20my\x20email\x20address</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20the\x20button\x20doesn\x27t\x20work,\x20you\x20can\x20copy\x20and\x20paste\x20this\x20link\x20in\x20your\x20browser:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22word-break:\x20break-all;\x22>'+_0x4ba266+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20';},sendWelcomeEmail=async(_0x4d8855,_0x2176b6)=>{const _0x53d411=a3_0x4419f3;try{let _0x34180b=config[_0x53d411(0x145)];_0x34180b[_0x53d411(0x12a)]('/')&&(_0x34180b=_0x34180b[_0x53d411(0x139)](0x0,-0x1));const _0x2c5054=_0x34180b+'/validate-email/'+_0x2176b6,_0x3d102c=getWelcomeEmailTemplate(_0x4d8855,_0x2c5054),_0x53eeb9={'from':config[_0x53d411(0x12c)],'to':_0x4d8855[_0x53d411(0x13f)],'subject':'Welcome\x20to\x20CADViewer','text':_0x53d411(0x12b),'html':_0x3d102c};await transporter[_0x53d411(0x13d)](_0x53eeb9),console['log'](_0x53d411(0x13e)+_0x4d8855['email']);}catch(_0x5c559f){console['log']('===================error==================='),console[_0x53d411(0x141)](_0x53d411(0x127)+_0x4d8855[_0x53d411(0x13f)]+':',_0x5c559f);throw _0x5c559f;}},getAccountDeletionPreventionTemplate=_0x2c0569=>{const _0x4ad81a=a3_0x4419f3;return _0x4ad81a(0x11c)+(_0x2c0569['first_name']||_0x2c0569['username'])+_0x4ad81a(0x143);},sendAccountDeletionPreventionEmails=async()=>{const _0x39ee6e=a3_0x4419f3;try{const [_0x91d216]=await conn['promise']()[_0x39ee6e(0x11a)](_0x39ee6e(0x13a),[config['demoUserRetentionDays']-config[_0x39ee6e(0x128)]]);if(_0x91d216[_0x39ee6e(0x120)]===0x0){console[_0x39ee6e(0x141)](_0x39ee6e(0x133));return;}for(const _0x5a2874 of _0x91d216){const _0x2d0aeb=getAccountDeletionPreventionTemplate(_0x5a2874),_0x4f9523={'from':config[_0x39ee6e(0x12c)],'to':_0x5a2874[_0x39ee6e(0x13f)],'subject':'Important:\x20Your\x20CADViewer\x20Account\x20Will\x20Expire\x20Soon','text':_0x39ee6e(0x13b),'html':_0x2d0aeb};try{await transporter[_0x39ee6e(0x13d)](_0x4f9523),console[_0x39ee6e(0x141)](_0x39ee6e(0x123)+_0x5a2874[_0x39ee6e(0x13f)]);}catch(_0x3d666c){console[_0x39ee6e(0x141)](_0x39ee6e(0x126)),console[_0x39ee6e(0x141)](_0x39ee6e(0x137)+_0x5a2874['email']),console['log'](_0x3d666c);}}}catch(_0x1b77d4){console[_0x39ee6e(0x141)](_0x39ee6e(0x126)),console[_0x39ee6e(0x141)](_0x39ee6e(0x144)),console[_0x39ee6e(0x141)](_0x1b77d4);}},getFollowUpEmailTemplate=(_0x3d38af,_0x218b18,_0x40ae8a)=>{const _0x5c21cc=a3_0x4419f3,_0x27b265={0x1:_0x5c21cc(0x131),0x2:'6\x20hours',0x3:_0x5c21cc(0x136)}[_0x40ae8a];return _0x5c21cc(0x121)+(_0x3d38af['first_name']||_0x3d38af[_0x5c21cc(0x140)])+_0x5c21cc(0x149)+_0x27b265+_0x5c21cc(0x124)+_0x218b18+'\x22\x20class=\x22button\x22>Validate\x20my\x20email\x20address</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20the\x20button\x20doesn\x27t\x20work,\x20you\x20can\x20copy\x20and\x20paste\x20this\x20link\x20in\x20your\x20browser:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22word-break:\x20break-all;\x22>'+_0x218b18+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20';},sendFollowUpEmails=async()=>{const _0x19855f=a3_0x4419f3;try{const _0x19585f='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20*\x0a\x20\x20\x20\x20\x20\x20FROM\x20users\x0a\x20\x20\x20\x20\x20\x20WHERE\x20is_enabled\x20=\x200\x0a\x20\x20\x20\x20\x20\x20AND\x20validation_token\x20IS\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20AND\x20follow_up_count\x20<\x203\x0a\x20\x20\x20\x20\x20\x20AND\x20created_at\x20<=\x20DATE_SUB(NOW(),\x20INTERVAL\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20CASE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x200\x20THEN\x203\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x201\x20THEN\x206\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x202\x20THEN\x2012\x0a\x20\x20\x20\x20\x20\x20\x20\x20END\x0a\x20\x20\x20\x20\x20\x20HOUR)\x0a\x20\x20\x20\x20',[_0x29e5b5]=await conn[_0x19855f(0x130)]()[_0x19855f(0x11a)](_0x19585f);for(const _0x25dc7b of _0x29e5b5){const _0x10b9e7=config[_0x19855f(0x145)]+_0x19855f(0x11f)+_0x25dc7b[_0x19855f(0x11b)],_0x525bfe=getFollowUpEmailTemplate(_0x25dc7b,_0x10b9e7,_0x25dc7b[_0x19855f(0x142)]+0x1),_0x581456={'from':config['smtpFrom'],'to':_0x25dc7b[_0x19855f(0x13f)],'subject':_0x19855f(0x147),'text':_0x19855f(0x129),'html':_0x525bfe};try{await transporter[_0x19855f(0x13d)](_0x581456),await conn[_0x19855f(0x130)]()[_0x19855f(0x11a)]('UPDATE\x20users\x20SET\x20follow_up_count\x20=\x20follow_up_count\x20+\x201\x20WHERE\x20id\x20=\x20?',[_0x25dc7b['id']]),console[_0x19855f(0x141)]('Follow-up\x20email\x20sent\x20to\x20'+_0x25dc7b[_0x19855f(0x13f)]);}catch(_0xa8b221){console[_0x19855f(0x11d)](_0x19855f(0x122)+_0x25dc7b[_0x19855f(0x13f)]+':',_0xa8b221);}}}catch(_0xbc6d6b){console[_0x19855f(0x11d)](_0x19855f(0x125),_0xbc6d6b);}};module['exports']={'transporter':transporter,'sendFollowUpEmails':sendFollowUpEmails,'sendAccountDeletionPreventionEmails':sendAccountDeletionPreventionEmails,'sendWelcomeEmail':sendWelcomeEmail};