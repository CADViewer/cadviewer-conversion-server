const a3_0x3b7544=a3_0xf220;function a3_0x2739(){const _0x169530=['Welcome\x20to\x20CADViewer','../CADViewer_config.json','UPDATE\x20users\x20SET\x20follow_up_count\x20=\x20follow_up_count\x20+\x201\x20WHERE\x20id\x20=\x20?','55720332wwEiMR','Please\x20validate\x20your\x20CADViewer\x20email\x20address','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>CADViewer\x20Email\x20Validation\x20Reminder</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20','33QGMKuV','first_name','smtpFrom','36OcXnto','5cclVQp','exports','3\x20hours','6\x20hours','endsWith','log','2342416NqenRP','2882050dvGJWn','CADViewer\x20Email\x20Validation\x20Reminder',',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20wanted\x20to\x20inform\x20you\x20that\x20your\x20demo\x20account\x20will\x20expire\x20in\x202\x20days\x20and\x20will\x20be\x20automatically\x20deleted.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20you\x20wish\x20to\x20keep\x20your\x20account\x20and\x20all\x20your\x20data,\x20please\x20contact\x20us\x20on\x20<a\x20href=\x22mailto:developer@tailormade.com\x22>developer@tailormade.com</a>\x20or\x20<a\x20href=\x22mailto:internationalsales@tailormade.com\x22>internationalsales@tailormade.com</a>\x20as\x20soon\x20as\x20possible.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Thank\x20you\x20for\x20using\x20CADViewer!</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20','\x20since\x20you\x20registered.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','demoUserRetentionDays','Your\x20CADViewer\x20demo\x20account\x20will\x20expire\x20in\x202\x20days.\x20Please\x20contact\x20an\x20administrator\x20if\x20you\x20wish\x20to\x20keep\x20your\x20account.','Important:\x20Your\x20CADViewer\x20Account\x20Will\x20Expire\x20Soon','username','21haQoml','===================error===================','\x22\x20class=\x22button\x22>Validate\x20my\x20email\x20address</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20the\x20button\x20doesn\x27t\x20work,\x20you\x20can\x20copy\x20and\x20paste\x20this\x20link\x20in\x20your\x20browser:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22word-break:\x20break-all;\x22>','/validate-email/','length','670008DEEYne','2OZYgeQ','error','follow_up_count','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Welcome\x20to\x20CADViewer!</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20are\x20delighted\x20to\x20welcome\x20you\x20to\x20our\x20community.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','validation_token','12\x20hours','518281PVHyhE','Welcome\x20email\x20sent\x20to\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20','363057kyNmxX',',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20noticed\x20that\x20you\x20haven\x27t\x20validated\x20your\x20email\x20address\x20yet.\x20It\x27s\x20been\x20','No\x20users\x20to\x20notify\x20about\x20account\x20deletion','promise','email','frontendUrl','Follow-up\x20email\x20sent\x20to\x20','./mail.js','sendMail','4689404ctDLAp','execute','Error\x20in\x20sendFollowUpEmails:'];a3_0x2739=function(){return _0x169530;};return a3_0x2739();}(function(_0x41c36d,_0xf8a823){const _0xedd951=a3_0xf220,_0x4dbca1=_0x41c36d();while(!![]){try{const _0x2d5357=-parseInt(_0xedd951(0xc1))/0x1+parseInt(_0xedd951(0xbb))/0x2*(parseInt(_0xedd951(0xc4))/0x3)+parseInt(_0xedd951(0x99))/0x4*(-parseInt(_0xedd951(0xa6))/0x5)+-parseInt(_0xedd951(0xba))/0x6*(parseInt(_0xedd951(0xb5))/0x7)+-parseInt(_0xedd951(0xac))/0x8*(parseInt(_0xedd951(0xa5))/0x9)+parseInt(_0xedd951(0xad))/0xa*(-parseInt(_0xedd951(0xa2))/0xb)+parseInt(_0xedd951(0x9f))/0xc;if(_0x2d5357===_0xf8a823)break;else _0x4dbca1['push'](_0x4dbca1['shift']());}catch(_0x1a7d85){_0x4dbca1['push'](_0x4dbca1['shift']());}}}(a3_0x2739,0xab9c9));const config=require(a3_0x3b7544(0x9d)),conn=require('./mysql.js'),transporter=require(a3_0x3b7544(0x97))['transporter'],getWelcomeEmailTemplate=(_0x5a0f2e,_0x289655)=>{const _0x4699d6=a3_0x3b7544;return _0x4699d6(0xbe)+_0x289655+_0x4699d6(0xb7)+_0x289655+_0x4699d6(0xc3);},sendWelcomeEmail=async(_0x311d3b,_0x4a9788)=>{const _0x2ad88c=a3_0x3b7544;try{let _0x190f7c=config[_0x2ad88c(0x95)];_0x190f7c[_0x2ad88c(0xaa)]('/')&&(_0x190f7c=_0x190f7c['slice'](0x0,-0x1));const _0x2b8118=_0x190f7c+_0x2ad88c(0xb8)+_0x4a9788,_0x45e098=getWelcomeEmailTemplate(_0x311d3b,_0x2b8118),_0x847ba0={'from':config[_0x2ad88c(0xa4)],'to':_0x311d3b[_0x2ad88c(0x94)],'subject':_0x2ad88c(0x9c),'text':_0x2ad88c(0x9c),'html':_0x45e098};await transporter[_0x2ad88c(0x98)](_0x847ba0),console[_0x2ad88c(0xab)](_0x2ad88c(0xc2)+_0x311d3b[_0x2ad88c(0x94)]);}catch(_0x1c8a0c){console[_0x2ad88c(0xab)](_0x2ad88c(0xb6)),console[_0x2ad88c(0xab)]('Failed\x20to\x20send\x20welcome\x20email\x20to\x20'+_0x311d3b[_0x2ad88c(0x94)]+':',_0x1c8a0c);throw _0x1c8a0c;}},getAccountDeletionPreventionTemplate=_0x4918f4=>{const _0x4a306b=a3_0x3b7544;return'\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Important:\x20Your\x20CADViewer\x20Account</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20'+(_0x4918f4[_0x4a306b(0xa3)]||_0x4918f4[_0x4a306b(0xb4)])+_0x4a306b(0xaf);},sendAccountDeletionPreventionEmails=async()=>{const _0x219b27=a3_0x3b7544;try{const [_0x2ea788]=await conn['promise']()[_0x219b27(0x9a)]('SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27demo_user\x27\x20AND\x20created_at\x20<\x20DATE_SUB(NOW(),\x20INTERVAL\x20?\x20DAY)',[config[_0x219b27(0xb1)]-config['demoUserRetentionDaysAlertBeforeDeletion']]);if(_0x2ea788[_0x219b27(0xb9)]===0x0){console[_0x219b27(0xab)](_0x219b27(0xc6));return;}for(const _0x110f58 of _0x2ea788){const _0x3ca345=getAccountDeletionPreventionTemplate(_0x110f58),_0xd9cc70={'from':config[_0x219b27(0xa4)],'to':_0x110f58['email'],'subject':_0x219b27(0xb3),'text':_0x219b27(0xb2),'html':_0x3ca345};try{await transporter[_0x219b27(0x98)](_0xd9cc70),console[_0x219b27(0xab)]('Deletion\x20prevention\x20email\x20sent\x20to\x20'+_0x110f58['email']);}catch(_0x5702be){console['log']('===================error==================='),console[_0x219b27(0xab)]('Failed\x20to\x20send\x20email\x20to\x20'+_0x110f58[_0x219b27(0x94)]),console['log'](_0x5702be);}}}catch(_0xddaf45){console['log'](_0x219b27(0xb6)),console[_0x219b27(0xab)]('Error\x20while\x20fetching\x20users\x20for\x20account\x20deletion\x20prevention\x20emails'),console['log'](_0xddaf45);}},getFollowUpEmailTemplate=(_0x5b90f2,_0x407087,_0x5e0835)=>{const _0x381e5c=a3_0x3b7544,_0x287910={0x1:_0x381e5c(0xa8),0x2:_0x381e5c(0xa9),0x3:_0x381e5c(0xc0)}[_0x5e0835];return _0x381e5c(0xa1)+(_0x5b90f2['first_name']||_0x5b90f2[_0x381e5c(0xb4)])+_0x381e5c(0xc5)+_0x287910+_0x381e5c(0xb0)+_0x407087+_0x381e5c(0xb7)+_0x407087+_0x381e5c(0xc3);},sendFollowUpEmails=async()=>{const _0x51671b=a3_0x3b7544;try{const _0x4a4803='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20*\x0a\x20\x20\x20\x20\x20\x20FROM\x20users\x0a\x20\x20\x20\x20\x20\x20WHERE\x20is_enabled\x20=\x200\x0a\x20\x20\x20\x20\x20\x20AND\x20validation_token\x20IS\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20AND\x20follow_up_count\x20<\x203\x0a\x20\x20\x20\x20\x20\x20AND\x20created_at\x20<=\x20DATE_SUB(NOW(),\x20INTERVAL\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20CASE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x200\x20THEN\x203\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x201\x20THEN\x206\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x202\x20THEN\x2012\x0a\x20\x20\x20\x20\x20\x20\x20\x20END\x0a\x20\x20\x20\x20\x20\x20HOUR)\x0a\x20\x20\x20\x20',[_0x446db3]=await conn[_0x51671b(0xc7)]()[_0x51671b(0x9a)](_0x4a4803);for(const _0x4d6b77 of _0x446db3){const _0x5145c2=config[_0x51671b(0x95)]+_0x51671b(0xb8)+_0x4d6b77[_0x51671b(0xbf)],_0x35e641=getFollowUpEmailTemplate(_0x4d6b77,_0x5145c2,_0x4d6b77[_0x51671b(0xbd)]+0x1),_0x457bcd={'from':config['smtpFrom'],'to':_0x4d6b77['email'],'subject':_0x51671b(0xae),'text':_0x51671b(0xa0),'html':_0x35e641};try{await transporter[_0x51671b(0x98)](_0x457bcd),await conn[_0x51671b(0xc7)]()[_0x51671b(0x9a)](_0x51671b(0x9e),[_0x4d6b77['id']]),console[_0x51671b(0xab)](_0x51671b(0x96)+_0x4d6b77[_0x51671b(0x94)]);}catch(_0x45d67c){console[_0x51671b(0xbc)]('Failed\x20to\x20send\x20follow-up\x20email\x20to\x20'+_0x4d6b77[_0x51671b(0x94)]+':',_0x45d67c);}}}catch(_0x131cf4){console[_0x51671b(0xbc)](_0x51671b(0x9b),_0x131cf4);}};function a3_0xf220(_0xfe6181,_0x2fd901){const _0x2739ad=a3_0x2739();return a3_0xf220=function(_0xf220f2,_0x2303f8){_0xf220f2=_0xf220f2-0x94;let _0x444ea7=_0x2739ad[_0xf220f2];return _0x444ea7;},a3_0xf220(_0xfe6181,_0x2fd901);}module[a3_0x3b7544(0xa7)]={'transporter':transporter,'sendFollowUpEmails':sendFollowUpEmails,'sendAccountDeletionPreventionEmails':sendAccountDeletionPreventionEmails,'sendWelcomeEmail':sendWelcomeEmail};