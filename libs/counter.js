function a2_0x50d4(){const _0x41aca9=['forEach','memory','92IVUrWI','cadviewer/settings/http-codes-24h.json','506916wJzBAO','filter','log','mem','httpCodesStoragePath','end','total','cadviewer/settings/requests-per-minute.json','rpsStoragePath','startPeriodicSave','slice','method','utf8','Error\x20saving\x20monitoring\x20data:','24zPWyCA','codes','getHours','padStart','12028BXbSdB','byCodes','cadviewer/settings/ressources-usage-stats.json','1569504vRXwry','Initializing\x20request\x20monitor...','cpu','path','ressourcesUsageStatsPath','12477160gqhJpy','currentRequests','Request\x20monitor\x20middleware','writeFile','info','then','error','exports','httpCodesData','outputMb','3569153QvJBCV','ressourcesUsageStats','now','13036626hqFmKT','Request\x20monitor\x20initialized.','usage','inputMb','getUsageRessourcesStatsAndSave','floor','Error\x20getting\x20CPU\x20usage:','middleware','init','statusCode','readFile','toString','byPath','save','network','usedMemMb','timestamp','stringify','netstat','push','rpsData','90suHFUY','getMinutes','1786096kElXLj','toFixed','time','lastMinute','getStats'];a2_0x50d4=function(){return _0x41aca9;};return a2_0x50d4();}const a2_0x179340=a2_0x4bea;(function(_0x179a18,_0x482f7c){const _0x3d1df4=a2_0x4bea,_0x35bcc5=_0x179a18();while(!![]){try{const _0x10921c=-parseInt(_0x3d1df4(0x1e7))/0x1*(-parseInt(_0x3d1df4(0x1d3))/0x2)+parseInt(_0x3d1df4(0x1ea))/0x3+-parseInt(_0x3d1df4(0x1cc))/0x4+parseInt(_0x3d1df4(0x1ca))/0x5*(parseInt(_0x3d1df4(0x1d5))/0x6)+parseInt(_0x3d1df4(0x1f9))/0x7*(parseInt(_0x3d1df4(0x1e3))/0x8)+-parseInt(_0x3d1df4(0x1fc))/0x9+-parseInt(_0x3d1df4(0x1ef))/0xa;if(_0x10921c===_0x482f7c)break;else _0x35bcc5['push'](_0x35bcc5['shift']());}catch(_0x31c9fc){_0x35bcc5['push'](_0x35bcc5['shift']());}}}(a2_0x50d4,0xf0417));const fs=require('fs')['promises'],osu=require('node-os-utils');class RequestMonitor{static [a2_0x179340(0x1dd)]=a2_0x179340(0x1dc);static ['httpCodesStoragePath']=a2_0x179340(0x1d4);static [a2_0x179340(0x1ee)]=a2_0x179340(0x1e9);static ['rpsData']=[];static ['httpCodesData']=[];static ['ressourcesUsageStats']={};static [a2_0x179340(0x1cf)]=Math[a2_0x179340(0x201)](Date[a2_0x179340(0x1fb)]()/0x3e8/0x3c);static [a2_0x179340(0x1f0)]=0x0;static async[a2_0x179340(0x204)](){const _0x370c28=a2_0x179340;console[_0x370c28(0x1d7)](_0x370c28(0x1eb));try{const _0x43e830=await fs[_0x370c28(0x1bf)](RequestMonitor[_0x370c28(0x1dd)],'utf8');RequestMonitor[_0x370c28(0x1c9)]=JSON['parse'](_0x43e830);}catch(_0x2fab93){RequestMonitor[_0x370c28(0x1c9)]=[];}try{const _0x334d3d=await fs[_0x370c28(0x1bf)](RequestMonitor[_0x370c28(0x1d9)],_0x370c28(0x1e1));RequestMonitor[_0x370c28(0x1f7)]=JSON['parse'](_0x334d3d);}catch(_0x153246){RequestMonitor[_0x370c28(0x1f7)]=[];}try{const _0x133a90=await fs[_0x370c28(0x1bf)](RequestMonitor['ressourcesUsageStatsPath'],_0x370c28(0x1e1));RequestMonitor['ressourcesUsageStats']=JSON['parse'](_0x133a90),!RequestMonitor['ressourcesUsageStats'][_0x370c28(0x1ec)]&&(RequestMonitor[_0x370c28(0x1fa)][_0x370c28(0x1ec)]=[]),!RequestMonitor[_0x370c28(0x1fa)][_0x370c28(0x1d2)]&&(RequestMonitor[_0x370c28(0x1fa)][_0x370c28(0x1d2)]=[]),!RequestMonitor[_0x370c28(0x1fa)][_0x370c28(0x1c3)]&&(RequestMonitor['ressourcesUsageStats']['network']=[]);}catch(_0x313f18){RequestMonitor['ressourcesUsageStats']={'cpu':[],'memory':[],'network':[]};}console[_0x370c28(0x1d7)](_0x370c28(0x1fd));}static[a2_0x179340(0x203)](_0x299b82,_0x1c3c3f,_0x69336a){const _0x17d362=a2_0x179340;if(_0x299b82[_0x17d362(0x1ed)]['includes']('/metrics'))return _0x69336a();console[_0x17d362(0x1d7)](_0x17d362(0x1f1));let _0x1328c2=Date[_0x17d362(0x1fb)](),_0x1e0bbe=Math[_0x17d362(0x201)](_0x1328c2/0x3e8/0x3c);console[_0x17d362(0x1d7)]('=======>');const _0x2eca1c=_0x1c3c3f[_0x17d362(0x1da)];_0x1c3c3f[_0x17d362(0x1da)]=(..._0xa3774)=>{const _0x4e0b9b=_0x17d362;console['log'](_0x1e0bbe,{'currentMinute':_0x1e0bbe});_0x1e0bbe>RequestMonitor[_0x4e0b9b(0x1cf)]&&(RequestMonitor[_0x4e0b9b(0x1c9)]['push']({'timestamp':RequestMonitor[_0x4e0b9b(0x1cf)]*0x3e8*0x3c,'requests':RequestMonitor[_0x4e0b9b(0x1f0)]}),RequestMonitor['currentRequests']=0x0,RequestMonitor[_0x4e0b9b(0x1cf)]=_0x1e0bbe);RequestMonitor[_0x4e0b9b(0x1f0)]++,RequestMonitor[_0x4e0b9b(0x1f7)][_0x4e0b9b(0x1c8)]({'timestamp':Date[_0x4e0b9b(0x1fb)](),'statusCode':_0x1c3c3f['statusCode'],'path':_0x299b82['path'],'method':_0x299b82['method']});const _0x18b8f2=Date[_0x4e0b9b(0x1fb)]()-0x18*0x3c*0x3c*0x3e8;return RequestMonitor[_0x4e0b9b(0x1f7)]=RequestMonitor['httpCodesData']['filter'](_0x334faf=>_0x334faf[_0x4e0b9b(0x1c5)]>_0x18b8f2),_0x2eca1c['apply'](_0x1c3c3f,_0xa3774);},_0x69336a();}static async[a2_0x179340(0x1c2)](){const _0x52bb7e=a2_0x179340;try{RequestMonitor[_0x52bb7e(0x1cf)]!==Math[_0x52bb7e(0x201)](Date[_0x52bb7e(0x1fb)]()/0x3e8/0x3c)&&(RequestMonitor[_0x52bb7e(0x1c9)][_0x52bb7e(0x1c8)]({'timestamp':RequestMonitor[_0x52bb7e(0x1cf)]*0x3e8*0x3c,'requests':RequestMonitor[_0x52bb7e(0x1f0)]}),RequestMonitor[_0x52bb7e(0x1f0)]=0x0,RequestMonitor['lastMinute']=Math[_0x52bb7e(0x201)](Date[_0x52bb7e(0x1fb)]()/0x3e8/0x3c)),await fs[_0x52bb7e(0x1f2)](RequestMonitor[_0x52bb7e(0x1dd)],JSON[_0x52bb7e(0x1c6)](RequestMonitor[_0x52bb7e(0x1c9)],null,0x2)),await fs[_0x52bb7e(0x1f2)](RequestMonitor[_0x52bb7e(0x1d9)],JSON['stringify'](RequestMonitor[_0x52bb7e(0x1f7)],null,0x2));}catch(_0x365838){console[_0x52bb7e(0x1f5)](_0x52bb7e(0x1e2),_0x365838);}}static async[a2_0x179340(0x1de)](){const _0x8604c4=a2_0x179340;setInterval(()=>RequestMonitor['save'](),0x3c*0x3e8),setInterval(()=>{const _0x58cb01=a2_0x4bea;RequestMonitor[_0x58cb01(0x200)]()[_0x58cb01(0x1f4)](()=>{});},0x3c*0x3e8),RequestMonitor[_0x8604c4(0x200)]()[_0x8604c4(0x1f4)](()=>{});}static async[a2_0x179340(0x200)](){const _0x453a10=a2_0x179340,_0x4deb08=osu[_0x453a10(0x1ec)],_0x290ced=osu[_0x453a10(0x1d8)],_0x381799=osu[_0x453a10(0x1c7)],_0x4695a8={'total':{'inputMb':0x0,'outputMb':0x0}};try{const _0x25bc26=await _0x381799['inOut']();_0x4695a8[_0x453a10(0x1db)][_0x453a10(0x1ff)]=_0x25bc26[_0x453a10(0x1db)][_0x453a10(0x1ff)],_0x4695a8[_0x453a10(0x1db)][_0x453a10(0x1f8)]=_0x25bc26[_0x453a10(0x1db)][_0x453a10(0x1f8)];}catch(_0x29bba1){}let _0x1f6f52=0x0;try{_0x1f6f52=await _0x4deb08[_0x453a10(0x1fe)]();}catch(_0x37d74a){console['log'](_0x453a10(0x202),_0x37d74a);}const _0xdc8327={'usedMemMb':0x0};try{const _0xec200d=await _0x290ced[_0x453a10(0x1f3)]();_0xdc8327[_0x453a10(0x1c4)]=_0xec200d[_0x453a10(0x1c4)];}catch(_0x33e8d7){console[_0x453a10(0x1d7)]('Error\x20getting\x20memory\x20usage:',_0x33e8d7);}const _0xf918f9=new Date()[_0x453a10(0x1e5)]()[_0x453a10(0x1c0)]()[_0x453a10(0x1e6)](0x2,'0')+':'+new Date()[_0x453a10(0x1cb)]()[_0x453a10(0x1c0)]()['padStart'](0x2,'0');RequestMonitor[_0x453a10(0x1fa)]['cpu']=RequestMonitor['ressourcesUsageStats'][_0x453a10(0x1ec)][_0x453a10(0x1df)](-0x3c)[_0x453a10(0x1d6)](_0x436bda=>_0x436bda[_0x453a10(0x1ce)]!==_0xf918f9),RequestMonitor[_0x453a10(0x1fa)][_0x453a10(0x1d2)]=RequestMonitor[_0x453a10(0x1fa)][_0x453a10(0x1d2)][_0x453a10(0x1df)](-0x3c)[_0x453a10(0x1d6)](_0xad1a27=>_0xad1a27['time']!==_0xf918f9),RequestMonitor[_0x453a10(0x1fa)][_0x453a10(0x1c3)]=RequestMonitor[_0x453a10(0x1fa)]['network'][_0x453a10(0x1df)](-0x3c)[_0x453a10(0x1d6)](_0x2342c0=>_0x2342c0[_0x453a10(0x1ce)]!==_0xf918f9),RequestMonitor[_0x453a10(0x1fa)][_0x453a10(0x1ec)][_0x453a10(0x1c8)]({'time':_0xf918f9,'usage':_0x1f6f52}),RequestMonitor[_0x453a10(0x1fa)][_0x453a10(0x1d2)][_0x453a10(0x1c8)]({'time':_0xf918f9,'usage':(_0xdc8327[_0x453a10(0x1c4)]/0x3e8)[_0x453a10(0x1cd)](0x2)}),RequestMonitor[_0x453a10(0x1fa)]['network'][_0x453a10(0x1c8)]({'time':_0xf918f9,'usage':{'in':_0x4695a8['total']?.[_0x453a10(0x1ff)]??0x0,'out':_0x4695a8['total']?.[_0x453a10(0x1f8)]??0x0}});try{await fs[_0x453a10(0x1f2)](RequestMonitor['ressourcesUsageStatsPath'],JSON[_0x453a10(0x1c6)](RequestMonitor[_0x453a10(0x1fa)],null,0x2));}catch(_0xd4d34f){console[_0x453a10(0x1f5)](_0x453a10(0x1e2),_0xd4d34f);}}static[a2_0x179340(0x1d0)](){const _0x473998=a2_0x179340,_0x12770f=Date[_0x473998(0x1fb)](),_0x5e44b0=_0x12770f-0x3c*0x3c*0x3e8,_0x3f62f3=_0x12770f-0x18*0x3c*0x3c*0x3e8,_0x49d446=RequestMonitor['rpsData'][_0x473998(0x1d6)](_0x52dabb=>_0x52dabb['timestamp']>_0x5e44b0),_0x476569={'total':RequestMonitor['httpCodesData']['length'],'byCodes':{},'byPath':{}};return RequestMonitor['httpCodesData'][_0x473998(0x1d1)](_0x1a467d=>{const _0x257266=_0x473998;_0x476569['byCodes'][_0x1a467d[_0x257266(0x205)]]=(_0x476569[_0x257266(0x1e8)][_0x1a467d[_0x257266(0x205)]]||0x0)+0x1;const _0x3a6078=_0x1a467d[_0x257266(0x1e0)]+'\x20'+_0x1a467d[_0x257266(0x1ed)];!_0x476569[_0x257266(0x1c1)][_0x3a6078]&&(_0x476569[_0x257266(0x1c1)][_0x3a6078]={'total':0x0,'codes':{}}),_0x476569[_0x257266(0x1c1)][_0x3a6078][_0x257266(0x1db)]++,_0x476569[_0x257266(0x1c1)][_0x3a6078][_0x257266(0x1e4)][_0x1a467d['statusCode']]=(_0x476569['byPath'][_0x3a6078][_0x257266(0x1e4)][_0x1a467d['statusCode']]||0x0)+0x1;}),{'rps':_0x49d446,'httpCodes':_0x476569,'ressourcesUsageStats':RequestMonitor[_0x473998(0x1fa)]};}}RequestMonitor[a2_0x179340(0x204)]()[a2_0x179340(0x1f4)](()=>{}),RequestMonitor[a2_0x179340(0x1de)]();const counter=RequestMonitor;function a2_0x4bea(_0xffc27c,_0x1d7c9d){const _0x50d405=a2_0x50d4();return a2_0x4bea=function(_0x4bea46,_0x30dd27){_0x4bea46=_0x4bea46-0x1bf;let _0x23dd93=_0x50d405[_0x4bea46];return _0x23dd93;},a2_0x4bea(_0xffc27c,_0x1d7c9d);}module[a2_0x179340(0x1f6)]=counter;