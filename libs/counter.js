function a2_0x47f2(){const _0x192f81=['68Fkokjg','includes','startPeriodicSave','floor','stringify','total','getHours','1332401kRTlMv','readFile','rpsStoragePath','method','promises','memory','codes','save','error','init','3062128MrVgaU','getUsageRessourcesStatsAndSave','toFixed','then','timestamp','getStats','statusCode','utf8','mem','Error\x20getting\x20memory\x20usage:','network','now','getMinutes','lastMinute','2DYHXKR','Request\x20monitor\x20middleware','567400YnJPPk','byCodes','1012182hCGEKk','110bRtZbG','cpu','apply','netstat','Error\x20saving\x20monitoring\x20data:','ressourcesUsageStatsPath','=======>','128116TARbNf','push','slice','currentRequests','middleware','cadviewer/settings/http-codes-24h.json','byPath','Request\x20monitor\x20initialized.','info','end','exports','9wEwKKk','httpCodesStoragePath','cadviewer/settings/ressources-usage-stats.json','httpCodesData','rpsData','time','outputMb','inputMb','parse','196227bhNpeX','filter','path','usedMemMb','ressourcesUsageStats','28015vAinfw','toString','writeFile','usage','node-os-utils','inOut','log'];a2_0x47f2=function(){return _0x192f81;};return a2_0x47f2();}const a2_0x7593a9=a2_0x2fa2;(function(_0x35e5aa,_0x54e10f){const _0x463a64=a2_0x2fa2,_0xaa0b5=_0x35e5aa();while(!![]){try{const _0x145e7a=-parseInt(_0x463a64(0xfe))/0x1+-parseInt(_0x463a64(0xf2))/0x2*(-parseInt(_0x463a64(0xc7))/0x3)+parseInt(_0x463a64(0xd3))/0x4*(parseInt(_0x463a64(0xcc))/0x5)+parseInt(_0x463a64(0xf6))/0x6+parseInt(_0x463a64(0xda))/0x7+-parseInt(_0x463a64(0xe4))/0x8*(-parseInt(_0x463a64(0x109))/0x9)+-parseInt(_0x463a64(0xf4))/0xa*(parseInt(_0x463a64(0xf7))/0xb);if(_0x145e7a===_0x54e10f)break;else _0xaa0b5['push'](_0xaa0b5['shift']());}catch(_0x5250e3){_0xaa0b5['push'](_0xaa0b5['shift']());}}}(a2_0x47f2,0x32866));const fs=require('fs')[a2_0x7593a9(0xde)],osu=require(a2_0x7593a9(0xd0));class RequestMonitor{static [a2_0x7593a9(0xdc)]='cadviewer/settings/requests-per-minute.json';static [a2_0x7593a9(0x10a)]=a2_0x7593a9(0x103);static ['ressourcesUsageStatsPath']=a2_0x7593a9(0x10b);static ['rpsData']=[];static [a2_0x7593a9(0xc1)]=[];static ['ressourcesUsageStats']={};static [a2_0x7593a9(0xf1)]=Math['floor'](Date[a2_0x7593a9(0xef)]()/0x3e8/0x3c);static [a2_0x7593a9(0x101)]=0x0;static async[a2_0x7593a9(0xe3)](){const _0x398e0d=a2_0x7593a9;console['log']('Initializing\x20request\x20monitor...');try{const _0x367851=await fs[_0x398e0d(0xdb)](RequestMonitor['rpsStoragePath'],_0x398e0d(0xeb));RequestMonitor[_0x398e0d(0xc2)]=JSON[_0x398e0d(0xc6)](_0x367851);}catch(_0x3d3657){RequestMonitor[_0x398e0d(0xc2)]=[];}try{const _0x1a9fd3=await fs['readFile'](RequestMonitor[_0x398e0d(0x10a)],_0x398e0d(0xeb));RequestMonitor['httpCodesData']=JSON[_0x398e0d(0xc6)](_0x1a9fd3);}catch(_0x1fac48){RequestMonitor[_0x398e0d(0xc1)]=[];}try{const _0x3cdf2c=await fs[_0x398e0d(0xdb)](RequestMonitor[_0x398e0d(0xfc)],_0x398e0d(0xeb));RequestMonitor[_0x398e0d(0xcb)]=JSON['parse'](_0x3cdf2c),!RequestMonitor[_0x398e0d(0xcb)][_0x398e0d(0xf8)]&&(RequestMonitor[_0x398e0d(0xcb)][_0x398e0d(0xf8)]=[]),!RequestMonitor['ressourcesUsageStats'][_0x398e0d(0xdf)]&&(RequestMonitor[_0x398e0d(0xcb)][_0x398e0d(0xdf)]=[]),!RequestMonitor[_0x398e0d(0xcb)][_0x398e0d(0xee)]&&(RequestMonitor[_0x398e0d(0xcb)][_0x398e0d(0xee)]=[]);}catch(_0x467d21){RequestMonitor[_0x398e0d(0xcb)]={'cpu':[],'memory':[],'network':[]};}console[_0x398e0d(0xd2)](_0x398e0d(0x105));}static[a2_0x7593a9(0x102)](_0x377b83,_0x5eead9,_0x2e251c){const _0x3be4c7=a2_0x7593a9;if(_0x377b83[_0x3be4c7(0xc9)][_0x3be4c7(0xd4)]('/metrics'))return _0x2e251c();console[_0x3be4c7(0xd2)](_0x3be4c7(0xf3));let _0x3a5157=Date['now'](),_0x4168bd=Math[_0x3be4c7(0xd6)](_0x3a5157/0x3e8/0x3c);console['log'](_0x3be4c7(0xfd));const _0x29c8a0=_0x5eead9[_0x3be4c7(0x107)];_0x5eead9[_0x3be4c7(0x107)]=(..._0x3f9816)=>{const _0x434172=_0x3be4c7;console[_0x434172(0xd2)](_0x4168bd,{'currentMinute':_0x4168bd});_0x4168bd>RequestMonitor[_0x434172(0xf1)]&&(RequestMonitor[_0x434172(0xc2)][_0x434172(0xff)]({'timestamp':RequestMonitor[_0x434172(0xf1)]*0x3e8*0x3c,'requests':RequestMonitor['currentRequests']}),RequestMonitor['currentRequests']=0x0,RequestMonitor[_0x434172(0xf1)]=_0x4168bd);RequestMonitor[_0x434172(0x101)]++,RequestMonitor[_0x434172(0xc1)][_0x434172(0xff)]({'timestamp':Date[_0x434172(0xef)](),'statusCode':_0x5eead9['statusCode'],'path':_0x377b83[_0x434172(0xc9)],'method':_0x377b83[_0x434172(0xdd)]});const _0x33989b=Date['now']()-0x18*0x3c*0x3c*0x3e8;return RequestMonitor['httpCodesData']=RequestMonitor['httpCodesData'][_0x434172(0xc8)](_0x51122d=>_0x51122d[_0x434172(0xe8)]>_0x33989b),_0x29c8a0[_0x434172(0xf9)](_0x5eead9,_0x3f9816);},_0x2e251c();}static async['save'](){const _0x48b3c3=a2_0x7593a9;try{RequestMonitor[_0x48b3c3(0xf1)]!==Math[_0x48b3c3(0xd6)](Date['now']()/0x3e8/0x3c)&&(RequestMonitor[_0x48b3c3(0xc2)][_0x48b3c3(0xff)]({'timestamp':RequestMonitor['lastMinute']*0x3e8*0x3c,'requests':RequestMonitor[_0x48b3c3(0x101)]}),RequestMonitor[_0x48b3c3(0x101)]=0x0,RequestMonitor[_0x48b3c3(0xf1)]=Math[_0x48b3c3(0xd6)](Date['now']()/0x3e8/0x3c)),await fs[_0x48b3c3(0xce)](RequestMonitor['rpsStoragePath'],JSON[_0x48b3c3(0xd7)](RequestMonitor[_0x48b3c3(0xc2)],null,0x2)),await fs[_0x48b3c3(0xce)](RequestMonitor['httpCodesStoragePath'],JSON[_0x48b3c3(0xd7)](RequestMonitor[_0x48b3c3(0xc1)],null,0x2));}catch(_0x2158c0){console[_0x48b3c3(0xe2)](_0x48b3c3(0xfb),_0x2158c0);}}static async[a2_0x7593a9(0xd5)](){const _0x310d6a=a2_0x7593a9;setInterval(()=>RequestMonitor[_0x310d6a(0xe1)](),0x3c*0x3e8),setInterval(()=>{const _0x461f87=_0x310d6a;RequestMonitor[_0x461f87(0xe5)]()[_0x461f87(0xe7)](()=>{});},0x3c*0x3e8),RequestMonitor['getUsageRessourcesStatsAndSave']()[_0x310d6a(0xe7)](()=>{});}static async[a2_0x7593a9(0xe5)](){const _0xf8a46c=a2_0x7593a9,_0x46e1ac=osu[_0xf8a46c(0xf8)],_0x562a9c=osu[_0xf8a46c(0xec)],_0x5ba546=osu[_0xf8a46c(0xfa)],_0x1e118f={'total':{'inputMb':0x0,'outputMb':0x0}};try{const _0x1f36d8=await _0x5ba546[_0xf8a46c(0xd1)]();_0x1e118f[_0xf8a46c(0xd8)][_0xf8a46c(0xc5)]=_0x1f36d8[_0xf8a46c(0xd8)][_0xf8a46c(0xc5)],_0x1e118f['total'][_0xf8a46c(0xc4)]=_0x1f36d8[_0xf8a46c(0xd8)]['outputMb'];}catch(_0x57f87e){}let _0x41b062=0x0;try{_0x41b062=await _0x46e1ac[_0xf8a46c(0xcf)]();}catch(_0xb60eef){console[_0xf8a46c(0xd2)]('Error\x20getting\x20CPU\x20usage:',_0xb60eef);}const _0x710f8e={'usedMemMb':0x0};try{const _0x3aaa20=await _0x562a9c[_0xf8a46c(0x106)]();_0x710f8e[_0xf8a46c(0xca)]=_0x3aaa20['usedMemMb'];}catch(_0x1b57f2){console[_0xf8a46c(0xd2)](_0xf8a46c(0xed),_0x1b57f2);}const _0x30ad72=new Date()[_0xf8a46c(0xd9)]()[_0xf8a46c(0xcd)]()['padStart'](0x2,'0')+':'+new Date()[_0xf8a46c(0xf0)]()[_0xf8a46c(0xcd)]()['padStart'](0x2,'0');RequestMonitor['ressourcesUsageStats']['cpu']=RequestMonitor[_0xf8a46c(0xcb)][_0xf8a46c(0xf8)][_0xf8a46c(0x100)](-0x3c)[_0xf8a46c(0xc8)](_0x1dd035=>_0x1dd035[_0xf8a46c(0xc3)]!==_0x30ad72),RequestMonitor[_0xf8a46c(0xcb)]['memory']=RequestMonitor['ressourcesUsageStats'][_0xf8a46c(0xdf)][_0xf8a46c(0x100)](-0x3c)[_0xf8a46c(0xc8)](_0x4dda19=>_0x4dda19[_0xf8a46c(0xc3)]!==_0x30ad72),RequestMonitor[_0xf8a46c(0xcb)]['network']=RequestMonitor[_0xf8a46c(0xcb)]['network'][_0xf8a46c(0x100)](-0x3c)['filter'](_0x3d2166=>_0x3d2166[_0xf8a46c(0xc3)]!==_0x30ad72),RequestMonitor[_0xf8a46c(0xcb)]['cpu']['push']({'time':_0x30ad72,'usage':_0x41b062}),RequestMonitor[_0xf8a46c(0xcb)][_0xf8a46c(0xdf)][_0xf8a46c(0xff)]({'time':_0x30ad72,'usage':(_0x710f8e[_0xf8a46c(0xca)]/0x3e8)[_0xf8a46c(0xe6)](0x2)}),RequestMonitor['ressourcesUsageStats'][_0xf8a46c(0xee)][_0xf8a46c(0xff)]({'time':_0x30ad72,'usage':{'in':_0x1e118f[_0xf8a46c(0xd8)]?.[_0xf8a46c(0xc5)]??0x0,'out':_0x1e118f[_0xf8a46c(0xd8)]?.[_0xf8a46c(0xc4)]??0x0}});try{await fs[_0xf8a46c(0xce)](RequestMonitor[_0xf8a46c(0xfc)],JSON[_0xf8a46c(0xd7)](RequestMonitor[_0xf8a46c(0xcb)],null,0x2));}catch(_0x1fce56){console[_0xf8a46c(0xe2)]('Error\x20saving\x20monitoring\x20data:',_0x1fce56);}}static[a2_0x7593a9(0xe9)](){const _0x4e830f=a2_0x7593a9,_0x22c4e2=Date[_0x4e830f(0xef)](),_0x1e0c97=_0x22c4e2-0x3c*0x3c*0x3e8,_0x1da209=_0x22c4e2-0x18*0x3c*0x3c*0x3e8,_0x2ea60b=RequestMonitor[_0x4e830f(0xc2)][_0x4e830f(0xc8)](_0x5a89d2=>_0x5a89d2[_0x4e830f(0xe8)]>_0x1e0c97),_0x49d55e={'total':RequestMonitor[_0x4e830f(0xc1)]['length'],'byCodes':{},'byPath':{}};return RequestMonitor[_0x4e830f(0xc1)]['forEach'](_0x57c3b6=>{const _0xbdf061=_0x4e830f;_0x49d55e['byCodes'][_0x57c3b6[_0xbdf061(0xea)]]=(_0x49d55e[_0xbdf061(0xf5)][_0x57c3b6[_0xbdf061(0xea)]]||0x0)+0x1;const _0x39b8d4=_0x57c3b6[_0xbdf061(0xdd)]+'\x20'+_0x57c3b6[_0xbdf061(0xc9)];!_0x49d55e[_0xbdf061(0x104)][_0x39b8d4]&&(_0x49d55e[_0xbdf061(0x104)][_0x39b8d4]={'total':0x0,'codes':{}}),_0x49d55e['byPath'][_0x39b8d4]['total']++,_0x49d55e[_0xbdf061(0x104)][_0x39b8d4][_0xbdf061(0xe0)][_0x57c3b6[_0xbdf061(0xea)]]=(_0x49d55e[_0xbdf061(0x104)][_0x39b8d4][_0xbdf061(0xe0)][_0x57c3b6[_0xbdf061(0xea)]]||0x0)+0x1;}),{'rps':_0x2ea60b,'httpCodes':_0x49d55e,'ressourcesUsageStats':RequestMonitor[_0x4e830f(0xcb)]};}}RequestMonitor[a2_0x7593a9(0xe3)]()[a2_0x7593a9(0xe7)](()=>{}),RequestMonitor[a2_0x7593a9(0xd5)]();function a2_0x2fa2(_0x232fef,_0x240117){const _0x47f259=a2_0x47f2();return a2_0x2fa2=function(_0x2fa2e6,_0x51f850){_0x2fa2e6=_0x2fa2e6-0xc1;let _0x34b35e=_0x47f259[_0x2fa2e6];return _0x34b35e;},a2_0x2fa2(_0x232fef,_0x240117);}const counter=RequestMonitor;module[a2_0x7593a9(0x108)]=counter;