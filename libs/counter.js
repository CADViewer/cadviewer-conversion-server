function a1_0x1f28(){const _0x46a4f7=['Request\x20monitor\x20initialized.','writeFile','now','/metrics','getStats','Request\x20monitor\x20middleware','cpu','padStart','log','1646718tViRnn','length','inOut','cadviewer/settings/http-codes-24h.json','42TcwqHn','includes','=======>','usedMemMb','path','parse','byCodes','forEach','httpCodesStoragePath','end','rpsData','slice','298265zvPRCo','308HifnIO','byPath','getUsageRessourcesStatsAndSave','rpsStoragePath','currentRequests','Error\x20saving\x20monitoring\x20data:','getMinutes','apply','Error\x20getting\x20memory\x20usage:','error','push','mem','getHours','outputMb','network','32931zqrxJY','inputMb','save','timestamp','utf8','stringify','usage','ressourcesUsageStats','42516kdAOXd','total','1070KAViDq','exports','info','time','ressourcesUsageStatsPath','5HUpAvI','statusCode','Initializing\x20request\x20monitor...','promises','filter','readFile','memory','Error\x20getting\x20CPU\x20usage:','codes','then','httpCodesData','method','495174TYSrdf','floor','toString','lastMinute','69880uThbRE','init','417053bUsYIX','middleware'];a1_0x1f28=function(){return _0x46a4f7;};return a1_0x1f28();}function a1_0x4764(_0x21f6bb,_0x1d1dbc){const _0x1f28b7=a1_0x1f28();return a1_0x4764=function(_0x4764b5,_0x29f863){_0x4764b5=_0x4764b5-0x12d;let _0x4f4749=_0x1f28b7[_0x4764b5];return _0x4f4749;},a1_0x4764(_0x21f6bb,_0x1d1dbc);}const a1_0x3845f7=a1_0x4764;(function(_0x1434d9,_0x3b6ae6){const _0x3d494a=a1_0x4764,_0x3554d8=_0x1434d9();while(!![]){try{const _0x391a53=-parseInt(_0x3d494a(0x13e))/0x1+parseInt(_0x3d494a(0x138))/0x2+-parseInt(_0x3d494a(0x14d))/0x3*(-parseInt(_0x3d494a(0x171))/0x4)+-parseInt(_0x3d494a(0x178))/0x5*(-parseInt(_0x3d494a(0x149))/0x6)+parseInt(_0x3d494a(0x15a))/0x7*(-parseInt(_0x3d494a(0x13c))/0x8)+parseInt(_0x3d494a(0x169))/0x9*(parseInt(_0x3d494a(0x173))/0xa)+-parseInt(_0x3d494a(0x159))/0xb;if(_0x391a53===_0x3b6ae6)break;else _0x3554d8['push'](_0x3554d8['shift']());}catch(_0x264695){_0x3554d8['push'](_0x3554d8['shift']());}}}(a1_0x1f28,0x3917b));const fs=require('fs')[a1_0x3845f7(0x12f)],osu=require('node-os-utils');class RequestMonitor{static [a1_0x3845f7(0x15d)]='cadviewer/settings/requests-per-minute.json';static [a1_0x3845f7(0x155)]=a1_0x3845f7(0x14c);static [a1_0x3845f7(0x177)]='cadviewer/settings/ressources-usage-stats.json';static [a1_0x3845f7(0x157)]=[];static [a1_0x3845f7(0x136)]=[];static [a1_0x3845f7(0x170)]={};static [a1_0x3845f7(0x13b)]=Math[a1_0x3845f7(0x139)](Date[a1_0x3845f7(0x142)]()/0x3e8/0x3c);static ['currentRequests']=0x0;static async[a1_0x3845f7(0x13d)](){const _0x3532d1=a1_0x3845f7;console[_0x3532d1(0x148)](_0x3532d1(0x12e));try{const _0x2fd91f=await fs[_0x3532d1(0x131)](RequestMonitor[_0x3532d1(0x15d)],_0x3532d1(0x16d));RequestMonitor[_0x3532d1(0x157)]=JSON[_0x3532d1(0x152)](_0x2fd91f);}catch(_0x19a649){RequestMonitor[_0x3532d1(0x157)]=[];}try{const _0x356cf9=await fs['readFile'](RequestMonitor[_0x3532d1(0x155)],_0x3532d1(0x16d));RequestMonitor['httpCodesData']=JSON['parse'](_0x356cf9);}catch(_0x3b2656){RequestMonitor[_0x3532d1(0x136)]=[];}try{const _0xe49eaf=await fs['readFile'](RequestMonitor[_0x3532d1(0x177)],_0x3532d1(0x16d));RequestMonitor[_0x3532d1(0x170)]=JSON[_0x3532d1(0x152)](_0xe49eaf),!RequestMonitor[_0x3532d1(0x170)][_0x3532d1(0x146)]&&(RequestMonitor[_0x3532d1(0x170)][_0x3532d1(0x146)]=[]),!RequestMonitor[_0x3532d1(0x170)][_0x3532d1(0x132)]&&(RequestMonitor[_0x3532d1(0x170)][_0x3532d1(0x132)]=[]),!RequestMonitor[_0x3532d1(0x170)][_0x3532d1(0x168)]&&(RequestMonitor[_0x3532d1(0x170)][_0x3532d1(0x168)]=[]);}catch(_0xe155af){RequestMonitor[_0x3532d1(0x170)]={'cpu':[],'memory':[],'network':[]};}console[_0x3532d1(0x148)](_0x3532d1(0x140));}static[a1_0x3845f7(0x13f)](_0xa7e0b9,_0x77f2da,_0x314d1b){const _0x33a4e7=a1_0x3845f7;if(_0xa7e0b9['path'][_0x33a4e7(0x14e)](_0x33a4e7(0x143)))return _0x314d1b();console['log'](_0x33a4e7(0x145));let _0x6a3aa8=Date[_0x33a4e7(0x142)](),_0x4c3aca=Math[_0x33a4e7(0x139)](_0x6a3aa8/0x3e8/0x3c);console[_0x33a4e7(0x148)](_0x33a4e7(0x14f));const _0x59160f=_0x77f2da[_0x33a4e7(0x156)];_0x77f2da[_0x33a4e7(0x156)]=(..._0x62c766)=>{const _0x165cd2=_0x33a4e7;console['log'](_0x4c3aca,{'currentMinute':_0x4c3aca});_0x4c3aca>RequestMonitor[_0x165cd2(0x13b)]&&(RequestMonitor[_0x165cd2(0x157)][_0x165cd2(0x164)]({'timestamp':RequestMonitor[_0x165cd2(0x13b)]*0x3e8*0x3c,'requests':RequestMonitor[_0x165cd2(0x15e)]}),RequestMonitor[_0x165cd2(0x15e)]=0x0,RequestMonitor[_0x165cd2(0x13b)]=_0x4c3aca);RequestMonitor[_0x165cd2(0x15e)]++,RequestMonitor[_0x165cd2(0x136)][_0x165cd2(0x164)]({'timestamp':Date[_0x165cd2(0x142)](),'statusCode':_0x77f2da[_0x165cd2(0x12d)],'path':_0xa7e0b9[_0x165cd2(0x151)],'method':_0xa7e0b9[_0x165cd2(0x137)]});const _0x74bf25=Date['now']()-0x18*0x3c*0x3c*0x3e8;return RequestMonitor['httpCodesData']=RequestMonitor['httpCodesData'][_0x165cd2(0x130)](_0x538ddf=>_0x538ddf[_0x165cd2(0x16c)]>_0x74bf25),_0x59160f[_0x165cd2(0x161)](_0x77f2da,_0x62c766);},_0x314d1b();}static async[a1_0x3845f7(0x16b)](){const _0x4f698d=a1_0x3845f7;try{RequestMonitor['lastMinute']!==Math['floor'](Date[_0x4f698d(0x142)]()/0x3e8/0x3c)&&(RequestMonitor['rpsData'][_0x4f698d(0x164)]({'timestamp':RequestMonitor[_0x4f698d(0x13b)]*0x3e8*0x3c,'requests':RequestMonitor[_0x4f698d(0x15e)]}),RequestMonitor[_0x4f698d(0x15e)]=0x0,RequestMonitor[_0x4f698d(0x13b)]=Math['floor'](Date[_0x4f698d(0x142)]()/0x3e8/0x3c)),await fs['writeFile'](RequestMonitor[_0x4f698d(0x15d)],JSON[_0x4f698d(0x16e)](RequestMonitor[_0x4f698d(0x157)],null,0x2)),await fs[_0x4f698d(0x141)](RequestMonitor['httpCodesStoragePath'],JSON[_0x4f698d(0x16e)](RequestMonitor[_0x4f698d(0x136)],null,0x2));}catch(_0x1a1907){console[_0x4f698d(0x163)](_0x4f698d(0x15f),_0x1a1907);}}static async['startPeriodicSave'](){const _0x5d30d3=a1_0x3845f7;setInterval(()=>RequestMonitor[_0x5d30d3(0x16b)](),0x3c*0x3e8),setInterval(()=>{const _0x396ec2=_0x5d30d3;RequestMonitor[_0x396ec2(0x15c)]()['then'](()=>{});},0x3c*0x3e8),RequestMonitor[_0x5d30d3(0x15c)]()[_0x5d30d3(0x135)](()=>{});}static async['getUsageRessourcesStatsAndSave'](){const _0x18b638=a1_0x3845f7,_0x2c75a0=osu[_0x18b638(0x146)],_0x2eadf3=osu[_0x18b638(0x165)],_0x7cc78c=osu['netstat'],_0x454051={'total':{'inputMb':0x0,'outputMb':0x0}};try{const _0x437d19=await _0x7cc78c[_0x18b638(0x14b)]();_0x454051['total']['inputMb']=_0x437d19['total'][_0x18b638(0x16a)],_0x454051['total'][_0x18b638(0x167)]=_0x437d19[_0x18b638(0x172)][_0x18b638(0x167)];}catch(_0x1e2724){}let _0x334489=0x0;try{_0x334489=await _0x2c75a0[_0x18b638(0x16f)]();}catch(_0xf31b5b){console[_0x18b638(0x148)](_0x18b638(0x133),_0xf31b5b);}const _0x24a593={'usedMemMb':0x0};try{const _0x59f0bf=await _0x2eadf3[_0x18b638(0x175)]();_0x24a593['usedMemMb']=_0x59f0bf[_0x18b638(0x150)];}catch(_0x6c236a){console['log'](_0x18b638(0x162),_0x6c236a);}const _0x3087ce=new Date()[_0x18b638(0x166)]()[_0x18b638(0x13a)]()[_0x18b638(0x147)](0x2,'0')+':'+new Date()[_0x18b638(0x160)]()['toString']()['padStart'](0x2,'0');RequestMonitor[_0x18b638(0x170)][_0x18b638(0x146)]=RequestMonitor[_0x18b638(0x170)][_0x18b638(0x146)][_0x18b638(0x158)](-0x3c)['filter'](_0x4de97f=>_0x4de97f[_0x18b638(0x176)]!==_0x3087ce),RequestMonitor[_0x18b638(0x170)][_0x18b638(0x132)]=RequestMonitor[_0x18b638(0x170)][_0x18b638(0x132)]['slice'](-0x3c)[_0x18b638(0x130)](_0x1c3254=>_0x1c3254['time']!==_0x3087ce),RequestMonitor['ressourcesUsageStats'][_0x18b638(0x168)]=RequestMonitor[_0x18b638(0x170)][_0x18b638(0x168)][_0x18b638(0x158)](-0x3c)[_0x18b638(0x130)](_0x1d122e=>_0x1d122e[_0x18b638(0x176)]!==_0x3087ce),RequestMonitor[_0x18b638(0x170)]['cpu'][_0x18b638(0x164)]({'time':_0x3087ce,'usage':_0x334489}),RequestMonitor[_0x18b638(0x170)]['memory'][_0x18b638(0x164)]({'time':_0x3087ce,'usage':(_0x24a593[_0x18b638(0x150)]/0x3e8)['toFixed'](0x2)}),RequestMonitor['ressourcesUsageStats'][_0x18b638(0x168)][_0x18b638(0x164)]({'time':_0x3087ce,'usage':{'in':_0x454051[_0x18b638(0x172)]?.['inputMb']??0x0,'out':_0x454051[_0x18b638(0x172)]?.[_0x18b638(0x167)]??0x0}});try{await fs['writeFile'](RequestMonitor[_0x18b638(0x177)],JSON[_0x18b638(0x16e)](RequestMonitor[_0x18b638(0x170)],null,0x2));}catch(_0x4692f0){console['error'](_0x18b638(0x15f),_0x4692f0);}}static[a1_0x3845f7(0x144)](){const _0x6a40c8=a1_0x3845f7,_0x21a964=Date[_0x6a40c8(0x142)](),_0x535e86=_0x21a964-0x3c*0x3c*0x3e8,_0x2abf22=_0x21a964-0x18*0x3c*0x3c*0x3e8,_0x4e2292=RequestMonitor[_0x6a40c8(0x157)][_0x6a40c8(0x130)](_0x1a67a0=>_0x1a67a0[_0x6a40c8(0x16c)]>_0x535e86),_0xdc01d6={'total':RequestMonitor['httpCodesData'][_0x6a40c8(0x14a)],'byCodes':{},'byPath':{}};return RequestMonitor[_0x6a40c8(0x136)][_0x6a40c8(0x154)](_0xc9aa0=>{const _0x51ab3c=_0x6a40c8;_0xdc01d6[_0x51ab3c(0x153)][_0xc9aa0[_0x51ab3c(0x12d)]]=(_0xdc01d6[_0x51ab3c(0x153)][_0xc9aa0['statusCode']]||0x0)+0x1;const _0x4d2d48=_0xc9aa0[_0x51ab3c(0x137)]+'\x20'+_0xc9aa0['path'];!_0xdc01d6['byPath'][_0x4d2d48]&&(_0xdc01d6[_0x51ab3c(0x15b)][_0x4d2d48]={'total':0x0,'codes':{}}),_0xdc01d6[_0x51ab3c(0x15b)][_0x4d2d48][_0x51ab3c(0x172)]++,_0xdc01d6['byPath'][_0x4d2d48][_0x51ab3c(0x134)][_0xc9aa0[_0x51ab3c(0x12d)]]=(_0xdc01d6[_0x51ab3c(0x15b)][_0x4d2d48][_0x51ab3c(0x134)][_0xc9aa0['statusCode']]||0x0)+0x1;}),{'rps':_0x4e2292,'httpCodes':_0xdc01d6,'ressourcesUsageStats':RequestMonitor[_0x6a40c8(0x170)]};}}RequestMonitor['init']()[a1_0x3845f7(0x135)](()=>{}),RequestMonitor['startPeriodicSave']();const counter=RequestMonitor;module[a1_0x3845f7(0x174)]=counter;