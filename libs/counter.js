const a1_0x3f47d8=a1_0x178d;(function(_0x1d7517,_0xbe075c){const _0x4db6e=a1_0x178d,_0x151bf=_0x1d7517();while(!![]){try{const _0x5ebc6e=-parseInt(_0x4db6e(0xae))/0x1*(-parseInt(_0x4db6e(0xb0))/0x2)+parseInt(_0x4db6e(0xb4))/0x3+-parseInt(_0x4db6e(0xd4))/0x4*(parseInt(_0x4db6e(0x90))/0x5)+parseInt(_0x4db6e(0xd2))/0x6+-parseInt(_0x4db6e(0xb5))/0x7+parseInt(_0x4db6e(0x8f))/0x8*(-parseInt(_0x4db6e(0xbd))/0x9)+-parseInt(_0x4db6e(0xc0))/0xa*(-parseInt(_0x4db6e(0xa6))/0xb);if(_0x5ebc6e===_0xbe075c)break;else _0x151bf['push'](_0x151bf['shift']());}catch(_0x1cc79b){_0x151bf['push'](_0x151bf['shift']());}}}(a1_0x12ef,0x855eb));const fs=require('fs')[a1_0x3f47d8(0xbe)],osu=require(a1_0x3f47d8(0xb1));class RequestMonitor{static ['rpsStoragePath']=a1_0x3f47d8(0xd9);static [a1_0x3f47d8(0xcc)]=a1_0x3f47d8(0xa1);static [a1_0x3f47d8(0xc8)]=a1_0x3f47d8(0xa8);static [a1_0x3f47d8(0xa5)]=[];static [a1_0x3f47d8(0x92)]=[];static ['ressourcesUsageStats']={};static [a1_0x3f47d8(0xcf)]=Math[a1_0x3f47d8(0xd8)](Date[a1_0x3f47d8(0xca)]()/0x3e8/0x3c);static ['currentRequests']=0x0;static async[a1_0x3f47d8(0xd5)](){const _0x1032bd=a1_0x3f47d8;console['log']('Initializing\x20request\x20monitor...');try{const _0x58ec18=await fs[_0x1032bd(0x9a)](RequestMonitor[_0x1032bd(0xba)],_0x1032bd(0xc5));RequestMonitor[_0x1032bd(0xa5)]=JSON[_0x1032bd(0xab)](_0x58ec18);}catch(_0x253c3e){RequestMonitor[_0x1032bd(0xa5)]=[];}try{const _0xbd24cf=await fs[_0x1032bd(0x9a)](RequestMonitor[_0x1032bd(0xcc)],_0x1032bd(0xc5));RequestMonitor[_0x1032bd(0x92)]=JSON[_0x1032bd(0xab)](_0xbd24cf);}catch(_0x2d72bb){RequestMonitor[_0x1032bd(0x92)]=[];}try{const _0x383a7c=await fs[_0x1032bd(0x9a)](RequestMonitor['ressourcesUsageStatsPath'],_0x1032bd(0xc5));RequestMonitor[_0x1032bd(0xad)]=JSON['parse'](_0x383a7c),!RequestMonitor[_0x1032bd(0xad)][_0x1032bd(0xc2)]&&(RequestMonitor[_0x1032bd(0xad)][_0x1032bd(0xc2)]=[]),!RequestMonitor[_0x1032bd(0xad)][_0x1032bd(0xd7)]&&(RequestMonitor[_0x1032bd(0xad)][_0x1032bd(0xd7)]=[]),!RequestMonitor[_0x1032bd(0xad)][_0x1032bd(0x8e)]&&(RequestMonitor[_0x1032bd(0xad)]['network']=[]);}catch(_0x2bf3a2){RequestMonitor[_0x1032bd(0xad)]={'cpu':[],'memory':[],'network':[]};}console[_0x1032bd(0xa9)](_0x1032bd(0xb3));}static[a1_0x3f47d8(0xbf)](_0x215419,_0x4e1749,_0x1c0481){const _0x235dee=a1_0x3f47d8;if(_0x215419[_0x235dee(0xb9)][_0x235dee(0xcd)](_0x235dee(0xb2)))return _0x1c0481();console[_0x235dee(0xa9)](_0x235dee(0x9c));let _0x32e8da=Date[_0x235dee(0xca)](),_0x3d1ab8=Math[_0x235dee(0xd8)](_0x32e8da/0x3e8/0x3c);console[_0x235dee(0xa9)](_0x235dee(0x9f));const _0x8698b3=_0x4e1749[_0x235dee(0xcb)];_0x4e1749[_0x235dee(0xcb)]=(..._0x936a5d)=>{const _0x57cdd0=_0x235dee;console['log'](_0x3d1ab8,{'currentMinute':_0x3d1ab8});_0x3d1ab8>RequestMonitor[_0x57cdd0(0xcf)]&&(RequestMonitor[_0x57cdd0(0xa5)]['push']({'timestamp':RequestMonitor[_0x57cdd0(0xcf)]*0x3e8*0x3c,'requests':RequestMonitor[_0x57cdd0(0xa2)]}),RequestMonitor[_0x57cdd0(0xa2)]=0x0,RequestMonitor[_0x57cdd0(0xcf)]=_0x3d1ab8);RequestMonitor[_0x57cdd0(0xa2)]++,RequestMonitor[_0x57cdd0(0x92)][_0x57cdd0(0x91)]({'timestamp':Date[_0x57cdd0(0xca)](),'statusCode':_0x4e1749[_0x57cdd0(0xc3)],'path':_0x215419[_0x57cdd0(0xb9)],'method':_0x215419[_0x57cdd0(0xc6)]});const _0x4b2c63=Date[_0x57cdd0(0xca)]()-0x18*0x3c*0x3c*0x3e8;return RequestMonitor['httpCodesData']=RequestMonitor['httpCodesData'][_0x57cdd0(0x97)](_0x5e72c0=>_0x5e72c0['timestamp']>_0x4b2c63),_0x8698b3['apply'](_0x4e1749,_0x936a5d);},_0x1c0481();}static async[a1_0x3f47d8(0xa0)](){const _0x131f08=a1_0x3f47d8;try{RequestMonitor[_0x131f08(0xcf)]!==Math[_0x131f08(0xd8)](Date[_0x131f08(0xca)]()/0x3e8/0x3c)&&(RequestMonitor[_0x131f08(0xa5)]['push']({'timestamp':RequestMonitor['lastMinute']*0x3e8*0x3c,'requests':RequestMonitor['currentRequests']}),RequestMonitor[_0x131f08(0xa2)]=0x0,RequestMonitor[_0x131f08(0xcf)]=Math[_0x131f08(0xd8)](Date[_0x131f08(0xca)]()/0x3e8/0x3c)),await fs['writeFile'](RequestMonitor[_0x131f08(0xba)],JSON[_0x131f08(0xaa)](RequestMonitor[_0x131f08(0xa5)],null,0x2)),await fs['writeFile'](RequestMonitor['httpCodesStoragePath'],JSON[_0x131f08(0xaa)](RequestMonitor[_0x131f08(0x92)],null,0x2));}catch(_0xc628d2){console[_0x131f08(0xc7)](_0x131f08(0xbc),_0xc628d2);}}static async[a1_0x3f47d8(0xbb)](){const _0x56c810=a1_0x3f47d8;setInterval(()=>RequestMonitor[_0x56c810(0xa0)](),0x3c*0x3e8),setInterval(()=>{const _0x1077a3=_0x56c810;RequestMonitor[_0x1077a3(0xd6)]()[_0x1077a3(0xce)](()=>{});},0x3c*0x3e8),RequestMonitor[_0x56c810(0xd6)]()['then'](()=>{});}static async[a1_0x3f47d8(0xd6)](){const _0x158bea=a1_0x3f47d8,_0x24aad2=osu[_0x158bea(0xc2)],_0x424ea1=osu[_0x158bea(0x95)],_0x1bba37=osu[_0x158bea(0xaf)],_0x3643d7={'total':{'inputMb':0x0,'outputMb':0x0}};try{const _0x2fbdf3=await _0x1bba37['inOut']();_0x3643d7['total'][_0x158bea(0x96)]=_0x2fbdf3['total']['inputMb'],_0x3643d7['total'][_0x158bea(0x9b)]=_0x2fbdf3['total'][_0x158bea(0x9b)];}catch(_0xf5e304){}let _0x4a7f9f=0x0;try{_0x4a7f9f=await _0x24aad2[_0x158bea(0xc9)]();}catch(_0x534a32){console['log']('Error\x20getting\x20CPU\x20usage:',_0x534a32);}const _0x48649d={'usedMemMb':0x0};try{const _0xc4726c=await _0x424ea1[_0x158bea(0x98)]();_0x48649d[_0x158bea(0xa7)]=_0xc4726c[_0x158bea(0xa7)];}catch(_0x39b7b0){console[_0x158bea(0xa9)](_0x158bea(0x93),_0x39b7b0);}const _0x54e790=new Date()['getHours']()[_0x158bea(0x94)]()[_0x158bea(0x9e)](0x2,'0')+':'+new Date()[_0x158bea(0xc1)]()[_0x158bea(0x94)]()[_0x158bea(0x9e)](0x2,'0');RequestMonitor[_0x158bea(0xad)][_0x158bea(0xc2)]=RequestMonitor[_0x158bea(0xad)][_0x158bea(0xc2)][_0x158bea(0x9d)](-0x3c)[_0x158bea(0x97)](_0x2f002e=>_0x2f002e[_0x158bea(0xd1)]!==_0x54e790),RequestMonitor['ressourcesUsageStats'][_0x158bea(0xd7)]=RequestMonitor['ressourcesUsageStats']['memory'][_0x158bea(0x9d)](-0x3c)[_0x158bea(0x97)](_0x244b64=>_0x244b64['time']!==_0x54e790),RequestMonitor[_0x158bea(0xad)][_0x158bea(0x8e)]=RequestMonitor[_0x158bea(0xad)][_0x158bea(0x8e)][_0x158bea(0x9d)](-0x3c)['filter'](_0x28adb1=>_0x28adb1[_0x158bea(0xd1)]!==_0x54e790),RequestMonitor[_0x158bea(0xad)][_0x158bea(0xc2)][_0x158bea(0x91)]({'time':_0x54e790,'usage':_0x4a7f9f}),RequestMonitor[_0x158bea(0xad)][_0x158bea(0xd7)]['push']({'time':_0x54e790,'usage':(_0x48649d['usedMemMb']/0x3e8)[_0x158bea(0xa3)](0x2)}),RequestMonitor[_0x158bea(0xad)][_0x158bea(0x8e)][_0x158bea(0x91)]({'time':_0x54e790,'usage':{'in':_0x3643d7[_0x158bea(0xb7)]?.[_0x158bea(0x96)]??0x0,'out':_0x3643d7[_0x158bea(0xb7)]?.[_0x158bea(0x9b)]??0x0}});try{await fs[_0x158bea(0x99)](RequestMonitor[_0x158bea(0xc8)],JSON['stringify'](RequestMonitor[_0x158bea(0xad)],null,0x2));}catch(_0x42deef){console[_0x158bea(0xc7)](_0x158bea(0xbc),_0x42deef);}}static['getStats'](){const _0x200d48=a1_0x3f47d8,_0x4d4aee=Date[_0x200d48(0xca)](),_0x32662c=_0x4d4aee-0x3c*0x3c*0x3e8,_0x258392=_0x4d4aee-0x18*0x3c*0x3c*0x3e8,_0x2accb2=RequestMonitor[_0x200d48(0xa5)]['filter'](_0x5fb9b2=>_0x5fb9b2[_0x200d48(0xc4)]>_0x32662c),_0x10221a={'total':RequestMonitor['httpCodesData'][_0x200d48(0xb6)],'byCodes':{},'byPath':{}};return RequestMonitor[_0x200d48(0x92)][_0x200d48(0xd0)](_0x30e9fb=>{const _0x520365=_0x200d48;_0x10221a['byCodes'][_0x30e9fb[_0x520365(0xc3)]]=(_0x10221a[_0x520365(0xac)][_0x30e9fb[_0x520365(0xc3)]]||0x0)+0x1;const _0x284b57=_0x30e9fb[_0x520365(0xc6)]+'\x20'+_0x30e9fb[_0x520365(0xb9)];!_0x10221a[_0x520365(0xd3)][_0x284b57]&&(_0x10221a[_0x520365(0xd3)][_0x284b57]={'total':0x0,'codes':{}}),_0x10221a['byPath'][_0x284b57][_0x520365(0xb7)]++,_0x10221a[_0x520365(0xd3)][_0x284b57][_0x520365(0xb8)][_0x30e9fb[_0x520365(0xc3)]]=(_0x10221a['byPath'][_0x284b57][_0x520365(0xb8)][_0x30e9fb[_0x520365(0xc3)]]||0x0)+0x1;}),{'rps':_0x2accb2,'httpCodes':_0x10221a,'ressourcesUsageStats':RequestMonitor['ressourcesUsageStats']};}}RequestMonitor[a1_0x3f47d8(0xd5)]()['then'](()=>{}),RequestMonitor[a1_0x3f47d8(0xbb)]();function a1_0x12ef(){const _0x2e01a1=['utf8','method','error','ressourcesUsageStatsPath','usage','now','end','httpCodesStoragePath','includes','then','lastMinute','forEach','time','3809820KkLCXI','byPath','184tsWbPE','init','getUsageRessourcesStatsAndSave','memory','floor','cadviewer/settings/requests-per-minute.json','network','16ZtDCjl','57110ZtBWhu','push','httpCodesData','Error\x20getting\x20memory\x20usage:','toString','mem','inputMb','filter','info','writeFile','readFile','outputMb','Request\x20monitor\x20middleware','slice','padStart','=======>','save','cadviewer/settings/http-codes-24h.json','currentRequests','toFixed','exports','rpsData','99FCDjDF','usedMemMb','cadviewer/settings/ressources-usage-stats.json','log','stringify','parse','byCodes','ressourcesUsageStats','279701JThsMs','netstat','6gyIFek','node-os-utils','/metrics','Request\x20monitor\x20initialized.','356370IQiOWz','1062313ChemmH','length','total','codes','path','rpsStoragePath','startPeriodicSave','Error\x20saving\x20monitoring\x20data:','3406554ROHGbg','promises','middleware','430670cFEpdZ','getMinutes','cpu','statusCode','timestamp'];a1_0x12ef=function(){return _0x2e01a1;};return a1_0x12ef();}const counter=RequestMonitor;function a1_0x178d(_0x2cf476,_0xa38209){const _0x12ef0f=a1_0x12ef();return a1_0x178d=function(_0x178d51,_0x3d1b72){_0x178d51=_0x178d51-0x8e;let _0x2121e2=_0x12ef0f[_0x178d51];return _0x2121e2;},a1_0x178d(_0x2cf476,_0xa38209);}module[a1_0x3f47d8(0xa4)]=counter;