const a1_0x122c18=a1_0x76a8;(function(_0x267717,_0x4f344b){const _0x443a9a=a1_0x76a8,_0x4bc84a=_0x267717();while(!![]){try{const _0x261725=-parseInt(_0x443a9a(0x13c))/0x1*(-parseInt(_0x443a9a(0x150))/0x2)+-parseInt(_0x443a9a(0x164))/0x3*(-parseInt(_0x443a9a(0x121))/0x4)+-parseInt(_0x443a9a(0x160))/0x5+parseInt(_0x443a9a(0x153))/0x6+parseInt(_0x443a9a(0x166))/0x7*(parseInt(_0x443a9a(0x14b))/0x8)+parseInt(_0x443a9a(0x133))/0x9*(-parseInt(_0x443a9a(0x148))/0xa)+parseInt(_0x443a9a(0x14e))/0xb*(-parseInt(_0x443a9a(0x15a))/0xc);if(_0x261725===_0x4f344b)break;else _0x4bc84a['push'](_0x4bc84a['shift']());}catch(_0x10284b){_0x4bc84a['push'](_0x4bc84a['shift']());}}}(a1_0x43a0,0x8af96));function a1_0x43a0(){const _0x4240e4=['Error\x20saving\x20monitoring\x20data:','httpCodesData','671CONEek','mem','134770BYxMOX','apply','cadviewer/settings/http-codes-24h.json','3114738dHtnPY','now','method','end','ressourcesUsageStats','writeFile','cadviewer/settings/requests-per-minute.json','137892UhEbJj','usage','forEach','currentRequests','usedMemMb','utf8','2186145SypboJ','toString','Initializing\x20request\x20monitor...','getUsageRessourcesStatsAndSave','2725515VQuuwu','cadviewer/settings/ressources-usage-stats.json','156443sXfoTI','timestamp','getStats','readFile','parse','network','statusCode','4vcDGIz','rpsStoragePath','byCodes','exports','getHours','path','netstat','codes','Error\x20getting\x20CPU\x20usage:','time','filter','memory','padStart','startPeriodicSave','node-os-utils','stringify','log','Request\x20monitor\x20middleware','113742mXGdmC','error','save','lastMinute','init','promises','total','byPath','inputMb','6TVETJv','getMinutes','slice','outputMb','then','inOut','info','cpu','rpsData','=======>','floor','push','240xgmHXD','/metrics','middleware','64KrEkhr'];a1_0x43a0=function(){return _0x4240e4;};return a1_0x43a0();}function a1_0x76a8(_0x57ae21,_0x36338b){const _0x43a0cf=a1_0x43a0();return a1_0x76a8=function(_0x76a8f7,_0x408460){_0x76a8f7=_0x76a8f7-0x11b;let _0x4652e7=_0x43a0cf[_0x76a8f7];return _0x4652e7;},a1_0x76a8(_0x57ae21,_0x36338b);}const fs=require('fs')[a1_0x122c18(0x138)],osu=require(a1_0x122c18(0x12f));class RequestMonitor{static ['rpsStoragePath']=a1_0x122c18(0x159);static ['httpCodesStoragePath']=a1_0x122c18(0x152);static ['ressourcesUsageStatsPath']=a1_0x122c18(0x165);static [a1_0x122c18(0x144)]=[];static [a1_0x122c18(0x14d)]=[];static [a1_0x122c18(0x157)]={};static [a1_0x122c18(0x136)]=Math['floor'](Date[a1_0x122c18(0x154)]()/0x3e8/0x3c);static [a1_0x122c18(0x15d)]=0x0;static async[a1_0x122c18(0x137)](){const _0x719377=a1_0x122c18;console[_0x719377(0x131)](_0x719377(0x162));try{const _0x35f099=await fs[_0x719377(0x11d)](RequestMonitor[_0x719377(0x122)],'utf8');RequestMonitor['rpsData']=JSON[_0x719377(0x11e)](_0x35f099);}catch(_0x24e795){RequestMonitor[_0x719377(0x144)]=[];}try{const _0x1c141a=await fs[_0x719377(0x11d)](RequestMonitor['httpCodesStoragePath'],_0x719377(0x15f));RequestMonitor['httpCodesData']=JSON[_0x719377(0x11e)](_0x1c141a);}catch(_0x479cb7){RequestMonitor[_0x719377(0x14d)]=[];}try{const _0x3aac3b=await fs[_0x719377(0x11d)](RequestMonitor['ressourcesUsageStatsPath'],_0x719377(0x15f));RequestMonitor[_0x719377(0x157)]=JSON[_0x719377(0x11e)](_0x3aac3b),!RequestMonitor[_0x719377(0x157)][_0x719377(0x143)]&&(RequestMonitor[_0x719377(0x157)][_0x719377(0x143)]=[]),!RequestMonitor[_0x719377(0x157)][_0x719377(0x12c)]&&(RequestMonitor[_0x719377(0x157)][_0x719377(0x12c)]=[]),!RequestMonitor['ressourcesUsageStats'][_0x719377(0x11f)]&&(RequestMonitor[_0x719377(0x157)][_0x719377(0x11f)]=[]);}catch(_0x596342){RequestMonitor[_0x719377(0x157)]={'cpu':[],'memory':[],'network':[]};}console[_0x719377(0x131)]('Request\x20monitor\x20initialized.');}static[a1_0x122c18(0x14a)](_0x2809b0,_0x2345cd,_0x42f808){const _0x28384b=a1_0x122c18;if(_0x2809b0['path']['includes'](_0x28384b(0x149)))return _0x42f808();console[_0x28384b(0x131)](_0x28384b(0x132));let _0x50df10=Date[_0x28384b(0x154)](),_0x515a34=Math[_0x28384b(0x146)](_0x50df10/0x3e8/0x3c);console['log'](_0x28384b(0x145));const _0x5350e8=_0x2345cd[_0x28384b(0x156)];_0x2345cd['end']=(..._0x488d5f)=>{const _0x4fa1d7=_0x28384b;console[_0x4fa1d7(0x131)](_0x515a34,{'currentMinute':_0x515a34});_0x515a34>RequestMonitor[_0x4fa1d7(0x136)]&&(RequestMonitor[_0x4fa1d7(0x144)]['push']({'timestamp':RequestMonitor[_0x4fa1d7(0x136)]*0x3e8*0x3c,'requests':RequestMonitor[_0x4fa1d7(0x15d)]}),RequestMonitor[_0x4fa1d7(0x15d)]=0x0,RequestMonitor[_0x4fa1d7(0x136)]=_0x515a34);RequestMonitor[_0x4fa1d7(0x15d)]++,RequestMonitor[_0x4fa1d7(0x14d)][_0x4fa1d7(0x147)]({'timestamp':Date[_0x4fa1d7(0x154)](),'statusCode':_0x2345cd[_0x4fa1d7(0x120)],'path':_0x2809b0['path'],'method':_0x2809b0['method']});const _0x35db58=Date[_0x4fa1d7(0x154)]()-0x18*0x3c*0x3c*0x3e8;return RequestMonitor['httpCodesData']=RequestMonitor[_0x4fa1d7(0x14d)]['filter'](_0x1d0d10=>_0x1d0d10[_0x4fa1d7(0x11b)]>_0x35db58),_0x5350e8[_0x4fa1d7(0x151)](_0x2345cd,_0x488d5f);},_0x42f808();}static async[a1_0x122c18(0x135)](){const _0x18758c=a1_0x122c18;try{RequestMonitor['lastMinute']!==Math[_0x18758c(0x146)](Date[_0x18758c(0x154)]()/0x3e8/0x3c)&&(RequestMonitor[_0x18758c(0x144)]['push']({'timestamp':RequestMonitor[_0x18758c(0x136)]*0x3e8*0x3c,'requests':RequestMonitor[_0x18758c(0x15d)]}),RequestMonitor[_0x18758c(0x15d)]=0x0,RequestMonitor['lastMinute']=Math[_0x18758c(0x146)](Date['now']()/0x3e8/0x3c)),await fs[_0x18758c(0x158)](RequestMonitor[_0x18758c(0x122)],JSON['stringify'](RequestMonitor[_0x18758c(0x144)],null,0x2)),await fs[_0x18758c(0x158)](RequestMonitor['httpCodesStoragePath'],JSON[_0x18758c(0x130)](RequestMonitor[_0x18758c(0x14d)],null,0x2));}catch(_0x558042){console[_0x18758c(0x134)](_0x18758c(0x14c),_0x558042);}}static async[a1_0x122c18(0x12e)](){const _0x8e22ff=a1_0x122c18;setInterval(()=>RequestMonitor['save'](),0x3c*0x3e8),setInterval(()=>{const _0x561d07=a1_0x76a8;RequestMonitor['getUsageRessourcesStatsAndSave']()[_0x561d07(0x140)](()=>{});},0x3c*0x3e8),RequestMonitor['getUsageRessourcesStatsAndSave']()[_0x8e22ff(0x140)](()=>{});}static async[a1_0x122c18(0x163)](){const _0x21d92b=a1_0x122c18,_0x1ef742=osu['cpu'],_0x4f843a=osu[_0x21d92b(0x14f)],_0x3cc062=osu[_0x21d92b(0x127)],_0x3b394f={'total':{'inputMb':0x0,'outputMb':0x0}};try{const _0x3cbfc7=await _0x3cc062[_0x21d92b(0x141)]();_0x3b394f[_0x21d92b(0x139)][_0x21d92b(0x13b)]=_0x3cbfc7[_0x21d92b(0x139)][_0x21d92b(0x13b)],_0x3b394f[_0x21d92b(0x139)][_0x21d92b(0x13f)]=_0x3cbfc7[_0x21d92b(0x139)][_0x21d92b(0x13f)];}catch(_0x4ca0b3){}let _0x37b174=0x0;try{_0x37b174=await _0x1ef742[_0x21d92b(0x15b)]();}catch(_0x4e38fa){console[_0x21d92b(0x131)](_0x21d92b(0x129),_0x4e38fa);}const _0x9e4b54={'usedMemMb':0x0};try{const _0x5ce527=await _0x4f843a[_0x21d92b(0x142)]();_0x9e4b54[_0x21d92b(0x15e)]=_0x5ce527[_0x21d92b(0x15e)];}catch(_0x585af7){console['log']('Error\x20getting\x20memory\x20usage:',_0x585af7);}const _0x452920=new Date()[_0x21d92b(0x125)]()[_0x21d92b(0x161)]()['padStart'](0x2,'0')+':'+new Date()[_0x21d92b(0x13d)]()[_0x21d92b(0x161)]()[_0x21d92b(0x12d)](0x2,'0');RequestMonitor[_0x21d92b(0x157)]['cpu']=RequestMonitor[_0x21d92b(0x157)][_0x21d92b(0x143)]['slice'](-0x3c)[_0x21d92b(0x12b)](_0x52142c=>_0x52142c['time']!==_0x452920),RequestMonitor[_0x21d92b(0x157)][_0x21d92b(0x12c)]=RequestMonitor[_0x21d92b(0x157)][_0x21d92b(0x12c)][_0x21d92b(0x13e)](-0x3c)['filter'](_0x4f940c=>_0x4f940c['time']!==_0x452920),RequestMonitor['ressourcesUsageStats']['network']=RequestMonitor['ressourcesUsageStats'][_0x21d92b(0x11f)][_0x21d92b(0x13e)](-0x3c)['filter'](_0x12cc48=>_0x12cc48[_0x21d92b(0x12a)]!==_0x452920),RequestMonitor[_0x21d92b(0x157)][_0x21d92b(0x143)][_0x21d92b(0x147)]({'time':_0x452920,'usage':_0x37b174}),RequestMonitor['ressourcesUsageStats']['memory']['push']({'time':_0x452920,'usage':(_0x9e4b54['usedMemMb']/0x3e8)['toFixed'](0x2)}),RequestMonitor[_0x21d92b(0x157)][_0x21d92b(0x11f)]['push']({'time':_0x452920,'usage':{'in':_0x3b394f[_0x21d92b(0x139)]?.[_0x21d92b(0x13b)]??0x0,'out':_0x3b394f[_0x21d92b(0x139)]?.[_0x21d92b(0x13f)]??0x0}});try{await fs[_0x21d92b(0x158)](RequestMonitor['ressourcesUsageStatsPath'],JSON['stringify'](RequestMonitor[_0x21d92b(0x157)],null,0x2));}catch(_0x1c14c7){console['error'](_0x21d92b(0x14c),_0x1c14c7);}}static[a1_0x122c18(0x11c)](){const _0x1000ff=a1_0x122c18,_0x29a2b8=Date[_0x1000ff(0x154)](),_0x59206e=_0x29a2b8-0x3c*0x3c*0x3e8,_0x6ffbda=_0x29a2b8-0x18*0x3c*0x3c*0x3e8,_0x40a809=RequestMonitor['rpsData'][_0x1000ff(0x12b)](_0x2fc0a8=>_0x2fc0a8[_0x1000ff(0x11b)]>_0x59206e),_0x3e8daf={'total':RequestMonitor[_0x1000ff(0x14d)]['length'],'byCodes':{},'byPath':{}};return RequestMonitor['httpCodesData'][_0x1000ff(0x15c)](_0x13f92f=>{const _0x4cd72a=_0x1000ff;_0x3e8daf[_0x4cd72a(0x123)][_0x13f92f[_0x4cd72a(0x120)]]=(_0x3e8daf['byCodes'][_0x13f92f[_0x4cd72a(0x120)]]||0x0)+0x1;const _0x23efaa=_0x13f92f[_0x4cd72a(0x155)]+'\x20'+_0x13f92f[_0x4cd72a(0x126)];!_0x3e8daf[_0x4cd72a(0x13a)][_0x23efaa]&&(_0x3e8daf[_0x4cd72a(0x13a)][_0x23efaa]={'total':0x0,'codes':{}}),_0x3e8daf[_0x4cd72a(0x13a)][_0x23efaa][_0x4cd72a(0x139)]++,_0x3e8daf[_0x4cd72a(0x13a)][_0x23efaa][_0x4cd72a(0x128)][_0x13f92f[_0x4cd72a(0x120)]]=(_0x3e8daf[_0x4cd72a(0x13a)][_0x23efaa][_0x4cd72a(0x128)][_0x13f92f[_0x4cd72a(0x120)]]||0x0)+0x1;}),{'rps':_0x40a809,'httpCodes':_0x3e8daf,'ressourcesUsageStats':RequestMonitor[_0x1000ff(0x157)]};}}RequestMonitor[a1_0x122c18(0x137)]()[a1_0x122c18(0x140)](()=>{}),RequestMonitor[a1_0x122c18(0x12e)]();const counter=RequestMonitor;module[a1_0x122c18(0x124)]=counter;