function a1_0x1e86(){const _0x5e503a=['84mNbwqQ','usedMemMb','error','9549gsdxut','stringify','statusCode','toFixed','cadviewer/settings/requests-per-minute.json','mem','node-os-utils','push','startPeriodicSave','floor','log','532592cRfQPY','writeFile','method','codes','httpCodesData','92687kUOdqp','end','lastMinute','150011mOWzZq','netstat','time','getStats','/metrics','inOut','cadviewer/settings/http-codes-24h.json','now','filter','byPath','10023SzGnOz','Error\x20saving\x20monitoring\x20data:','readFile','1010cBufsv','padStart','promises','middleware','currentRequests','forEach','utf8','init','info','usage','path','42Qruqdd','slice','httpCodesStoragePath','apply','length','737015XUBaei','parse','includes','1387440oVYGcN','memory','network','ressourcesUsageStatsPath','=======>','timestamp','save','rpsStoragePath','ressourcesUsageStats','cadviewer/settings/ressources-usage-stats.json','cpu','Request\x20monitor\x20initialized.','byCodes','Error\x20getting\x20CPU\x20usage:','rpsData','Request\x20monitor\x20middleware','getUsageRessourcesStatsAndSave','then','outputMb','getHours','Error\x20getting\x20memory\x20usage:','total','inputMb'];a1_0x1e86=function(){return _0x5e503a;};return a1_0x1e86();}const a1_0x189b2d=a1_0x176f;(function(_0x460c8d,_0x48e028){const _0x3e5667=a1_0x176f,_0x394907=_0x460c8d();while(!![]){try{const _0x397381=-parseInt(_0x3e5667(0x15f))/0x1+-parseInt(_0x3e5667(0x12a))/0x2*(-parseInt(_0x3e5667(0x11c))/0x3)+parseInt(_0x3e5667(0x157))/0x4+-parseInt(_0x3e5667(0x12f))/0x5+-parseInt(_0x3e5667(0x149))/0x6*(-parseInt(_0x3e5667(0x15c))/0x7)+parseInt(_0x3e5667(0x132))/0x8+parseInt(_0x3e5667(0x14c))/0x9*(-parseInt(_0x3e5667(0x11f))/0xa);if(_0x397381===_0x48e028)break;else _0x394907['push'](_0x394907['shift']());}catch(_0x187b87){_0x394907['push'](_0x394907['shift']());}}}(a1_0x1e86,0x26762));function a1_0x176f(_0x30cbc2,_0x157a69){const _0x1e86f1=a1_0x1e86();return a1_0x176f=function(_0x176fac,_0x499762){_0x176fac=_0x176fac-0x11a;let _0x34b945=_0x1e86f1[_0x176fac];return _0x34b945;},a1_0x176f(_0x30cbc2,_0x157a69);}const fs=require('fs')[a1_0x189b2d(0x121)],osu=require(a1_0x189b2d(0x152));class RequestMonitor{static [a1_0x189b2d(0x139)]=a1_0x189b2d(0x150);static [a1_0x189b2d(0x12c)]=a1_0x189b2d(0x165);static ['ressourcesUsageStatsPath']=a1_0x189b2d(0x13b);static [a1_0x189b2d(0x140)]=[];static ['httpCodesData']=[];static [a1_0x189b2d(0x13a)]={};static [a1_0x189b2d(0x15e)]=Math['floor'](Date[a1_0x189b2d(0x166)]()/0x3e8/0x3c);static [a1_0x189b2d(0x123)]=0x0;static async[a1_0x189b2d(0x126)](){const _0x564802=a1_0x189b2d;console[_0x564802(0x156)]('Initializing\x20request\x20monitor...');try{const _0x2f69ac=await fs[_0x564802(0x11e)](RequestMonitor[_0x564802(0x139)],_0x564802(0x125));RequestMonitor['rpsData']=JSON['parse'](_0x2f69ac);}catch(_0x251b47){RequestMonitor[_0x564802(0x140)]=[];}try{const _0x387b7a=await fs['readFile'](RequestMonitor[_0x564802(0x12c)],_0x564802(0x125));RequestMonitor[_0x564802(0x15b)]=JSON[_0x564802(0x130)](_0x387b7a);}catch(_0x2b8dd5){RequestMonitor[_0x564802(0x15b)]=[];}try{const _0xfb56d7=await fs[_0x564802(0x11e)](RequestMonitor[_0x564802(0x135)],_0x564802(0x125));RequestMonitor[_0x564802(0x13a)]=JSON[_0x564802(0x130)](_0xfb56d7),!RequestMonitor[_0x564802(0x13a)][_0x564802(0x13c)]&&(RequestMonitor[_0x564802(0x13a)][_0x564802(0x13c)]=[]),!RequestMonitor[_0x564802(0x13a)][_0x564802(0x133)]&&(RequestMonitor['ressourcesUsageStats'][_0x564802(0x133)]=[]),!RequestMonitor[_0x564802(0x13a)][_0x564802(0x134)]&&(RequestMonitor[_0x564802(0x13a)]['network']=[]);}catch(_0xa31580){RequestMonitor[_0x564802(0x13a)]={'cpu':[],'memory':[],'network':[]};}console[_0x564802(0x156)](_0x564802(0x13d));}static[a1_0x189b2d(0x122)](_0x54e820,_0xbdd6f7,_0x150abe){const _0x35b35a=a1_0x189b2d;if(_0x54e820[_0x35b35a(0x129)][_0x35b35a(0x131)](_0x35b35a(0x163)))return _0x150abe();console['log'](_0x35b35a(0x141));let _0x2e99c2=Date[_0x35b35a(0x166)](),_0x1b3696=Math['floor'](_0x2e99c2/0x3e8/0x3c);console[_0x35b35a(0x156)](_0x35b35a(0x136));const _0x4f9150=_0xbdd6f7['end'];_0xbdd6f7[_0x35b35a(0x15d)]=(..._0x7e6280)=>{const _0x61352c=_0x35b35a;console[_0x61352c(0x156)](_0x1b3696,{'currentMinute':_0x1b3696});_0x1b3696>RequestMonitor['lastMinute']&&(RequestMonitor['rpsData']['push']({'timestamp':RequestMonitor[_0x61352c(0x15e)]*0x3e8*0x3c,'requests':RequestMonitor[_0x61352c(0x123)]}),RequestMonitor[_0x61352c(0x123)]=0x0,RequestMonitor[_0x61352c(0x15e)]=_0x1b3696);RequestMonitor[_0x61352c(0x123)]++,RequestMonitor['httpCodesData']['push']({'timestamp':Date[_0x61352c(0x166)](),'statusCode':_0xbdd6f7[_0x61352c(0x14e)],'path':_0x54e820[_0x61352c(0x129)],'method':_0x54e820[_0x61352c(0x159)]});const _0x3a0db3=Date['now']()-0x18*0x3c*0x3c*0x3e8;return RequestMonitor[_0x61352c(0x15b)]=RequestMonitor[_0x61352c(0x15b)][_0x61352c(0x11a)](_0x189209=>_0x189209['timestamp']>_0x3a0db3),_0x4f9150[_0x61352c(0x12d)](_0xbdd6f7,_0x7e6280);},_0x150abe();}static async[a1_0x189b2d(0x138)](){const _0x3fa700=a1_0x189b2d;try{RequestMonitor[_0x3fa700(0x15e)]!==Math['floor'](Date[_0x3fa700(0x166)]()/0x3e8/0x3c)&&(RequestMonitor['rpsData'][_0x3fa700(0x153)]({'timestamp':RequestMonitor[_0x3fa700(0x15e)]*0x3e8*0x3c,'requests':RequestMonitor[_0x3fa700(0x123)]}),RequestMonitor[_0x3fa700(0x123)]=0x0,RequestMonitor[_0x3fa700(0x15e)]=Math[_0x3fa700(0x155)](Date[_0x3fa700(0x166)]()/0x3e8/0x3c)),await fs[_0x3fa700(0x158)](RequestMonitor[_0x3fa700(0x139)],JSON[_0x3fa700(0x14d)](RequestMonitor[_0x3fa700(0x140)],null,0x2)),await fs[_0x3fa700(0x158)](RequestMonitor[_0x3fa700(0x12c)],JSON[_0x3fa700(0x14d)](RequestMonitor['httpCodesData'],null,0x2));}catch(_0xc046b5){console[_0x3fa700(0x14b)](_0x3fa700(0x11d),_0xc046b5);}}static async['startPeriodicSave'](){const _0x58fc28=a1_0x189b2d;setInterval(()=>RequestMonitor[_0x58fc28(0x138)](),0x3c*0x3e8),setInterval(()=>{const _0x12ef33=_0x58fc28;RequestMonitor[_0x12ef33(0x142)]()[_0x12ef33(0x143)](()=>{});},0x3c*0x3e8),RequestMonitor[_0x58fc28(0x142)]()[_0x58fc28(0x143)](()=>{});}static async[a1_0x189b2d(0x142)](){const _0x204f8a=a1_0x189b2d,_0x17c5b5=osu['cpu'],_0x155529=osu[_0x204f8a(0x151)],_0x4435b7=osu[_0x204f8a(0x160)],_0x87149a={'total':{'inputMb':0x0,'outputMb':0x0}};try{const _0x12fb7d=await _0x4435b7[_0x204f8a(0x164)]();_0x87149a[_0x204f8a(0x147)][_0x204f8a(0x148)]=_0x12fb7d['total'][_0x204f8a(0x148)],_0x87149a[_0x204f8a(0x147)][_0x204f8a(0x144)]=_0x12fb7d['total'][_0x204f8a(0x144)];}catch(_0x30689f){}let _0x5e07ce=0x0;try{_0x5e07ce=await _0x17c5b5[_0x204f8a(0x128)]();}catch(_0x22a788){console[_0x204f8a(0x156)](_0x204f8a(0x13f),_0x22a788);}const _0x5c7664={'usedMemMb':0x0};try{const _0xca77b2=await _0x155529[_0x204f8a(0x127)]();_0x5c7664[_0x204f8a(0x14a)]=_0xca77b2[_0x204f8a(0x14a)];}catch(_0xa2ef4d){console['log'](_0x204f8a(0x146),_0xa2ef4d);}const _0x3e5a28=new Date()[_0x204f8a(0x145)]()['toString']()[_0x204f8a(0x120)](0x2,'0')+':'+new Date()['getMinutes']()['toString']()['padStart'](0x2,'0');RequestMonitor[_0x204f8a(0x13a)][_0x204f8a(0x13c)]=RequestMonitor[_0x204f8a(0x13a)][_0x204f8a(0x13c)][_0x204f8a(0x12b)](-0x3c)['filter'](_0x1e30a5=>_0x1e30a5[_0x204f8a(0x161)]!==_0x3e5a28),RequestMonitor[_0x204f8a(0x13a)]['memory']=RequestMonitor['ressourcesUsageStats'][_0x204f8a(0x133)]['slice'](-0x3c)[_0x204f8a(0x11a)](_0x885f23=>_0x885f23[_0x204f8a(0x161)]!==_0x3e5a28),RequestMonitor['ressourcesUsageStats'][_0x204f8a(0x134)]=RequestMonitor[_0x204f8a(0x13a)][_0x204f8a(0x134)][_0x204f8a(0x12b)](-0x3c)['filter'](_0x252345=>_0x252345[_0x204f8a(0x161)]!==_0x3e5a28),RequestMonitor['ressourcesUsageStats']['cpu'][_0x204f8a(0x153)]({'time':_0x3e5a28,'usage':_0x5e07ce}),RequestMonitor[_0x204f8a(0x13a)][_0x204f8a(0x133)][_0x204f8a(0x153)]({'time':_0x3e5a28,'usage':(_0x5c7664[_0x204f8a(0x14a)]/0x3e8)[_0x204f8a(0x14f)](0x2)}),RequestMonitor[_0x204f8a(0x13a)][_0x204f8a(0x134)][_0x204f8a(0x153)]({'time':_0x3e5a28,'usage':{'in':_0x87149a['total']?.[_0x204f8a(0x148)]??0x0,'out':_0x87149a['total']?.[_0x204f8a(0x144)]??0x0}});try{await fs[_0x204f8a(0x158)](RequestMonitor['ressourcesUsageStatsPath'],JSON[_0x204f8a(0x14d)](RequestMonitor[_0x204f8a(0x13a)],null,0x2));}catch(_0x14ce68){console['error'](_0x204f8a(0x11d),_0x14ce68);}}static[a1_0x189b2d(0x162)](){const _0x4a7622=a1_0x189b2d,_0x3b8528=Date['now'](),_0x370242=_0x3b8528-0x3c*0x3c*0x3e8,_0x321645=_0x3b8528-0x18*0x3c*0x3c*0x3e8,_0x3e0894=RequestMonitor[_0x4a7622(0x140)][_0x4a7622(0x11a)](_0x3adc0c=>_0x3adc0c[_0x4a7622(0x137)]>_0x370242),_0xb846c0={'total':RequestMonitor[_0x4a7622(0x15b)][_0x4a7622(0x12e)],'byCodes':{},'byPath':{}};return RequestMonitor[_0x4a7622(0x15b)][_0x4a7622(0x124)](_0x11147e=>{const _0x205289=_0x4a7622;_0xb846c0['byCodes'][_0x11147e[_0x205289(0x14e)]]=(_0xb846c0[_0x205289(0x13e)][_0x11147e['statusCode']]||0x0)+0x1;const _0x339dff=_0x11147e[_0x205289(0x159)]+'\x20'+_0x11147e[_0x205289(0x129)];!_0xb846c0[_0x205289(0x11b)][_0x339dff]&&(_0xb846c0['byPath'][_0x339dff]={'total':0x0,'codes':{}}),_0xb846c0[_0x205289(0x11b)][_0x339dff][_0x205289(0x147)]++,_0xb846c0[_0x205289(0x11b)][_0x339dff][_0x205289(0x15a)][_0x11147e[_0x205289(0x14e)]]=(_0xb846c0[_0x205289(0x11b)][_0x339dff]['codes'][_0x11147e[_0x205289(0x14e)]]||0x0)+0x1;}),{'rps':_0x3e0894,'httpCodes':_0xb846c0,'ressourcesUsageStats':RequestMonitor[_0x4a7622(0x13a)]};}}RequestMonitor['init']()[a1_0x189b2d(0x143)](()=>{}),RequestMonitor[a1_0x189b2d(0x154)]();const counter=RequestMonitor;module['exports']=counter;