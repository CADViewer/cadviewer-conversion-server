function a1_0x5a11(_0x2a9cb7,_0x5bd79e){const _0x2ab321=a1_0x2ab3();return a1_0x5a11=function(_0x5a1181,_0x4bc874){_0x5a1181=_0x5a1181-0x156;let _0x3c1f97=_0x2ab321[_0x5a1181];return _0x3c1f97;},a1_0x5a11(_0x2a9cb7,_0x5bd79e);}const a1_0x2c2c83=a1_0x5a11;(function(_0x330a15,_0x123b51){const _0x13017c=a1_0x5a11,_0x306096=_0x330a15();while(!![]){try{const _0x4fbc95=-parseInt(_0x13017c(0x17c))/0x1*(parseInt(_0x13017c(0x17a))/0x2)+parseInt(_0x13017c(0x157))/0x3+-parseInt(_0x13017c(0x166))/0x4+-parseInt(_0x13017c(0x15d))/0x5+parseInt(_0x13017c(0x159))/0x6*(-parseInt(_0x13017c(0x191))/0x7)+parseInt(_0x13017c(0x18b))/0x8+parseInt(_0x13017c(0x188))/0x9;if(_0x4fbc95===_0x123b51)break;else _0x306096['push'](_0x306096['shift']());}catch(_0x2199bc){_0x306096['push'](_0x306096['shift']());}}}(a1_0x2ab3,0x9903c));const fs=require('fs')['promises'],osu=require(a1_0x2c2c83(0x15b));class RequestMonitor{static [a1_0x2c2c83(0x16b)]='cadviewer/settings/requests-per-minute.json';static [a1_0x2c2c83(0x186)]=a1_0x2c2c83(0x187);static [a1_0x2c2c83(0x162)]=a1_0x2c2c83(0x194);static [a1_0x2c2c83(0x182)]=[];static [a1_0x2c2c83(0x163)]=[];static [a1_0x2c2c83(0x164)]={};static [a1_0x2c2c83(0x173)]=Math[a1_0x2c2c83(0x16d)](Date[a1_0x2c2c83(0x198)]()/0x3e8/0x3c);static [a1_0x2c2c83(0x171)]=0x0;static async[a1_0x2c2c83(0x19d)](){const _0x4fbed7=a1_0x2c2c83;console[_0x4fbed7(0x174)](_0x4fbed7(0x177));try{const _0x2e104f=await fs[_0x4fbed7(0x16e)](RequestMonitor[_0x4fbed7(0x16b)],_0x4fbed7(0x18d));RequestMonitor['rpsData']=JSON[_0x4fbed7(0x18c)](_0x2e104f);}catch(_0x12d756){RequestMonitor[_0x4fbed7(0x182)]=[];}try{const _0x1026b4=await fs[_0x4fbed7(0x16e)](RequestMonitor[_0x4fbed7(0x186)],_0x4fbed7(0x18d));RequestMonitor[_0x4fbed7(0x163)]=JSON[_0x4fbed7(0x18c)](_0x1026b4);}catch(_0x52afc7){RequestMonitor[_0x4fbed7(0x163)]=[];}try{const _0x1bd547=await fs[_0x4fbed7(0x16e)](RequestMonitor[_0x4fbed7(0x162)],'utf8');RequestMonitor[_0x4fbed7(0x164)]=JSON[_0x4fbed7(0x18c)](_0x1bd547),!RequestMonitor['ressourcesUsageStats'][_0x4fbed7(0x181)]&&(RequestMonitor['ressourcesUsageStats'][_0x4fbed7(0x181)]=[]),!RequestMonitor[_0x4fbed7(0x164)]['memory']&&(RequestMonitor[_0x4fbed7(0x164)][_0x4fbed7(0x15c)]=[]),!RequestMonitor[_0x4fbed7(0x164)][_0x4fbed7(0x189)]&&(RequestMonitor[_0x4fbed7(0x164)][_0x4fbed7(0x189)]=[]);}catch(_0x22fb4f){RequestMonitor[_0x4fbed7(0x164)]={'cpu':[],'memory':[],'network':[]};}console[_0x4fbed7(0x174)](_0x4fbed7(0x17b));}static[a1_0x2c2c83(0x15a)](_0x590d23,_0x406ef4,_0x5a5580){const _0x250bbe=a1_0x2c2c83;if(_0x590d23[_0x250bbe(0x190)][_0x250bbe(0x19a)](_0x250bbe(0x193)))return _0x5a5580();console['log'](_0x250bbe(0x178));let _0x52941c=Date[_0x250bbe(0x198)](),_0x4972cf=Math['floor'](_0x52941c/0x3e8/0x3c);console[_0x250bbe(0x174)](_0x250bbe(0x183));const _0x507059=_0x406ef4['end'];_0x406ef4[_0x250bbe(0x172)]=(..._0x412680)=>{const _0x200fdc=_0x250bbe;console[_0x200fdc(0x174)](_0x4972cf,{'currentMinute':_0x4972cf});_0x4972cf>RequestMonitor[_0x200fdc(0x173)]&&(RequestMonitor[_0x200fdc(0x182)][_0x200fdc(0x197)]({'timestamp':RequestMonitor[_0x200fdc(0x173)]*0x3e8*0x3c,'requests':RequestMonitor[_0x200fdc(0x171)]}),RequestMonitor[_0x200fdc(0x171)]=0x0,RequestMonitor[_0x200fdc(0x173)]=_0x4972cf);RequestMonitor[_0x200fdc(0x171)]++,RequestMonitor[_0x200fdc(0x163)][_0x200fdc(0x197)]({'timestamp':Date[_0x200fdc(0x198)](),'statusCode':_0x406ef4[_0x200fdc(0x175)],'path':_0x590d23[_0x200fdc(0x190)],'method':_0x590d23[_0x200fdc(0x169)]});const _0x2f6ffb=Date[_0x200fdc(0x198)]()-0x18*0x3c*0x3c*0x3e8;return RequestMonitor[_0x200fdc(0x163)]=RequestMonitor[_0x200fdc(0x163)][_0x200fdc(0x184)](_0x2d5226=>_0x2d5226['timestamp']>_0x2f6ffb),_0x507059[_0x200fdc(0x161)](_0x406ef4,_0x412680);},_0x5a5580();}static async[a1_0x2c2c83(0x167)](){const _0x78f00c=a1_0x2c2c83;try{RequestMonitor[_0x78f00c(0x173)]!==Math[_0x78f00c(0x16d)](Date[_0x78f00c(0x198)]()/0x3e8/0x3c)&&(RequestMonitor[_0x78f00c(0x182)][_0x78f00c(0x197)]({'timestamp':RequestMonitor['lastMinute']*0x3e8*0x3c,'requests':RequestMonitor[_0x78f00c(0x171)]}),RequestMonitor[_0x78f00c(0x171)]=0x0,RequestMonitor[_0x78f00c(0x173)]=Math['floor'](Date[_0x78f00c(0x198)]()/0x3e8/0x3c)),await fs['writeFile'](RequestMonitor[_0x78f00c(0x16b)],JSON[_0x78f00c(0x18e)](RequestMonitor['rpsData'],null,0x2)),await fs['writeFile'](RequestMonitor[_0x78f00c(0x186)],JSON[_0x78f00c(0x18e)](RequestMonitor[_0x78f00c(0x163)],null,0x2));}catch(_0x26a4ba){console[_0x78f00c(0x19c)](_0x78f00c(0x192),_0x26a4ba);}}static async[a1_0x2c2c83(0x168)](){const _0x4bf9e7=a1_0x2c2c83;setInterval(()=>RequestMonitor[_0x4bf9e7(0x167)](),0x3c*0x3e8),setInterval(()=>{const _0x52d52c=_0x4bf9e7;RequestMonitor['getUsageRessourcesStatsAndSave']()[_0x52d52c(0x16a)](()=>{});},0x3c*0x3e8),RequestMonitor[_0x4bf9e7(0x158)]()['then'](()=>{});}static async[a1_0x2c2c83(0x158)](){const _0x2cc38d=a1_0x2c2c83,_0x5730a5=osu[_0x2cc38d(0x181)],_0x539715=osu[_0x2cc38d(0x195)],_0x1a8427=osu['netstat'],_0x416adb={'total':{'inputMb':0x0,'outputMb':0x0}};try{const _0xca7242=await _0x1a8427['inOut']();_0x416adb[_0x2cc38d(0x17e)][_0x2cc38d(0x18f)]=_0xca7242[_0x2cc38d(0x17e)][_0x2cc38d(0x18f)],_0x416adb[_0x2cc38d(0x17e)][_0x2cc38d(0x196)]=_0xca7242[_0x2cc38d(0x17e)]['outputMb'];}catch(_0x5b6403){}let _0x1e3bba=0x0;try{_0x1e3bba=await _0x5730a5[_0x2cc38d(0x199)]();}catch(_0x4094f0){console['log'](_0x2cc38d(0x17f),_0x4094f0);}const _0x1bc915={'usedMemMb':0x0};try{const _0x237b56=await _0x539715['info']();_0x1bc915['usedMemMb']=_0x237b56['usedMemMb'];}catch(_0x3468a1){console['log'](_0x2cc38d(0x179),_0x3468a1);}const _0x367838=new Date()[_0x2cc38d(0x156)]()[_0x2cc38d(0x15e)]()['padStart'](0x2,'0')+':'+new Date()[_0x2cc38d(0x165)]()['toString']()['padStart'](0x2,'0');RequestMonitor[_0x2cc38d(0x164)][_0x2cc38d(0x181)]=RequestMonitor[_0x2cc38d(0x164)][_0x2cc38d(0x181)]['slice'](-0x3c)['filter'](_0xcda9af=>_0xcda9af['time']!==_0x367838),RequestMonitor[_0x2cc38d(0x164)]['memory']=RequestMonitor['ressourcesUsageStats']['memory'][_0x2cc38d(0x180)](-0x3c)[_0x2cc38d(0x184)](_0x159d86=>_0x159d86[_0x2cc38d(0x15f)]!==_0x367838),RequestMonitor[_0x2cc38d(0x164)][_0x2cc38d(0x189)]=RequestMonitor[_0x2cc38d(0x164)]['network'][_0x2cc38d(0x180)](-0x3c)[_0x2cc38d(0x184)](_0x486850=>_0x486850['time']!==_0x367838),RequestMonitor[_0x2cc38d(0x164)]['cpu'][_0x2cc38d(0x197)]({'time':_0x367838,'usage':_0x1e3bba}),RequestMonitor['ressourcesUsageStats'][_0x2cc38d(0x15c)][_0x2cc38d(0x197)]({'time':_0x367838,'usage':(_0x1bc915[_0x2cc38d(0x18a)]/0x3e8)[_0x2cc38d(0x16f)](0x2)}),RequestMonitor[_0x2cc38d(0x164)][_0x2cc38d(0x189)]['push']({'time':_0x367838,'usage':{'in':_0x416adb[_0x2cc38d(0x17e)]?.[_0x2cc38d(0x18f)]??0x0,'out':_0x416adb['total']?.[_0x2cc38d(0x196)]??0x0}});try{await fs['writeFile'](RequestMonitor[_0x2cc38d(0x162)],JSON[_0x2cc38d(0x18e)](RequestMonitor[_0x2cc38d(0x164)],null,0x2));}catch(_0xab7398){console[_0x2cc38d(0x19c)]('Error\x20saving\x20monitoring\x20data:',_0xab7398);}}static[a1_0x2c2c83(0x170)](){const _0x43781a=a1_0x2c2c83,_0x1aee15=Date[_0x43781a(0x198)](),_0x56ae10=_0x1aee15-0x3c*0x3c*0x3e8,_0x46183d=_0x1aee15-0x18*0x3c*0x3c*0x3e8,_0x5a0411=RequestMonitor[_0x43781a(0x182)][_0x43781a(0x184)](_0x469674=>_0x469674['timestamp']>_0x56ae10),_0xa2bc36={'total':RequestMonitor[_0x43781a(0x163)][_0x43781a(0x160)],'byCodes':{},'byPath':{}};return RequestMonitor[_0x43781a(0x163)][_0x43781a(0x17d)](_0x43f73b=>{const _0x125fc2=_0x43781a;_0xa2bc36[_0x125fc2(0x185)][_0x43f73b['statusCode']]=(_0xa2bc36[_0x125fc2(0x185)][_0x43f73b[_0x125fc2(0x175)]]||0x0)+0x1;const _0x498c9e=_0x43f73b[_0x125fc2(0x169)]+'\x20'+_0x43f73b['path'];!_0xa2bc36[_0x125fc2(0x19b)][_0x498c9e]&&(_0xa2bc36['byPath'][_0x498c9e]={'total':0x0,'codes':{}}),_0xa2bc36[_0x125fc2(0x19b)][_0x498c9e][_0x125fc2(0x17e)]++,_0xa2bc36[_0x125fc2(0x19b)][_0x498c9e][_0x125fc2(0x176)][_0x43f73b[_0x125fc2(0x175)]]=(_0xa2bc36[_0x125fc2(0x19b)][_0x498c9e][_0x125fc2(0x176)][_0x43f73b[_0x125fc2(0x175)]]||0x0)+0x1;}),{'rps':_0x5a0411,'httpCodes':_0xa2bc36,'ressourcesUsageStats':RequestMonitor[_0x43781a(0x164)]};}}RequestMonitor[a1_0x2c2c83(0x19d)]()[a1_0x2c2c83(0x16a)](()=>{}),RequestMonitor['startPeriodicSave']();function a1_0x2ab3(){const _0x1f4977=['exports','floor','readFile','toFixed','getStats','currentRequests','end','lastMinute','log','statusCode','codes','Initializing\x20request\x20monitor...','Request\x20monitor\x20middleware','Error\x20getting\x20memory\x20usage:','566ggvWYk','Request\x20monitor\x20initialized.','1451NJPNpP','forEach','total','Error\x20getting\x20CPU\x20usage:','slice','cpu','rpsData','=======>','filter','byCodes','httpCodesStoragePath','cadviewer/settings/http-codes-24h.json','10541808BWRGoA','network','usedMemMb','7971832EZyLGQ','parse','utf8','stringify','inputMb','path','2527vNElOE','Error\x20saving\x20monitoring\x20data:','/metrics','cadviewer/settings/ressources-usage-stats.json','mem','outputMb','push','now','usage','includes','byPath','error','init','getHours','3373269TuIpFF','getUsageRessourcesStatsAndSave','15954lGinAx','middleware','node-os-utils','memory','3471745eBNBIn','toString','time','length','apply','ressourcesUsageStatsPath','httpCodesData','ressourcesUsageStats','getMinutes','2402340OTfzXJ','save','startPeriodicSave','method','then','rpsStoragePath'];a1_0x2ab3=function(){return _0x1f4977;};return a1_0x2ab3();}const counter=RequestMonitor;module[a1_0x2c2c83(0x16c)]=counter;