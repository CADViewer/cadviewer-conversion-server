const a1_0x19fad9=a1_0x1632;(function(_0x1e4883,_0x482caa){const _0x301421=a1_0x1632,_0x12f00a=_0x1e4883();while(!![]){try{const _0x21d72f=parseInt(_0x301421(0x17f))/0x1+parseInt(_0x301421(0x18e))/0x2+parseInt(_0x301421(0x1a3))/0x3*(-parseInt(_0x301421(0x1be))/0x4)+-parseInt(_0x301421(0x1ad))/0x5+-parseInt(_0x301421(0x1b0))/0x6*(parseInt(_0x301421(0x1c0))/0x7)+parseInt(_0x301421(0x18f))/0x8+parseInt(_0x301421(0x185))/0x9*(parseInt(_0x301421(0x1b2))/0xa);if(_0x21d72f===_0x482caa)break;else _0x12f00a['push'](_0x12f00a['shift']());}catch(_0x328bca){_0x12f00a['push'](_0x12f00a['shift']());}}}(a1_0xaf0f,0x7954e));const fs=require('fs')[a1_0x19fad9(0x18c)],osu=require(a1_0x19fad9(0x1c1));class RequestMonitor{static [a1_0x19fad9(0x187)]=a1_0x19fad9(0x186);static [a1_0x19fad9(0x182)]=a1_0x19fad9(0x1ac);static [a1_0x19fad9(0x190)]=a1_0x19fad9(0x1b5);static ['rpsData']=[];static [a1_0x19fad9(0x191)]=[];static ['ressourcesUsageStats']={};static [a1_0x19fad9(0x183)]=Math[a1_0x19fad9(0x1bf)](Date['now']()/0x3e8/0x3c);static [a1_0x19fad9(0x1a7)]=0x0;static async[a1_0x19fad9(0x189)](){const _0x49461b=a1_0x19fad9;console[_0x49461b(0x1b3)](_0x49461b(0x19e));try{const _0x522e7b=await fs[_0x49461b(0x1a9)](RequestMonitor['rpsStoragePath'],_0x49461b(0x193));RequestMonitor['rpsData']=JSON[_0x49461b(0x197)](_0x522e7b);}catch(_0x273d03){RequestMonitor[_0x49461b(0x1a6)]=[];}try{const _0x403ed2=await fs[_0x49461b(0x1a9)](RequestMonitor[_0x49461b(0x182)],_0x49461b(0x193));RequestMonitor[_0x49461b(0x191)]=JSON[_0x49461b(0x197)](_0x403ed2);}catch(_0x31dda6){RequestMonitor[_0x49461b(0x191)]=[];}try{const _0x343ff9=await fs['readFile'](RequestMonitor[_0x49461b(0x190)],_0x49461b(0x193));RequestMonitor[_0x49461b(0x1b8)]=JSON['parse'](_0x343ff9),!RequestMonitor[_0x49461b(0x1b8)][_0x49461b(0x181)]&&(RequestMonitor[_0x49461b(0x1b8)]['cpu']=[]),!RequestMonitor[_0x49461b(0x1b8)][_0x49461b(0x1af)]&&(RequestMonitor[_0x49461b(0x1b8)][_0x49461b(0x1af)]=[]),!RequestMonitor['ressourcesUsageStats']['network']&&(RequestMonitor[_0x49461b(0x1b8)][_0x49461b(0x18a)]=[]);}catch(_0x4bfaba){RequestMonitor[_0x49461b(0x1b8)]={'cpu':[],'memory':[],'network':[]};}console[_0x49461b(0x1b3)](_0x49461b(0x1a1));}static['middleware'](_0x41a6ec,_0x428e28,_0x23dc61){const _0x47d2f1=a1_0x19fad9;if(_0x41a6ec[_0x47d2f1(0x1b9)][_0x47d2f1(0x1a8)](_0x47d2f1(0x1b1)))return _0x23dc61();console['log'](_0x47d2f1(0x1bc));let _0x239ff8=Date[_0x47d2f1(0x1bd)](),_0x20ca3a=Math[_0x47d2f1(0x1bf)](_0x239ff8/0x3e8/0x3c);console[_0x47d2f1(0x1b3)]('=======>');const _0x1e403d=_0x428e28[_0x47d2f1(0x19b)];_0x428e28[_0x47d2f1(0x19b)]=(..._0x5eb683)=>{const _0x325657=_0x47d2f1;console[_0x325657(0x1b3)](_0x20ca3a,{'currentMinute':_0x20ca3a});_0x20ca3a>RequestMonitor[_0x325657(0x183)]&&(RequestMonitor[_0x325657(0x1a6)][_0x325657(0x1ae)]({'timestamp':RequestMonitor[_0x325657(0x183)]*0x3e8*0x3c,'requests':RequestMonitor['currentRequests']}),RequestMonitor[_0x325657(0x1a7)]=0x0,RequestMonitor[_0x325657(0x183)]=_0x20ca3a);RequestMonitor[_0x325657(0x1a7)]++,RequestMonitor[_0x325657(0x191)][_0x325657(0x1ae)]({'timestamp':Date[_0x325657(0x1bd)](),'statusCode':_0x428e28[_0x325657(0x199)],'path':_0x41a6ec[_0x325657(0x1b9)],'method':_0x41a6ec[_0x325657(0x180)]});const _0x805fa1=Date[_0x325657(0x1bd)]()-0x18*0x3c*0x3c*0x3e8;return RequestMonitor[_0x325657(0x191)]=RequestMonitor[_0x325657(0x191)][_0x325657(0x1a2)](_0xffad3b=>_0xffad3b[_0x325657(0x1c9)]>_0x805fa1),_0x1e403d['apply'](_0x428e28,_0x5eb683);},_0x23dc61();}static async[a1_0x19fad9(0x1b7)](){const _0x5ec6aa=a1_0x19fad9;try{RequestMonitor[_0x5ec6aa(0x183)]!==Math[_0x5ec6aa(0x1bf)](Date[_0x5ec6aa(0x1bd)]()/0x3e8/0x3c)&&(RequestMonitor[_0x5ec6aa(0x1a6)]['push']({'timestamp':RequestMonitor[_0x5ec6aa(0x183)]*0x3e8*0x3c,'requests':RequestMonitor['currentRequests']}),RequestMonitor[_0x5ec6aa(0x1a7)]=0x0,RequestMonitor['lastMinute']=Math[_0x5ec6aa(0x1bf)](Date['now']()/0x3e8/0x3c)),await fs[_0x5ec6aa(0x1a0)](RequestMonitor[_0x5ec6aa(0x187)],JSON[_0x5ec6aa(0x192)](RequestMonitor[_0x5ec6aa(0x1a6)],null,0x2)),await fs[_0x5ec6aa(0x1a0)](RequestMonitor[_0x5ec6aa(0x182)],JSON[_0x5ec6aa(0x192)](RequestMonitor[_0x5ec6aa(0x191)],null,0x2));}catch(_0x52a8bb){console[_0x5ec6aa(0x1aa)](_0x5ec6aa(0x19f),_0x52a8bb);}}static async[a1_0x19fad9(0x18d)](){const _0x326bb5=a1_0x19fad9;setInterval(()=>RequestMonitor[_0x326bb5(0x1b7)](),0x3c*0x3e8),setInterval(()=>{const _0x393958=_0x326bb5;RequestMonitor[_0x393958(0x198)]()['then'](()=>{});},0x3c*0x3e8),RequestMonitor[_0x326bb5(0x198)]()[_0x326bb5(0x1c2)](()=>{});}static async['getUsageRessourcesStatsAndSave'](){const _0x24be2e=a1_0x19fad9,_0x4e05d2=osu[_0x24be2e(0x181)],_0x5942b1=osu[_0x24be2e(0x18b)],_0x2c15e2=osu[_0x24be2e(0x1c6)],_0x494322={'total':{'inputMb':0x0,'outputMb':0x0}};try{const _0xee859=await _0x2c15e2[_0x24be2e(0x1c7)]();_0x494322[_0x24be2e(0x19d)][_0x24be2e(0x1a4)]=_0xee859['total'][_0x24be2e(0x1a4)],_0x494322[_0x24be2e(0x19d)][_0x24be2e(0x1c3)]=_0xee859[_0x24be2e(0x19d)]['outputMb'];}catch(_0x1f81c9){}let _0x4db9de=0x0;try{_0x4db9de=await _0x4e05d2[_0x24be2e(0x188)]();}catch(_0x4af450){console[_0x24be2e(0x1b3)](_0x24be2e(0x1ba),_0x4af450);}const _0x3e1975={'usedMemMb':0x0};try{const _0x1c45a7=await _0x5942b1['info']();_0x3e1975[_0x24be2e(0x1a5)]=_0x1c45a7[_0x24be2e(0x1a5)];}catch(_0x4ca85c){console[_0x24be2e(0x1b3)](_0x24be2e(0x1c8),_0x4ca85c);}const _0x59a444=new Date()[_0x24be2e(0x196)]()[_0x24be2e(0x19a)]()[_0x24be2e(0x1b4)](0x2,'0')+':'+new Date()['getMinutes']()[_0x24be2e(0x19a)]()[_0x24be2e(0x1b4)](0x2,'0');RequestMonitor[_0x24be2e(0x1b8)][_0x24be2e(0x181)]=RequestMonitor[_0x24be2e(0x1b8)][_0x24be2e(0x181)][_0x24be2e(0x19c)](-0x3c)[_0x24be2e(0x1a2)](_0x18325f=>_0x18325f[_0x24be2e(0x1b6)]!==_0x59a444),RequestMonitor[_0x24be2e(0x1b8)][_0x24be2e(0x1af)]=RequestMonitor[_0x24be2e(0x1b8)][_0x24be2e(0x1af)][_0x24be2e(0x19c)](-0x3c)['filter'](_0x2e36c7=>_0x2e36c7[_0x24be2e(0x1b6)]!==_0x59a444),RequestMonitor[_0x24be2e(0x1b8)]['network']=RequestMonitor[_0x24be2e(0x1b8)]['network'][_0x24be2e(0x19c)](-0x3c)[_0x24be2e(0x1a2)](_0x2f378d=>_0x2f378d[_0x24be2e(0x1b6)]!==_0x59a444),RequestMonitor[_0x24be2e(0x1b8)][_0x24be2e(0x181)][_0x24be2e(0x1ae)]({'time':_0x59a444,'usage':_0x4db9de}),RequestMonitor[_0x24be2e(0x1b8)][_0x24be2e(0x1af)][_0x24be2e(0x1ae)]({'time':_0x59a444,'usage':(_0x3e1975[_0x24be2e(0x1a5)]/0x3e8)[_0x24be2e(0x1bb)](0x2)}),RequestMonitor[_0x24be2e(0x1b8)][_0x24be2e(0x18a)][_0x24be2e(0x1ae)]({'time':_0x59a444,'usage':{'in':_0x494322[_0x24be2e(0x19d)]?.['inputMb']??0x0,'out':_0x494322[_0x24be2e(0x19d)]?.[_0x24be2e(0x1c3)]??0x0}});try{await fs[_0x24be2e(0x1a0)](RequestMonitor[_0x24be2e(0x190)],JSON[_0x24be2e(0x192)](RequestMonitor[_0x24be2e(0x1b8)],null,0x2));}catch(_0x259ee5){console[_0x24be2e(0x1aa)](_0x24be2e(0x19f),_0x259ee5);}}static[a1_0x19fad9(0x1c4)](){const _0x8327e7=a1_0x19fad9,_0x766183=Date[_0x8327e7(0x1bd)](),_0x242ed4=_0x766183-0x3c*0x3c*0x3e8,_0x3f9cf9=_0x766183-0x18*0x3c*0x3c*0x3e8,_0x12a76f=RequestMonitor['rpsData'][_0x8327e7(0x1a2)](_0x10ced9=>_0x10ced9[_0x8327e7(0x1c9)]>_0x242ed4),_0x2793cb={'total':RequestMonitor[_0x8327e7(0x191)]['length'],'byCodes':{},'byPath':{}};return RequestMonitor[_0x8327e7(0x191)][_0x8327e7(0x194)](_0x533d61=>{const _0x1f4e2f=_0x8327e7;_0x2793cb['byCodes'][_0x533d61[_0x1f4e2f(0x199)]]=(_0x2793cb[_0x1f4e2f(0x184)][_0x533d61[_0x1f4e2f(0x199)]]||0x0)+0x1;const _0x6be3be=_0x533d61[_0x1f4e2f(0x180)]+'\x20'+_0x533d61[_0x1f4e2f(0x1b9)];!_0x2793cb['byPath'][_0x6be3be]&&(_0x2793cb[_0x1f4e2f(0x1c5)][_0x6be3be]={'total':0x0,'codes':{}}),_0x2793cb[_0x1f4e2f(0x1c5)][_0x6be3be]['total']++,_0x2793cb[_0x1f4e2f(0x1c5)][_0x6be3be][_0x1f4e2f(0x1ab)][_0x533d61['statusCode']]=(_0x2793cb[_0x1f4e2f(0x1c5)][_0x6be3be][_0x1f4e2f(0x1ab)][_0x533d61[_0x1f4e2f(0x199)]]||0x0)+0x1;}),{'rps':_0x12a76f,'httpCodes':_0x2793cb,'ressourcesUsageStats':RequestMonitor[_0x8327e7(0x1b8)]};}}RequestMonitor['init']()[a1_0x19fad9(0x1c2)](()=>{}),RequestMonitor[a1_0x19fad9(0x18d)]();const counter=RequestMonitor;function a1_0x1632(_0x185a50,_0x154fc9){const _0xaf0f99=a1_0xaf0f();return a1_0x1632=function(_0x163242,_0x112b1e){_0x163242=_0x163242-0x17f;let _0x3873df=_0xaf0f99[_0x163242];return _0x3873df;},a1_0x1632(_0x185a50,_0x154fc9);}function a1_0xaf0f(){const _0x16d1a0=['statusCode','toString','end','slice','total','Initializing\x20request\x20monitor...','Error\x20saving\x20monitoring\x20data:','writeFile','Request\x20monitor\x20initialized.','filter','4119KwjEwi','inputMb','usedMemMb','rpsData','currentRequests','includes','readFile','error','codes','cadviewer/settings/http-codes-24h.json','1645995ExeVaa','push','memory','85740IevDnp','/metrics','37780JTHJZX','log','padStart','cadviewer/settings/ressources-usage-stats.json','time','save','ressourcesUsageStats','path','Error\x20getting\x20CPU\x20usage:','toFixed','Request\x20monitor\x20middleware','now','808DnMXJJ','floor','469EQIBTY','node-os-utils','then','outputMb','getStats','byPath','netstat','inOut','Error\x20getting\x20memory\x20usage:','timestamp','800878WEXXxd','method','cpu','httpCodesStoragePath','lastMinute','byCodes','2277XCyZsJ','cadviewer/settings/requests-per-minute.json','rpsStoragePath','usage','init','network','mem','promises','startPeriodicSave','193194bdSvyT','1661120fXyFIL','ressourcesUsageStatsPath','httpCodesData','stringify','utf8','forEach','exports','getHours','parse','getUsageRessourcesStatsAndSave'];a1_0xaf0f=function(){return _0x16d1a0;};return a1_0xaf0f();}module[a1_0x19fad9(0x195)]=counter;