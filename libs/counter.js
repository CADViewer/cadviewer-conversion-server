function a1_0x183e(){const _0x4a6ad3=['outputMb','statusCode','getHours','mem','952104obXoix','4619MKwKTc','includes','136fDLySZ','parse','codes','inOut','now','913340WGVhUi','Error\x20saving\x20monitoring\x20data:','push','then','cpu','path','node-os-utils','log','save','error','lastMinute','rpsData','end','httpCodesData','inputMb','cadviewer/settings/requests-per-minute.json','getUsageRessourcesStatsAndSave','toString','Request\x20monitor\x20initialized.','586926MHqMLY','exports','5KUbPgX','init','time','network','=======>','apply','1664410Txlgwn','/metrics','8bFAxzh','middleware','byCodes','padStart','byPath','usage','filter','ressourcesUsageStatsPath','Error\x20getting\x20CPU\x20usage:','promises','cadviewer/settings/http-codes-24h.json','2446542UQuHNw','startPeriodicSave','usedMemMb','memory','Request\x20monitor\x20middleware','ressourcesUsageStats','method','Error\x20getting\x20memory\x20usage:','cadviewer/settings/ressources-usage-stats.json','getStats','currentRequests','utf8','timestamp','getMinutes','30ERPQIk','356046gXfrdf','total','writeFile','stringify','slice','toFixed','httpCodesStoragePath','floor','readFile','rpsStoragePath'];a1_0x183e=function(){return _0x4a6ad3;};return a1_0x183e();}const a1_0x39dfcf=a1_0x1803;(function(_0x51ecc8,_0x131730){const _0x562d63=a1_0x1803,_0x23c687=_0x51ecc8();while(!![]){try{const _0x522bb2=-parseInt(_0x562d63(0x14e))/0x1*(parseInt(_0x562d63(0x150))/0x2)+parseInt(_0x562d63(0x14d))/0x3+-parseInt(_0x562d63(0x155))/0x4+-parseInt(_0x562d63(0x11d))/0x5*(-parseInt(_0x562d63(0x13f))/0x6)+parseInt(_0x562d63(0x130))/0x7*(parseInt(_0x562d63(0x125))/0x8)+-parseInt(_0x562d63(0x11b))/0x9*(-parseInt(_0x562d63(0x13e))/0xa)+-parseInt(_0x562d63(0x123))/0xb;if(_0x522bb2===_0x131730)break;else _0x23c687['push'](_0x23c687['shift']());}catch(_0x34bec8){_0x23c687['push'](_0x23c687['shift']());}}}(a1_0x183e,0x37b18));const fs=require('fs')[a1_0x39dfcf(0x12e)],osu=require(a1_0x39dfcf(0x15b));function a1_0x1803(_0x1a0a29,_0x5ef464){const _0x183e06=a1_0x183e();return a1_0x1803=function(_0x180346,_0x564713){_0x180346=_0x180346-0x11a;let _0x23b080=_0x183e06[_0x180346];return _0x23b080;},a1_0x1803(_0x1a0a29,_0x5ef464);}class RequestMonitor{static [a1_0x39dfcf(0x148)]=a1_0x39dfcf(0x164);static [a1_0x39dfcf(0x145)]=a1_0x39dfcf(0x12f);static [a1_0x39dfcf(0x12c)]=a1_0x39dfcf(0x138);static [a1_0x39dfcf(0x160)]=[];static ['httpCodesData']=[];static [a1_0x39dfcf(0x135)]={};static [a1_0x39dfcf(0x15f)]=Math[a1_0x39dfcf(0x146)](Date[a1_0x39dfcf(0x154)]()/0x3e8/0x3c);static ['currentRequests']=0x0;static async[a1_0x39dfcf(0x11e)](){const _0x2e3c43=a1_0x39dfcf;console['log']('Initializing\x20request\x20monitor...');try{const _0x2a01f6=await fs[_0x2e3c43(0x147)](RequestMonitor[_0x2e3c43(0x148)],_0x2e3c43(0x13b));RequestMonitor[_0x2e3c43(0x160)]=JSON['parse'](_0x2a01f6);}catch(_0x9c6566){RequestMonitor[_0x2e3c43(0x160)]=[];}try{const _0x33c5a4=await fs[_0x2e3c43(0x147)](RequestMonitor[_0x2e3c43(0x145)],_0x2e3c43(0x13b));RequestMonitor['httpCodesData']=JSON[_0x2e3c43(0x151)](_0x33c5a4);}catch(_0x20d92d){RequestMonitor[_0x2e3c43(0x162)]=[];}try{const _0x4a50d5=await fs['readFile'](RequestMonitor[_0x2e3c43(0x12c)],_0x2e3c43(0x13b));RequestMonitor['ressourcesUsageStats']=JSON['parse'](_0x4a50d5),!RequestMonitor[_0x2e3c43(0x135)]['cpu']&&(RequestMonitor[_0x2e3c43(0x135)]['cpu']=[]),!RequestMonitor[_0x2e3c43(0x135)][_0x2e3c43(0x133)]&&(RequestMonitor['ressourcesUsageStats'][_0x2e3c43(0x133)]=[]),!RequestMonitor[_0x2e3c43(0x135)]['network']&&(RequestMonitor[_0x2e3c43(0x135)][_0x2e3c43(0x120)]=[]);}catch(_0x89892c){RequestMonitor[_0x2e3c43(0x135)]={'cpu':[],'memory':[],'network':[]};}console[_0x2e3c43(0x15c)](_0x2e3c43(0x11a));}static[a1_0x39dfcf(0x126)](_0x445b8e,_0x496547,_0x5b7b66){const _0x157962=a1_0x39dfcf;if(_0x445b8e['path'][_0x157962(0x14f)](_0x157962(0x124)))return _0x5b7b66();console[_0x157962(0x15c)](_0x157962(0x134));let _0x331c50=Date[_0x157962(0x154)](),_0x3432a8=Math[_0x157962(0x146)](_0x331c50/0x3e8/0x3c);console[_0x157962(0x15c)](_0x157962(0x121));const _0x152b83=_0x496547[_0x157962(0x161)];_0x496547[_0x157962(0x161)]=(..._0x2ee0ba)=>{const _0x175e8a=_0x157962;console['log'](_0x3432a8,{'currentMinute':_0x3432a8});_0x3432a8>RequestMonitor[_0x175e8a(0x15f)]&&(RequestMonitor['rpsData']['push']({'timestamp':RequestMonitor[_0x175e8a(0x15f)]*0x3e8*0x3c,'requests':RequestMonitor[_0x175e8a(0x13a)]}),RequestMonitor[_0x175e8a(0x13a)]=0x0,RequestMonitor[_0x175e8a(0x15f)]=_0x3432a8);RequestMonitor['currentRequests']++,RequestMonitor[_0x175e8a(0x162)][_0x175e8a(0x157)]({'timestamp':Date[_0x175e8a(0x154)](),'statusCode':_0x496547[_0x175e8a(0x14a)],'path':_0x445b8e[_0x175e8a(0x15a)],'method':_0x445b8e[_0x175e8a(0x136)]});const _0x2caf18=Date['now']()-0x18*0x3c*0x3c*0x3e8;return RequestMonitor['httpCodesData']=RequestMonitor[_0x175e8a(0x162)][_0x175e8a(0x12b)](_0xd64dc1=>_0xd64dc1[_0x175e8a(0x13c)]>_0x2caf18),_0x152b83[_0x175e8a(0x122)](_0x496547,_0x2ee0ba);},_0x5b7b66();}static async[a1_0x39dfcf(0x15d)](){const _0x586813=a1_0x39dfcf;try{RequestMonitor[_0x586813(0x15f)]!==Math[_0x586813(0x146)](Date[_0x586813(0x154)]()/0x3e8/0x3c)&&(RequestMonitor[_0x586813(0x160)][_0x586813(0x157)]({'timestamp':RequestMonitor[_0x586813(0x15f)]*0x3e8*0x3c,'requests':RequestMonitor[_0x586813(0x13a)]}),RequestMonitor[_0x586813(0x13a)]=0x0,RequestMonitor['lastMinute']=Math[_0x586813(0x146)](Date['now']()/0x3e8/0x3c)),await fs[_0x586813(0x141)](RequestMonitor[_0x586813(0x148)],JSON[_0x586813(0x142)](RequestMonitor[_0x586813(0x160)],null,0x2)),await fs[_0x586813(0x141)](RequestMonitor['httpCodesStoragePath'],JSON[_0x586813(0x142)](RequestMonitor[_0x586813(0x162)],null,0x2));}catch(_0x2220c7){console[_0x586813(0x15e)](_0x586813(0x156),_0x2220c7);}}static async[a1_0x39dfcf(0x131)](){setInterval(()=>RequestMonitor['save'](),0x3c*0x3e8),setInterval(()=>{const _0x526cbc=a1_0x1803;RequestMonitor[_0x526cbc(0x165)]()[_0x526cbc(0x158)](()=>{});},0x3c*0x3e8),RequestMonitor['getUsageRessourcesStatsAndSave']()['then'](()=>{});}static async[a1_0x39dfcf(0x165)](){const _0x1a0d2a=a1_0x39dfcf,_0x1feee7=osu[_0x1a0d2a(0x159)],_0x4244b9=osu[_0x1a0d2a(0x14c)],_0x24cb1c=osu['netstat'],_0xcbf2af={'total':{'inputMb':0x0,'outputMb':0x0}};try{const _0x5b6de9=await _0x24cb1c[_0x1a0d2a(0x153)]();_0xcbf2af[_0x1a0d2a(0x140)][_0x1a0d2a(0x163)]=_0x5b6de9[_0x1a0d2a(0x140)][_0x1a0d2a(0x163)],_0xcbf2af[_0x1a0d2a(0x140)][_0x1a0d2a(0x149)]=_0x5b6de9[_0x1a0d2a(0x140)]['outputMb'];}catch(_0x4bccf4){}let _0x188c83=0x0;try{_0x188c83=await _0x1feee7[_0x1a0d2a(0x12a)]();}catch(_0x1aca73){console[_0x1a0d2a(0x15c)](_0x1a0d2a(0x12d),_0x1aca73);}const _0x5ed944={'usedMemMb':0x0};try{const _0x323b3d=await _0x4244b9['info']();_0x5ed944['usedMemMb']=_0x323b3d[_0x1a0d2a(0x132)];}catch(_0x3bc6b4){console[_0x1a0d2a(0x15c)](_0x1a0d2a(0x137),_0x3bc6b4);}const _0x3270a5=new Date()[_0x1a0d2a(0x14b)]()[_0x1a0d2a(0x166)]()[_0x1a0d2a(0x128)](0x2,'0')+':'+new Date()[_0x1a0d2a(0x13d)]()[_0x1a0d2a(0x166)]()[_0x1a0d2a(0x128)](0x2,'0');RequestMonitor[_0x1a0d2a(0x135)][_0x1a0d2a(0x159)]=RequestMonitor[_0x1a0d2a(0x135)][_0x1a0d2a(0x159)][_0x1a0d2a(0x143)](-0x3c)[_0x1a0d2a(0x12b)](_0x48ebbd=>_0x48ebbd['time']!==_0x3270a5),RequestMonitor[_0x1a0d2a(0x135)][_0x1a0d2a(0x133)]=RequestMonitor[_0x1a0d2a(0x135)][_0x1a0d2a(0x133)][_0x1a0d2a(0x143)](-0x3c)['filter'](_0x1e1c7c=>_0x1e1c7c[_0x1a0d2a(0x11f)]!==_0x3270a5),RequestMonitor[_0x1a0d2a(0x135)][_0x1a0d2a(0x120)]=RequestMonitor['ressourcesUsageStats']['network'][_0x1a0d2a(0x143)](-0x3c)[_0x1a0d2a(0x12b)](_0x1fed3a=>_0x1fed3a[_0x1a0d2a(0x11f)]!==_0x3270a5),RequestMonitor['ressourcesUsageStats'][_0x1a0d2a(0x159)][_0x1a0d2a(0x157)]({'time':_0x3270a5,'usage':_0x188c83}),RequestMonitor[_0x1a0d2a(0x135)][_0x1a0d2a(0x133)][_0x1a0d2a(0x157)]({'time':_0x3270a5,'usage':(_0x5ed944[_0x1a0d2a(0x132)]/0x3e8)[_0x1a0d2a(0x144)](0x2)}),RequestMonitor[_0x1a0d2a(0x135)][_0x1a0d2a(0x120)][_0x1a0d2a(0x157)]({'time':_0x3270a5,'usage':{'in':_0xcbf2af[_0x1a0d2a(0x140)]?.[_0x1a0d2a(0x163)]??0x0,'out':_0xcbf2af[_0x1a0d2a(0x140)]?.[_0x1a0d2a(0x149)]??0x0}});try{await fs[_0x1a0d2a(0x141)](RequestMonitor[_0x1a0d2a(0x12c)],JSON[_0x1a0d2a(0x142)](RequestMonitor[_0x1a0d2a(0x135)],null,0x2));}catch(_0x13f43d){console[_0x1a0d2a(0x15e)](_0x1a0d2a(0x156),_0x13f43d);}}static[a1_0x39dfcf(0x139)](){const _0x2016e4=a1_0x39dfcf,_0x3570a3=Date['now'](),_0xc4471e=_0x3570a3-0x3c*0x3c*0x3e8,_0x1c45b0=_0x3570a3-0x18*0x3c*0x3c*0x3e8,_0x3e003f=RequestMonitor[_0x2016e4(0x160)][_0x2016e4(0x12b)](_0x524216=>_0x524216[_0x2016e4(0x13c)]>_0xc4471e),_0x40b8f1={'total':RequestMonitor['httpCodesData']['length'],'byCodes':{},'byPath':{}};return RequestMonitor[_0x2016e4(0x162)]['forEach'](_0x477124=>{const _0x6ef0c=_0x2016e4;_0x40b8f1[_0x6ef0c(0x127)][_0x477124[_0x6ef0c(0x14a)]]=(_0x40b8f1[_0x6ef0c(0x127)][_0x477124[_0x6ef0c(0x14a)]]||0x0)+0x1;const _0x4f8c45=_0x477124[_0x6ef0c(0x136)]+'\x20'+_0x477124[_0x6ef0c(0x15a)];!_0x40b8f1['byPath'][_0x4f8c45]&&(_0x40b8f1[_0x6ef0c(0x129)][_0x4f8c45]={'total':0x0,'codes':{}}),_0x40b8f1['byPath'][_0x4f8c45][_0x6ef0c(0x140)]++,_0x40b8f1[_0x6ef0c(0x129)][_0x4f8c45][_0x6ef0c(0x152)][_0x477124[_0x6ef0c(0x14a)]]=(_0x40b8f1['byPath'][_0x4f8c45][_0x6ef0c(0x152)][_0x477124['statusCode']]||0x0)+0x1;}),{'rps':_0x3e003f,'httpCodes':_0x40b8f1,'ressourcesUsageStats':RequestMonitor[_0x2016e4(0x135)]};}}RequestMonitor[a1_0x39dfcf(0x11e)]()['then'](()=>{}),RequestMonitor[a1_0x39dfcf(0x131)]();const counter=RequestMonitor;module[a1_0x39dfcf(0x11c)]=counter;