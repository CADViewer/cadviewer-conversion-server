function a2_0x1974(_0x38e02c,_0x4a4f9f){const _0x483d07=a2_0x483d();return a2_0x1974=function(_0x19749d,_0x195850){_0x19749d=_0x19749d-0x150;let _0x280dcf=_0x483d07[_0x19749d];return _0x280dcf;},a2_0x1974(_0x38e02c,_0x4a4f9f);}const a2_0x3cd63c=a2_0x1974;(function(_0x508df7,_0x210b10){const _0x44a507=a2_0x1974,_0x11da6b=_0x508df7();while(!![]){try{const _0x1e449d=-parseInt(_0x44a507(0x15d))/0x1*(parseInt(_0x44a507(0x17d))/0x2)+-parseInt(_0x44a507(0x161))/0x3*(-parseInt(_0x44a507(0x17b))/0x4)+parseInt(_0x44a507(0x15a))/0x5+parseInt(_0x44a507(0x184))/0x6*(parseInt(_0x44a507(0x180))/0x7)+parseInt(_0x44a507(0x16c))/0x8*(-parseInt(_0x44a507(0x150))/0x9)+parseInt(_0x44a507(0x172))/0xa+parseInt(_0x44a507(0x188))/0xb;if(_0x1e449d===_0x210b10)break;else _0x11da6b['push'](_0x11da6b['shift']());}catch(_0x1f048f){_0x11da6b['push'](_0x11da6b['shift']());}}}(a2_0x483d,0x658b7));function a2_0x483d(){const _0x219331=['promises','Error\x20saving\x20monitoring\x20data:','Request\x20monitor\x20initialized.','40420NbNIpr','now','1636slsWAx','network','toString','140854OzvRtY','=======>','init','apply','78sZLceF','info','Error\x20getting\x20CPU\x20usage:','currentRequests','9037182FlkpCH','stringify','getMinutes','statusCode','log','utf8','httpCodesData','end','time','node-os-utils','timestamp','ressourcesUsageStatsPath','httpCodesStoragePath','getStats','cpu','9vnYFBq','method','byCodes','includes','error','cadviewer/settings/http-codes-24h.json','then','floor','total','getUsageRessourcesStatsAndSave','1285330aRPsaA','byPath','lastMinute','974FjlTIX','ressourcesUsageStats','toFixed','getHours','132fyMkIL','parse','Error\x20getting\x20memory\x20usage:','rpsStoragePath','readFile','cadviewer/settings/ressources-usage-stats.json','push','exports','inputMb','slice','rpsData','6081832ohRRve','path','inOut','memory','filter','outputMb','1880540JZNKjl','mem','writeFile','save','startPeriodicSave','codes'];a2_0x483d=function(){return _0x219331;};return a2_0x483d();}const fs=require('fs')[a2_0x3cd63c(0x178)],osu=require(a2_0x3cd63c(0x191));class RequestMonitor{static ['rpsStoragePath']='cadviewer/settings/requests-per-minute.json';static [a2_0x3cd63c(0x194)]=a2_0x3cd63c(0x155);static ['ressourcesUsageStatsPath']=a2_0x3cd63c(0x166);static [a2_0x3cd63c(0x16b)]=[];static [a2_0x3cd63c(0x18e)]=[];static [a2_0x3cd63c(0x15e)]={};static ['lastMinute']=Math[a2_0x3cd63c(0x157)](Date[a2_0x3cd63c(0x17c)]()/0x3e8/0x3c);static [a2_0x3cd63c(0x187)]=0x0;static async[a2_0x3cd63c(0x182)](){const _0x1ee919=a2_0x3cd63c;console['log']('Initializing\x20request\x20monitor...');try{const _0x475cc2=await fs[_0x1ee919(0x165)](RequestMonitor[_0x1ee919(0x164)],_0x1ee919(0x18d));RequestMonitor['rpsData']=JSON['parse'](_0x475cc2);}catch(_0x2c4180){RequestMonitor['rpsData']=[];}try{const _0x3b2702=await fs[_0x1ee919(0x165)](RequestMonitor[_0x1ee919(0x194)],_0x1ee919(0x18d));RequestMonitor[_0x1ee919(0x18e)]=JSON['parse'](_0x3b2702);}catch(_0x554507){RequestMonitor[_0x1ee919(0x18e)]=[];}try{const _0x3c1993=await fs[_0x1ee919(0x165)](RequestMonitor[_0x1ee919(0x193)],'utf8');RequestMonitor['ressourcesUsageStats']=JSON[_0x1ee919(0x162)](_0x3c1993),!RequestMonitor[_0x1ee919(0x15e)][_0x1ee919(0x196)]&&(RequestMonitor[_0x1ee919(0x15e)]['cpu']=[]),!RequestMonitor[_0x1ee919(0x15e)][_0x1ee919(0x16f)]&&(RequestMonitor[_0x1ee919(0x15e)][_0x1ee919(0x16f)]=[]),!RequestMonitor['ressourcesUsageStats']['network']&&(RequestMonitor[_0x1ee919(0x15e)][_0x1ee919(0x17e)]=[]);}catch(_0x8314ea){RequestMonitor[_0x1ee919(0x15e)]={'cpu':[],'memory':[],'network':[]};}console[_0x1ee919(0x18c)](_0x1ee919(0x17a));}static['middleware'](_0x35a0a3,_0x54a4bf,_0xe9c779){const _0x22b127=a2_0x3cd63c;if(_0x35a0a3[_0x22b127(0x16d)][_0x22b127(0x153)]('/metrics'))return _0xe9c779();console[_0x22b127(0x18c)]('Request\x20monitor\x20middleware');let _0x5e28cc=Date[_0x22b127(0x17c)](),_0x43d270=Math[_0x22b127(0x157)](_0x5e28cc/0x3e8/0x3c);console[_0x22b127(0x18c)](_0x22b127(0x181));const _0xafb06a=_0x54a4bf[_0x22b127(0x18f)];_0x54a4bf[_0x22b127(0x18f)]=(..._0x3caff0)=>{const _0x3f52b6=_0x22b127;console['log'](_0x43d270,{'currentMinute':_0x43d270});_0x43d270>RequestMonitor[_0x3f52b6(0x15c)]&&(RequestMonitor['rpsData'][_0x3f52b6(0x167)]({'timestamp':RequestMonitor['lastMinute']*0x3e8*0x3c,'requests':RequestMonitor[_0x3f52b6(0x187)]}),RequestMonitor[_0x3f52b6(0x187)]=0x0,RequestMonitor[_0x3f52b6(0x15c)]=_0x43d270);RequestMonitor['currentRequests']++,RequestMonitor[_0x3f52b6(0x18e)]['push']({'timestamp':Date[_0x3f52b6(0x17c)](),'statusCode':_0x54a4bf[_0x3f52b6(0x18b)],'path':_0x35a0a3[_0x3f52b6(0x16d)],'method':_0x35a0a3['method']});const _0x202131=Date[_0x3f52b6(0x17c)]()-0x18*0x3c*0x3c*0x3e8;return RequestMonitor[_0x3f52b6(0x18e)]=RequestMonitor[_0x3f52b6(0x18e)][_0x3f52b6(0x170)](_0x419a90=>_0x419a90[_0x3f52b6(0x192)]>_0x202131),_0xafb06a[_0x3f52b6(0x183)](_0x54a4bf,_0x3caff0);},_0xe9c779();}static async[a2_0x3cd63c(0x175)](){const _0x4859f1=a2_0x3cd63c;try{RequestMonitor[_0x4859f1(0x15c)]!==Math[_0x4859f1(0x157)](Date[_0x4859f1(0x17c)]()/0x3e8/0x3c)&&(RequestMonitor[_0x4859f1(0x16b)][_0x4859f1(0x167)]({'timestamp':RequestMonitor['lastMinute']*0x3e8*0x3c,'requests':RequestMonitor['currentRequests']}),RequestMonitor['currentRequests']=0x0,RequestMonitor[_0x4859f1(0x15c)]=Math['floor'](Date[_0x4859f1(0x17c)]()/0x3e8/0x3c)),await fs[_0x4859f1(0x174)](RequestMonitor[_0x4859f1(0x164)],JSON[_0x4859f1(0x189)](RequestMonitor[_0x4859f1(0x16b)],null,0x2)),await fs[_0x4859f1(0x174)](RequestMonitor['httpCodesStoragePath'],JSON[_0x4859f1(0x189)](RequestMonitor[_0x4859f1(0x18e)],null,0x2));}catch(_0x2550da){console[_0x4859f1(0x154)](_0x4859f1(0x179),_0x2550da);}}static async[a2_0x3cd63c(0x176)](){const _0x37c818=a2_0x3cd63c;setInterval(()=>RequestMonitor[_0x37c818(0x175)](),0x3c*0x3e8),setInterval(()=>{const _0x3f610d=_0x37c818;RequestMonitor['getUsageRessourcesStatsAndSave']()[_0x3f610d(0x156)](()=>{});},0x3c*0x3e8),RequestMonitor[_0x37c818(0x159)]()[_0x37c818(0x156)](()=>{});}static async[a2_0x3cd63c(0x159)](){const _0x3849d7=a2_0x3cd63c,_0x5c08af=osu[_0x3849d7(0x196)],_0x31462e=osu[_0x3849d7(0x173)],_0x420a99=osu['netstat'],_0x420c7a={'total':{'inputMb':0x0,'outputMb':0x0}};try{const _0x32cf78=await _0x420a99[_0x3849d7(0x16e)]();_0x420c7a[_0x3849d7(0x158)][_0x3849d7(0x169)]=_0x32cf78[_0x3849d7(0x158)][_0x3849d7(0x169)],_0x420c7a[_0x3849d7(0x158)][_0x3849d7(0x171)]=_0x32cf78[_0x3849d7(0x158)]['outputMb'];}catch(_0x12d711){}let _0x3d009d=0x0;try{_0x3d009d=await _0x5c08af['usage']();}catch(_0x4a9b2a){console['log'](_0x3849d7(0x186),_0x4a9b2a);}const _0x4e1567={'usedMemMb':0x0};try{const _0x1fb1d9=await _0x31462e[_0x3849d7(0x185)]();_0x4e1567['usedMemMb']=_0x1fb1d9['usedMemMb'];}catch(_0x40f576){console['log'](_0x3849d7(0x163),_0x40f576);}const _0x45527b=new Date()[_0x3849d7(0x160)]()[_0x3849d7(0x17f)]()['padStart'](0x2,'0')+':'+new Date()[_0x3849d7(0x18a)]()[_0x3849d7(0x17f)]()['padStart'](0x2,'0');RequestMonitor[_0x3849d7(0x15e)]['cpu']=RequestMonitor[_0x3849d7(0x15e)][_0x3849d7(0x196)][_0x3849d7(0x16a)](-0x3c)[_0x3849d7(0x170)](_0x33feea=>_0x33feea[_0x3849d7(0x190)]!==_0x45527b),RequestMonitor['ressourcesUsageStats'][_0x3849d7(0x16f)]=RequestMonitor[_0x3849d7(0x15e)][_0x3849d7(0x16f)][_0x3849d7(0x16a)](-0x3c)[_0x3849d7(0x170)](_0x3ca65e=>_0x3ca65e['time']!==_0x45527b),RequestMonitor[_0x3849d7(0x15e)][_0x3849d7(0x17e)]=RequestMonitor[_0x3849d7(0x15e)]['network']['slice'](-0x3c)[_0x3849d7(0x170)](_0xc6cdd6=>_0xc6cdd6[_0x3849d7(0x190)]!==_0x45527b),RequestMonitor[_0x3849d7(0x15e)][_0x3849d7(0x196)][_0x3849d7(0x167)]({'time':_0x45527b,'usage':_0x3d009d}),RequestMonitor[_0x3849d7(0x15e)][_0x3849d7(0x16f)]['push']({'time':_0x45527b,'usage':(_0x4e1567['usedMemMb']/0x3e8)[_0x3849d7(0x15f)](0x2)}),RequestMonitor[_0x3849d7(0x15e)][_0x3849d7(0x17e)]['push']({'time':_0x45527b,'usage':{'in':_0x420c7a[_0x3849d7(0x158)]?.[_0x3849d7(0x169)]??0x0,'out':_0x420c7a[_0x3849d7(0x158)]?.[_0x3849d7(0x171)]??0x0}});try{await fs[_0x3849d7(0x174)](RequestMonitor[_0x3849d7(0x193)],JSON[_0x3849d7(0x189)](RequestMonitor['ressourcesUsageStats'],null,0x2));}catch(_0x3306d6){console[_0x3849d7(0x154)](_0x3849d7(0x179),_0x3306d6);}}static[a2_0x3cd63c(0x195)](){const _0x203362=a2_0x3cd63c,_0x658bee=Date['now'](),_0x5c4630=_0x658bee-0x3c*0x3c*0x3e8,_0x5e5831=_0x658bee-0x18*0x3c*0x3c*0x3e8,_0x5b50b5=RequestMonitor[_0x203362(0x16b)][_0x203362(0x170)](_0x24d339=>_0x24d339[_0x203362(0x192)]>_0x5c4630),_0x507b6b={'total':RequestMonitor[_0x203362(0x18e)]['length'],'byCodes':{},'byPath':{}};return RequestMonitor[_0x203362(0x18e)]['forEach'](_0x52c3c7=>{const _0x21603a=_0x203362;_0x507b6b[_0x21603a(0x152)][_0x52c3c7[_0x21603a(0x18b)]]=(_0x507b6b[_0x21603a(0x152)][_0x52c3c7[_0x21603a(0x18b)]]||0x0)+0x1;const _0x41b879=_0x52c3c7[_0x21603a(0x151)]+'\x20'+_0x52c3c7[_0x21603a(0x16d)];!_0x507b6b['byPath'][_0x41b879]&&(_0x507b6b[_0x21603a(0x15b)][_0x41b879]={'total':0x0,'codes':{}}),_0x507b6b[_0x21603a(0x15b)][_0x41b879][_0x21603a(0x158)]++,_0x507b6b['byPath'][_0x41b879]['codes'][_0x52c3c7[_0x21603a(0x18b)]]=(_0x507b6b[_0x21603a(0x15b)][_0x41b879][_0x21603a(0x177)][_0x52c3c7[_0x21603a(0x18b)]]||0x0)+0x1;}),{'rps':_0x5b50b5,'httpCodes':_0x507b6b,'ressourcesUsageStats':RequestMonitor[_0x203362(0x15e)]};}}RequestMonitor['init']()[a2_0x3cd63c(0x156)](()=>{}),RequestMonitor[a2_0x3cd63c(0x176)]();const counter=RequestMonitor;module[a2_0x3cd63c(0x168)]=counter;