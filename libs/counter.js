function a1_0x22cf(_0x359243,_0x2ac474){const _0x1b5944=a1_0x1b59();return a1_0x22cf=function(_0x22cfdf,_0x40f47f){_0x22cfdf=_0x22cfdf-0x125;let _0x8f06db=_0x1b5944[_0x22cfdf];return _0x8f06db;},a1_0x22cf(_0x359243,_0x2ac474);}const a1_0x7f7886=a1_0x22cf;(function(_0x4468c2,_0x40f4db){const _0x1ee487=a1_0x22cf,_0x354419=_0x4468c2();while(!![]){try{const _0x11c5d2=parseInt(_0x1ee487(0x14f))/0x1*(parseInt(_0x1ee487(0x128))/0x2)+-parseInt(_0x1ee487(0x16f))/0x3+parseInt(_0x1ee487(0x13e))/0x4*(parseInt(_0x1ee487(0x138))/0x5)+parseInt(_0x1ee487(0x13a))/0x6+parseInt(_0x1ee487(0x12c))/0x7*(parseInt(_0x1ee487(0x135))/0x8)+-parseInt(_0x1ee487(0x127))/0x9*(parseInt(_0x1ee487(0x15b))/0xa)+-parseInt(_0x1ee487(0x144))/0xb;if(_0x11c5d2===_0x40f4db)break;else _0x354419['push'](_0x354419['shift']());}catch(_0xa433c9){_0x354419['push'](_0x354419['shift']());}}}(a1_0x1b59,0xaacae));const fs=require('fs')[a1_0x7f7886(0x12d)],osu=require(a1_0x7f7886(0x14e));class RequestMonitor{static [a1_0x7f7886(0x145)]='cadviewer/settings/requests-per-minute.json';static ['httpCodesStoragePath']=a1_0x7f7886(0x130);static [a1_0x7f7886(0x156)]=a1_0x7f7886(0x16c);static ['rpsData']=[];static [a1_0x7f7886(0x12a)]=[];static [a1_0x7f7886(0x14b)]={};static [a1_0x7f7886(0x13d)]=Math[a1_0x7f7886(0x15d)](Date['now']()/0x3e8/0x3c);static [a1_0x7f7886(0x139)]=0x0;static async[a1_0x7f7886(0x14d)](){const _0x59e443=a1_0x7f7886;console[_0x59e443(0x13c)]('Initializing\x20request\x20monitor...');try{const _0x353508=await fs[_0x59e443(0x165)](RequestMonitor[_0x59e443(0x145)],_0x59e443(0x133));RequestMonitor[_0x59e443(0x12f)]=JSON[_0x59e443(0x131)](_0x353508);}catch(_0x330022){RequestMonitor[_0x59e443(0x12f)]=[];}try{const _0x56f883=await fs[_0x59e443(0x165)](RequestMonitor['httpCodesStoragePath'],_0x59e443(0x133));RequestMonitor[_0x59e443(0x12a)]=JSON[_0x59e443(0x131)](_0x56f883);}catch(_0x4fd1a4){RequestMonitor[_0x59e443(0x12a)]=[];}try{const _0x2b8c46=await fs[_0x59e443(0x165)](RequestMonitor[_0x59e443(0x156)],_0x59e443(0x133));RequestMonitor[_0x59e443(0x14b)]=JSON[_0x59e443(0x131)](_0x2b8c46),!RequestMonitor[_0x59e443(0x14b)][_0x59e443(0x164)]&&(RequestMonitor[_0x59e443(0x14b)][_0x59e443(0x164)]=[]),!RequestMonitor[_0x59e443(0x14b)][_0x59e443(0x159)]&&(RequestMonitor[_0x59e443(0x14b)][_0x59e443(0x159)]=[]),!RequestMonitor['ressourcesUsageStats'][_0x59e443(0x162)]&&(RequestMonitor[_0x59e443(0x14b)]['network']=[]);}catch(_0x42e2c2){RequestMonitor[_0x59e443(0x14b)]={'cpu':[],'memory':[],'network':[]};}console[_0x59e443(0x13c)](_0x59e443(0x12b));}static[a1_0x7f7886(0x140)](_0x22cfcc,_0x51e015,_0x435a18){const _0x35d280=a1_0x7f7886;if(_0x22cfcc['path']['includes'](_0x35d280(0x155)))return _0x435a18();console[_0x35d280(0x13c)](_0x35d280(0x141));let _0x19a86e=Date['now'](),_0x586601=Math[_0x35d280(0x15d)](_0x19a86e/0x3e8/0x3c);console[_0x35d280(0x13c)](_0x35d280(0x16e));const _0x5834b6=_0x51e015[_0x35d280(0x153)];_0x51e015[_0x35d280(0x153)]=(..._0xbb85bf)=>{const _0x44f405=_0x35d280;console[_0x44f405(0x13c)](_0x586601,{'currentMinute':_0x586601});_0x586601>RequestMonitor['lastMinute']&&(RequestMonitor[_0x44f405(0x12f)][_0x44f405(0x166)]({'timestamp':RequestMonitor['lastMinute']*0x3e8*0x3c,'requests':RequestMonitor[_0x44f405(0x139)]}),RequestMonitor['currentRequests']=0x0,RequestMonitor[_0x44f405(0x13d)]=_0x586601);RequestMonitor[_0x44f405(0x139)]++,RequestMonitor[_0x44f405(0x12a)][_0x44f405(0x166)]({'timestamp':Date['now'](),'statusCode':_0x51e015['statusCode'],'path':_0x22cfcc[_0x44f405(0x14c)],'method':_0x22cfcc[_0x44f405(0x14a)]});const _0x4639a5=Date['now']()-0x18*0x3c*0x3c*0x3e8;return RequestMonitor[_0x44f405(0x12a)]=RequestMonitor[_0x44f405(0x12a)][_0x44f405(0x146)](_0x57ab3c=>_0x57ab3c[_0x44f405(0x147)]>_0x4639a5),_0x5834b6['apply'](_0x51e015,_0xbb85bf);},_0x435a18();}static async[a1_0x7f7886(0x136)](){const _0x39b4eb=a1_0x7f7886;try{RequestMonitor[_0x39b4eb(0x13d)]!==Math[_0x39b4eb(0x15d)](Date[_0x39b4eb(0x129)]()/0x3e8/0x3c)&&(RequestMonitor[_0x39b4eb(0x12f)][_0x39b4eb(0x166)]({'timestamp':RequestMonitor[_0x39b4eb(0x13d)]*0x3e8*0x3c,'requests':RequestMonitor[_0x39b4eb(0x139)]}),RequestMonitor[_0x39b4eb(0x139)]=0x0,RequestMonitor[_0x39b4eb(0x13d)]=Math[_0x39b4eb(0x15d)](Date[_0x39b4eb(0x129)]()/0x3e8/0x3c)),await fs['writeFile'](RequestMonitor['rpsStoragePath'],JSON[_0x39b4eb(0x163)](RequestMonitor[_0x39b4eb(0x12f)],null,0x2)),await fs['writeFile'](RequestMonitor[_0x39b4eb(0x169)],JSON[_0x39b4eb(0x163)](RequestMonitor[_0x39b4eb(0x12a)],null,0x2));}catch(_0x2078bf){console[_0x39b4eb(0x16b)](_0x39b4eb(0x16d),_0x2078bf);}}static async['startPeriodicSave'](){const _0x338f12=a1_0x7f7886;setInterval(()=>RequestMonitor['save'](),0x3c*0x3e8),setInterval(()=>{const _0x2f3d4=a1_0x22cf;RequestMonitor[_0x2f3d4(0x167)]()[_0x2f3d4(0x151)](()=>{});},0x3c*0x3e8),RequestMonitor[_0x338f12(0x167)]()[_0x338f12(0x151)](()=>{});}static async[a1_0x7f7886(0x167)](){const _0x3f0162=a1_0x7f7886,_0x49bd8f=osu[_0x3f0162(0x164)],_0x337b8f=osu[_0x3f0162(0x137)],_0x1daac1=osu[_0x3f0162(0x134)],_0x2202f4={'total':{'inputMb':0x0,'outputMb':0x0}};try{const _0x285608=await _0x1daac1[_0x3f0162(0x160)]();_0x2202f4[_0x3f0162(0x15c)]['inputMb']=_0x285608['total'][_0x3f0162(0x142)],_0x2202f4['total']['outputMb']=_0x285608['total'][_0x3f0162(0x126)];}catch(_0x1e73f9){}let _0x151ea3=0x0;try{_0x151ea3=await _0x49bd8f[_0x3f0162(0x143)]();}catch(_0x4fc621){console['log'](_0x3f0162(0x125),_0x4fc621);}const _0x4b9a1f={'usedMemMb':0x0};try{const _0x32e47d=await _0x337b8f[_0x3f0162(0x15f)]();_0x4b9a1f[_0x3f0162(0x15e)]=_0x32e47d[_0x3f0162(0x15e)];}catch(_0x31a061){console[_0x3f0162(0x13c)]('Error\x20getting\x20memory\x20usage:',_0x31a061);}const _0x28b14e=new Date()[_0x3f0162(0x132)]()['toString']()[_0x3f0162(0x152)](0x2,'0')+':'+new Date()['getMinutes']()[_0x3f0162(0x158)]()[_0x3f0162(0x152)](0x2,'0');RequestMonitor['ressourcesUsageStats'][_0x3f0162(0x164)]=RequestMonitor[_0x3f0162(0x14b)]['cpu'][_0x3f0162(0x148)](-0x3c)['filter'](_0x44b9cc=>_0x44b9cc[_0x3f0162(0x168)]!==_0x28b14e),RequestMonitor['ressourcesUsageStats']['memory']=RequestMonitor['ressourcesUsageStats'][_0x3f0162(0x159)][_0x3f0162(0x148)](-0x3c)[_0x3f0162(0x146)](_0x2c1434=>_0x2c1434[_0x3f0162(0x168)]!==_0x28b14e),RequestMonitor[_0x3f0162(0x14b)][_0x3f0162(0x162)]=RequestMonitor[_0x3f0162(0x14b)]['network'][_0x3f0162(0x148)](-0x3c)[_0x3f0162(0x146)](_0x562602=>_0x562602['time']!==_0x28b14e),RequestMonitor['ressourcesUsageStats']['cpu'][_0x3f0162(0x166)]({'time':_0x28b14e,'usage':_0x151ea3}),RequestMonitor['ressourcesUsageStats'][_0x3f0162(0x159)][_0x3f0162(0x166)]({'time':_0x28b14e,'usage':(_0x4b9a1f[_0x3f0162(0x15e)]/0x3e8)[_0x3f0162(0x13b)](0x2)}),RequestMonitor[_0x3f0162(0x14b)][_0x3f0162(0x162)]['push']({'time':_0x28b14e,'usage':{'in':_0x2202f4[_0x3f0162(0x15c)]?.[_0x3f0162(0x142)]??0x0,'out':_0x2202f4['total']?.[_0x3f0162(0x126)]??0x0}});try{await fs[_0x3f0162(0x150)](RequestMonitor[_0x3f0162(0x156)],JSON[_0x3f0162(0x163)](RequestMonitor[_0x3f0162(0x14b)],null,0x2));}catch(_0xf7bccf){console[_0x3f0162(0x16b)]('Error\x20saving\x20monitoring\x20data:',_0xf7bccf);}}static[a1_0x7f7886(0x15a)](){const _0x18e594=a1_0x7f7886,_0x545e52=Date[_0x18e594(0x129)](),_0x570af7=_0x545e52-0x3c*0x3c*0x3e8,_0x1a14cc=_0x545e52-0x18*0x3c*0x3c*0x3e8,_0x1927b5=RequestMonitor['rpsData'][_0x18e594(0x146)](_0xcaea57=>_0xcaea57[_0x18e594(0x147)]>_0x570af7),_0x2e511b={'total':RequestMonitor[_0x18e594(0x12a)][_0x18e594(0x161)],'byCodes':{},'byPath':{}};return RequestMonitor[_0x18e594(0x12a)][_0x18e594(0x149)](_0x38e8a9=>{const _0x3f17ad=_0x18e594;_0x2e511b[_0x3f17ad(0x154)][_0x38e8a9[_0x3f17ad(0x16a)]]=(_0x2e511b[_0x3f17ad(0x154)][_0x38e8a9['statusCode']]||0x0)+0x1;const _0x36901c=_0x38e8a9['method']+'\x20'+_0x38e8a9[_0x3f17ad(0x14c)];!_0x2e511b[_0x3f17ad(0x157)][_0x36901c]&&(_0x2e511b[_0x3f17ad(0x157)][_0x36901c]={'total':0x0,'codes':{}}),_0x2e511b[_0x3f17ad(0x157)][_0x36901c][_0x3f17ad(0x15c)]++,_0x2e511b[_0x3f17ad(0x157)][_0x36901c][_0x3f17ad(0x12e)][_0x38e8a9[_0x3f17ad(0x16a)]]=(_0x2e511b[_0x3f17ad(0x157)][_0x36901c]['codes'][_0x38e8a9[_0x3f17ad(0x16a)]]||0x0)+0x1;}),{'rps':_0x1927b5,'httpCodes':_0x2e511b,'ressourcesUsageStats':RequestMonitor[_0x18e594(0x14b)]};}}RequestMonitor['init']()[a1_0x7f7886(0x151)](()=>{}),RequestMonitor['startPeriodicSave']();const counter=RequestMonitor;module[a1_0x7f7886(0x13f)]=counter;function a1_0x1b59(){const _0x5ddd60=['getHours','utf8','netstat','5083480nOCDBp','save','mem','4039575ajkLob','currentRequests','1608882WaONts','toFixed','log','lastMinute','4OIkigX','exports','middleware','Request\x20monitor\x20middleware','inputMb','usage','9265014KQsJAF','rpsStoragePath','filter','timestamp','slice','forEach','method','ressourcesUsageStats','path','init','node-os-utils','110858ZrcVuc','writeFile','then','padStart','end','byCodes','/metrics','ressourcesUsageStatsPath','byPath','toString','memory','getStats','72140mTgXlm','total','floor','usedMemMb','info','inOut','length','network','stringify','cpu','readFile','push','getUsageRessourcesStatsAndSave','time','httpCodesStoragePath','statusCode','error','cadviewer/settings/ressources-usage-stats.json','Error\x20saving\x20monitoring\x20data:','=======>','3388173CmapRm','Error\x20getting\x20CPU\x20usage:','outputMb','324LAvZeJ','22xPTaNh','now','httpCodesData','Request\x20monitor\x20initialized.','7UlIykZ','promises','codes','rpsData','cadviewer/settings/http-codes-24h.json','parse'];a1_0x1b59=function(){return _0x5ddd60;};return a1_0x1b59();}