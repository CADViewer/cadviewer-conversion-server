const a2_0x302f23=a2_0x5556;(function(_0x590808,_0x4df625){const _0x6e4489=a2_0x5556,_0x4928e5=_0x590808();while(!![]){try{const _0x3e1ee7=parseInt(_0x6e4489(0x146))/0x1+parseInt(_0x6e4489(0x17d))/0x2*(parseInt(_0x6e4489(0x14c))/0x3)+-parseInt(_0x6e4489(0x147))/0x4*(-parseInt(_0x6e4489(0x171))/0x5)+-parseInt(_0x6e4489(0x160))/0x6+parseInt(_0x6e4489(0x172))/0x7*(-parseInt(_0x6e4489(0x16e))/0x8)+parseInt(_0x6e4489(0x163))/0x9+-parseInt(_0x6e4489(0x149))/0xa*(parseInt(_0x6e4489(0x15d))/0xb);if(_0x3e1ee7===_0x4df625)break;else _0x4928e5['push'](_0x4928e5['shift']());}catch(_0x51af9e){_0x4928e5['push'](_0x4928e5['shift']());}}}(a2_0x43c8,0x276ad));const fs=require('fs')[a2_0x302f23(0x17a)],osu=require(a2_0x302f23(0x158));class RequestMonitor{static [a2_0x302f23(0x187)]=a2_0x302f23(0x189);static [a2_0x302f23(0x169)]=a2_0x302f23(0x18f);static ['ressourcesUsageStatsPath']=a2_0x302f23(0x177);static ['rpsData']=[];static [a2_0x302f23(0x164)]=[];static [a2_0x302f23(0x188)]={};static [a2_0x302f23(0x143)]=Math['floor'](Date[a2_0x302f23(0x15b)]()/0x3e8/0x3c);static ['currentRequests']=0x0;static async[a2_0x302f23(0x17f)](){const _0x45ce4b=a2_0x302f23;console[_0x45ce4b(0x14d)]('Initializing\x20request\x20monitor...');try{const _0x5a208b=await fs['readFile'](RequestMonitor[_0x45ce4b(0x187)],'utf8');RequestMonitor[_0x45ce4b(0x168)]=JSON[_0x45ce4b(0x162)](_0x5a208b);}catch(_0x5f0d1c){RequestMonitor[_0x45ce4b(0x168)]=[];}try{const _0x57e219=await fs[_0x45ce4b(0x14e)](RequestMonitor['httpCodesStoragePath'],'utf8');RequestMonitor[_0x45ce4b(0x164)]=JSON[_0x45ce4b(0x162)](_0x57e219);}catch(_0x51b3d4){RequestMonitor[_0x45ce4b(0x164)]=[];}try{const _0x51019a=await fs[_0x45ce4b(0x14e)](RequestMonitor['ressourcesUsageStatsPath'],_0x45ce4b(0x16d));RequestMonitor['ressourcesUsageStats']=JSON['parse'](_0x51019a),!RequestMonitor['ressourcesUsageStats'][_0x45ce4b(0x183)]&&(RequestMonitor['ressourcesUsageStats']['cpu']=[]),!RequestMonitor[_0x45ce4b(0x188)][_0x45ce4b(0x148)]&&(RequestMonitor['ressourcesUsageStats']['memory']=[]),!RequestMonitor[_0x45ce4b(0x188)][_0x45ce4b(0x145)]&&(RequestMonitor[_0x45ce4b(0x188)][_0x45ce4b(0x145)]=[]);}catch(_0x438713){RequestMonitor[_0x45ce4b(0x188)]={'cpu':[],'memory':[],'network':[]};}console[_0x45ce4b(0x14d)]('Request\x20monitor\x20initialized.');}static[a2_0x302f23(0x166)](_0x4e8e8d,_0x45b328,_0x573320){const _0x1a0e59=a2_0x302f23;if(_0x4e8e8d[_0x1a0e59(0x161)][_0x1a0e59(0x18d)](_0x1a0e59(0x17c)))return _0x573320();console['log'](_0x1a0e59(0x14b));let _0x3a72ec=Date['now'](),_0x65cc8a=Math[_0x1a0e59(0x18c)](_0x3a72ec/0x3e8/0x3c);console[_0x1a0e59(0x14d)](_0x1a0e59(0x14a));const _0x1411e9=_0x45b328[_0x1a0e59(0x153)];_0x45b328[_0x1a0e59(0x153)]=(..._0x32b087)=>{const _0xc35498=_0x1a0e59;console[_0xc35498(0x14d)](_0x65cc8a,{'currentMinute':_0x65cc8a});_0x65cc8a>RequestMonitor[_0xc35498(0x143)]&&(RequestMonitor[_0xc35498(0x168)][_0xc35498(0x178)]({'timestamp':RequestMonitor['lastMinute']*0x3e8*0x3c,'requests':RequestMonitor[_0xc35498(0x173)]}),RequestMonitor[_0xc35498(0x173)]=0x0,RequestMonitor[_0xc35498(0x143)]=_0x65cc8a);RequestMonitor[_0xc35498(0x173)]++,RequestMonitor[_0xc35498(0x164)]['push']({'timestamp':Date[_0xc35498(0x15b)](),'statusCode':_0x45b328[_0xc35498(0x170)],'path':_0x4e8e8d['path'],'method':_0x4e8e8d[_0xc35498(0x144)]});const _0x573448=Date[_0xc35498(0x15b)]()-0x18*0x3c*0x3c*0x3e8;return RequestMonitor['httpCodesData']=RequestMonitor[_0xc35498(0x164)][_0xc35498(0x155)](_0x58c041=>_0x58c041[_0xc35498(0x174)]>_0x573448),_0x1411e9[_0xc35498(0x16c)](_0x45b328,_0x32b087);},_0x573320();}static async[a2_0x302f23(0x16b)](){const _0x31e822=a2_0x302f23;try{RequestMonitor[_0x31e822(0x143)]!==Math['floor'](Date[_0x31e822(0x15b)]()/0x3e8/0x3c)&&(RequestMonitor[_0x31e822(0x168)][_0x31e822(0x178)]({'timestamp':RequestMonitor['lastMinute']*0x3e8*0x3c,'requests':RequestMonitor[_0x31e822(0x173)]}),RequestMonitor[_0x31e822(0x173)]=0x0,RequestMonitor['lastMinute']=Math[_0x31e822(0x18c)](Date[_0x31e822(0x15b)]()/0x3e8/0x3c)),await fs[_0x31e822(0x150)](RequestMonitor[_0x31e822(0x187)],JSON[_0x31e822(0x14f)](RequestMonitor[_0x31e822(0x168)],null,0x2)),await fs[_0x31e822(0x150)](RequestMonitor[_0x31e822(0x169)],JSON['stringify'](RequestMonitor['httpCodesData'],null,0x2));}catch(_0x246a57){console['error'](_0x31e822(0x165),_0x246a57);}}static async[a2_0x302f23(0x16f)](){const _0x4ec817=a2_0x302f23;setInterval(()=>RequestMonitor[_0x4ec817(0x16b)](),0x3c*0x3e8),setInterval(()=>{const _0x27fb56=_0x4ec817;RequestMonitor[_0x27fb56(0x151)]()['then'](()=>{});},0x3c*0x3e8),RequestMonitor['getUsageRessourcesStatsAndSave']()[_0x4ec817(0x17b)](()=>{});}static async[a2_0x302f23(0x151)](){const _0xdeeb63=a2_0x302f23,_0x121df0=osu[_0xdeeb63(0x183)],_0x803c7e=osu['mem'],_0x5eb55c=osu[_0xdeeb63(0x18b)],_0x549ddd={'total':{'inputMb':0x0,'outputMb':0x0}};try{const _0xa615df=await _0x5eb55c[_0xdeeb63(0x156)]();_0x549ddd[_0xdeeb63(0x179)][_0xdeeb63(0x18a)]=_0xa615df[_0xdeeb63(0x179)]['inputMb'],_0x549ddd['total'][_0xdeeb63(0x182)]=_0xa615df[_0xdeeb63(0x179)][_0xdeeb63(0x182)];}catch(_0x27d959){}let _0x15d575=0x0;try{_0x15d575=await _0x121df0['usage']();}catch(_0x4e0a1a){console[_0xdeeb63(0x14d)](_0xdeeb63(0x154),_0x4e0a1a);}const _0x34a7cf={'usedMemMb':0x0};try{const _0x36af44=await _0x803c7e[_0xdeeb63(0x176)]();_0x34a7cf['usedMemMb']=_0x36af44['usedMemMb'];}catch(_0x219afa){console[_0xdeeb63(0x14d)](_0xdeeb63(0x180),_0x219afa);}const _0x2ffd94=new Date()[_0xdeeb63(0x190)]()[_0xdeeb63(0x15c)]()[_0xdeeb63(0x167)](0x2,'0')+':'+new Date()[_0xdeeb63(0x184)]()['toString']()[_0xdeeb63(0x167)](0x2,'0');RequestMonitor[_0xdeeb63(0x188)][_0xdeeb63(0x183)]=RequestMonitor[_0xdeeb63(0x188)][_0xdeeb63(0x183)]['slice'](-0x3c)[_0xdeeb63(0x155)](_0x460b00=>_0x460b00[_0xdeeb63(0x159)]!==_0x2ffd94),RequestMonitor[_0xdeeb63(0x188)][_0xdeeb63(0x148)]=RequestMonitor[_0xdeeb63(0x188)]['memory']['slice'](-0x3c)[_0xdeeb63(0x155)](_0x314e78=>_0x314e78['time']!==_0x2ffd94),RequestMonitor[_0xdeeb63(0x188)][_0xdeeb63(0x145)]=RequestMonitor[_0xdeeb63(0x188)][_0xdeeb63(0x145)][_0xdeeb63(0x175)](-0x3c)[_0xdeeb63(0x155)](_0x1cec99=>_0x1cec99[_0xdeeb63(0x159)]!==_0x2ffd94),RequestMonitor[_0xdeeb63(0x188)]['cpu']['push']({'time':_0x2ffd94,'usage':_0x15d575}),RequestMonitor[_0xdeeb63(0x188)][_0xdeeb63(0x148)]['push']({'time':_0x2ffd94,'usage':(_0x34a7cf[_0xdeeb63(0x152)]/0x3e8)[_0xdeeb63(0x181)](0x2)}),RequestMonitor[_0xdeeb63(0x188)]['network'][_0xdeeb63(0x178)]({'time':_0x2ffd94,'usage':{'in':_0x549ddd['total']?.[_0xdeeb63(0x18a)]??0x0,'out':_0x549ddd[_0xdeeb63(0x179)]?.[_0xdeeb63(0x182)]??0x0}});try{await fs[_0xdeeb63(0x150)](RequestMonitor[_0xdeeb63(0x18e)],JSON[_0xdeeb63(0x14f)](RequestMonitor[_0xdeeb63(0x188)],null,0x2));}catch(_0x541520){console[_0xdeeb63(0x15e)](_0xdeeb63(0x165),_0x541520);}}static[a2_0x302f23(0x15a)](){const _0xd987e3=a2_0x302f23,_0x58882b=Date[_0xd987e3(0x15b)](),_0x212fcc=_0x58882b-0x3c*0x3c*0x3e8,_0x38c3f7=_0x58882b-0x18*0x3c*0x3c*0x3e8,_0x4d4b35=RequestMonitor[_0xd987e3(0x168)]['filter'](_0x1d4294=>_0x1d4294[_0xd987e3(0x174)]>_0x212fcc),_0x45c98b={'total':RequestMonitor[_0xd987e3(0x164)][_0xd987e3(0x186)],'byCodes':{},'byPath':{}};return RequestMonitor[_0xd987e3(0x164)][_0xd987e3(0x16a)](_0x58ec6f=>{const _0x417c36=_0xd987e3;_0x45c98b[_0x417c36(0x17e)][_0x58ec6f['statusCode']]=(_0x45c98b['byCodes'][_0x58ec6f[_0x417c36(0x170)]]||0x0)+0x1;const _0xff42de=_0x58ec6f[_0x417c36(0x144)]+'\x20'+_0x58ec6f[_0x417c36(0x161)];!_0x45c98b[_0x417c36(0x157)][_0xff42de]&&(_0x45c98b[_0x417c36(0x157)][_0xff42de]={'total':0x0,'codes':{}}),_0x45c98b[_0x417c36(0x157)][_0xff42de]['total']++,_0x45c98b[_0x417c36(0x157)][_0xff42de][_0x417c36(0x15f)][_0x58ec6f['statusCode']]=(_0x45c98b['byPath'][_0xff42de][_0x417c36(0x15f)][_0x58ec6f[_0x417c36(0x170)]]||0x0)+0x1;}),{'rps':_0x4d4b35,'httpCodes':_0x45c98b,'ressourcesUsageStats':RequestMonitor[_0xd987e3(0x188)]};}}function a2_0x5556(_0x59df15,_0x5ef3c0){const _0x43c860=a2_0x43c8();return a2_0x5556=function(_0x5556ef,_0x56b2bf){_0x5556ef=_0x5556ef-0x143;let _0x4a0dd0=_0x43c860[_0x5556ef];return _0x4a0dd0;},a2_0x5556(_0x59df15,_0x5ef3c0);}RequestMonitor['init']()[a2_0x302f23(0x17b)](()=>{}),RequestMonitor[a2_0x302f23(0x16f)]();function a2_0x43c8(){const _0x36659c=['statusCode','1218850SKydlE','351953kHypFr','currentRequests','timestamp','slice','info','cadviewer/settings/ressources-usage-stats.json','push','total','promises','then','/metrics','90290nwQznS','byCodes','init','Error\x20getting\x20memory\x20usage:','toFixed','outputMb','cpu','getMinutes','exports','length','rpsStoragePath','ressourcesUsageStats','cadviewer/settings/requests-per-minute.json','inputMb','netstat','floor','includes','ressourcesUsageStatsPath','cadviewer/settings/http-codes-24h.json','getHours','lastMinute','method','network','183100XLZsgV','4InXdKy','memory','30EbIfXF','=======>','Request\x20monitor\x20middleware','15jguMkh','log','readFile','stringify','writeFile','getUsageRessourcesStatsAndSave','usedMemMb','end','Error\x20getting\x20CPU\x20usage:','filter','inOut','byPath','node-os-utils','time','getStats','now','toString','1822865zmMgYE','error','codes','251562OMtPut','path','parse','1336392tePAOH','httpCodesData','Error\x20saving\x20monitoring\x20data:','middleware','padStart','rpsData','httpCodesStoragePath','forEach','save','apply','utf8','16FqgeIQ','startPeriodicSave'];a2_0x43c8=function(){return _0x36659c;};return a2_0x43c8();}const counter=RequestMonitor;module[a2_0x302f23(0x185)]=counter;